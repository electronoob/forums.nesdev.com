<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=20&amp;t=7385" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2011-01-16T10:10:05-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=20&amp;t=7385</id>
<entry>
<author><name><![CDATA[DParrott]]></name></author>
<updated>2011-01-16T10:10:05-07:00</updated>
<published>2011-01-16T10:10:05-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72779#p72779</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72779#p72779"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72779#p72779"><![CDATA[
OK, after playing a game of spot the muppet and fixing my ROM banking I'm there:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">cpu_instrs<br /><br />01:ok  02:ok  03:ok  04:ok  05:ok  06:ok  07:ok  08:ok  09:ok  10:ok  11:ok  <br /><br />Passed all tests</div><br /><br /><img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Now onto the next bits.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4497">DParrott</a> — Sun Jan 16, 2011 10:10 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[DParrott]]></name></author>
<updated>2011-01-16T04:36:32-07:00</updated>
<published>2011-01-16T04:36:32-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72772#p72772</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72772#p72772"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72772#p72772"><![CDATA[
<div class="quotetitle">mic_ wrote:</div><div class="quotecontent"><br />IIRC, it should be set for SBC if the low 4 bits of the second operand (including the carry) are greater than the low 4 bits of the first operand.<br /></div><br />Thanks.<br /><br />After fixing that and some of my shifts and rotates I now get the following:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">cpu_instrs<br /><br />01:ok  02:ok  03:ok  04:ok  <br /><br />Passed all tests</div><br /><br /><img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Not sure why I'm only getting 4 tests run though. If I run the test on another emulator I see it run 11 tests. Would it be dependent on some features I'm missing? I've run all these tests so far before doing any LCD emulation, the output I'm getting from the serial IO.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4497">DParrott</a> — Sun Jan 16, 2011 4:36 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mic_]]></name></author>
<updated>2011-01-15T11:08:09-07:00</updated>
<published>2011-01-15T11:08:09-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72753#p72753</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72753#p72753"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72753#p72753"><![CDATA[
IIRC, it should be set for SBC if the low 4 bits of the second operand (including the carry) are greater than the low 4 bits of the first operand.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1181">mic_</a> — Sat Jan 15, 2011 11:08 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[DParrott]]></name></author>
<updated>2011-01-15T10:55:29-07:00</updated>
<published>2011-01-15T10:55:29-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72752#p72752</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72752#p72752"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72752#p72752"><![CDATA[
I think I have narrowed it down to my SBC opcode and the H flag.<br /><br />What should be happening to the H flag during SBC?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4497">DParrott</a> — Sat Jan 15, 2011 10:55 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[DParrott]]></name></author>
<updated>2011-01-15T09:39:39-07:00</updated>
<published>2011-01-15T09:39:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72751#p72751</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72751#p72751"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72751#p72751"><![CDATA[
<div class="quotetitle">mic_ wrote:</div><div class="quotecontent"><br />Well are you sure 0E is the opcode? It might be something else, like an index into the table of values that it's testing the instructions with.<br /></div><br />No <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />That's where I'm unsure, don't know if it's the opcode or an index into the table etc.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4497">DParrott</a> — Sat Jan 15, 2011 9:39 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mic_]]></name></author>
<updated>2011-01-15T09:32:05-07:00</updated>
<published>2011-01-15T09:32:05-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72750#p72750</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72750#p72750"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72750#p72750"><![CDATA[
Well are you sure 0E is the opcode? It might be something else, like an index into the table of values that it's testing the instructions with.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1181">mic_</a> — Sat Jan 15, 2011 9:32 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[DParrott]]></name></author>
<updated>2011-01-15T09:19:54-07:00</updated>
<published>2011-01-15T09:19:54-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72749#p72749</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72749#p72749"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72749#p72749"><![CDATA[
Ok, I fixed test 3 and got that passing now. <br /><br />I wasn't calculating the H flag correctly in my 16 bit add. 09 was in fact ADD HL, BC. <br /><br />I don't understand the error for test 4 though as 0E is LD C,n and I can't see any problems with that, it's just doing what all the other immediate loads are doing.<br /><br />Anyone know what the 0E 0E from test 4 means. <br /><br />The other question is that when I run the test in other emulators it goes through more tests but I only have it run the 4 then fail. Is it because  the other tests rely on something that the first 4 test so bail out at the point?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4497">DParrott</a> — Sat Jan 15, 2011 9:19 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[DParrott]]></name></author>
<updated>2011-01-15T07:36:18-07:00</updated>
<published>2011-01-15T07:36:18-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72748#p72748</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72748#p72748"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72748#p72748"><![CDATA[
Do you mean that the 09 and 0E 0E have something to do with the flags?<br /><br />I've been through my instructions and compared to the gb programming reference I have and I think the instructions are doing as they should and setting/resetting the right flags.<br /><br />I was hoping the number output would help me try and identify which instruction the test says is failing.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4497">DParrott</a> — Sat Jan 15, 2011 7:36 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Dwedit]]></name></author>
<updated>2011-01-15T06:51:10-07:00</updated>
<published>2011-01-15T06:51:10-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72747#p72747</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72747#p72747"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72747#p72747"><![CDATA[
Is it the flags register (F) output of what those instructions do?  I think the hl,sp instructions did unexpected things to compute the flags.  Maybe read the source code to Gambatte's CPU core, and see what it does.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=53">Dwedit</a> — Sat Jan 15, 2011 6:51 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[DParrott]]></name></author>
<updated>2011-01-15T05:30:09-07:00</updated>
<published>2011-01-15T05:30:09-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72745#p72745</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72745#p72745"/>
<title type="html"><![CDATA[Emulator CPU tests]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=7385&amp;p=72745#p72745"><![CDATA[
I've recently started my own GB emulator and I'm currently trying to nail down the CPU. <br /><br />I'm using Blaarg's cpu instructions test from this thread and I've got some that come back as passed but others that are failing, I'm not sure how to interpret the output of the failed tests to try and see where I'm going wrong.<br /><br />The multi test craps out on test 4:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">cpu_instrs<br /><br />01:ok  02:ok  03:01  04:01  <br /><br />Failed 2 tests.</div><br /><br />It's test 3 and 4 I'm not sure where to start with, the output from them is:<br /><br />Test 03:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">03-op sp,hl<br /><br />09 <br />Failed</div><br /><br />Test 04:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">04-op r,imm<br /><br />0E 0E <br />Failed</div><br /><br />I'm not sure what the error codes printed from these individual tests mean.<br /><br />Any clues as to where to start appreciated.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4497">DParrott</a> — Sat Jan 15, 2011 5:30 am</p><hr />
]]></content>
</entry>
</feed>