<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=12407" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2015-03-20T19:38:50-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=12407</id>
<entry>
<author><name><![CDATA[zeroone]]></name></author>
<updated>2015-03-20T19:38:50-07:00</updated>
<published>2015-03-20T19:38:50-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=143483#p143483</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=143483#p143483"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=143483#p143483"><![CDATA[
By the way, was Huge Insect a ripoff of <a href="http://en.wikipedia.org/wiki/Buzz_Bombers" class="postlink">Buzz Bombers</a>?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6828">zeroone</a> — Fri Mar 20, 2015 7:38 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[SedrynTyros]]></name></author>
<updated>2015-02-22T22:29:50-07:00</updated>
<published>2015-02-22T22:29:50-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141814#p141814</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141814#p141814"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141814#p141814"><![CDATA[
<div class="quotetitle">koitsu wrote:</div><div class="quotecontent"><br />Tatakai no Banka (Eulogy of War) is also known as Trojan in the US and other countries.  It's an arcade port.  It's also not that bad of a game -- really.  It doesn't feel like a &quot;high school project&quot; to me.  <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":-)" title="Smile" /><br /><br />That game is also useful in some way for testing certain mirroring quirks.  I forget what the details are, sadly, but I remember some emulators not implementing something correctly, so during the map screen (&quot;Let's try the first stage, good luck!&quot;) text would get printed oddly or in the wrong on-screen location.  Ugh, I wish I could remember what the issue was.  IMO this, and the use of $2003/$2004, make it a good subject for &quot;emulator testing&quot;.<br /><br />And if I remember right, the quirks with $2003/$2004 are why everyone advocates using $4014 (DMA) instead.<br /></div><br /><br />I played this game on my NES with my cousins back in the late 1980s when it was new.  I remember it was a lot of fun at the time.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6883">SedrynTyros</a> — Sun Feb 22, 2015 10:29 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2015-02-22T17:36:35-07:00</updated>
<published>2015-02-22T17:36:35-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141776#p141776</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141776#p141776"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141776#p141776"><![CDATA[
I remembered the japanese name (!) after a nap during the afternoon. ^_^;; Go figure... <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sun Feb 22, 2015 5:36 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[koitsu]]></name></author>
<updated>2015-02-22T13:45:46-07:00</updated>
<published>2015-02-22T13:45:46-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141766#p141766</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141766#p141766"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141766#p141766"><![CDATA[
Tatakai no Banka (Eulogy of War) is also known as Trojan in the US and other countries.  It's an arcade port.  It's also not that bad of a game -- really.  It doesn't feel like a &quot;high school project&quot; to me.  :-)<br /><br />That game is also useful in some way for testing certain mirroring quirks.  I forget what the details are, sadly, but I remember some emulators not implementing something correctly, so during the map screen (&quot;Let's try the first stage, good luck!&quot;) text would get printed oddly or in the wrong on-screen location.  Ugh, I wish I could remember what the issue was.  IMO this, and the use of $2003/$2004, make it a good subject for &quot;emulator testing&quot;.<br /><br />And if I remember right, the quirks with $2003/$2004 are why everyone advocates using $4014 (DMA) instead.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3">koitsu</a> — Sun Feb 22, 2015 1:45 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[zeroone]]></name></author>
<updated>2015-02-22T13:07:32-07:00</updated>
<published>2015-02-22T13:07:32-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141764#p141764</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141764#p141764"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141764#p141764"><![CDATA[
<div class="quotetitle">Zepper wrote:</div><div class="quotecontent"><br />Tatakai no Banka (J).<br /></div><br /><br />That game seems to work.  But, it's horrible.  It looks like some kid's high school game project.  How did something like that get through Nintendo's quality control.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6828">zeroone</a> — Sun Feb 22, 2015 1:07 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2015-02-22T12:57:42-07:00</updated>
<published>2015-02-22T12:57:42-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141763#p141763</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141763#p141763"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141763#p141763"><![CDATA[
Tatakai no Banka (J).<br /><br />It's glitched if sprite rotation isn't emulated.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sun Feb 22, 2015 12:57 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2015-02-22T12:31:30-07:00</updated>
<published>2015-02-22T12:31:30-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141760#p141760</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141760#p141760"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141760#p141760"><![CDATA[
<div class="quotetitle">tepples wrote:</div><div class="quotecontent"><br />I just wonder what the h███ Sachen engineers were thinking when they decided to rely on this bug.<br /></div>&quot;Free sprite rotation!&quot;<br />1- Assuming OAMADDR &amp; 7 = 0, the first two entries you upload always become Sprite 0 and Sprite 1<br />→ You don't need to restructure your OAM page at all<br />2- They probably didn't notice the loss of the two sprites that were obliterated by the copy.<br /><br /><br />Zepper: One of the latter Ironsword games?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Sun Feb 22, 2015 12:31 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2015-02-22T10:16:31-07:00</updated>
<published>2015-02-22T10:16:31-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141749#p141749</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141749#p141749"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141749#p141749"><![CDATA[
No no... there's a japanese Capcom game that's glitched if such thing isn't emulated...<br /><br />but... what's its name? A side scroller, a guy with a sword and a shield walking in a city in background, night time.<br />After the title screen, a map is displayed, much like Ghost'n Gobblins.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sun Feb 22, 2015 10:16 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2015-02-22T09:42:58-07:00</updated>
<published>2015-02-22T09:42:58-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141748#p141748</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141748#p141748"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141748#p141748"><![CDATA[
I just wonder what the h███ Sachen engineers were thinking when they decided to rely on this bug.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Sun Feb 22, 2015 9:42 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[zeroone]]></name></author>
<updated>2015-02-22T09:13:31-07:00</updated>
<published>2015-02-22T09:13:31-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141742#p141742</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141742#p141742"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141742#p141742"><![CDATA[
I missed this on the wiki:<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />On the 2C02, writes to OAMADDR reliably corrupt OAM. This can then be worked around by writing all 256 bytes of OAM. It is also the case that if OAMADDR is not less than eight when rendering starts, the eight bytes starting at OAMADDR &amp; 0xF8 are copied to the first eight bytes of OAM; it seems likely that this is related. The former bug is known to have been fixed in the 2C07; the latter is believed to be.<br /></div><br /><br />And, yes, that solved the problem:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">if (oamAddress &gt;= 8) {<br />  for(int i = 0; i &lt; 8; i++) {<br />    primaryOAM&#91;i&#93; = primaryOAM&#91;(oamAddress &amp; 0xF8) + i&#93;;<br />  }<br />}</div><br /><br />Thanks.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6828">zeroone</a> — Sun Feb 22, 2015 9:13 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2015-02-22T07:00:23-07:00</updated>
<published>2015-02-22T07:00:23-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141733#p141733</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141733#p141733"/>
<title type="html"><![CDATA[Re: Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141733#p141733"><![CDATA[
<strong>EDIT:</strong> fixed the problem. According to Nintendulator:<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />If Sprite address is not zero at the beginning of the pre-render scanline, then copy the contents of its 8-byte page into the first 8 bytes.<br /></div><br />B00M, working like a charm. <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />---------------------------------------<br />Hehe, a Sachen game. <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /> In my emulator, it's almost the same problem. <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /> <br />I can move the shooter (&amp;shoot), but that's it. If your sprite evaluation code is wrong, mine is wrong too. ^_^;;<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sun Feb 22, 2015 7:00 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[zeroone]]></name></author>
<updated>2015-02-21T11:20:46-07:00</updated>
<published>2015-02-21T11:20:46-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141698#p141698</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141698#p141698"/>
<title type="html"><![CDATA[Huge Insect does not fully start]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=12407&amp;p=141698#p141698"><![CDATA[
As shown below, my emulator makes it to the Stage 1 - 1 screen, the player can control the sprayer (left, right and fire works) and the music and sound effects work.  But, the Stage 1 - 1 message never vanishes and no enemies ever appear.<br /><br /><img src="http://i.imgur.com/7yhUKEp.png" alt="Image" /><br /><br />I carefully implemented the <a href="http://wiki.nesdev.com/w/index.php/PPU_sprite_evaluation" class="postlink">PPU sprite evaluation</a> incorporating the ideas from these links: <a href="http://wiki.nesdev.com/w/index.php/PPU_registers#Obscure_details_of_OAMADDR" class="postlink">Obscure details of OAMADDR</a> and <a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=1366" class="postlink">Where to start DMA</a>.  But, that was not enough.<br /><br />On even cycles (65--256), my code does this:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">            int address = (n + oamAddress) &lt;&lt; 2;<br />            spriteY = primaryOAM&#91;0xFF &amp; (address + m)&#93;;<br />            spriteT = primaryOAM&#91;0xFF &amp; (address + m + 1)&#93;;<br />            spriteA = primaryOAM&#91;0xFF &amp; (address + m + 2)&#93;;<br />            spriteX = primaryOAM&#91;0xFF &amp; (address + m + 3)&#93;;</div><br /><br />On odd cycles, it does this:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">            if (secondaryOamWritesEnabled) {<br />              int address = s &lt;&lt; 2;<br />              secondaryOAM&#91;address&#93; = spriteY;<br />              if (!(spriteY &gt; scanline <br />                  || spriteY + spriteBottomOffset &lt; scanline)) {<br />                if (n == 0) {<br />                  sprite0Used = true;<br />                }                <br />                secondaryOAM&#91;address + 1&#93; = spriteT;<br />                secondaryOAM&#91;address + 2&#93; = spriteA;<br />                secondaryOAM&#91;address + 3&#93; = spriteX;<br />                if (++s == 8) {<br />                  secondaryOamWritesEnabled = false;                  <br />                }<br />              }<br />              n = 0x3F &amp; (n + 1);<br />              if (n == 0) {<br />                oamTransferCompleted = true;<br />              }<br />            } else {<br />              if (!(spriteY &gt; scanline <br />                  || spriteY + spriteBottomOffset &lt; scanline)) {<br />                spriteOverflowDetected = true;<br />                for(int k = 0; k &lt; 4; k++) {<br />                  m = 0x03 &amp; (m + 1);<br />                  if (m == 0) {<br />                    n = 0x3F &amp; (n + 1);<br />                    if (n == 0) {<br />                      oamTransferCompleted = true;<br />                      break;<br />                    }<br />                  }<br />                }<br />              } else {<br />                m = 0x03 &amp; (m + 1);<br />                n = 0x3F &amp; (n + 1);<br />                if (n == 0) {<br />                  oamTransferCompleted = true;<br />                }<br />              }<br />            }<br />          }</div><br /><br />Those pieces of code execute while oamTransferCompleted is false.  n, m and s are initialized to 0.  secondaryOamWritesEnabled is initialized to true.  spriteBottomOffset is either 8 or 16 depending on sprite size mode.<br /><br />oamAddress is set to 0 during each of ticks 257--320 (the sprite tile loading interval) of the pre-render and visible scanlines.<br /><br />At cycle 257, the PPU status register ($2002) is updated with the value of spriteOverflowDetected.  I found that if the code updates the status register during cycles 65--256, some games had issues.  For instance, in Battletoads level 2, the player could not injure the yellow venus fly trap creatures and vice versa; the player and the enemy would pass through each other.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6828">zeroone</a> — Sat Feb 21, 2015 11:20 am</p><hr />
]]></content>
</entry>
</feed>