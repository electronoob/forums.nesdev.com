<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Randomness before the first button press</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Randomness before the first button press</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=9796">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=9796</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>2</strong> of <strong>4</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sik</b> [ Mon Feb 11, 2013 6:29 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">The initial RAM content will vary from NES to NES, but will be likely the same at power up on the same console.</div><br />Are you sure? The whole reason RAM is garbage on start up is because the values aren't stable, resulting in pretty much the equivalent to random. Otherwise RAM would always be filled with 00 or FF at startup, since all cells would be probably stable to the same value.<br /><br />(there's an exception regarding leaving a value in RAM for <em>really</em> long periods of time can actually affect the value on power-on, but I doubt there's any such place in the NES' 2KB of RAM =P)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Feb 11, 2013 6:36 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />eric_j_ in #nesdev tried power cycles, waiting a few seconds after each, and got CF84, 20A7, 3EAE, 4DA1, E72E, 4EE8, FE6A<br />He noticed that the third digit was far more likely to be even than odd, and I have no idea why that is.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Mon Feb 11, 2013 6:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">The initial RAM content will vary from NES to NES, but will be likely the same at power up on the same console.</div><br /><br />I don't find this is true, exactly. The same console is subject to random static/capacitance/etc. Individual bits have a tendency to go one way or the other on startup, but there's plenty of uncontrollable environmental factors that can sway them one way or another.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>blargg</b> [ Mon Feb 11, 2013 8:48 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Denine wrote:</div><div class="quotecontent"><div class="quotetitle">blargg wrote:</div><div class="quotecontent">* Initial RAM contents</div><br />When I start reading this topic, I had same idea. But it is not emulated, is it?</div><br />You're suggesting that we not program things that depend on things not emulated? Chicken-and-egg situation there. By relying on unemulated features, we give incentive to emulator authors to emulate these things.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>infiniteneslives</b> [ Tue Feb 12, 2013 12:06 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">blargg wrote:</div><div class="quotecontent"><div class="quotetitle">Denine wrote:</div><div class="quotecontent"><div class="quotetitle">blargg wrote:</div><div class="quotecontent">* Initial RAM contents</div><br />When I start reading this topic, I had same idea. But it is not emulated, is it?</div><br />You're suggesting that we not program things that depend on things not emulated? Chicken-and-egg situation there. By relying on unemulated features, we give incentive to emulator authors to emulate these things.</div><br /><br />Agreed, I am mystified when this backwards logic is used...<br /><br /><br />So it looks like you already got your data, but more data is always better <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" /><br /><br />AC92, 0D5F, CC4B, D600, 66C1, 8C67, 3460, 2DCC, 56EA, 726C, E0BC, CB09, F292, B78F, C769, 779A, 04A4, 0C9E, B6F4, 4988, 1955, ACFC, 0318, 0C43...<br /><br />Those were all from power on/power cycling.  I didn't wait a few seconds like eric did....<br /><br />A few from reset if you're curious:  5969, 5211, 2CE2, 7E96, F3A2, 0DDB, 6CCD, D841, 085E, 9621, C5EA, 1C17, 9308, F903, 0291, 060F, 40F8, B553, D89A, 08CA, 9CB3.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Tue Feb 12, 2013 8:09 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks. So we appear to have something usable as a hardware RNG, at least at power-on. Now all I need are more puns on &quot;Nintendo&quot;.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Tue Feb 12, 2013 11:47 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Now all I need are more puns on &quot;Nintendo&quot;.</div><br />No, thanks.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sik</b> [ Tue Feb 12, 2013 2:36 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Thanks. So we appear to have something usable as a hardware RNG, at least at power-on. Now all I need are more puns on &quot;Nintendo&quot;.</div><br />What I do on the Mega Drive is take several samples from RAM scattered around (won't waste time reading all RAM!) and add them, gives a good enough value for a seed. Then add it to whatever value is in the seed variable (which is already random anyway). I imagine this should work for the NES too.<br /><br />On reset the values of RAM aren't random anymore, although you still are unlikely to know what was going on when the system was reset so for all effects and purposes it's the same - and since we add to whatever value was in the seed before, it will still have the random factor from the initial boot up.<br /><br />The Mega Drive has the added randomness factor that the HV counter (the position of the TV beam) can start at a completely different place each time, so I add that into the mix too. Does the NES have something similar?<br /><br />(and yes, I'm aware that adding many random sources isn't always a good idea - if the sources are completely different and the output results can't have repeats (e.g. an addition will always yield an unique result for each possible value) this shouldn't be an issue)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Tue Feb 12, 2013 2:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'll say it again - the content of RAM is NOT random : <a href="http://wiki.nesdev.com/w/index.php/CPU_power_up_state" class="postlink">http://wiki.nesdev.com/w/index.php/CPU_power_up_state</a><br /><br /><div class="quotetitle">Nesdev Wiki wrote:</div><div class="quotecontent">All internal memory ($0000-$07FF) was consistently set to $ff except for a few bytes, which probably vary from console to console: <br />$0008=$F7 <br />$0009=$EF <br />$000a=$DF <br />$000f=$BF</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Tue Feb 12, 2013 2:49 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Against how many consoles was that wiki page tested? Besides, this technique relies on &quot;analog effects&quot; of bus conflicts in the PPU.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sik</b> [ Wed Feb 13, 2013 5:05 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Against how many consoles was that wiki page tested?</div><br />Still would mean it isn't safe. Though also you'd need to ask for the flashcart that was used to test - unless it was something that only showed the program itself and nothing else (i.e. as if it was a normal cartridge with pure ROM, no firmware at all), any initialization-time testing goes out of the window =/<br /><br />Also Nintendo was trying to make hardware as cheap as possible, if they had used some RAM that was that much stable, wouldn't everybody be using RAM that is cleared on power up these days? =X<br /><br />PS: I notice a really curious pattern in the values that are the exception to the rule:<br />$08 ... 11110111<br />$09 ... 11101111<br />$0A ... 11011111<br />$0F ... 10111111<br /><br />What's with that 0? o_O;

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Wed Feb 13, 2013 5:10 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I think a very close approach to the transistors that makes the SRAM cell only could explain the power up state, and why there is this strange pattern.<br />Since a SRAM cell is basically a positive feedback loop, only the dimensions of the transistors and parasitic resistors will actually determine if the loop goes one way or the other (I guess).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Wed Feb 13, 2013 8:28 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Sik wrote:</div><div class="quotecontent">if they had used some RAM that was that much stable, wouldn't everybody be using RAM that is cleared on power up these days?</div><br />I guess that even though RAM isn't 100% stable, bits have a tendency to go one way or the other, which results in poor randomness.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>TmEE</b> [ Wed Feb 13, 2013 12:42 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Most bits in SRAM are at 1 on power up

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Wed Feb 13, 2013 1:02 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Randomness before the first button press</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Sik wrote:</div><div class="quotecontent">if they had used some RAM that was that much stable, wouldn't everybody be using RAM that is cleared on power up these days? =X</div><br />&quot;Guarantee of cleared on power-up&quot; is not the strict opposite of &quot;Powers up with a different value each time&quot;<br /><br />My take? The only variables you can control in an already-assembled NES that would affect how the RAM would be filled at power up are 1-how Vcc rises when you turn it on, and 2- what temperature the RAM is. Given the way the power switch is wired, 1 is fully predictable. (charge a 100uF capacitor through a 7805 from a 2200uF capacitor)<br /><br />That said, some <a href="http://hardware.majix.org/computers/sgi.pi/" class="postlink">really old computers</a> did require that the DRAM boot up with a specific contents.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>2</strong> of <strong>4</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>