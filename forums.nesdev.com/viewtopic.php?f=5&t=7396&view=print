<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - GNU/Linux drive sorter</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">GNU/Linux drive sorter</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=5&amp;t=7396">http://forums.nesdev.com/viewtopic.php?f=5&amp;t=7396</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>danntor</b> [ Tue Jan 18, 2011 1:23 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>GNU/Linux drive sorter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Just recently booted up my NES PowerPak for the first time in months and it reminded me of the annoying problem it had. The files do not sort alphabetically which can make searching for a game quite a chore. Finding a windows program to do this was fairly easy but I do not use Windows, does anybody know of a GNU/Linux program? Thank you very much.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Tue Jan 18, 2011 8:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Google <strong>linux fat sort</strong> brought up <a href="http://forums.fedoraforum.org/showthread.php?t=199159" class="postlink">this Fedora discussion</a> as the first result, but <a href="http://ubuntuforums.org/showthread.php?t=689879" class="postlink">apparently it's not that hot</a>, and <a href="http://foldersort.software.informer.com/" class="postlink">foldersort</a> should work in Wine.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Tue Jan 18, 2011 11:12 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: GNU/Linux drive sorter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">danntor wrote:</div><div class="quotecontent">Just recently booted up my NES PowerPak for the first time in months and it reminded me of the annoying problem it had. The files do not sort alphabetically which can make searching for a game quite a chore.</div>
<br />Believe me, it would be much more annoying if the 6502 was in charge of alphabetically sorting thousands of files. It would probably take more time for the menu to load than it currently takes for you to locate the game you want.
<br />
<br />Also, if you use some sort of folder structure (a folder for each letter, or genre, or company, whatever) locating games isn't so hard. Now, if you just pasted an entire "complete ROM set" full of files you will never touch (alternate versions, overdumps, different regions, languages you don't understand, hacks, etc...) into the root folder, then yeah, it will be hard.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Tue Jan 18, 2011 11:38 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Google <strong>linux fat sort</strong> brought up <a href="http://forums.fedoraforum.org/showthread.php?t=199159" class="postlink">this Fedora discussion</a> as the first result, but <a href="http://ubuntuforums.org/showthread.php?t=689879" class="postlink">apparently it's not that hot</a>, and <a href="http://foldersort.software.informer.com/" class="postlink">foldersort</a> should work in Wine.</div>
<br />Under any *n*x, the following bash shell script one-liner will achieve the same â€” assuming no file names with @ in them.
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">j=`mktemp -d XXXXXXXX.tmp`; mv * $j; cd $j; for i in `ls | sort | tr ' ' @`; do mv -vi &quot;`echo $i | tr @ ' '`&quot; ..; done; cd ..; rmdir $j</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>danntor</b> [ Tue Jan 18, 2011 11:13 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />lidnariq, you are a champion. That is getting added to the list of useful commands I have found or made over the years.
<br />
<br />@tepples
<br />
<br />I was going to do that as last resort. Thanks for the help though

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Wed Jan 19, 2011 6:49 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Is sorting really that slow?  You pre-load a list of all filenames into memory, then assign each file a sequence number, and build the pointer table so you can look up filenames given a sequence number.
<br />Then you sort the sequence numbers, by comparing their associated strings.  You end up with a table of numbers in some random-looking order, but their associated strings are sorted.
<br />
<br />For the sorting, you use Iterative Merge Sort.  It takes exactly N*lg2(N) string comparisons, and because you are using numbers to represent the arrays, you aren't needlessly copying a bunch of strings.  And it doesn't require any stack space, just a second copy of the integer array.
<br />
<br />Lets's say you have string comparison routine that takes exactly 600 CPU cycles per iteration (worst case).  If you had 1024 files, that would work out to about 3.5 seconds of sorting.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Jan 19, 2011 6:56 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />3.5 seconds of sorting is still slow as fsck. Imagine having to wait 3.5 seconds every time you go back up a directory. I'd love to be proven wrong with a sort demo ROM.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Wed Jan 19, 2011 7:00 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It's the way I did it on the GBA, and the sorting is instantaneous on its mighty 16MHZ ARM processor.
<br />
<br />Edit: more calculations...
<br />When reading all files in a directory, If filenames are 32 characters long on average, that's about 128 bytes per filename, and reads 256K of data to read 1024 filenames.  That probably dwarfs the sorting time.
<br />
<br />Oh well, just build an index (array of Directory Entry numbers in sorted order), and test if the directory's size and contents/hash of the last cluster matches to check if it's dirty.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Jan 19, 2011 10:50 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'd recommend heapsort instead because heapsort takes O(n) for the first filename on average and then O(k log n) for the next k filenames, both of which are less than O(n log n) to sort the whole thing. After the names are displayed, the rest of the sorting will happen in the background while the user is scrolling down. I call this "streaming heapsort".
<br />
<br />I ought to implement some sorting algorithms in Python and then in 6502 asm to demonstrate Shell sort, merge sort, heapsort, and streaming heapsort. The last time I touched sorting on the NES, it was Who's Cuter, a demo of Shell sort and PackBits tile compression. But does anyone following this topic speak French as a first language?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Drag</b> [ Wed Jan 19, 2011 12:36 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">I ought to implement some sorting algorithms in Python and then in 6502 asm to demonstrate Shell sort, merge sort, heapsort, and streaming heapsort.</div>
<br />I'm curious now, is the Power Pak's interface just a simple firmware that can be updated easily? I was thinking of possibly making a more "pretty" interface kinda like Dreamcast's, or something.
<br />
<br />At the same time, implementing sorting on the Power Pak wouldn't be too terrible, the Power Pak is capable of writing to the memory card too, right? Why not just sort the roms once, and record the file order in a cache-file? I can't imagine your rom folders changing too drastically, too often. Even if it does, you could easily update the cache-file to add and remove files, without needing to regenerate the whole thing

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Wed Jan 19, 2011 1:06 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Drag wrote:</div><div class="quotecontent"><div class="quotetitle">tepples wrote:</div><div class="quotecontent">I ought to implement some sorting algorithms in Python and then in 6502 asm to demonstrate Shell sort, merge sort, heapsort, and streaming heapsort.</div><br />I'm curious now, is the Power Pak's interface just a simple firmware that can be updated easily? I was thinking of possibly making a more "pretty" interface kinda like Dreamcast's, or something.</div><br />Code for menus and such is stored in the CF card ("POWERPAK" dir together with NES mappers). So yeah they can be updated easily.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">At the same time, implementing sorting on the Power Pak wouldn't be too terrible, the Power Pak is capable of writing to the memory card too, right? Why not just sort the roms once, and record the file order in a cache-file? I can't imagine your rom folders changing too drastically, too often. Even if it does, you could easily update the cache-file to add and remove files, without needing to regenerate the whole thing</div>
<br />Yeah I thought about caching too, should work for most purposes. PowerPak currently doesn't know how to create new files though, so an empty cache file needs to be added to the CF.
<br />
<br />It'd probably be feasible, but no technical details about the modules have been released, so it would require a fair amount of reverse engineering. I'm not sure if it's worth it just to get sorting. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />
<br />
<br />Anyway if you/others want to give a better menu a go, I can probably help with the RE part, I have most of it figured out already anyways.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Jan 19, 2011 1:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The results of "merdesort" are in. I just implemented three sort algorithms in Python, sorting 500 integers that have been shuffled.
<br />
<br />Merge sort completed after 3841 to 3886 compares.
<br />Shell sort completed in 5555 to 5790 compares.
<br />Heapsort finished fix heap after 900 to 943 compares.
<br />Heapsort returned 20 results after 1218 to 1263 compares.
<br />Heapsort completed after 7385 to 7450 compares.
<br />
<br />Conclusion: Merge sort finishes fastest, but heapsort returns the first page of results fastest. I can provide source code if you want to reproduce results.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>