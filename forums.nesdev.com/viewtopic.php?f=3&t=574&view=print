<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Colour Emphasis Bits</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Colour Emphasis Bits</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=574">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=574</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>WedNESday</b> [ Sat Sep 17, 2005 3:23 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Colour Emphasis Bits</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />If we set the Red bit so that the screen becomes more red (BGR 001), according to NinTech.txt, becomes 123.9% (23.9 'more red'). If the colour being drawn to the screen is white (0x00FFFFFF) does the red value (0xFF) remain the same or wrap? (Therefore is 0xFF the maximum the colour can be increased to).
<br />
<br />Also are there any demos in which to test the bits?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Sep 17, 2005 4:18 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The "emphasize red" bit darkens blue and green and lightens red. Likewise for the "emphasize green" and "emphasize blue" bits. If you turn on all three bits, you darken the whole screen.
<br />
<br />No, nothing wraps. The emphasis is said to be done in analog circuitry, which tends to saturate rather than wrap.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Disch</b> [ Sat Sep 17, 2005 6:37 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Only commercial game I know of to test is Final Fantasy, which cycles through emphasis modes to create the flashy effect when you get into a battle.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Sat Sep 17, 2005 11:42 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Didn't Dragon Warrior 2 also use it?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Nessie</b> [ Sun Sep 18, 2005 2:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />And Super Spy Hunter, when you pause the game the screen goes darker.
<br />And that Dizzy game with the scroll in the beginning.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sun Sep 18, 2005 5:06 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Just Breed have all emphasis bits always set, to have darker graphics. What do you think is the best ? Have all bits set for darker graphics, and clear them to do lightening effects (Just Breed) or having them clear, and set them to do lightening effects (Final Fantasy 1, 2).
<br />The only FF game I have running on my real NES is the second (thanks to drk414), and I think the effects is way to fast to notice how the color varies. However, it's not very different from an emulator such as FCEUltra.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Sep 18, 2005 1:35 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The attribute bits also darken blacks closer to the level of NTSC's "blacker than black" synchronization signals. If you set all the attribute bits, some older TVs might not find the sync signals.
<br />
<br />Try doing lighting effects by adding or subtracting $10 from each palette entry, clipping negative values to $0F and positive values to $30.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sun Sep 18, 2005 11:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'm sure that Just Breed does this, even with the black color (probably $0f). The problem, is whith doing effects only by software, it's impossible to get some intermediate colors. I always ask myself how looks the color $1d on a real screen. It should be the darker gray available on the NES palette, but all games seems to rely to $00-$30 to do gray and never to $1d-$3d (because $0d shouldn't used on a NTSC TV). I think that if could be good to use $1d for black sprites and $0f for black BG, so a black sprite on a black BG would still be visible. However, all emulators emulates $1d pretty much differently from nearly as grey than $00, to as black than $0f, and I don't know how looks the real one, nor any game using this color.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>WedNESday</b> [ Mon Sep 19, 2005 11:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Quietust's copper.nes also uses the CI bits rather well.
<br />
<br />001 B: 074.3% G: 091.5% R: 123.9%
<br />010 B: 088.2% G: 108.6% R: 079.4%
<br />011 B: 065.3% G: 098.0% R: 101.9%
<br />100 B: 127.7% G: 102.6% R: 090.5%
<br />101 B: 097.9% G: 090.8% R: 102.3%
<br />110 B: 100.1% G: 098.7% R: 074.1%
<br />111 B: 075.0% G: 075.0% R: 075.0%
<br />
<br />How accurate are those figures? Is it the same for NTSC/PAL? Can anyone improve on them? Or are they like the palette on every console (i.e. different all the time).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Quietust</b> [ Mon Sep 19, 2005 11:58 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">WedNESday wrote:</div><div class="quotecontent">Implementing the intensity is tricky though, and if done incorrectly is very CPU intensive.</div>
<br />
<br />Not really - just calculate all palette values in all emphasis modes (512 colors total, can be calculated at palette load time) and look up the proper one at rendering time.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Disch</b> [ Mon Sep 19, 2005 1:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That's exactly what I do.
<br />
<br />My output looks kind of like this:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">pixeltooutput = nOutputPalette&#91; nEmphasis | &#40;nPalette&#91; out &#93; &amp; nMonoMask&#41; &#93;;<br /></div>
<br />
<br />'nOutputPalette' being the precaculated RGB table (DWORDs if outputting 32-bit color, WORD if outputting 16-bit).  512 entries (64 colors * 8 emphasis modes)
<br />
<br />'nEmphasis' are the emphasis bits are written to the register, masked out and left shifted one (nEmphasis = 0x1C0 if all 3 emphasis bits set)
<br />
<br />'nPalette' is the NES palette as it exists at ppu$3Fxx
<br />
<br />'out' is the bg/sprite pixel to output
<br />
<br />'nMonoMask' will always either be 0x3F (normal) or 0x30 (in monochrome mode)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Mon Sep 19, 2005 3:45 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />yaya, that's it. ^_^;;
<br />if the guy is using an 8-bit mode, then... he should switch to 16-bit video mode...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>WedNESday</b> [ Sat Jan 21, 2006 8:58 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Quietust's copper.nes also uses the CI bits rather well. 
<br />
<br />001 B: 074.3% G: 091.5% R: 123.9% 
<br />010 B: 088.2% G: 108.6% R: 079.4% 
<br />011 B: 065.3% G: 098.0% R: 101.9% 
<br />100 B: 127.7% G: 102.6% R: 090.5% 
<br />101 B: 097.9% G: 090.8% R: 102.3% 
<br />110 B: 100.1% G: 098.7% R: 074.1% 
<br />111 B: 075.0% G: 075.0% R: 075.0% 
<br />
<br />How accurate are those figures? Is it the same for NTSC/PAL? Can anyone improve on them? Or are they like the palette on every console (i.e. different all the time).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>hap</b> [ Sat Jan 21, 2006 11:28 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Actually, Quietust posted a new measurement on this forum a few weeks ago, but I can't find the thread..
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">/* emphasis factors, %000 to %111. r,g,b */<br />/* measurement by Quietust */<br />const float emphasis_factor&#91;8&#93;&#91;3&#93;=&#123;<br />&nbsp; &nbsp;&#123;1.00, 1.00, 1.00&#125;,<br />&nbsp; &nbsp;&#123;1.00, 0.80, 0.81&#125;,<br />&nbsp; &nbsp;&#123;0.78, 0.94, 0.66&#125;,<br />&nbsp; &nbsp;&#123;0.79, 0.77, 0.63&#125;,<br />&nbsp; &nbsp;&#123;0.82, 0.83, 1.12&#125;,<br />&nbsp; &nbsp;&#123;0.81, 0.71, 0.87&#125;,<br />&nbsp; &nbsp;&#123;0.68, 0.79, 0.79&#125;,<br />&nbsp; &nbsp;&#123;0.70, 0.70, 0.70&#125;<br />&#125;;</div>
<br />
<br />NTSC/PAL difference ? dunno

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Quietust</b> [ Sat Jan 21, 2006 1:57 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">hap wrote:</div><div class="quotecontent">Actually, Quietust posted a new measurement on this forum a few weeks ago, but I can't find the thread..</div>
<br />
<br />I deleted the thread after somebody made a post questioning the purpose of measuring colour emphasis in terms of RGB adjustment when the NTSC PPU has no RGB logic inside it whatsoever - apparently, after the "NTSC emulation" showed up, people only want to know exactly how colour emphasis modifies the NTSC signal itself and don't care about such RGB adjustment hacks.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>