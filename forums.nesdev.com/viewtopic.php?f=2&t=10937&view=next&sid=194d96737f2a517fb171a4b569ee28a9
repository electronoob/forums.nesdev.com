<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - Lag in the game logic even though it is very short</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - NESdev" href="http://forums.nesdev.com/feed.php?f=2" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Lag in the game logic even though it is very short" href="http://forums.nesdev.com/feed.php?f=2&amp;t=10937" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en&amp;sid=1e4f7b5548eee5ffae5c9955448927de" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '1');
	var per_page = '15';
	var base_url = './viewtopic.php?f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



	/**
	* Play quicktime file by determining it's width/height
	* from the displayed rectangle area
	*
	* Only defined if there is a file block present.
	*/
	function play_qt_file(obj)
	{
		var rectangle = obj.GetRectangle();

		if (rectangle)
		{
			rectangle = rectangle.split(',')
			var x1 = parseInt(rectangle[0]);
			var x2 = parseInt(rectangle[2]);
			var y1 = parseInt(rectangle[1]);
			var y2 = parseInt(rectangle[3]);

			var width = (x1 < 0) ? (x1 * -1) + x2 : x2 - x1;
			var height = (y1 < 0) ? (y1 * -1) + y2 : y2 - y1;
		}
		else
		{
			var width = 200;
			var height = 0;
		}

		obj.width = width;
		obj.height = height + 16;

		obj.SetControllerVisible(true);

		obj.Play();
	}


// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php?sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<a href="./faq.php?sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php?sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=register&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Sun Apr 03, 2016 5:21 pm<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered&amp;sid=1e4f7b5548eee5ffae5c9955448927de">View unanswered posts</a> | <a href="./search.php?search_id=active_topics&amp;sid=1e4f7b5548eee5ffae5c9955448927de">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php?sid=1e4f7b5548eee5ffae5c9955448927de">Board index</a> &#187; <a href="./viewforum.php?f=24&amp;sid=1e4f7b5548eee5ffae5c9955448927de">NES / Famicom</a> &#187; <a href="./viewforum.php?f=2&amp;sid=1e4f7b5548eee5ffae5c9955448927de">NESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />

<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de">Lag in the game logic even though it is very short</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320&amp;sid=1e4f7b5548eee5ffae5c9955448927de">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=2&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>2</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 23 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de&amp;start=15">2</a> &nbsp;<a href="./viewtopic.php?f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de&amp;start=15">Next</a></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=2&amp;t=13272&amp;view=previous&amp;sid=1e4f7b5548eee5ffae5c9955448927de">Previous topic</a> | <a href="./viewtopic.php?f=2&amp;t=13272&amp;view=next&amp;sid=1e4f7b5548eee5ffae5c9955448927de">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p155618"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155618">Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155618&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155618"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 5:56 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 727
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I've encountered the problem that my game starts to lag even tough, as far as I can see it, the game logic is pretty short.<br /><br />I created a very small sample program to demonstrate my problem. It's in the attachments.<br /><br />When the game logic hits, this is basically the only thing that is done:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">#define ARRAY_LENGTH(array) (sizeof(array) / sizeof((array)&#91;0&#93;))<br /><br />extern unsigned char ScrollingPosition;<br />#pragma zpsym(&quot;ScrollingPosition&quot;)<br /><br />static unsigned char PpuUpdate&#91;255&#93;;<br />static unsigned char PpuUpdateIndex;<br /><br />static unsigned char b;<br /><br />static const unsigned char StatusBar&#91;&#93; =<br />{<br />&nbsp; &nbsp;0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br />};<br /><br />void PreparePpuUpdate(const unsigned char *data, unsigned char dataLength)<br />{<br />&nbsp; &nbsp;for (b = 0; b &lt; dataLength; ++b)<br />&nbsp; &nbsp;&nbsp; &nbsp;PpuUpdate&#91;PpuUpdateIndex++&#93; = data&#91;b&#93;;<br />}<br /><br />void ProcessNextFrame(void)<br />{<br />&nbsp; &nbsp;ScrollingPosition += 1;<br /><br />&nbsp; &nbsp;PpuUpdateIndex = 0;<br />&nbsp; &nbsp;PreparePpuUpdate(StatusBar, ARRAY_LENGTH(StatusBar));<br />&nbsp; &nbsp;PreparePpuUpdate(StatusBar, ARRAY_LENGTH(StatusBar));<br />&nbsp; &nbsp;PreparePpuUpdate(StatusBar, ARRAY_LENGTH(StatusBar));<br />}</div><br /><br />In the sample program, the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">PpuUpdate</tt> array isn't actually used for anything.<br />But in the actual game, this is the array that gets written into the PPU: I fill two status bars and, if applicable, a vertical column for the background update during scrolling.<br />And then I write it into the PPU during vblank to put the graphics on screen.<br /><br />But the above program already takes two frames to finish the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">ProcessNextFrame</tt> function.<br />If you remove one of the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">PreparePpuUpdate</tt> lines, it runs at full speed.<br /><br />But the problem is: In the moment, the function doesn't do anything else but filling the array. And this already exceeds the time per frame. So, how am I ever supposed to include actual game logic? Character behavior, enemy behavior etc. How will this be possible if the above code already lags?<br /><br />Or maybe I'm also doing something wrong in the &quot;Main.s&quot; file.<br /><br />Does anybody have an idea?</div>

					
						<br clear="all" /><br />

						<table class="tablebg" width="100%" cellspacing="1">
						<tr>
							<td class="row3"><b class="genmed">Attachments: </b></td>
						</tr>
						
							<tr>
								<td class="row2">
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=4047&amp;sid=1e4f7b5548eee5ffae5c9955448927de">Test.zip</a> [3.15 KiB]
			</span><br />
			<span class="gensmall">Downloaded 19 times</span>
		

		<br />
	</td>
							</tr>
						
						</table>
					

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p155620"></a>
				<b class="postauthor">Quietust</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155620">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155620&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155620"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 6:54 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 10:59 pm<br /><b>Posts:</b> 1243
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">cc65 appears to be <strong>extremely</strong> inefficient when it comes to passing pointers as parameters - it maintains its own internal stack for function parameters <em>and local variables</em>, and it takes nearly half a scanline just to push a pointer. Overall, a single call to PreparePpuUpdate(), which appends 26 bytes to a buffer, is taking <strong>over 12,000 cycles</strong> to perform.<br /><br />If you rewrite that function in assembly, you should be able to get it down to 600 cycles or less.</div>

					
						<div class="postbody"><br />_________________<br />Quietust, QMT Productions
<br />P.S. If you don't get this note, let me know and I'll write you another.</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p155622"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155622">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155622&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155622"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 8:02 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 727
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Thanks for the information. I was beginning to fear that the combination of the for-loop and incrementing the index variables was the reason it is so slow.<br /><br />O.k., it sucks that it is like it is. But I might be able to work with it.<br />For a start, I'll just use the standard C function <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">memcpy</tt>, even though I didn't want to use any actual C library functions.<br />I'll have to see what specific functions I'd have to write myself where a simple memcpy isn't enough anymore.<br /><br />Does anybody know a workaround where I don't have to use Assembly or C standard functions?<br /><br />I assume declaring the function as a parametrized macro isn't so good either because this would fill up my ROM space.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p155624"></a>
				<b class="postauthor">dougeff</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155624">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155624&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155624"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 8:20 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7008_1435206010.jpg" width="90" height="95" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri May 08, 2015 7:17 pm<br /><b>Posts:</b> 695
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I'm very interested in figuring out why the above code took 12,000 cycles. I'm at work, so I can't look at it now. My gut tells me that you can write it in C, but in an 'assembly like' way, and it should work as well as assembly. <br />Since cc65 translates a passed pointer as a push to a stack and a then a pull, and some juggling to index from the pointer (y)...</div>

					
						<div class="postbody"><br />_________________<br /><a href="http://nesdoug.com" class="postlink">nesdoug.com</a> -- blog/tutorial on programming for the NES</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7008&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p155627"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155627">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155627&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155627"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 9:18 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 727
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">dougeff wrote:</div><div class="quotecontent">My gut tells me that you can write it in C, but in an 'assembly like' way</div><br />What do you mean?<br /><br />I tried to declare a global pointer variable and to use this inside the function instead of a parameter. Before calling the function, I would have assigned the pointer:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">PreparePpuUpdateData = StatusBar;<br />PreparePpuUpdateDataSize = ARRAY_LENGTH(StatusBar)<br />PreparePpuUpdate();</div><br />But it wasn't faster either.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p155628"></a>
				<b class="postauthor">dougeff</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155628">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155628&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155628"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 9:32 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7008_1435206010.jpg" width="90" height="95" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri May 08, 2015 7:17 pm<br /><b>Posts:</b> 695
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I'm away from my computer, so I can't write any test programs, to identify how cc65 converts these kind of functions to assembly.<br /><br />I mean, do it in a way that it doesn't have to push any pointers to a stack. Somehow.</div>

					
						<div class="postbody"><br />_________________<br /><a href="http://nesdoug.com" class="postlink">nesdoug.com</a> -- blog/tutorial on programming for the NES</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7008&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p155633"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155633">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155633&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155633"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 11:02 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1384529626.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 3436<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">On the subject of &quot;memcpy&quot; being faster, the reason &quot;memcpy&quot; will do better than any naive version of it you can write in CC65 is that memcpy is implemented in assembly in the CRT. If you try to write a &quot;memcpy&quot; equivalent in CC65 C code it will always be slower.<br /><br />Modern compilers often go one better and turn memcpy into an intrinsic, rather than a function, so they can optimize through the memcpy. Sometimes they can detect simple for loops and automatically convert to the intrinsic too.<br /><br /><br />I made this suggestion before, but it very often helps to avoid using the C stack; which means: avoid local variables, avoid parameters to function call. Here's a simple version:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">// collection of generic &quot;parameter&quot; inputs<br />unsigned char temp_a;<br />unsigned char* temp_ptr;<br /><br />// actual function takes no parameters, uses static parameters instead of stack<br />void PreparePpuUpdate()<br />{<br />&nbsp; &nbsp;for (b = 0; b &lt; temp_a; ++b)<br />&nbsp; &nbsp; &nbsp; PpuUpdate&#91;PpuUpdateIndex++&#93; = temp_ptr&#91;b&#93;;<br />}<br /><br />// call like this (sort of like an assembly function call)<br />temp_ptr = data;<br />temp_a = dataLength;<br />PpuUpdate();<br /></div><br />You could create a macro to roll up that function call into a single line, if you need to cut down on the verbosity.<br /><br />Might go even further by making the temp variables zeropage. To do this I think you have to put their definition in an assembly file (with a leading _) and extern them here with an additional line:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">; assembly<br />.zeropage<br />_temp_a: .res 1<br />_temp_ptr: .res 2<br /><br />// C<br />extern unsigned char temp_a;<br />extern unsigned char temp_ptr;<br />#pragma zpsym (&quot;temp_a&quot;);<br />#pragma zpsym (&quot;temp_ptr&quot;);</div><br />I tend to have a collection of generic static temporaries with names like i, j, k, l defined like this.<br /><br /><br />And if you want a few more ideas to play with, register variables, and/or fastcall with small number of arguments may or may not help.<br /><br />Not sure if this variation would be faster, would have to test each case, but this is an example of other kinds of things you can try:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">#pramga regvars (on)<br />void fastcall PreparePpuUpdate(unsigned char data_len)<br />{<br />&nbsp; &nbsp;register unsigned char i;<br />&nbsp; &nbsp;for (i = 0; b &lt; data_len; ++i)<br />&nbsp; &nbsp; &nbsp; PpuUpdate&#91;PpuUpdateIndex++&#93; = temp_ptr&#91;i&#93;;<br />}</div><br />There's a tipping point where I don't want to mess around with variations of C code guessing to try to find the compiler's &quot;sweet spot&quot; and I'd rather just spend the time writing in assembly, though. Sometimes you can learn things that basically apply everywhere (e.g. principles like &quot;avoid the C stack&quot;) but sometimes all you're doing is trying to optimize a single function and it won't help you anywhere else (e.g. use of register variables is highly situation dependent). Up to you how far you want to experiment.<br /><br /><br />This is also a big pitfall of writing C on the NES. Sooner or later you run into something that just doesn't perform well enough despite looking like very sensible C code. At this point you can fight the compiler by trying variations of the code, bypass it by rewriting the function in assembly, or abandon your project entirely, I guess. Mostly I would recommend compiling and testing very frequently (try to measure performance often; while working on it I suggest writing $2001 with the greyscale bit at the end of the update) so that you have a good idea of what code you just changed that suddenly made it slow.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p155637"></a>
				<b class="postauthor">tokumaru</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155637">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155637&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155637"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 12:12 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=95.png" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Feb 12, 2005 9:43 pm<br /><b>Posts:</b> 8431<br /><b>Location:</b> Rio de Janeiro - Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">What's the point of coding in C if you have to do it in unintuitive ways, always minding the generated assembly code? Might just as well code directly in assembly, it will probably be easier/faster than going back and forth until you're satisfied with the code generated by the compiler.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=95&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p155640"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155640">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155640&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155640"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 12:33 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1384529626.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 3436<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">There's a difference between &quot;unintuitive&quot; and &quot;non-typical&quot;.<br /><br />The stuff like statics for parameters is non-typical for C, but it's hardly unintuitive. There's a learning curve, but once you know the general pitfalls it's fairly intuitive, even if the code looks a little weird compared to typical C code.<br /><br />Stuff that you really have to test to understand at all is unintuitive, like trying register variables to see if that helps, etc. I don't often find pursing that kind of thing worthwhile when I can just do it in assembly.<br /><br />You can't really expect every kind of typical code to work well on a limited platform like the NES. DRW has come across several cases where using pointers is dog-slow. CC65's C is very bad for moving arrays of data around like this. In particular, being able to use the absolute address of an array instead of a pointer variable can be a huge speed increase (though still slow compared to assembly). Just like you probably don't want to use multiply or divide in a performance critical section, you also probably don't want to copy an array through a pointer. That's a somewhat intuitive guideline, isn't it?<br /><br />There's always another way to get the same task done. If one way turns out to be bad, try a different way. In this case using &quot;memcpy&quot; is a pretty easy alternative? (Which DRW already discovered.)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p155643"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155643">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155643&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155643"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 1:17 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1384529626.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 3436<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">DRW wrote:</div><div class="quotecontent">I'll just use the standard C function <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">memcpy</tt>, even though I didn't want to use any actual C library functions.</div><br />Writing any code at all in C constantly uses functions from the CRT library. Like how if you write * the compiler actually generates a call to a multiply subroutine, any use of local variables or stack parameteres calls a bunch of stack handling subroutines, etc. The only difference here is memcpy is explicitly called from C instead of only implicitly.<br /><br />Also remember that nothing from the library gets added to your ROM unless you actually use it, so it's not harmful to have a CRT library that's got unused stuff in it.<br /><br />It might also be worth your while to write a custom 8-bit memcpy variant in assembly that takes 2 pointer parameters (or even better uses 2 pointer ZP statics) and copies up to 256 bytes. Something simple like:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">// C<br /><br />extern unsigned char* ptr0;<br />extern unsigned char* ptr1;<br />#pragma zpsym (&quot;ptr0&quot;)<br />#pragma zpsym (&quot;ptr1&quot;)<br />extern void fastcall copy8(unsigned char len); // copies len bytes from ptr0 to ptr1 (regions should not overlap)<br /><br />#define COPY8(param_dst,param_src,param_len) \<br />&nbsp; &nbsp;ptr0=param_src; \<br />&nbsp; &nbsp;ptr1=param_dst; \<br />&nbsp; &nbsp;copy8(param_len);<br /><br />// example call<br />COPY8(mydest,mysrc,25);<br /><br />; assembly<br /><br />.zeropage<br />_ptr0: .res 2<br />_ptr1: .res 2<br />.export _ptr0<br />.export _ptr1<br /><br />.code<br />.export _copy8<br />_copy8:<br />&nbsp; &nbsp;tay ; fastcall means len parameter is in A<br />&nbsp; &nbsp;jmp @next<br />&nbsp; &nbsp;@loop:<br />&nbsp; &nbsp;&nbsp; &nbsp;dey<br />&nbsp; &nbsp;&nbsp; &nbsp;lda (ptr0), Y<br />&nbsp; &nbsp;&nbsp; &nbsp;sta (ptr1), Y<br />&nbsp; &nbsp;@next:<br />&nbsp; &nbsp;&nbsp; &nbsp;cpy #0<br />&nbsp; &nbsp;&nbsp; &nbsp;bne @loop<br />&nbsp; &nbsp;rts</div><br /><br />(Could probably be optimized a bit more, but you get the idea.)</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=5165&amp;sid=1e4f7b5548eee5ffae5c9955448927de">rainwarrior</a> on Sat Sep 19, 2015 3:28 pm, edited 6 times in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p155655"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155655">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155655&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155655"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 2:24 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 727
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">On the subject of &quot;memcpy&quot; being faster, the reason &quot;memcpy&quot; will do better than any naive version of it you can write in CC65 is that memcpy is implemented in assembly in the CRT. If you try to write a &quot;memcpy&quot; equivalent in CC65 C code it will always be slower.</div><br />That's of course clear. But I was surprised that you can call memcpy 50 times (probably even more) in the same frame and the game still runs at full speed. But when you write a C equivalent, the game lags when you even just call it three times.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">I made this suggestion before, but it very often helps to avoid using the C stack; which means: avoid local variables, avoid parameters to function call.</div><br />Yeah, that was the next thing that I thought about as well. (See above.) I tried it out, but it still wasn't faster.<br /><br />Maybe I'm doing something wrong. If you replace the &quot;ProcessNextFrame.c&quot; in the above zip file with the below code, you can try it out:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">#define ARRAY_LENGTH(array) (sizeof(array) / sizeof((array)&#91;0&#93;))<br /><br />extern unsigned char ScrollingPosition;<br />#pragma zpsym(&quot;ScrollingPosition&quot;)<br /><br />static unsigned char PpuUpdate&#91;255&#93;;<br />static unsigned char PpuUpdateIndex;<br /><br />static unsigned char b;<br /><br />static const unsigned char StatusBar&#91;&#93; =<br />{<br />&nbsp; &nbsp;0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br />};<br /><br />const unsigned char *GenericPointer;<br />unsigned char GenericSizeValue;<br /><br />void PreparePpuUpdate_()<br />{<br />&nbsp; &nbsp;for (b = 0; b &lt; GenericSizeValue; ++b)<br />&nbsp; &nbsp;&nbsp; &nbsp;PpuUpdate&#91;PpuUpdateIndex++&#93; = GenericPointer&#91;b&#93;;<br />}<br /><br />#define PreparePpuUpdate(data)\<br />{\<br />&nbsp; &nbsp;GenericPointer = data;\<br />&nbsp; &nbsp;GenericSizeValue = ARRAY_LENGTH(data);\<br />&nbsp; &nbsp;PreparePpuUpdate_();\<br />}<br /><br />void ProcessNextFrame(void)<br />{<br />&nbsp; &nbsp;ScrollingPosition += 1;<br /><br />&nbsp; &nbsp;PpuUpdateIndex = 0;<br />&nbsp; &nbsp;PreparePpuUpdate(StatusBar);<br />&nbsp; &nbsp;PreparePpuUpdate(StatusBar);<br />&nbsp; &nbsp;PreparePpuUpdate(StatusBar);<br />}</div><br /><br />Only when I <em>actually</em> work with the constant value itself does it work at full speed again:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">void PreparePpuUpdate()<br />{<br />&nbsp; &nbsp;for (b = 0; b &lt; ARRAY_LENGTH(StatusBar); ++b)<br />&nbsp; &nbsp;&nbsp; &nbsp;PpuUpdate&#91;PpuUpdateIndex++&#93; = StatusBar&#91;b&#93;;<br />}</div><br />But this is of course not an option since there can be <em>any</em> value that needs to be passed to PpuUpdate.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">Might go even further by making the temp variables zeropage. To do this I think you have to put their definition in an assembly file (with a leading _) and extern them here with an additional line:</div><br />There's an alternate version where you can declare the variables even in C:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">#pragma bssseg(push, &quot;ZEROPAGE&quot;)<br />unsigned char MyZeropageVariable;<br />#pragma bssseg(push, &quot;BSS&quot;)<br />unsigned char AndNowWeAreInBssAgain;</div><br /><br />The __fastcall__ command I'm aware of. Although, if you write your function definition in C, it doesn't really change anything relevant. This is more for functions that you write in Assembly. I'll still use it just to be sure. But in the moment, something else is the bottleneck in my program, so I don't bother with these minimalistic optimizations until later.<br /><br />I put <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">#pramga regvars &#40;on&#41;</tt> into my todo list. I will check it out later when background buildup and sprite movement are implemented and work together in my game.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">Up to you how far you want to experiment.</div><br />I usually write the C code as I would in a PC program plus the general NES stuff (use global variables/static local variables instead of regular local ones etc., avoid function parameters if possible etc.). Only when something actually doesn't work with 60 frames per second anymore do I investigate and try to optimize. Furthermore, I have a bunch of items in my todo list that I need to change. But since I'm still building the basics of the game, this wasn't necessary yet.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">Sooner or later you run into something that just doesn't perform well enough despite looking like very sensible C code.</div><br />I'm still hoping that my game will be simple enough that this won't become an issue. But who knows? Maybe I will have to write an Assembly function here and there later.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">Mostly I would recommend compiling and testing very frequently</div><br />This is of course a given. I write a piece of code and see if it works.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">(try to measure performance often; while working on it I suggest writing $2001 with the greyscale bit at the end of the update) so that you have a good idea of what code you just changed that suddenly made it slow.</div><br />Sincy my program uses autoscrolling, I immediately see when something becomes slow.<br /><br /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">What's the point of coding in C if you have to do it in unintuitive ways, always minding the generated assembly code? Might just as well code directly in assembly, it will probably be easier/faster than going back and forth until you're satisfied with the code generated by the compiler.</div><br />I agree with rainwarrior's suggestions. You actually just have to keep some things in mind, like declaring a bunch of global variables for your temporary stuff instead of using a local variable whenever you need it. It's still a ton easier than writing pure Assembly.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">Writing any code at all in C constantly uses functions from the CRT library. Like how if you write * the compiler actually generates a call to a multiply subroutine, any use of local variables or stack parameteres calls a bunch of stack handling subroutines, etc. The only difference here is memcpy is explicitly called from C instead of only implicitly.</div><br />Sure, but that's the thing: I of course use the compiler to tranform C code into Assembly. But the C standard library, this is not just the language C anymore. This is a subjective collection of functions that the creators of C thought might be useful. And these kinds of functions, that's what I want to do myself.<br />That <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">a = 3* b;</tt> gets transformed to functions as well, sure, that's the way the compiler works.<br />But by using <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">#include &lt;string.h&gt;</tt>, I explicitly use external functions in my own code. And I wanted to avoid this, especially for such basic stuff like memory copy. All the called functions in C shall be part of my own project.<br /><br />I will get back to your copy function in a while. (Once I can actually move around a charcater on screen <em>and</em> that character interacts with the level, I'll take a break from implementing new stuff and try out all the code-related things that I've written down.)<br />Thanks for it.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p155660"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155660">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155660&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155660"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 2:57 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1384529626.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 3436<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">DRW wrote:</div><div class="quotecontent"><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">I made this suggestion before, but it very often helps to avoid using the C stack; which means: avoid local variables, avoid parameters to function call.</div><br />Yeah, that was the next thing that I thought about as well. (See above.) I tried it out, but it still wasn't faster.<br /><br />Maybe I'm doing something wrong. If you replace the &quot;ProcessNextFrame.c&quot; in the above zip file with the below code, you can try it out...</div><br />I took a look, and in this case you're right, it doesn't help very much. It optimizes away a stack access, but it's still really bogged down in the inefficent way the compiler is doing pointer access, so... sorry, yeah, this suggestion doesn't actually make a significant difference here. (I also suspect that &quot;register&quot; wouldn't do any good either. The generated code for this kind of pointer copy loop is just <em>really shitty</em>.)<br /><br />By the way, I highly recommend you break your cl65 line up into steps so you can take a look at the intermediate assembly. I had to do this to take a look at what it was producing:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">cc65 -o ProcessNextFrame.s -t nes ProcessNextFrame.c<br />ca65 -o ProcessNextFrame.o -t nes ProcessNextFrame.s<br />ca65 -o Main.o -t nes Main.s<br />cl65 -o Test.nes -t nes -C NES.cfg Main.o ProcessNextFrame.o<br /><br />; instead of<br /><br />cl65 -o Test.nes -t nes -C NES.cfg Main.s ProcessNextFrame.c</div><br /><br /><div class="quotetitle">DRW wrote:</div><div class="quotecontent">There's an alternate version where you can declare the variables even in C:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">#pragma bssseg(push, &quot;ZEROPAGE&quot;)<br />unsigned char MyZeropageVariable;<br />#pragma bssseg(push, &quot;BSS&quot;)<br />unsigned char AndNowWeAreInBssAgain;</div></div><br />Ah, interesting. Thanks for the tip.<br /><br /><div class="quotetitle">DRW wrote:</div><div class="quotecontent"><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">(try to measure performance often; while working on it I suggest writing $2001 with the greyscale bit at the end of the update) so that you have a good idea of what code you just changed that suddenly made it slow.</div><br />Sincy my program uses autoscrolling, I immediately see when something becomes slow.</div><br />The suggestions to write $2001 was to visually show where on the screen the CPU had reached when the update stopped. That way you get a rough estimate of how long the frame took; you don't have to wait for slowdown, you can see if the code you just added took 5 scanlines or 100 scanlines, even if you're still running at 60fps. (I actually like to use the emphasis bits + greyscale to color code different timings, though FCEUX doesn't support more than two emphasis states per frame yet; coming in its next version, available in beta builds...)<br /><br />Sometimes something is really slow, but not quite slow enough to run over the end of the frame. If you're only looking for slowdown cases, you might add something small that becomes &quot;the straw that broke the camel's back&quot; and mistakenly think it was the primary cause of slowdown.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p155664"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155664">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155664&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155664"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 3:32 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 727
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">By the way, I highly recommend you break your cl65 line up into steps so you can take a look at the intermediate assembly.</div><br />As often, I'm actually doing this in my real program. But for the sample program, I shortened it to one line to have the whole contents as small as possible. But I'll remember it next time I need to post a complete project.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">The suggestions to write $2001 was to visually show where on the screen the CPU had reached when the update stopped.</div><br />Oh, you mean I shall do a mid-frame update. Yeah, that might help.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p155682"></a>
				<b class="postauthor" style="color: #AA0000">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155682">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155682&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155682"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 5:00 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_online.gif" alt="Online" title="Online" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 15847<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">What's the point of coding in C if you have to do it in unintuitive ways, always minding the generated assembly code? Might just as well code directly in assembly, it will probably be easier/faster than going back and forth until you're satisfied with the code generated by the compiler.</div><br />Ability to share code between the NES and PC versions of a single game, perhaps? Or would it be better to write the game in assembly and then write a <a href="http://forums.nesdev.com/viewtopic.php?p=127177#p127177" class="postlink">static translator</a> from 6502 to C?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p155683"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155683">Re: Lag in the game logic even though it is very short</a></div><div style="float: right;"><a href="./viewtopic.php?p=155683&amp;sid=1e4f7b5548eee5ffae5c9955448927de#p155683"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 19, 2015 5:04 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 727
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I would say the biggest advantage is that you can still do most of the stuff pretty easily. I take care not to use fatures that are too slow for the NES. But if I had to code completely in Assembly, then I wouldn't start to program a game in the first place.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=2&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>2</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 23 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de&amp;start=15">2</a> &nbsp;<a href="./viewtopic.php?f=2&amp;t=13272&amp;sid=1e4f7b5548eee5ffae5c9955448927de&amp;start=15">Next</a></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php?sid=1e4f7b5548eee5ffae5c9955448927de">Board index</a> &#187; <a href="./viewforum.php?f=24&amp;sid=1e4f7b5548eee5ffae5c9955448927de">NES / Famicom</a> &#187; <a href="./viewforum.php?f=2&amp;sid=1e4f7b5548eee5ffae5c9955448927de">NESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 3 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php?sid=1e4f7b5548eee5ffae5c9955448927de"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="13272" />
<input type="hidden" name="sf" value="msgonly" />
<input type="hidden" name="sid" value="1e4f7b5548eee5ffae5c9955448927de" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php?sid=1e4f7b5548eee5ffae5c9955448927de" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2" selected="selected">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;Reproduction</option>
		
			<option value="11">&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="12">&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;GBDev</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>

<img src="./cron.php?cron_type=queue&amp;sid=1e4f7b5548eee5ffae5c9955448927de" width="1" height="1" alt="cron" />
</div>

<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>