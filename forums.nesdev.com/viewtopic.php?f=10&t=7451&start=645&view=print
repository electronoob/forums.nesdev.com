<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - 8x16 and whatever else unreg wants to know</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">8x16 and whatever else unreg wants to know</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=10&amp;t=7451">http://forums.nesdev.com/viewtopic.php?f=10&amp;t=7451</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>44</strong> of <strong>83</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Sat Jun 30, 2012 10:49 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I went through FamiToneUpdate and was looking for PPU accesses, but Shiru used names and at the top all the names are equal to <span style="color: yellow">$40xx</span> addresses... Those are APU addresses I remember it said that... my memory is getting better! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />   <img src="./images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" />... so I wanted to tell you, tokumaru, that moving my scroll function up just above the <span style="color: violet">SkipUpdates:</span> (line <span style="color: yellow">$0C350</span>) reverts my .nes file back to the problem preventing scrolling.  ...So you are incredibly right when you say updating the scroll should always be the last step of vblank!  Thank you so much telling me that! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />
<br />
<br />I also want to say a little bit more about the quick flashing of alternate nametables that happens right now (after the screen has started scrolling).  Before scrolling the screen the top half is the correct tiles... the bottom half is mostly tile 0.  Like about three rows or so... ok so it's not mostly  <img src="./images/smilies/icon_sad.gif" alt=":(" title="Sad" /> ...There are about three rows at the bottom of the screen; they're all tile 0.  When scrolling starts there are  a little over five rows of tile 0 at the bottom of the second screen that scrolls over.  And then I can see both the first and second screen.  In NINTENDULATOR as well as FCEUX 2.1.5.  haha! I could try this on the powerpack... but... well maybe I shouldn't? <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" />
<br />
<br /><div class="quotetitle">3gengames wrote:</div><div class="quotecontent">But I don't really see any problems, does the glitch happen with varying levels of height? it might be a wrong variable name somewhere or something like that. Log all your writes and make sure they're all right...</div>
<br />
<br />3gengames, I'm sorry I don't think I noticed this help... no the glitch happens at any height.  "Log all my writes..."; so I need to use the logger on FCEUX.........? How... well, I know I can click <span style="color: green">writes</span> in the debugger when setting a breakpoint...  I'm confused; going to try doing ? <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" />  <span style="color: orange">Thank you so much for helping me too. <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></span>
<br />
<br /><span style="color: orange">edit.</span>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Kasumi</b> [ Sat Jun 30, 2012 2:53 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Long post. Forgive spelling/grammar/forgotten words, please. Usually I spend more time proofreading, but I've got some things I have to do tonight. 
<br />
<br />What's draw_sprite?
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">0C35D A2 00                             ldx #$00                ; Reset VRAM<br />0C35F 8E 06 20                          stx $2006<br />0C362 8E 06 20                          stx $2006 <br /></div>
<br />I don't think there's a need for this. This would set the address $2007 would write to to zero if you wanted to do that, but it doesn't reset anything. If you're worried about the latches being out of sync, you could bit $2002. 
<br />
<br />Now, I don't understand your scrolling logic at all. Posting lots of code usually doesn't bother me, but I have to have an idea of what it's doing. Some stuff here is specific to your game which I have no clue about. I'm under the impression you're doing something like, "If the player is close to the edge of the screen, and he's holding right we scroll slightly faster than his walk speed" Is this correct?
<br />
<br />Now, I just do this in my vblank:
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">lda scrollxhigh<br />and #%00000001<br />ora mir2000;A variable that contains a mirror of $2000 that has already had its low two bits cleared out<br />sta $2000<br /><br />lda scrollxlow<br />sta $2005<br />lda scrollyscreenlow<br />sta $2005<br /></div><br /><br />My vblank routine doesn't care about what the values are, nor does it try to update them because my game logic should take care of that.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">;ldx oX&nbsp; work on this now<br />0C365&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;if oX &gt; 192<br />0C365 A5 04&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lda oX<br />0C367 38&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sec<br />0C368 E9 C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sbc #192<br />0C36A 30 13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bmi +skipscroll<br /></div><br />First question: What's oX? Second thing, I think this won't branch in some cases you'd want it to. Let's say oX is 0. #$00-#$C0 (192) = #$40. #$40 = #%01000000. The high bit isn't set. No branch. So from #$00-#$3F this would NOT branch to skipscroll. From #$40-#$BF it would. Then from #$C0-#$FF it would not.<br /><br />You may want to use the carry flag if you're trying to check if oX-192 was less than 0.<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0C36C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C36C A5 00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lda currControllerButtons&nbsp; ;make sure the<br />0C36E 29 01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and #00000001b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;Right Button is being pressed<br />0C370 F0 0D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;beq +skipscroll<br />0C372&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C372&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C372&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;lda #255<br />0C372&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;sta scroll<br />0C372 A5 1D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lda CameraX+0<br />0C374 38&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;Set subtract. Clear Add.<br />0C375 E9 FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sbc #255<br />0C377 F0 06&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;beq +skipscroll&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;skip incrementing scroll when it gets to #255<br /></div><br />If CameraX is 253 or 254, the beq won't skip the scroll and we'll add 3 to cameraX because of the code below, scrolling past zero which seems like something you don't want to have happen.<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0C379&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C379 E6 1D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INC CameraX+0&nbsp; &nbsp; &nbsp; &nbsp;; add one to our camera variable each frame<br />0C37B E6 1D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INC CameraX+0&nbsp; &nbsp; &nbsp; &nbsp;; add one to our camera variable each frame<br />0C37D E6 1D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INC CameraX+0&nbsp; &nbsp; &nbsp; &nbsp;; add one to our camera variable each frame <br /></div><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0C37F A9 88&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lda #%10001000<br />0C381 85 1A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; sta currNameTable;No need to store here. You're doing it again without loading the value immediately after.<br />0C383 29 FE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and #$fe ;clear the lowest bit;You don't need to do this. You loaded an immediate number that already has this bit clear.<br />0C385 85 1A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sta currNameTable ;Als<br /></div><br /><br />As well, I can see no condition where CameraX+1 ever changes. This means that once you scroll hits 255 for nametable 1, you'll be seeing MOST of nametable 2. But then when it hits 0, you'll see none of nametable 2 and all of nametable 1 again. Right now this problem will happen for you at least some of the time, because if those three inc CameraX instructions I posted above wrap CameraX back to 0, the high byte is never updated.<br /><br />Those are some problems I see. They actually probably won't fix the problem you describe, though. Please post anything that updates CameraX and CameraX+1 that outside of the vblank routine. (If there IS any code that updates them outside of the vblank.)<br /><br />The camera should be a 16bit variable.<br /><br />Want to scroll 8 pixels to the right?<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">lda CameraX<br />clc<br />adc #$08<br />sta CameraX<br /><br />lda CameraX+1<br />adc #$00<br />sta CameraX+1<br /></div>
<br />If you want to not scroll past a certain value, check the high byte after the add to see if it became too large. If it did, set both the high and low byte to the furthest you want it to scroll. 
<br />
<br />Do any camera logic outside of your vblank.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Mon Jul 02, 2012 2:09 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">Long post. Forgive spelling/grammar/forgotten words, please. Usually I spend more time proofreading, but I've got some things I have to do tonight.</div>It's ok, thank you for the quick help! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />  In 30 minutes I have to go mow... will try to reply to as much as I can now.<br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"> <br /><br />What's draw_sprite?</div><br />Oh sorry the code at bottom of page 43 should have continued... to the end of my vblank file...<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;80 81&nbsp; &nbsp; &nbsp; &nbsp;<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;90 91&nbsp; &nbsp; &nbsp; &nbsp;<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;a0 a1&nbsp; &nbsp; &nbsp; &nbsp;<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;b0 b1&nbsp; &nbsp;<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; &nbsp; &nbsp; &nbsp; .db aY, $80, $00, aX, aY, $81, $00, aX+8,<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; aY+8, $90, $00, aX, aY+8, $91, $00, aX+8,<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; aY+16, $a0, $00, aX, aY+16, $a1, $00, aX+8,<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;aY+24, $b0, $00, aX, aY+24, $b1, $00, aX+8<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;draw_sprite:<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; t0-t2 are temporary zero page locations holding<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; the address of a particular sprite layout and the<br />0C39D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; number of sprites left to draw<br />0C39D BD 14 D9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; lda sprite_layouts_lo, x&nbsp; ;&lt;-- ABSOLUTE INDEXED ADDRESSING<br />0C3A0 85 07&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; sta t0<br />0C3A2 BD 28 D9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; lda sprite_layouts_hi, x&nbsp; ;&lt;-- ABSOLUTE INDEXED ADDRESSING<br />0C3A5 85 08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; sta t0+1<br />0C3A7 BD 3C D9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; lda sprite_layouts_count, x&nbsp; ;&lt;-- ABSOLUTE INDEXED ADDRESSING<br />0C3AA 85 09&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; sta t2<br />0C3AC A0 00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ldy #0<br />0C3AE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; oamIndex is a variable tracking how far you've written<br />0C3AE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; into shadow OAM &#40;customarily at $0200-$02FF&#41;<br />0C3AE A6 0B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ldx oamIndex<br />0C3B0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;@loop:<br />0C3B0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; If you have the address of an array in a zero page pointer,<br />0C3B0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; you use the &#40;d&#41;,y addressing mode and increase Y to go<br />0C3B0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; to the next byte.<br />0C3B0 B1 07&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; lda &#40;t0&#41;, y&nbsp; ;&lt;-- INDIRECT INDEXED ADDRESSING<br />0C3B2 C8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; iny<br />0C3B3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ;ect. start<br />0C3B3 18&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; clc<br />0C3B4 65 05&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; adc oY<br />0C3B6 9D 00 02&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sta sprite, x&nbsp; ;&lt;-- ABSOLUTE INDEXED ADDRESSING<br />0C3B9 E8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; inx<br />0C3BA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <br />0C3BA B1 07&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; lda &#40;t0&#41;, y<br />0C3BC C8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; iny<br />0C3BD 9D 00 02&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sta sprite, x<br />0C3C0 E8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; inx<br />0C3C1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <br />0C3C1 B1 07&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; lda &#40;t0&#41;, y<br />0C3C3 C8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; iny<br />0C3C4 9D 00 02&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sta sprite, x<br />0C3C7 E8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; inx<br />0C3C8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <br />0C3C8 B1 07&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; lda &#40;t0&#41;, y<br />0C3CA C8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; iny<br />0C3CB 18&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; clc<br />0C3CC 65 04&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; adc oX<br />0C3CE 9D 00 02&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sta sprite, x<br />0C3D1 E8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; inx<br />0C3D2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <br />0C3D2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ;end ect.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <br />0C3D2 C6 09&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; dec t2<br />0C3D4 D0 DA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; bne @loop<br />0C3D6 86 0B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; stx oamIndex<br />0C3D8 60&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; rts</div> there this is the very end of my vblank file.<br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">0C35D A2 00                             ldx #$00                ; Reset VRAM<br />0C35F 8E 06 20                          stx $2006<br />0C362 8E 06 20                          stx $2006 <br /></div><br />I don't think there's a need for this. This would set the address $2007 would write to to zero if you wanted to do that, but it doesn't reset anything. If you're worried about the latches being out of sync, you could bit $2002. </div> <span style="color: orange">Sorry, I don't understand. <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" /></span><br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">Now, I don't understand your scrolling logic at all. Posting lots of code usually doesn't bother me, but I have to have an idea of what it's doing. Some stuff here is specific to your game which I have no clue about. I'm under the impression you're doing something like, "If the player is close to the edge of the screen, and he's holding right we scroll slightly faster than his walk speed" Is this correct?</div>  Yes, that's how it works now... not complicated... I know.<br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">Now, I just do this in my vblank:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">lda scrollxhigh<br />and #%00000001<br />ora mir2000;A variable that contains a mirror of $2000 that has already had its low two bits cleared out<br />sta $2000<br /><br />lda scrollxlow<br />sta $2005<br />lda scrollyscreenlow<br />sta $2005<br /></div><br /><br />My vblank routine doesn't care about what the values are, nor does it try to update them because my game logic should take care of that.</div><span style="color: orange">...I can't follow...  <img src="./images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /> </span><br /><br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"><div class="codetitle"><b>Code:</b></div><div class="codecontent">;ldx oX&nbsp; work on this now<br />0C365&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;if oX &gt; 192<br />0C365 A5 04&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lda oX<br />0C367 38&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sec<br />0C368 E9 C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sbc #192<br />0C36A 30 13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bmi +skipscroll<br /></div><br />First question: What's oX?</div> oX is my variable for the x-coordinate location of my one sprite on the screen.  oY is the y-coordinate... cause 'x' and 'y' refer to the x-register and y-register 
<br />   Sorry, must go mow now...
<br /><span style="color: orange">edited.</span>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Mon Jul 02, 2012 3:15 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Now, I dont have to mow... so here's the rest...
<br /> 
<br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">Second thing, I think this won't branch in some cases you'd want it to. Let's say oX is 0. #$00-#$C0 (192) = #$40. #$40 = #%01000000. The high bit isn't set. No branch. So from #$00-#$3F this would NOT branch to skipscroll. From #$40-#$BF it would. Then from #$C0-#$FF it would not.</div>  Ah, yes... after trying this with calculator Hex it read FFFFFFFFFFF40 and so I didn't see the fact that FF40 means 1111111101000000.  In my head all the Fs made it confusing  for me; thank you so much for seeing this and pointing it out! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /> <br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"><br />You may want to use the carry flag if you're trying to check if oX-192 was less than 0.</div>  Yes, thank you, I understand that now! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"><div class="codetitle"><b>Code:</b></div><div class="codecontent">0C36C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C36C A5 00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lda currControllerButtons&nbsp; ;make sure the<br />0C36E 29 01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and #00000001b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;Right Button is being pressed<br />0C370 F0 0D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;beq +skipscroll<br />0C372&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C372&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C372&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;lda #255<br />0C372&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;sta scroll<br />0C372 A5 1D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lda CameraX+0<br />0C374 38&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;Set subtract. Clear Add.<br />0C375 E9 FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sbc #255<br />0C377 F0 06&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;beq +skipscroll&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;skip incrementing scroll when it gets to #255<br /></div><br />If CameraX is 253 or 254, the beq won't skip the scroll and we'll add 3 to cameraX because of the code below, scrolling past zero which seems like something you don't want to have happen.<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0C379&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C379 E6 1D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INC CameraX+0&nbsp; &nbsp; &nbsp; &nbsp;; add one to our camera variable each frame<br />0C37B E6 1D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INC CameraX+0&nbsp; &nbsp; &nbsp; &nbsp;; add one to our camera variable each frame<br />0C37D E6 1D&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INC CameraX+0&nbsp; &nbsp; &nbsp; &nbsp;; add one to our camera variable each frame <br /></div><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0C37F A9 88&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lda #%10001000<br />0C381 85 1A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; sta currNameTable;No need to store here. You're doing it again without loading the value immediately after.<br />0C383 29 FE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and #$fe ;clear the lowest bit;You don't need to do this. You loaded an immediate number that already has this bit clear.<br />0C385 85 1A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sta currNameTable ;Als<br /></div><br /><br />As well, I can see no condition where CameraX+1 ever changes. This means that once you scroll hits 255 for nametable 1, you'll be seeing MOST of nametable 2. But then when it hits 0, you'll see none of nametable 2 and all of nametable 1 again. Right now this problem will happen for you at least some of the time, because if those three inc CameraX instructions I posted above wrap CameraX back to 0, the high byte is never updated.<br /><br />Those are some problems I see. They actually probably won't fix the problem you describe, though. Please post anything that updates CameraX and CameraX+1 that outside of the vblank routine. (If there IS any code that updates them outside of the vblank.)<br /><br />The camera should be a 16bit variable.<br /><br />Want to scroll 8 pixels to the right?<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">lda CameraX<br />clc<br />adc #$08<br />sta CameraX<br /><br />lda CameraX+1<br />adc #$00<br />sta CameraX+1<br /></div><br />If you want to not scroll past a certain value, check the high byte after the add to see if it became too large. <br /></div> Ahhh this is making sense! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> Thank you, but I don't understand these next 2 parts... it's ok that I dont understand; you are not at fault. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">If it did, set both the high and low byte to the furthest you want it to scroll.</div> <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" /> <br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">Do any camera logic outside of your vblank.</div>Why?  <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Denine</b> [ Mon Jul 02, 2012 3:46 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">unregistered wrote:</div><div class="quotecontent">Ahhh this is making sense! Very Happy Thank you, but I don't understand these next 2 parts... it's ok that I dont understand; you are not at fault. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">	<br />If it did, set both the high and low byte to the furthest you want it to scroll.<br /></div></div><br /><br />Say, you want to restrict scrolling to 1 (high byte) and 40(low byte).<br />So when it get bigger(for example 1 and 41) you manually set bytes back to 1 and 40.Of course you can make different approach. For example, instead of setting bytes manualy, simply jump over scrolling increasement code.<br /><br /><div class="quotetitle">unregistered wrote:</div><div class="quotecontent"><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">Do any camera logic outside of your vblank.</div>Why?  <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" /></div>
<br />Because Vblank time is precious and should not be wasted on thing that can be done in frame time. The thing is that during Vblank you can do various things that can't be done in frame time like writing to $2007(update tiles on screen, update pallete etc.) while screen rendering is turned ON.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Mon Jul 02, 2012 5:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">unregistered wrote:</div><div class="quotecontent"><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">0C35D A2 00                             ldx #$00                ; Reset VRAM<br />0C35F 8E 06 20                          stx $2006<br />0C362 8E 06 20                          stx $2006 <br /></div><br />I don't think there's a need for this. This would set the address $2007 would write to to zero if you wanted to do that, but it doesn't reset anything. If you're worried about the latches being out of sync, you could bit $2002. </div> <span style="color: orange">Sorry, I don't understand. <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" /></span></div>
<br />Writing zeroes to $2006 is something that bad NES programmers do when they don't know how to properly set the scroll and the screen is jumping. I seemingly fixes the problem, but it doesn't fully reset the scroll. BTW, since your game does scroll, you shouldn't be trying to reset the scroll at all, because if you were successful your screen just wouldn't move.
<br />
<br />Anyway, the correct way to set the scroll is by writing once to $2000 (to select the name table) and twice to $2005 (to set the X and Y scroll values). $2006 should only be used for scrolling under special circumstances that newbies shouldn't be worried about (such as changing the scroll mid-frame). Under normal circumstances, $2006 should only be used for setting the PPU address before reading/writing data through $2007, and there's absolutely no need to reset that address.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Kasumi</b> [ Mon Jul 02, 2012 10:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">unregistered wrote:</div><div class="quotecontent">In my head all the Fs made it confusing  for me; thank you so much for seeing this and pointing it out! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>
<br />Windows calculator? If so, protip: Switch it to byte mode. (There's a choice between Qword, Dword, Word, Byte when it's in hex or binary mode) That will make $00-$C0=$40, or turn -192 into $40 when switching to hex mode. No extra F's.
<br />
<br />On another note: Provided I'm understanding it correctly, draw_sprite seems to be updating at least part of $0200-02FF. But you run update_sprite (which actually copies the sprite's data from $0200-$02FF) before it. This means whatever draw_sprite is writing will only appear during the <em>NEXT</em> vblank. 
<br />
<br />Edit: Hmm... I guess this DOES keep updates that don't need to be done before rendering after things that do which is good. But, I'd recommend moving it out of vblank entirely if that's possible.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Tue Jul 03, 2012 5:04 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Denine wrote:</div><div class="quotecontent"><div class="quotetitle">unregistered wrote:</div><div class="quotecontent">Ahhh this is making sense! Very Happy Thank you, but I don't understand these next 2 parts... it's ok that I dont understand; you are not at fault. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">	<br />If it did, set both the high and low byte to the furthest you want it to scroll.<br /></div></div><br /><br />Say, you want to restrict scrolling to 1 (high byte) and 40(low byte).<br />So when it get bigger(for example 1 and 41) you manually set bytes back to 1 and 40.Of course you can make different approach. For example, instead of setting bytes manualy, simply jump over scrolling increasement code.<br /><br /><div class="quotetitle">unregistered wrote:</div><div class="quotecontent"><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">Do any camera logic outside of your vblank.</div>Why?  <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" /></div><br />Because Vblank time is precious and should not be wasted on thing that can be done in frame time. The thing is that during Vblank you can do various things that can't be done in frame time like writing to $2007(update tiles on screen, update pallete etc.) while screen rendering is turned ON.</div><br />Thank you Denine!   <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br /><br /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent"><div class="quotetitle">unregistered wrote:</div><div class="quotecontent"><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">0C35D A2 00                             ldx #$00                ; Reset VRAM<br />0C35F 8E 06 20                          stx $2006<br />0C362 8E 06 20                          stx $2006 <br /></div><br />I don't think there's a need for this. This would set the address $2007 would write to to zero if you wanted to do that, but it doesn't reset anything. If you're worried about the latches being out of sync, you could bit $2002. </div> <span style="color: orange">Sorry, I don't understand. <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" /></span></div><br />Writing zeroes to $2006 is something that bad NES programmers do when they don't know how to properly set the scroll and the screen is jumping. I seemingly fixes the problem, but it doesn't fully reset the scroll. BTW, since your game does scroll, you shouldn't be trying to reset the scroll at all, because if you were successful your screen just wouldn't move.<br /><br />Anyway, the correct way to set the scroll is by writing once to $2000 (to select the name table) and twice to $2005 (to set the X and Y scroll values). $2006 should only be used for scrolling under special circumstances that newbies shouldn't be worried about (such as changing the scroll mid-frame). Under normal circumstances, $2006 should only be used for setting the PPU address before reading/writing data through $2007, and there's absolutely no need to reset that address.</div><br />Thank you tokumaru! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"><div class="quotetitle">unregistered wrote:</div><div class="quotecontent">In my head all the Fs made it confusing  for me; thank you so much for seeing this and pointing it out! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div><br />Windows calculator? If so, protip: Switch it to byte mode. (There's a choice between Qword, Dword, Word, Byte when it's in hex or binary mode) That will make $00-$C0=$40, or turn -192 into $40 when switching to hex mode. No extra F's.</div>Kasumi, thanks for mentioning that! <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />  It's good to know that there's a purpose for using byte mode. <br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"><br />On another note: Provided I'm understanding it correctly, draw_sprite seems to be updating at least part of $0200-02FF. But you run update_sprite (which actually copies the sprite's data from $0200-$02FF) before it. This means whatever draw_sprite is writing will only appear during the <em>NEXT</em> vblank. <br /><br />Edit: Hmm... I guess this DOES keep updates that don't need to be done before rendering after things that do which is good. But, I'd recommend moving it out of vblank entirely if that's possible.</div>
<br />
<br />Hmm... <img src="./images/smilies/icon_neutral.gif" alt=":|" title="Neutral" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Fri Jul 06, 2012 9:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent"><div class="codetitle"><b>Code:</b></div><div class="codecontent">;ldx oX&nbsp; work on this now<br />0C365&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;if oX &gt; 192<br />0C365 A5 04&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lda oX<br />0C367 38&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sec<br />0C368 E9 C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sbc #192<br />0C36A 30 13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bmi +skipscroll<br /></div><br />...Second thing, I think this won't branch in some cases you'd want it to. Let's say oX is 0. #$00-#$C0 (192) = #$40. #$40 = #%01000000. The high bit isn't set. No branch. So from #$00-#$3F this would NOT branch to skipscroll. From #$40-#$BF it would. Then from #$C0-#$FF it would not.<br /><br />You may want to use the carry flag if you're trying to check if oX-192 was less than 0.</div>
<br />
<br />Do you mean to say that I could change the <span style="color: cyan">bmi</span> to <span style="color: cyan"><strong>b</strong></span>ranch on <span style="color: cyan"><strong>c</strong></span>arry <span style="color: cyan"><strong>s</strong></span>et or <span style="color: cyan"><strong>c</strong></span>lear?
<br />
<br />If not then I don't understand what you mean by, "You may want to use the carry flag if you're trying to check if oX-192 was less than 0."  <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" /> I'm sorry Kasumi. <img src="./images/smilies/icon_sad.gif" alt=":(" title="Sad" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Kasumi</b> [ Sat Jul 07, 2012 12:58 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="codetitle"><b>Code:</b></div><div class="codecontent">;ldx oX&nbsp; work on this now<br />0C365&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;if oX &gt; 192 don't branch<br />0C365 A5 04&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lda oX<br />0C367 38&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sec<br />0C368 E9 C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sbc #192<br />0C36A 30 13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bmi +skipscroll <br /></div>
<br />
<br />For unsigned subtracting, the carry is clear when the result (in actual arithmetic, forgetting all the byte stuff) would have been negative. Otherwise, it's set.
<br />
<br />The minus flag will check if the result byte (with wrap around) is signed negative. It's different in some cases.
<br />
<br />Forgetting hex for a moment:
<br />0  - 192 = -192.
<br />The carry would be clear after this subtraction because the result in real world math &lt; 0.
<br />
<br />But a signed byte can only store negative numbers from -1 through -128. Since the above subtraction is &lt; -128, we wrapped back to positive numbers. This is why the minus bit isn't useful for this particular check. 0-192= -192. But -192 = $40 which doesn't have the high bit set.
<br />
<br />(Before this edit, I made a definitive statement that you wanted to use bcc)
<br />Edit: Err... wait. I take that back. Give me a second to puzzle over which to use. 
<br />
<br />And, I think I had it right. Should be bcc. See below for the reason for my confusion. 
<br />
<br />I always get confused when if statements are mixed with branches. (Do we <em>not branch</em> and run the code below <strong>if</strong> the statement is true, or do we <em>branch</em> <strong>if</strong> the statement is true?) 
<br />
<br />I avoid this confusion now by ending the if statements with the expected action. (If variable - 8 &gt; 64, branch) or even (If variable - 8 &lt;= 64, don't branch). It's a style choice you don't have to adopt, but it helps me a lot with reading old/unfamiliar code. <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> 
<br />
<br />Now with it stated I may have it confused, I think your if statement comment may be incorrect. You may want it to say &gt;=.
<br />
<br />oX = 193
<br />193 - 192 = 1.
<br />Positive number. No branch.
<br />193&gt;192
<br />No problem.
<br />
<br />oX = 192
<br />192-192 = 0.
<br />Positive number. No branch.
<br />192&gt;192? 
<br />Nope. 
<br />
<br />The statement doesn't match the behavior, so whichever is "correct" should be updated to match the other.
<br />
<br />I gotta learn to write shorter posts.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Sat Jul 07, 2012 2:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />^Thank you so much Kasumi!! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />  Especially, thanks for letting me learn the logic below!  Alot of your long letters have been lavishly learnable and likeable for me. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /> A <strong>littler</strong> length may not only lose its luster, but it could also leave me lost, low, and lazily learning less.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Mon Jul 16, 2012 2:40 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Inside Nesst... there is an x variable that goes from 0 to 31 and thenthere's a y variable that increments to 1 as I move down to where x == 32.  Is it possible to use a y variable... but how would you use it?   Make it be a variable that increments on each #$20??

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Thu Jul 19, 2012 2:59 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">Those are some problems I see. They actually probably won't fix the problem you describe, though. Please post anything that updates CameraX and CameraX+1 that outside of the vblank routine. (If there IS any code that updates them outside of the vblank.)</div>
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0C048&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;;matthew's init RAM<br />0C048 A9 8B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;lda #$8b<br />0C04A 85 04&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;sta $0004 ;oX<br />0C04C 85 05&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;sta $0005 ;oY<br />0C04E A9 00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;lda #$00<br />0C050 85 06&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;sta $0006 ;scroll<br />0C052 85 1B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;sta $001b ;CameraX &#40;object&#41;<br />0C054 85 1C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;sta $001c ;CameraX+1<br />0C056&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<br />0C056&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<br />0C056 A9 00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;lda #$00<br />0C058 85 1A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;sta currNameTable<br />0C05A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<br />0C05A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<br />0C05A 58&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cli<br />0C05B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;----------------------------END OF RESET----------------------------------</div>
<br />
<br />There is the only time CameraX is updated (well initialized would be better) outside of vblank.
<br />
<br />It is still messed up... with the screen switching back and forth from nametable 1 and nametable 2... they switch so fast I've been trying to find where in the code that it is doing this; after much efforts I have still not discovered it... and  I've watched it through the repeating of the MainLoop... the screen never changed!  <img src="./images/smilies/icon_sad.gif" alt=":(" title="Sad" />  <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Kasumi</b> [ Thu Jul 19, 2012 10:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Provided you've made all the changes I've talked about, and provided I haven't told you to make a change that was messed up (which is certainly possible), I've really found about all I can while just reading the code and I cannot debug for you any other way. Whenever I end up with a problem that I absolutely cannot solve, I just rewrite it.
<br />
<br />There are very few variables involved here. 
<br />
<br />There are only two registers that should be affecting how to scroll the nametables when your screen is being rendered. $2005, and $2000. (Well, others can affect it, but not if you write to these last.) Break on writes to them, and find out what variables are stored there. Then find the code that updates those variables and find out why it's wrong. The fact that CameraX+1 is basically never touched makes it seem like you should be checking CameraX to see if it's doing something like switching between 0 and 255. (The only way I think that the nametables could be switching that quickly without CameraX+1's help).
<br />
<br />Edit: You know what? Try commenting out jsr draw_sprite and/or jsr FamiToneUpdate. If doing that works, you've run out of vblank time. It probably isn't FamiTone, but last time I check draw_sprite was before scroll_screen. It's tough for me to tell how much time draw_sprite would take, but if commenting it out helps it should be moved directly before or directly after FamiToneUpdate.
<br />
<br />But at this point, if that edit isn't true, I'd honestly just rewrite it. Remove 100% of the code that affects scroll variables and scroll registers. Then rewrite them slowly, and make sure independent parts work before putting them together. I may be wrong here, but I think you're trying to write too large pieces of code at once without verifying each small part. There's no reason not to verify even tiny things. Even for stuff that doesn't have any graphical output, you can just look at RAM values in a memory viewer.
<br />
<br />d-pad-&gt;moves character-&gt;affects scroll variables-&gt;affects scroll registers
<br />is harder to debug than
<br />d-pad-&gt;affects scroll variables-&gt;affects scroll registers
<br />which is harder to debug than
<br />d-pad-&gt;affects scroll variables
<br />which is harder to debug than
<br />d-pad (And I assume you already have working code to check for button presses!)
<br />
<br />I did something like this before I made my scrolling dependent on my character.
<br />(I was already sure my d-pad checking subroutines worked well)
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">;variables scrollxlow, scrollxhigh<br /><br />jsr p1left;If left is not being pressed<br />bne skipscrollleft;branch<br />lda scrollxlow<br />sec<br />sbc #$01<br />sta scrollxlow<br /><br />lda scrollxhigh<br />sbc #$00<br />sta scrollxhigh<br />skipscrollleft:<br /><br />jsr p1right;if right is not being pressed<br />bne skipscrollright;branch<br />lda scrollxlow<br />clc<br />adc #$01<br />sta scrollxlow<br /><br />lda scrollxhigh<br />adc #$00<br />sta scrollxhigh<br />skipscrollright:<br /></div><br />You can actually look at those variables being updated in a memory viewer when you press the d-pad. If for some reason it's wrong (which it may be!), you'll only have to look at &lt;30 lines of code.<br /><br />When it's right, you can use those variables to actually update the scroll registers.<br /><br />At the end of the NMI...<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">lda ppu2000;a variable that contains the same value in $2000<br />and #%11111100<br />sta ppu2000<br /><br />lda scrollxhigh<br />and #%00000001<br />ora ppu2000<br />sta ppu2000<br />sta $2000<br /><br />lda scrollxlow<br />sta $2005<br />lda #$00<br />sta $2005<br /></div>
<br />
<br />If something goes wrong, I'll only have to look at &lt;20 lines of code.
<br />
<br />Once I'm sure that works, I can make it so the scroll variables can't scroll past a max value or min value I set. When that works, I can make it so the scroll values are only added to when the character is past 192. When I'm sure that works, I can make it so a heavy enemy landing can shake the screen a little. If at any point something goes wrong, you'll know the newest thing is what's going wrong. (Well, sometimes something new creates a situation something old handles wrong that was never tested. But then... that usually means something old wasn't as well tested as it could have been before something new was added <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />)
<br />
<br />Doing this also really helps us, since we don't have to follow as much of the thread to help. 
<br />
<br />Short version: I've done about as much as I can with the info I've been given, and don't know what other info I could ask for that would help. I would rewrite it and check each <em>very small</em> part before moving on. I'm almost certain it will be faster than debugging what you've got, since I am rather stumped.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Thu Jul 26, 2012 7:53 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">Provided you've made all the changes I've talked about, and provided I haven't told you to make a change that was messed up (which is certainly possible), I've really found about all I can while just reading the code and I cannot debug for you any other way. Whenever I end up with a problem that I absolutely cannot solve, I just rewrite it.<br /><br />There are very few variables involved here. <br /><br />There are only two registers that should be affecting how to scroll the nametables when your screen is being rendered. $2005, and $2000. (Well, others can affect it, but not if you write to these last.) Break on writes to them, and find out what variables are stored there. Then find the code that updates those variables and find out why it's wrong. The fact that CameraX+1 is basically never touched makes it seem like you should be checking CameraX to see if it's doing something like switching between 0 and 255. (The only way I think that the nametables could be switching that quickly without CameraX+1's help).</div>
<br />
<br />So... I haven't rewritten my scrolling code because there is some other flashing of the nametables that happens if I press the A button 19 times in a row.  And so I spent some time a few days trying to find a solution so that the A button could be pressed an infinite number of times in a row and the flashing would never happen.  I kind of succeeded with this code  <div class="codetitle"><b>Code:</b></div><div class="codecontent">0C35C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;draw_sprite:<br />0C35C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <br />0C35C 85 FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; sta $ff<br />0C35E E0 13&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cpx #19 ;this will prevent the screen from flashing<br />0C360 10 0F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; bpl&nbsp; +<br />0C362&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; <br />0C362&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <br />0C362&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; <br />0C362&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; t0-t2 are temporary zero page locations holding<br />0C362&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; the address of a particular sprite layout and the<br />0C362&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; number of sprites left to draw<br />0C362 BD D9 D8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; lda sprite_layouts_lo, x&nbsp; ;&lt;-- ABSOLUTE INDEXED ADDRESSING<br />0C365 85 07&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; sta t0<br />0C367 BD ED D8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; lda sprite_layouts_hi, x&nbsp; ;&lt;-- ABSOLUTE INDEXED ADDRESSING<br />0C36A 85 08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; sta t0+1<br />0C36C BD 01 D9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; lda sprite_layouts_count, x&nbsp; ;&lt;-- ABSOLUTE INDEXED ADDRESSING<br />0C36F 85 09&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; sta t2<br />0C371 A0 00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;+ ldy #0<br />0C373&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; oamIndex is a variable tracking how far you've written<br />0C373&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; into shadow OAM &#40;customarily at $0200-$02FF&#41;<br />0C373 A6 0B&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ldx oamIndex<br />0C375&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;@loop:<br />0C375&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; If you have the address of an array in a zero page pointer,<br />0C375&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; you use the &#40;d&#41;,y addressing mode and increase Y to go<br />0C375&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; to the next byte.<br />0C375 B1 07&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; lda &#40;t0&#41;, y&nbsp; ;&lt;-- INDIRECT INDEXED ADDRESSING<br />0C377 C8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; iny<br />0C378&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ;ect. start<br />0C378 18&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; clc<br />0C379 65 05&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; adc oY<br />0C37B 9D 00 02&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sta sprite, x&nbsp; ;&lt;-- ABSOLUTE INDEXED ADDRESSING</div><br /><br />Up there at the top I added to the code two lines<br />1)<span style="color: red">cpx  #19</span><br />2)<span style="color: orange">bpl +</span><br /><br />Here's the place where the x is assigned right before jsring to... draw_sprite (^above).<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0C347&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0C347 A6 0F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;ldx aFrame<br />0C349 20 5C C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;jsr draw_sprite<br />0C34C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br /></div>
<br />I was concerned that the X value could be more than #19... then the flashing would start I thought...  but after having the <span style="color: red">red</span> and <span style="color: orange">orange</span> line in place the flashing starts on the #19th press of the A button... and that flashing continues until B is pressed (the B button resets aFrame back down to 0).
<br />
<br />edit: and by 'flashing' I mean the top of nametable 1 starts flashing on and off the lower part of the screen.  And ok... I am going to rewrite scrollland.  Maybe start tomorrow. good night yall.
<br />Many thanks to Kasumi!!!! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>44</strong> of <strong>83</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>