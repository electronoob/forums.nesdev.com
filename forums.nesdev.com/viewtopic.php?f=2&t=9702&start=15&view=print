<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Thinking clearly about collision detection</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Thinking clearly about collision detection</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=9702">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=9702</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>2</strong> of <strong>3</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Denine</b> [ Tue Jan 15, 2013 11:34 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent"><a href="http://www.mariowiki.com/File:How2Get-1.gif" class="postlink"><img src="http://www.mariowiki.com/images/0/05/How2Get-1.gif" alt="Image" /><br />MarioWiki.com</a><br /><br />This glitch is caused by the collision detection routine not seeing that the lower left corner of Mario is within air when Mario comes out of the crouch.</div><br />Ok, but individual 16x16 (pixel) boxes(such a coin block) can do the thing I have in mind, too<br />In <a href="http://youtu.be/FgDqwa_pzmg?t=2m10s" class="postlink">this video</a> the guy uses the fact that coin block box pushes the player to the left to bring mario closer to the right part of the screen.<br />Which shape(0-F) is the one that makes this trick possible? Guess it's....01?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Brickman</b> [ Tue Jan 15, 2013 11:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Interesting article on MCKid's development with a section on sloped collision:<br /><!-- m --><a class="postlink" href="http://games.greggman.com/game/programming_m_c__kids/">http://games.greggman.com/game/programming_m_c__kids/</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Tue Jan 15, 2013 12:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I have actually set a size/speed limit in my game as a work around. Objects which can collide with one another must not be smaller than the number of pixels they will move per frame (actually, half of that, I believe). Typically, I don't have objects smaller than 8x8 pixels, and I don't have anything moving close to 8 pixels per frame (or even 4, for that matter). </div><br />Hehe, it sounds like it would be &quot;collision alasing&quot;.<br />But the problem is that if you want for example an enemy to move 3 pixels in a direction, and that there is a collision, does it means the enemy can't move ? Of course not, because the enemy could possibly move 1 or 2 pixels in the same direction, and if this is possible, you definitely want it to do that.<br />Because of this, I think the simplest way is to do it one pixel at a time. Of course it's lazy and inefficient, but my game is not a shooter that will requires lots of fast moving bullets at the same time so I don't care.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Rotating levels aren't any harder provided the object and camera positions are stored in &quot;world space&quot;, relative to the origin of the map.</div><br />Now that you mention it this is right, you only have to rotate the gravity, and the display. However I still think it is complex to do, and I still show much respect for programmers of SCV4 in this regard.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Tue Jan 15, 2013 1:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Super Ghouls 'n Ghosts also has a rotating level... Just the other day I was wondering how I would handle a situation like that.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Denine</b> [ Tue Jan 15, 2013 1:38 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">Super Ghouls 'n Ghosts also has a rotating level... Just the other day I was wondering how I would handle a situation like that.</div><br />You mean handling collisions in a rotating level? I beat the game and I can only remember <a href="http://youtu.be/WNmq1MJ0R2o?t=32s" class="postlink">rotating in Level 4</a>, but it immobilizes the player, so no collisions check are actually needed...<br />As for me-I would never be able to calculate collisions for rotating level...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Wed Jan 16, 2013 11:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I have actually set a size/speed limit in my game as a work around. Objects which can collide with one another must not be smaller than the number of pixels they will move per frame (actually, half of that, I believe). Typically, I don't have objects smaller than 8x8 pixels, and I don't have anything moving close to 8 pixels per frame (or even 4, for that matter). </div><br />Hehe, it sounds like it would be &quot;collision alasing&quot;.<br />But the problem is that if you want for example an enemy to move 3 pixels in a direction, and that there is a collision, does it means the enemy can't move ? Of course not, because the enemy could possibly move 1 or 2 pixels in the same direction, and if this is possible, you definitely want it to do that.<br />Because of this, I think the simplest way is to do it one pixel at a time. Of course it's lazy and inefficient, but my game is not a shooter that will requires lots of fast moving bullets at the same time so I don't care.</div><br /><br />Well, if we're talking object to BG collision, there is a displacement routine that checks how far the bounding box is sticking into the solid wall, and moves them in the opposite direction that many pixels. Depending on the scenario, it might certainly be easier to just not allow them in, in the first place. This can be done by moving them one pixel at a time, like you were saying.<br /><br />And since my game is a platformer, with upwards of 8 enemies + projectiles on the screen at one time, it can be tricky to manage time, so moving one pixel at a time wouldn't work. But for a static screen game, it would definitely be easier. And there comes a point where if the engine doesn't require increased efficiency, it's ok to be lazy <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />.<br /><br /><div class="quotetitle">Denine wrote:</div><div class="quotecontent"><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">Super Ghouls 'n Ghosts also has a rotating level... Just the other day I was wondering how I would handle a situation like that.</div><br />You mean handling collisions in a rotating level? I beat the game and I can only remember <a href="http://youtu.be/WNmq1MJ0R2o?t=32s" class="postlink">rotating in Level 4</a>, but it immobilizes the player, so no collisions check are actually needed...<br />As for me-I would never be able to calculate collisions for rotating level...</div><br /><br />It might actually be easier to see the objects as being rotated in relation to the level. Then again, I've never done collision detection for an object with a rotated bounding box. You might also use a square bounding box that just changes dimensions as the objects rotate, to more appropriately accommodate the object it houses.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Wed Jan 16, 2013 12:01 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Denine wrote:</div><div class="quotecontent">You mean handling collisions in a rotating level? I beat the game and I can only remember <a href="http://youtu.be/WNmq1MJ0R2o?t=32s" class="postlink">rotating in Level 4</a>, but it immobilizes the player, so no collisions check are actually needed...<br />As for me-I would never be able to calculate collisions for rotating level...</div><br />Pardon me but it sounds like this should have been a joke to code. The hero is immobilized during the rotation, and the rotation only do it 90Â° at once.<br /><br />Look what a real rotating level looks like :<br /><a href="http://www.youtube.com/watch?v=EAkSpq0FZJE" class="postlink">http://www.youtube.com/watch?v=EAkSpq0FZJE</a> at 1:35<br />Then at 3:25 you have 2 layers.<br /><br />and here too :<br /><a href="http://www.youtube.com/watch?v=jkKDPFUUDHU" class="postlink">http://www.youtube.com/watch?v=jkKDPFUUDHU</a> at 1:05<br /><br />Now THIS should have been hard to code.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Wed Jan 16, 2013 12:35 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent"><a href="http://www.youtube.com/watch?v=EAkSpq0FZJE" class="postlink">http://www.youtube.com/watch?v=EAkSpq0FZJE</a></div><br />How is this different from what Super Ghouls 'n Ghosts does? Can you release that switch before the level snaps to a multiple of 90 degrees?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Then at 3:25 you have 2 layers.</div><br />I don't see anything rotating at 3:25 besides the funky tunnel background.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><a href="http://www.youtube.com/watch?v=jkKDPFUUDHU" class="postlink">http://www.youtube.com/watch?v=jkKDPFUUDHU</a> at 1:05</div><br />Doesn't seem so hard... there are no walls to collide with, the slope doesn't cause the player to slide down, and the movement is jerky as hell.<br /><br />For a second I though you were going to point me to a level that worked at odd angles, filled with objects moving around and properly colliding with slopes and walls. That would've been impressive. I really don't see how this stuff in Super Castlevania 4 is way more advanced than what Super Ghouls 'n Ghosts has.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Wed Jan 16, 2013 12:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">How is this different from what Super Ghouls 'n Ghosts does? Can you release that switch before the level snaps to a multiple of 90 degrees?</div><br />Yes you can. And the collision detection is not only with walls, but also with spikes. It's true there is no enemies DURING the rotation, but come on. This is still very impressive.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I don't see anything rotating at 3:25 besides the funky tunnel background.</div><br />Nothing rotating but pehaps if you wait until 3:30 then you will see 2 independents backgrounds, which should have been hard to code for collision detection. You can also die by being crushed between both backgrounds.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>MottZilla</b> [ Wed Jan 16, 2013 12:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The rotating of the level in Super CV4 has very limited collision going on while the level actually rotates. There is the ground plane that you need to escape by whipping the hold. It gradually slopes and I believe eventually you'll slide off and die. Then it rotates once more where again you'll slide off the small platform and fall to your death if you don't whip the hold. There isn't a whole lot going on. I'm not sure how difficult it would be to program something to handle this. You may not need to involve the background map array at all, you could simulate these things were game objects that you don't actually see as sprites. The big swinging things in the later level are just some kind of game object platforms that behave in that swinging pattern probably. <br /><br />So I'd agree that neither game does anything completely amazing with scaling while actually navigating a level. It's just a visual effect but in practice probably only the minimal amount of effort to compute whatever needs to be done. I think you'd need a coprocessor to calculate everything if the whole level was rotating without some sort of tricks. But then again those tricks are part of the fun of figuring out how to do such effects.<br /><br />The two backgrounds at the 3:30 mark, the scrolling up part actually might be sprites. The SNES has enough sprites per line to do that. All the pieces moving up could be game objects that it tests collision with.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Jan 16, 2013 5:09 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The part with two background layers was done in some of the castles in Super Mario World. What you need to do for levels like these is run collision against both layers, then make sure the push vectors returned by the algorithm don't point in opposite angles.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Wed Jan 16, 2013 8:37 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">Yes you can.</div><br />I'm curious to see what that looks like... is there a video?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">2 independents backgrounds, which should have been hard to code for collision detection.</div><br />My initial though was to just check for collisions against both planes and react as normal. Crushing happens when one layer ejects you into the other.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sik</b> [ Wed Jan 16, 2013 9:40 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">How is this different from what Super Ghouls 'n Ghosts does? Can you release that switch before the level snaps to a multiple of 90 degrees?</div><br />At 2:17 the level starts rotating while the player is still on the floor, giving away that the game has at least to be able to handle such stuff.<br /><br /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">My initial though was to just check for collisions against both planes and react as normal. Crushing happens when one layer ejects you into the other.</div><br />I believe this is exactly what happens in Sonic &amp; Knuckles in Sky Sanctuary (except for the crushing part as maps can't crush you, only objects - that's why there are some invisible solid objects in some areas).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Thu Jan 17, 2013 11:04 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Sik wrote:</div><div class="quotecontent"><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">How is this different from what Super Ghouls 'n Ghosts does? Can you release that switch before the level snaps to a multiple of 90 degrees?</div><br />At 2:17 the level starts rotating while the player is still on the floor, giving away that the game has at least to be able to handle such stuff.</div><br /><br />Another thing that must be tricky is factoring in gravitational effects. If you're standing on the platform as the level rotates, do you end up sliding off? Or do you stay on it until it is completely rotated 90 degrees?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Thu Jan 17, 2013 2:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Thinking clearly about collision detection</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I'm curious to see what that looks like... is there a video?</div><br />I don't know but honnestly you should just play the game. It's one of the best on the console, and I'm not the only one who is in this opinion. And it's really quite easy, especially at the beginning, so you shouldn't have trouble passing the first 3 levels if you are a platformer veteran.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>2</strong> of <strong>3</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>