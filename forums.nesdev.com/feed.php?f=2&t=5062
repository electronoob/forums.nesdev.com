<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=2&amp;t=5062" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2010-08-19T20:11:41-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=2&amp;t=5062</id>
<entry>
<author><name><![CDATA[comegordas]]></name></author>
<updated>2010-08-19T20:11:41-07:00</updated>
<published>2010-08-19T20:11:41-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=66317#p66317</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=66317#p66317"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=66317#p66317"><![CDATA[
thanks a lot Disch. hat's off. it's a great doc this one you whipped up.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4531">comegordas</a> — Thu Aug 19, 2010 8:11 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WJYkK]]></name></author>
<updated>2010-03-14T16:51:37-07:00</updated>
<published>2010-03-14T16:51:37-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58269#p58269</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58269#p58269"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58269#p58269"><![CDATA[
Oh, it works, except you have to download <a href="http://nesdevhandbook.googlepages.com/theframe.html" class="postlink">http://nesdevhandbook.googlepages.com/theframe.html</a> (AKA chapter 1 AKA the only chapter).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4164">WJYkK</a> — Sun Mar 14, 2010 4:51 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Disch]]></name></author>
<updated>2010-03-14T11:13:22-07:00</updated>
<published>2010-03-14T11:13:22-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58226#p58226</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58226#p58226"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58226#p58226"><![CDATA[
Well I didn't mean for nesdev stuff, I meant for general filesharing.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=33">Disch</a> — Sun Mar 14, 2010 11:13 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2010-03-14T10:16:09-07:00</updated>
<published>2010-03-14T10:16:09-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58215#p58215</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58215#p58215"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58215#p58215"><![CDATA[
<div class="quotetitle">Disch wrote:</div><div class="quotecontent"><br />I don't have any free webhosting these days =(<br /></div><br />wiki.nesdev.com<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Sun Mar 14, 2010 10:16 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Disch]]></name></author>
<updated>2010-03-14T10:13:32-07:00</updated>
<published>2010-03-14T10:13:32-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58214#p58214</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58214#p58214"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58214#p58214"><![CDATA[
Yeah apparently googlepages doesn't work anymore.  Talk about lame.<br /><br />I don't have any free webhosting these days =(<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=33">Disch</a> — Sun Mar 14, 2010 10:13 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[No Carrier]]></name></author>
<updated>2010-03-14T10:09:38-07:00</updated>
<published>2010-03-14T10:09:38-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58212#p58212</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58212#p58212"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58212#p58212"><![CDATA[
<div class="quotetitle">Disch wrote:</div><div class="quotecontent"><br />http://nesdevhandbook.googlepages.com/index.html<br /><br />It's a start!  We'll see how much I can actually get done before getting bored and moving on.  XD<br /></div><br /><br />Since this thread was brought back from the dead, I'll mention that this link isn't working. You can get to the index, but subpage links are dead.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=265">No Carrier</a> — Sun Mar 14, 2010 10:09 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ehguacho]]></name></author>
<updated>2010-03-11T20:03:07-07:00</updated>
<published>2010-03-11T20:03:07-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58022#p58022</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58022#p58022"/>
<title type="html"><![CDATA[Re: Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=58022#p58022"><![CDATA[
<div class="quotetitle">Disch wrote:</div><div class="quotecontent"><br />...I was bored and needed a break from my other project...<br /></div><br />thanks mate! (a.k.a. "you should get bored more frequently") <img src="http://forums.nesdev.com/images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4281">ehguacho</a> — Thu Mar 11, 2010 8:03 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Jarhmander]]></name></author>
<updated>2009-04-20T09:35:00-07:00</updated>
<published>2009-04-20T09:35:00-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45990#p45990</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45990#p45990"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45990#p45990"><![CDATA[
<div class="quotetitle">Drag wrote:</div><div class="quotecontent"><br /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent"><div class="quotetitle">frantik wrote:</div><div class="quotecontent">here is a buffer read routine i came up with based on a simplified version of SMB's routine..<br /></div><br />The only problem with your code is that it's quite slow... INY, DEX and BNE for every copied byte is terribly inneficient. Unfortunately I don't have a better suggestion that doesn't require much more ROM.<br /><br />If there's more ROM available, I can always recommend my <a href="http://nesdev.com/bbs/viewtopic.php?p=32622#32622" class="postlink">pseudo-DMA idea</a>. In my current project, I use a variation of it that is limited to 32 bytes at a time, so it doesn't need so much ROM.</div><br /><br />You could kinda compromise and do it both ways at the same time, like StarTropics II. <img src="http://forums.nesdev.com/images/smilies/icon_razz.gif" alt=":P" title="Razz" /><br /><br />Assume X is the loop count (the number of bytes remaining that we need to transfer).<br /><br />Basically, it has an unrolled loop of:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&lt;subtract 8 from X&gt;<br />LDA buffer,Y<br />STA $2007<br />LDA buffer+1,Y<br />STA $2007<br />...<br />LDA buffer+7,Y<br />STA $2007<br />&lt;add 8 to Y&gt;<br /></div><br /><br />plus the normal loop:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">LDA buffer,Y<br />STA $2007<br />INY<br />DEX<br />BNE -<br /></div><br /><br />The unrolled loop is the equivalent of a loop of 8, so what the program does is use the unrolled loop, copying 8 bytes each time, (subtracting 8 from the loop count each time), until the loop count is &lt; 8, in which it just uses the normal loop for the remaining bytes.<br /><br />So basically, if you need to transfer 5 bytes, it uses the normal loop with an X of 5.<br />If you need to transfer 8 bytes, it uses the unrolled loop once.<br />For 16 bytes, it uses the unrolled loop twice.<br />For 20 bytes, it's the unrolled loop twice, and the normal loop with an X of 4.<br /><br />It doesn't rely on huge unrolled loops, indirect jumps, tables, or anything of the sort, yet offers a better efficiency for transfers that are &gt;= 8 bytes in length.</div><br /><br />This is exactly the Duff device! <a href="http://en.wikipedia.org/wiki/Duff%27s_device" class="postlink">http://en.wikipedia.org/wiki/Duff%27s_device</a><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=336">Jarhmander</a> — Mon Apr 20, 2009 9:35 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Disch]]></name></author>
<updated>2009-04-20T08:17:04-07:00</updated>
<published>2009-04-20T08:17:04-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45987#p45987</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45987#p45987"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45987#p45987"><![CDATA[
1)  Which is why you don't unconditionally read $2002 or set the scroll.  Note that I made both of those conditional in my latest version.<br /><br />2)  The music engine should do all of that anyway.  Starting a new track or playing a sound effect should equate to changing a single area of RAM.<br /><br />Only real concern I had that was unavoidable was for mappers which require serial writes to a register.  MMC3 style address/data regs can be guarded against easily enough:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">swapmmc3:<br />  lda #$81<br />  sta soft8000     ; nmi would then copy this to $8000 before exit<br />  sta $8000<br />  lda pagenumber<br />  sta somewhere  ; if this is necessary<br />  sta $8001<br /></div><br /><br />Howver MMC1 style serial writes are pretty much impossible to guard against, and so you'd need to disable NMIs around them<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=33">Disch</a> — Mon Apr 20, 2009 8:17 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Bregalad]]></name></author>
<updated>2009-04-20T03:42:09-07:00</updated>
<published>2009-04-20T03:42:09-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45978#p45978</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45978#p45978"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45978#p45978"><![CDATA[
Hey, just something about the doc...<br />Dish says it's good to never disable the NMI is good, but I can see two reasons to disable it :<br />- When redrawing something when the screen is turned off, if an NMI happens between two $2006 writes, the NMI will acknownledge the interrupt by reading $2002 and the result would be very bad (this has actually happened to me once).<br />- When starting a sound effect/a new piece of music if the music engine is called while the sound effect/music is initiated, BAD things could happen.<br /><br />Unless you programm the NMI to not even acknownledge the interrupt depending on the state of the main engine, and because that NMIs on the 6502 are edge based and not state based, I guess it would be a workarround to issue 1, algouth it's not really "clean".<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> — Mon Apr 20, 2009 3:42 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[frantik]]></name></author>
<updated>2009-04-20T03:08:42-07:00</updated>
<published>2009-04-20T03:08:42-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45976#p45976</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45976#p45976"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45976#p45976"><![CDATA[
^ hey i like that idea <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3841">frantik</a> — Mon Apr 20, 2009 3:08 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Drag]]></name></author>
<updated>2009-04-20T00:22:01-07:00</updated>
<published>2009-04-20T00:22:01-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45974#p45974</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45974#p45974"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45974#p45974"><![CDATA[
<div class="quotetitle">tokumaru wrote:</div><div class="quotecontent"><br /><div class="quotetitle">frantik wrote:</div><div class="quotecontent">here is a buffer read routine i came up with based on a simplified version of SMB's routine..<br /></div><br />The only problem with your code is that it's quite slow... INY, DEX and BNE for every copied byte is terribly inneficient. Unfortunately I don't have a better suggestion that doesn't require much more ROM.<br /><br />If there's more ROM available, I can always recommend my <a href="http://nesdev.com/bbs/viewtopic.php?p=32622#32622" class="postlink">pseudo-DMA idea</a>. In my current project, I use a variation of it that is limited to 32 bytes at a time, so it doesn't need so much ROM.</div><br /><br />You could kinda compromise and do it both ways at the same time, like StarTropics II. <img src="http://forums.nesdev.com/images/smilies/icon_razz.gif" alt=":P" title="Razz" /><br /><br />Assume X is the loop count (the number of bytes remaining that we need to transfer).<br /><br />Basically, it has an unrolled loop of:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&lt;subtract 8 from X&gt;<br />LDA buffer,Y<br />STA $2007<br />LDA buffer+1,Y<br />STA $2007<br />...<br />LDA buffer+7,Y<br />STA $2007<br />&lt;add 8 to Y&gt;<br /></div><br /><br />plus the normal loop:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">LDA buffer,Y<br />STA $2007<br />INY<br />DEX<br />BNE -<br /></div><br /><br />The unrolled loop is the equivalent of a loop of 8, so what the program does is use the unrolled loop, copying 8 bytes each time, (subtracting 8 from the loop count each time), until the loop count is &lt; 8, in which it just uses the normal loop for the remaining bytes.<br /><br />So basically, if you need to transfer 5 bytes, it uses the normal loop with an X of 5.<br />If you need to transfer 8 bytes, it uses the unrolled loop once.<br />For 16 bytes, it uses the unrolled loop twice.<br />For 20 bytes, it's the unrolled loop twice, and the normal loop with an X of 4.<br /><br />It doesn't rely on huge unrolled loops, indirect jumps, tables, or anything of the sort, yet offers a better efficiency for transfers that are &gt;= 8 bytes in length.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=21">Drag</a> — Mon Apr 20, 2009 12:22 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[No Carrier]]></name></author>
<updated>2009-04-19T09:03:50-07:00</updated>
<published>2009-04-19T09:03:50-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45946#p45946</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45946#p45946"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45946#p45946"><![CDATA[
Great stuff, Disch! Thanks!<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=265">No Carrier</a> — Sun Apr 19, 2009 9:03 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[frantik]]></name></author>
<updated>2009-04-18T01:33:51-07:00</updated>
<published>2009-04-18T01:33:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45886#p45886</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45886#p45886"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45886#p45886"><![CDATA[
i have to admit i'm having a hard time understanding all of your code... but thats ok for now.<br /><br />with the code snippet I posted, I can see a way to output null terminated strings which would save a dex operation each byte... but then you can't use the 00 tile for anything<br /><br />edit:  actutally i improved my code so that if the first byte is positive, it writes that byte and the following byte to PPUADDR.  If the first byte is negative, it uses that value as the length of the string to write.   this will make it much easier to make locate and print commands, and also saves a byte in the buffer when appending strings<br /><br />edit2: eh.. having to deal with string lengths for everything is a pain.. worth it to have 00 be a null character to save time in a lot of places <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3841">frantik</a> — Sat Apr 18, 2009 1:33 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tokumaru]]></name></author>
<updated>2009-04-18T01:06:12-07:00</updated>
<published>2009-04-18T01:06:12-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45883#p45883</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45883#p45883"/>
<title type="html"><![CDATA[Drawing, Vblank, and NMI - A doc I whipped up]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5062&amp;p=45883#p45883"><![CDATA[
<div class="quotetitle">frantik wrote:</div><div class="quotecontent"><br />yeah I suppose if you know how long your buffer will be each time, an unrolled loop would be faster.<br /></div><br />If you pay attention to my code you'll see that the cool thing about it is that it's actually an unrolled loop that copies a variable amount of bytes. Just the total amount of bytes is limited to 128, but you can read variable amounts of data from those 128.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=95">tokumaru</a> — Sat Apr 18, 2009 1:06 am</p><hr />
]]></content>
</entry>
</feed>