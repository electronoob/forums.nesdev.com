<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - External USB Drive Interrupted When Trying to Format</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">External USB Drive Interrupted When Trying to Format</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=5&amp;t=17204">http://forums.nesdev.com/viewtopic.php?f=5&amp;t=17204</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jedi QuestMaster</b> [ Thu Mar 29, 2018 6:14 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yesterday I plugged in my 2TB external HD into my laptop's USB 2.0 port only for it to hang and keep giving me the &quot;This Device can perform faster&quot; message. It completely lagged my computer to a halt. So I decided to do a full format. I made sure the power settings would always give power to the USB ports. But eventually my USB drive would get interrupted (lose power?)<br /><br />I read it could take 26 hours to do a full format on a 2TB drive. So I gave up and did a quick format.<br /><br />What do you suggest? This drive is for completely backing up my files, which sometimes gets interrupted while doing so.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Thu Mar 29, 2018 8:21 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Get a better external enclosure.  Some of them just suck, and should not be used at all.  I've made the mistake of just buying the cheapest one.<br />And if the external hard drive does not have a reliable connection, you need to force Windows to NEVER try to defrag the drive, otherwise you can lose everything during a botched defrag.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Thu Mar 29, 2018 9:02 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Dwedit's advice is correct -- nagging Customer Support of the product for help, or buying a different product is really all you can do.<br /><br />There are still many problems with XHCI (USB 3.0) and EHCI (USB 2.0) compatibility between mainboard chipsets and device chipsets, causing a slower negotiated protocol to be chosen (ex. EHCI instead of XHCI, or OHCI/UHCI (USB 1.1/1.0) instead of EHCI).  I have several PNY USB 3.0 flash drives which cause the same message, despite their USB descriptor data clearly showing they support SuperSpeed (USB 3.0).  Other USB 3.0 flash drives (and MHDDs for that matter) work just fine.  I even have a couple USB 3.0 devices which, if plugged into a USB 3.0 port, don't show up on the bus at all -- voltage and current get applied but that's it.  Same devices work fine on a USB 2.0/1.1/1.0 port.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Mar 29, 2018 9:20 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />When you went through support for a USB peripheral you purchased, did the PC maker and the peripheral maker end up pointing fingers at each other?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Thu Mar 29, 2018 1:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Good idea, use a usb 2.0 hub to prevent the usb 3.0 nonsense that all the cheap adapters fail it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jedi QuestMaster</b> [ Thu Mar 29, 2018 4:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">When you went through support for a USB peripheral you purchased, did the PC maker and the peripheral maker end up pointing fingers at each other?</div><br />Was this directed at me? I never contacted any customer support. I feel like I'll get connected to some poor schmuck who has no idea what he's talking about.<br /><br />Okay, what do you all use? Mine's a WD Elements. I admit, it was a good <em>price</em> compared to others. I'll bust out my old HP Personal Media Drive (but it's only 500GB). This one's a much bigger enclosure and requires external power, which brings me to my next question:<br /><br />Are drives that require external power more secure? I would assume so because if it keep disconnecting and the USB is its power source I'd imagine it's more likely to get corrupted.<br /><br />By the way, just found out it's called a <em>portable</em> hard drive if it's USB-powered, and that it's <em>external</em> hard drive if it requires external power. <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" /><br /><br />Edit: &quot;USB Device Not Recognized&quot;  <img src="./images/smilies/icon_sad.gif" alt=":(" title="Sad" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Thu Mar 29, 2018 5:31 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Jedi QuestMaster wrote:</div><div class="quotecontent">Okay, what do you all use? Mine's a WD Elements. I admit, it was a good <em>price</em> compared to others.</div><br />I've had generally good success with WD Passport drives, <span style="text-decoration: underline">specifically</span> the 1TB models, using the included/provided USB 3.0 cable (which is quite short, and for a damn good reason -- longer cable tends to result in less current, which means the drive may have problems spinning up or operating).  These drives also support proper SMART passthrough via SAT, which means you can do analysis of them similar to a SATA-connected hard disk without too much trouble.  It's convenient for folks like myself.  Not all SATA/USB bridge chipsets support this (in fact, many of them don't, others do so badly (semi-implemented), and others have been known to botch/corrupt CDB payload).<br /><br />Additional reasons I like these drives: small, lightweight, contain a single platter (thus one pair of heads; read: fewer moving parts), are generally quiet and run tolerably cool, and finally, get really good throughput.  They even implement SES, if you care about that sort of thing.  I use mine as a workstation backup drive.<br /><br />The reason I dislike these drives: they're native USB 3.0 -- there is no native SATA interface inside of the drive (there are some solder points which you can supposedly use to wire this up, but you have to de-solder some other traces to some chips and other nonsense), and are <a href="https://en.wikipedia.org/wiki/Hardware-based_full_disk_encryption" class="postlink">SED</a> (i.e. use proprietary hardware-based AES encryption), which means data recovery on them is extremely difficult.  For some, the latter is a pro, for others it's a con.  And yes, before some sperglord mentions it, I'm quite familiar <a href="https://eprint.iacr.org/2015/1002.pdf" class="postlink">with this paper</a>.<br /><br />Off-topic: I did data recovery for a friend of GideonZhi's who had two different 2TB WD Passport drives -- one black/ultra, one silver -- and was able to recover all of his data on the silver but not the black.  I semi-documented what all I did to achieve the recovery on the latter, and even did a little Twitch stream for it (which is where I figured out a workaround allowing me to fix the problem the drive was encountering).  Had I not found that workaround + had some people on the <a href="http://www.hddoracle.com/viewtopic.php?f=3&amp;t=1463" class="postlink">HDDOracle forum</a> and <a href="https://forum.hddguru.com/viewtopic.php?f=1&amp;t=32501" class="postlink">HDDGuru forum</a> informing me of the mod32 patch, I wouldn't have been able to fix it.  BTW: the HDDGuru forum is filled with actual data recovery professionals who intentionally try and sabotage independent recovery efforts (because it &quot;infringes&quot; on their business/impacts their ability to make money), so you will find in that thread people saying disparaging junk.  HDDOracle was created by technically-competent recovery folks who enjoy helping, and who also keep the jerks away.<br /><br />If you're using a USB/SATA enclosure of your choice + SATA MHDD of your choice, rule out MHDD problems by taking it out + hooking it up to a PC via native SATA.  I've had very limited success with USB/SATA enclosures, but the few I've had success with I hold dear to me -- and all of them are enclosures which are USB 2.0 + companies have since gone out of business.  There's one present-day exception though: I'm particularly fond of enclosures using ASMedia 1053E or 1153E chips (these don't use encryption and support proper SAT and SMART passthrough), such as those in the <a href="https://plugable.com/products/usb3-sata-uasp1/" class="postlink">Plugable USB3-SATA-UASP1 dock</a> -- note that Plugable seems to understand the importance of this, and in turn even lets you <a href="https://plugable.com/drivers/hddockfirmware/" class="postlink">download alternate firmwares</a> that have chipset-level features like auto-spindown removed entirely.  Most enclosure vendors are just shipping repacked/rebadged Chinese junk with whatever chipset was available for cheapest on the market that day -- bleh.<br /><br />I think Tepples (?) has asked me in the past for some kind of &quot;authoritative list&quot; of what enclosures are good.  Yeah, not going to happen, for the reason I just mentioned.  Literally impossible to track reliably.  Plugable's USB3-SATA-UASP1 is the only product I've bought over the years (on multiple occasions) and got the same quality of product, though you can see even they changed chipsets at one point (from 1053E to 1153E).<br /><br /><div class="quotetitle">Jedi QuestMaster wrote:</div><div class="quotecontent">Are drives that require external power more secure? I would assume so because if it keep disconnecting and the USB is its power source I'd imagine it's more likely to get corrupted.</div><br />More current (power) has nothing to do with security.  Did you mean &quot;more reliable&quot;?  The answer is: sort of.  You definitely don't want your HDD falling off the bus due to voltage ripple or (more common) variable current.  This is why you should always hook your USB HDDs up to a USB port on the back of the computer if at all possible (these are guaranteed high-power ports), otherwise use an AC-powered hub.  Or if the drive/enclosure offers a native AC power connection, use that.  I talk about low-power vs. high-power ports here: <!-- l --><a class="postlink-local" href="http://forums.nesdev.com/viewtopic.php?p=215531#p215531">viewtopic.php?p=215531#p215531</a><!-- l --><br /><br />I know -- front-panel USB connectors are convenient and you want to plug your stuff in there for that reason.  But more often than not they're low-power, or worse, &quot;almost high-power&quot; (they might provide enough to spin up, but heavy I/O might cause bus droppage).  I've seen all sorts of madness over the years.<br /><br /><div class="quotetitle">Jedi QuestMaster wrote:</div><div class="quotecontent">By the way, just found out it's called a <em>portable</em> hard drive if it's USB-powered, and that it's <em>external</em> hard drive if it requires external power. :?</div><br />The terms are interchangeable.  Whoever insisted upon that is pedantic in terminology and is focused on something that doesn't really matter.  Sounds almost like a &quot;gamer forum&quot; type of point/argument.  Ignore that nonsense.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Mar 29, 2018 7:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Jedi QuestMaster wrote:</div><div class="quotecontent"><div class="quotetitle">tepples wrote:</div><div class="quotecontent">When you went through support for a USB peripheral you purchased, did the PC maker and the peripheral maker end up pointing fingers at each other?</div><br />Was this directed at me? I never contacted any customer support.</div><br />That was toward koitsu's experience with support.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Thu Mar 29, 2018 9:11 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">That was toward koitsu's experience with support.</div><br />It's not an experience I've actually had myself because I don't call support lines for consumer-grade storage products.  That's because I'm also not like other people given my technical background and familiarity with storage.<br /><br />But I have called support/filed support tickets before with consumer product vendors and gotten *amazing* support, so I always recommend people do it.  Plus, if there's a ticket logged, usually that gets analysed later by management/analytics and &quot;Hey, a lot of people called us about our Turdmaster 6000-24T since we made that one change to it 3 months ago... maybe we should look into it&quot; conversations can/do happen.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jedi QuestMaster</b> [ Thu Mar 29, 2018 9:36 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">koitsu wrote:</div><div class="quotecontent">If you're using a USB/SATA enclosure of your choice + SATA MHDD of your choice, rule out MHDD problems by taking it out + hooking it up to a PC via native SATA. </div><br />I'll try that with my HP drive; if it still works. <img src="./images/smilies/icon_confused.gif" alt=":?" title="Confused" /><br /><br /><div class="quotetitle">koitsu wrote:</div><div class="quotecontent">More current (power) has nothing to do with security.  Did you mean &quot;more reliable&quot;?  The answer is: sort of.  You definitely don't want your HDD falling off the bus due to voltage ripple or (more common) variable current.</div><br />I think the term I meant was <em>safety.</em> Like <em>am I safer living in Southern California or Bangladesh... where natural disasters happen every year?</em> Is my data safer powered externally? Isn't prematurely disconnecting a USB-powered drive more prone to bad sectors than an AC-powered unit?<br /><br /><div class="quotetitle">koitsu wrote:</div><div class="quotecontent">I know -- front-panel USB connectors are convenient and you want to plug your stuff in there for that reason.</div><br />I only have side USB ports--two on the left, one on the right for my mouse. (this is a laptop) Are these not that good?<br /><br />Edit: By the way, I <em>do</em> have a SATA port. <img src="./images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Thu Mar 29, 2018 10:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Jedi QuestMaster wrote:</div><div class="quotecontent">I think the term I meant was <em>safety.</em> Like <em>am I safer living in Southern California or Bangladesh... where natural disasters happen every year?</em> Is my data safer powered externally? Isn't prematurely disconnecting a USB-powered drive more prone to bad sectors than an AC-powered unit?</div><br />To answer both questions directly: no, and no.<br /><br />Can I ask what is making you think there's a relationship between unreadable LBAs (&quot;bad sectors&quot;) and power/current source (AC vs. USB bus)?  Maybe there's something about general HDD technology I can clear up for you.<br /><br />One thing you <em>should</em> be doing universally, to guarantee filesystem integrity (has nothing to do with unreadable LBAs though) + all data cached by the kernel has been fully flushed to the USB HDD, is (speaking of Windows here -- Linux, FreeBSD, OS X, etc. all have some equivalent of this) use the systray icon that lets you &quot;Safely Eject&quot; the device.  Do not just pull the USB cord out of the port when done with the drive.  This has nothing to do with HDD technology (it applies to anything; SD cards, CF cards, SSDs, flash drives, whatever) but more to do with how filesystems and block devices work overall (there are always layers of caching involved, both in the OS in several ways/layers, as well as on the HDD itself).  If you fail to do this, you risk filesystem corruption and/or lost data.<br /><br />Edit: additional point I want to make: in general -- and I classify this under section &quot;being nice to your hardware&quot; -- I recommend doing &quot;Safely Eject&quot; and then waiting a full ~10 seconds to give the device a chance to fully shut down (think about device/drive firmware and what it's doing independent of the system OS).  I do this with MHDDs particularly, since it gives them time to spin down; my WD Passport drive actually slowly/steadily blinks its white I/O access LED when it's truly/safely ready to be unplugged.  But the same could apply to an SSD or flash drive, for example, if it hasn't completed writing all data in its cache (on the PCB) to the physical media; SSDs for example tend to retain power for several seconds even after they're physically unplugged (this is by design, BTW -- ask if you want details).  ATA and SCSI protocol actually has commands that are supposed to guarantee this (ATA = FLUSH CACHE and FLUSH CACHE EXT, SCSI = SYNCHRONIZE CACHE), and most OSes submit those commands to a device prior to indicating it can be removed, but believe it or not, some controllers (hardware RAID controllers are particularly bad about this) and devices themselves (e.g. device firmware) don't fully complete doing that for several seconds.  You can read about that here: <!-- m --><a class="postlink" href="https://en.wikipedia.org/wiki/Disk_buffer">https://en.wikipedia.org/wiki/Disk_buffer</a><!-- m --> .<br /><br />Another reason to let things &quot;settle&quot; for several seconds, particularly for MHDDs, is to give the spindle motor a chance to fully stop before physically transporting/moving the drive (this could cause &quot;bad sectors&quot; if the heads were to physically touch the platters).  By waiting several seconds, the actuator arm, thus drive heads, <em>should</em> already be placed in the landing zone so they won't hit the platters if the drive is jostled.  So especially with MHDDs: be patient!  With laptops, it's pretty amazing how often people toss them around while powered on, as well as immediately after being powered off (before the arm has a chance to be positioned over the LZ) (e.g. power down the system, screen goes blank, person immediately tosses laptop into a backpack -- an MHDD almost certainly has not fully stopped yet!).  G-shock sensors in 2.5&quot; MHDDs are incredibly sensitive for this exact reason.<br /><br /><div class="quotetitle">Jedi QuestMaster wrote:</div><div class="quotecontent">I only have side USB ports--two on the left, one on the right for my mouse. (this is a laptop) Are these not that good?</div><br />It depends on how the motherboard manufacturer/vendor decided to implement things.  It may be that one connector is high-power while the other is low-power.  99% of the time user manuals don't disclose this.  So how do you figure it out?<br /><br />Windows Device Manager can actually show you this when doing a Properties on some types of USB root hubs, showing you how much power draw there was via the device itself.  But it depends on USB drivers (i.e. chipset drivers) for example, it usually <a href="http://windowstipoftheday.blogspot.com/2010/11/windows-7-checking-usb-device-power.html" class="postlink">looks like this</a>, but on my current Windows 7 workstation with a Z270 Express chipset using Intel's own drivers, I do not get this tab (Power tab != Power Management tab).  Anyway, as you can see in the screenshot, &quot;Total power available&quot; would essentially answer your question (100mA = low power, 500mA = high power, and 900mA would be high power but USB 3.0).  You had to go digging around to get this info though (lots of clicking), rather than just in one convenient place...<br /><br />If the USB drivers don't provide this natively, then the only solution you have is to use <a href="https://www.nirsoft.net/utils/usb_devices_view.html" class="postlink">a third-party utility from NirSoft called USBDeview</a> which will disclose power draw amount in a column called &quot;Power&quot; (gotta scroll pretty far horizontally to find it, or toggle off a ton of columns like I did).  This addresses the above convenience &quot;issue&quot; too.  <strong><span style="text-decoration: underline">However, be sure to read the &quot;Known Issues&quot; section of that web page.</span></strong>  I've also read that some devices can draw more than they claim, which is somewhat true on some level, but it just depends on the device.  USB 3.0 high power devices are supposed to pull up to 900mA at maximum, though there are some chipset vendors who advertise being able to draw more than that (the spec, AFAIK, doesn't allow for it though).  Specification details (see chart): <!-- m --><a class="postlink" href="https://en.wikipedia.org/wiki/USB#Power">https://en.wikipedia.org/wiki/USB#Power</a><!-- m --><br /><br />Here is a screenshot demonstrating the different devices I have attached to my workstation on different USB ports, and using different USB protocol versions: <!-- m --><a class="postlink" href="https://imgur.com/a/4oWob">https://imgur.com/a/4oWob</a><!-- m --> -- I even attached my WD Passport 1TB drive to demonstrate (it's connected to a front-panel USB 3.0 port on my desktop -- it just so happens the front/top panel USB 3.0 ports are high power.  The USB 2.0/1.1/1.0 ports, however, probably aren't -- I have nothing attached to them right now).<br /><br />I should be clear about these values shown: they do not represent the &quot;active power draw&quot; (as in, some kind of dynamically changing value like you would expect for, say, temperature or voltage) -- they represent what has been negotiated per USB protocol at the time based on USB class and USB protocol standards.  There is an actual descriptor field in the USB protocol that refers to maximum power draw.  As you can see, some devices advertise 98mA (rather than 100mA) and so on.  My reaction to that (deviations of 2mA etc.): &quot;uh, okay, whatever&quot;.<br /><br />Laptops are also somewhat special because they may actually drop their maximum current capability down to something lower (500mA --&gt; 100mA) based on battery life, as well as if the laptop is actively powered via AC or not -- same goes for if it's attached to a dock, and if the dock is AC powered or not.  I really don't care to deal with laptops for this reason amongst a billion others.  Everyone's use cases + needs + environments + finances are different though.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jedi QuestMaster</b> [ Fri Mar 30, 2018 9:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Damn, this enclosure was not meant to be opened! Ever. <img src="./images/smilies/icon_mad.gif" alt=":x" title="Mad" /> <!-- m --><a class="postlink" href="https://www.ifixit.com/Answers/View/400286/How+to+open+the+HP+Drive+enclosure">https://www.ifixit.com/Answers/View/400 ... +enclosure</a><!-- m --><br /><br />Anyway, under Device Manager, I see 8 USB Root Hubs. Under Properties, they all say <strong>&quot;The hub is self-powered.&quot;</strong> <strong>&quot;Total power available: 500 mA per port&quot;</strong><br /><br />first one: USB composite device, 5 ports available<br />second: 2 ports available<br />third: 2 ports available<br />fourth: USB composite device, 1 port available<br />fifth: HID-compliant mouse 100mA, 1 port available<br />sixth: 2 ports available<br />seventh: 2 ports available<br />eighth: 6 ports available<br /><br />Besides the mouse taking up 100 milliamps, what does this all mean?<br /><br />Also, thanks for all the help!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Fri Mar 30, 2018 9:38 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It means they're all USB root devices that support up to 500mA of power draw (for USB 2.0/1.1/1.0).  So, if your USB MHDD when attached draws 500mA or thereabouts, then it should ideally work fine.  If the enclosure uses AC power (via an AC adapter), then use that, because it certainly provides more than 500mA and the drive may need &gt;500mA -- in this scenario, it doesn't matter what the current/power draw at the USB layer is because for the MHDD itself it's all being provided via the AC adapter.<br /><br />Regarding disassembling the enclosure: remember what I said about SEDs above.  I hope the enclosure doesn't use encryption, otherwise you won't be able to access any of the data on the drive.  If Windows at any time gives you a message like &quot;You need to format the disk in drive Z: before you can use it.  Format it?&quot;, OBVIOUSLY DO NOT.  SEDs are encrypted and thus direct I/O to the drive will return jibberish for all LBAs, so the OS has no way of knowing how to decrypt it, thus to it the partition table looks corrupted; there's little you can do about this (sadly forced to use the enclosure that it was in).  Sometimes you can buy another identical device/enclosure and put the disk into it and bam, you're good.  It has to be the same model and revision though!  Else if the SATA/USB bridge chip changed, then you risk losing all the data on the drive.  I can talk more about why this happens if asked -- it has to do with how SEDs work (the Wikipedia article goes into the details).<br /><br />I don't usually use Windows much for this type of troubleshooting, because the OS tends to issue all sorts of I/O to a drive upon attachment.  FreeBSD, Linux, etc. tend to not do this -- for ATA they tend to issue IDENTIFY to get details of the drive, then do what's called &quot;tasting&quot; (reading MBR and/or GPT; LBA 0 (MBR) or LBAs 0-34 (GPT primary) or the last 34 LBAs of the disk (GPT backup) for partition table data), but that's about it.  Windows on the other hand tries to do all sorts of madness including mounting filesystems and so on, so if there's an unreadable LBA -- especially one which causes the device to lock up/stall indefinitely, or maybe even tickle a firmware-level bug (similar to what I dealt with for GideonZhi's friend) -- then there's not much you can do about it.  This is why I tend to use non-Windows OSes for this type of work.<br /><br />But, if it **is** readable/usable via native SATA, and you can access data on it, then I can suggest issuing a SMART selective scan of all LBAs on the drive to see if they're all readable.  This is done by the drive firmware itself, not by the OS (the command is issued by the OS though), and progress monitoring/etc. varies per drive model.  I don't have much experience with HP drives.  If the selective scan fails, it'll abort and usually give an indicator in the SMART error log of what LBA failed to be read.  But there's no sense in me going into great lengths talking about data recovery this early.<br /><br />P.S. -- I didn't get an answer to my earlier question, so I'll repeat it: Can I ask what is making you think there's a relationship between unreadable LBAs (&quot;bad sectors&quot;) and power/current source (AC vs. USB bus)? Maybe there's something about general HDD technology I can clear up for you.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jedi QuestMaster</b> [ Fri Mar 30, 2018 10:28 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">koitsu wrote:</div><div class="quotecontent">P.S. -- I didn't get an answer to my earlier question, so I'll repeat it: Can I ask what is making you think there's a relationship between unreadable LBAs (&quot;bad sectors&quot;) and power/current source (AC vs. USB bus)? Maybe there's something about general HDD technology I can clear up for you.</div><br />Because you're so insistent:<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Causes of Soft Bad Sectors<br /><br />Soft bad sectors are caused by software issues. For example, if your computer suddenly shuts off due to a power outage or a pulled power cable, it’s possible that the hard drive may have shut off in the middle of writing to a sector. In some cases, it’s possible for sectors on the hard drive to contain data that doesn’t match their error-correction code — this would be marked as a bad sector. Viruses and other malware that messes with your computer could also cause such system issues and cause soft bad sectors to develop.</div><br /><!-- m --><a class="postlink" href="https://www.howtogeek.com/173463/bad-sectors-explained-why-hard-drives-get-bad-sectors-and-what-you-can-do-about-it/">https://www.howtogeek.com/173463/bad-se ... -about-it/</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Sat Mar 31, 2018 2:37 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: External USB Drive Interrupted When Trying to Format</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Jedi QuestMaster wrote:</div><div class="quotecontent">https://www.howtogeek.com/173463/bad-sectors-explained-why-hard-drives-get-bad-sectors-and-what-you-can-do-about-it/</div><br />Thanks!  Whoever wrote that is out of their mind; there is no such thing as a &quot;soft&quot; bad sector, and it certainly has no correlation to power loss.  They're using &quot;soft&quot; and &quot;hard&quot; terms because those actually come from memory (RAM), where there really are &quot;soft&quot; and &quot;hard&quot; errors (soft = temporary, where subsequent attempts work fine, i.e. a flaky bit; hard = permanent, where all attempts fail, i.e. reliably busted).  But based on their weird description, I think they're trying to describe what I call &quot;suspect&quot; LBAs/sectors.  I'll try to explain, with some background.<br /><br />The data contained in an actual sector (either 512 bytes or 4KBytes) -- which an LBA correlates with, just not always 1:1 due to remapping that can happen -- does contain ECC data alongside the raw data written.  The ECC implementations tend to be of varying algorithms (depends on vendor, drive age, blah blah), usually Hamming type or Solomon-Reed.  Going off of memory here, but there's something like 64 bytes of ECC used data per 512-byte sector, and 128 for 4K sectors.  Someone much smarter than me and more familiar with math can probably figure out the exact amounts, but again going off of memory, I think with 512-byte sectors ECC can correct up to something like 24 bits of data, and with 4K it can correct twice that amount.  Correlating ECC values are written at the same time as raw data.  I think there's a paper released by Toshiba somewhere with details; Google around a bit.<br /><br />Is it possible that one could end up writing only a portion of raw data and/or ECC, thus in effect, having a &quot;partially written&quot; sector?  Sure.  ECC is used on an LBA read operation (and there are some vendor-specific ATA commands that can actually do a read that bypasses the ECC region).  If the (effective) checksum calculation doesn't match what's in the ECC region, depending on the number of bit errors, the drive can auto-correct this.  I can't speak for all drives, but this is tracked in SMART attribute 1 (Raw_Read_Error_Rate).<br /><br />Is it possible there are too many errors thus ECC cannot correct it?  Again, sure.  However, in this case, the sector *is not* marked as &quot;bad&quot; -- in the fashion that you think -- but rather is marked (what I call) &quot;suspect&quot;.  Drive firmwares have all sorts of retry algorithms and heuristics to minimise this situation because what it ultimately means is data loss.  Once a sector is marked &quot;suspect&quot; the data there can't normally be obtained.  Anyway, the algorithms and heuristics vary TREMENDOUSLY across vendors, drive models, and firmware versions.  It's the most common variance point there is.<br /><br />Anyway, in this situation, the LBA that maps to that physical sector, when read, will return an I/O error.  These types of LBAs are tracked in SMART attribute 197 (Current_Pending_Sectors).  The drive will re-evaluate if the physical sector is usable (i.e. was this some sporadic error or is it reproducible?) <strong>when the LBA is <span style="text-decoration: underline">written</span> to</strong>.  I've heard rumours that some MHDDs actually do this in the background when the drive is idle for long periods of time, but I've never actually seen such in practise -- I've only seen it happen when the OS issues a write command to said LBA.  If the re-evaluation done during a write fails, the drive then marks that physical sector as bad (SMART attribute 5 and 196 get incremented), and the LBA is mapped to a spare sector from that point onward, and the drive writes the data there from then on.  If the re-evaluation done during a write is *successful*, the sector is marked usable -- i.e. no remapping happens -- and attribute 197 is decremented.<br /><br />SMART attribute 198 (Offline_Uncorrectable) is also sometimes involved in severe outcome situations like the above -- but for both reads and writes -- but this more commonly indicates an actual mechanical problem with the drive and not &quot;a problem with a sector&quot; per se.<br /><br />Also: there's also a lot of stuff that goes on under the hood too, such as some drives storing a kind of &quot;sector history&quot; in general-purpose log regions on the drive (space dedicated for these purposes is limited, but can vary from anywhere between 1 and 100 sectors or so).  This helps with analysis decisions by the firmware.  MHDD firmware today is *INSANELY* complicated -- sadly, long gone are the days of the &quot;do what the OS says and stay out of the way&quot; approach, instead vendors keep adding all this extra stuff.  Sometimes that stuff is great and increases reliability, other times the stuff is a huge problem and gets in the way of what should be a pretty obvious true bad sector situation.  Tricky ones are ones like what I dealt with, where a drive was functional for 6-7 seconds after powering on, but then went totally catatonic; all those brains in the firmware certainly can have or result in bugs, case in point.  :P<br /><br />BTW: don't confuse the above type of ECC with that used in RAM (i.e. cache) -- which some MHDDs and SSDs use (many do not however) -- or with some ECC algorithms used by certain manufacturers that allow for auto-detection and correction of certain kinds of data &quot;local&quot; to the drive (i.e. data written to the cache by the OS was fine, but when read from the cache to write to a physical sector, the data was corrupt -- this is usually the sign of bad cache/RAM on the MHDD itself).  One company that has historically done this is, believe it or not, HP -- at least in their &quot;enterprise&quot; drives, dunno about consumer stuff.  This is tracked in SMART attribute 184 (End-to-End_Error).  HP published a paper on it at one point -- they call it &quot;SMART IV&quot; (again, Google around to find the paper).<br /><br />So, there is no such thing as a &quot;soft bad sector&quot;.  Whoever wrote that article tried to explain the above probably without having familiarity with actual MHDD operation.  This type of crap has become commonplace on the Internet these days.  I <a href="https://koitsu.wordpress.com/2013/02/12/how-intels-ssd-toolbox-optimizer-trim-feature-works/" class="postlink">rant about it here</a> (bottom of page, &quot;An opinionated footnote&quot; -- the rest of the article has nothing to do with what we're discussing here).<br /><br />I swear, I've done write-ups like this one/this post so many times in my life that I feel like I'm a broken record.  What I can never get, however, is confirmation of behaviour from <em>actual MHDD engineers/vendors</em> -- nobody talks about this stuff because NDAs, intellectual property, blah blah blah.  Some of the people who know for sure work in the data recovery industry (and were previously employees at MHDD vendor companies).  It's really too bad, because there's a lot of bullshit information out there these days.  Sigh, &quot;enthusiasts&quot; and gamers... :/  So how do I know it?  Working with drives and ATA protocol for a while, combined with doing freelance/amateur data recovery (and no, I don't do hardware-level stuff, i.e. I don't work in clean rooms).<br /><br />smartmontools' Wiki page actually has a write-up on how some of this works in one fashion or another if you're interested.  Most of the information though comes from circa 2003-2005, so things today are more complicated.  However, the document quickly crosses into the filesystem arena, which is obviously relevant but makes understanding drive behaviour more complicated.  And remember: SCSI is *completely* different from ATA in several regards (especially bad sector management), everything above is in regards to ATA drives. <!-- m --><a class="postlink" href="https://www.smartmontools.org/wiki/BadBlockHowto">https://www.smartmontools.org/wiki/BadBlockHowto</a><!-- m -->

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>