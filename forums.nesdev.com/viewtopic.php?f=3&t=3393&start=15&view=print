<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - NTSC emulation test?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">NTSC emulation test?</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=3393">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=3393</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>2</strong> of <strong>4</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Sun Jun 03, 2007 6:43 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />What emu did you use to take that screenshot?
<br />Here what it looks like on RockNES anyways...
<br /><img src="http://www.myfilestash.com/userfiles/rot00_2/tv_0.png" alt="Image" />
<br />
<br />Bigger:
<br /><img src="http://www.myfilestash.com/userfiles/rot00_2/tv_1.png" alt="Image" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>blargg</b> [ Sun Jun 03, 2007 10:30 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The passing image was a video capture from my NTSC NES. The failing image was from my NES emulator in RGB mode.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jagasian</b> [ Sun Jun 03, 2007 10:30 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Can the test's bit pattern be tweaked to further obfuscate the "PASS!" message, when not displayed under NTSC?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Jun 03, 2007 12:59 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Jagasian wrote:</div><div class="quotecontent">Can the test's bit pattern be tweaked to further obfuscate the "PASS!" message, when not displayed under NTSC?</div>
<br />Not that I can think of right now.
<br />
<br />But pixel aspect ratio is another bugaboo of mine, and I've added a second screen to the <a href="http://pics.pineight.com/nes/tvpassfail.zip" class="postlink">test program</a>.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>blargg</b> [ Sun Jun 03, 2007 5:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Nifty update. People so often post about aspect ratio problems for various emulators, and then other people give wrong authoritative answers like "A TV's width is 4:3 the height, therefore pixels are rectangular with the same ratio", even though the width of a pixel depends on the particular console, etc. I'll have to adapt your code to the SNES (including your flashy anti-aliased font heh).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jagasian</b> [ Sun Jun 03, 2007 6:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent"><div class="quotetitle">Jagasian wrote:</div><div class="quotecontent">Can the test's bit pattern be tweaked to further obfuscate the "PASS!" message, when not displayed under NTSC?</div><br />Not that I can think of right now.<br /><br />But pixel aspect ratio is another bugaboo of mine, and I've added a second screen to the <a href="http://pics.pineight.com/nes/tvpassfail.zip" class="postlink">test program</a>.</div>
<br />
<br />I just tested Nestopia using your latest TV test ROM, and the 1:1 box is definitely not square, but the NTSC box is just a little bit too tall.  I actually measured with a ruler.  I am using Nestopia's "TV Aspect" setting.  Can anybody else confirm that Nestopia's aspect ratio is just slightly off, or is it user error on my part?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Jun 03, 2007 8:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Nestopia is probably within the tolerance for consumer TV sets, as all CRTs are calibrated slightly different.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>dvdmth</b> [ Sun Jun 03, 2007 8:31 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I just tested the Mac version of Nestopia.  In full-screen mode, with aspect ratio correction set to 4:3.  I took a full-screen screenshot (Command-Shift-3) and drew a diagonal line on the NTSC box from upper-left to lower-right.  The line hit at the bottom edge, not even close to the corner.  Even without drawing the line, I could tell that the box was wider than it was tall.
<br />
<br />I'll post this at the Nestopia message board.  The aspect ratio problem was brought up there before, and Richard Bannister claimed that the aspect ratio was correct.  So much for that claim.  When I first got Emulator Enhancer, I knew its aspect ratio correction was off, but I didn't have evidence to prove it.  Now there is proof.
<br />
<br />I can't verify the other test, though, because for some reason Nestopia is crashing every time I try to check the NTSC filter option (ugh!).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Jun 03, 2007 8:53 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Before you bug Richard Bannister, I'd like to have the second screen tested on NES hardware on a couple different TVs first.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>hap</b> [ Mon Jun 04, 2007 12:59 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Maybe Nestopia calculates the aspect ratio based on NTSC_OUT_WIDTH from blargg's NTSC library, which width is about 3% too wide in favour of optimisations.
<br />(it's what Sega Li does, with a bit too wide square as result)
<br />
<br />*edit* Anyway, nice test tepples, and I agree with:<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Nestopia is probably within the tolerance for consumer TV sets, as all CRTs are calibrated slightly different.</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>dvdmth</b> [ Mon Jun 04, 2007 6:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Before you bug Richard Bannister, I'd like to have the second screen tested on NES hardware on a couple different TVs first.</div>Even without the test ROM, I could tell (by comparing with two different TVs in my household) that the aspect ratio in Nestopia for Mac OS X was stretched too far horizontally (it was enough for me to notice within seconds after I got Emulator Enhancer, which is what adds the aspect ratio correction feature).
<br />
<br />That said, testing on real hardware will help validate the test as accurate (at least within a particular margin of error), so I am all for hardware testing.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>blargg</b> [ Mon Jun 04, 2007 10:03 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Jagasian: did you first measure with a ruler a square box drawn with a graphics program? That'd rule out your monitor itself not being calibrated for the PC's square pixels.
<br />
<br />hap: Using nes_ntsc, the NTSC box appears about 163x160 pixels; an emulator should display the output vertically doubled and horizontally unchanged, or some factor for both of those; the number of pixels in the image should have no part in aspect ratio handling.
<br />
<br />tepples: Below are some camera shots of a TV connected to an NTSC NES running your latest test. For the aspect ratio test, the boxes were 75 mm high, and 80 mm, 61mm, and 85 mm wide from left to right. I also did a test shot of a square object (not shown) to verify that my digital camera's pixels are square. Oh, and you might want to add an <a href="http://www.io.com/~greens/temp/epilepsy_warning.gif" class="postlink">epilepsy warning</a> for the NTSC test, as it flickered a bunch on the TV (probably due to the PPU alternating between two phases between frames, rather than your code slowly shifting the diagonal pattern).
<br />
<br /><img src="http://www.io.com/~greens/temp/tvpassfail2_ntsc.jpg" alt="Image" /> <img src="http://www.io.com/~greens/temp/tvpassfail2_aspect.jpg" alt="Image" />
<br />
<br />(the TV is less warped in the right shot because I moved farther away and zoomed in, exactly for this purpose)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>dvdmth</b> [ Mon Jun 04, 2007 10:22 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />OK, I took the TV image and compared it against the Nestopia screenshot, and the image from Nestopia is obviously wider.  If I draw a diagonal line on the NTSC box in the TV image, the line almost hits the corner exactly (it's only slightly to the left of the lower-right corner), but in Nestopia, the line is pretty distant from the corner.
<br />
<br />Again, this is the Mac port.  The Windows version of Nestopia may have different results.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Mon Jun 04, 2007 2:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Only Nestopia is the main point of this discussion? If another test pops, any error on Nestopia will be the main topic? <img src="./images/smilies/icon_neutral.gif" alt=":|" title="Neutral" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>blargg</b> [ Mon Jun 04, 2007 3:15 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Feel free to list any other emulators which fail either test, and one or more of us can bug the author to get it fixed. How does RockNES fare on the aspect ratio test?

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>2</strong> of <strong>4</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>