<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - 8 by 16 sprites</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">8 by 16 sprites</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=10&amp;t=621">http://forums.nesdev.com/viewtopic.php?f=10&amp;t=621</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>4</strong> of <strong>4</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Oct 08, 2005 2:43 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">blargg wrote:</div><div class="quotecontent">I can provide you with simple code that you can insert that will probably prevent your game from running on all emulators, but not on a real NES.</div>
<br />I use something like that but much simpler for detecting nesticle in some of my more recent projects. It just checks to make sure that a CPU$2002 read clears the vblank flag (four instructions), and then it throws up a "warning: compatibility not guaranteed; press start" screen if not.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Sat Oct 08, 2005 9:15 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Okay, this is kind of dumb, but I've always understood that branches in 6502 executed a jsr, am I right? Well, I don't think I'm right, because I have a routine that branches off, and excecutes an rts at the end of it, and it never returns from the subroutine! why?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Memblers</b> [ Sat Oct 08, 2005 9:40 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />No, there's no branch to subroutine.  RTS pulls the return address off the stack, that only works after a JSR or messing with the stack manually.
<br />
<br />A branch will simply continue running either at the next instruction, or the branch location.  So replace your RTS with a JMP to where you want it to go at that point.  Or if there's nothing else to skip after the branch, you can put your code after the branch and reverse the branch condition.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Sat Oct 08, 2005 10:59 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Okay, thanks. I always thought it was the other way, though. I am wondering if anyone knows of a good "getchar()" style function on 6502. And then I'm wondering if there's a way to do something like this:
<br />
<br />getvalue:
<br />      ch = getchar()
<br />
<br />background:
<br />      lda data
<br />      sta $2007
<br />
<br />data:
<br />       .db ch
<br />
<br />How would you first, store a number in a variable, and have that number displayed on screen? and how would you do a getchar() style thing, such as naming a character on an FF game? You know, it somehow takes the letters you select, and it stores them in a variable, then it takes that variable and puts it on screen. Do you know how?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sun Oct 09, 2005 1:03 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Note than with NESHLA, you normally don't have to bother with branches any longer, scince you have basic/C style loops.
<br />But, declaring variable and data bytes (.db) in NESHLA is damn hell ! I can't get this working as I like.
<br />To name your characters... Just make small buffers in RAM that will content a string with the letters of the name the player had choosen. You'll need to make several copies of the same buffer, once for each saved game (I think you sould not bother about saved games right now, so just have a single buffer for each character).
<br />When it's time to show it on the screen, just read it and write the output to $2007. It has to be filled with the letters the player had chossen on the name selection screen... it's up to you to programm an engine for that, but I think it isn't hard at all.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Sun Oct 09, 2005 11:36 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Okay, I need to read that guide to neshla, even though it kind of sucks. Can you even do a .db in neshla? or do you have to do like a "byte" thing? I don't know. I think you can do something like this:
<br />
<br />byte [$0,$0,$64,$02,$0...]
<br />
<br />in NESHLA to do that. I have been working on a demo in nesasm, and I was going to just convert it to NESHLA, but I realized that I don't know too much about NESHLA. I need to go learn more. It's really different...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sun Oct 09, 2005 12:09 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yeah, it is really different. I have been able to input data bytes in PRGROM bank section, but it needs 2 lablels and it rather sucks (or am I doing something wrong ?) There is an example in the gide to NESHLA, and yeah, that guide isn't too much complex and doesnt go in details, but it does the works, not like the guide of XOR-Cyst that is actually unundertandible, at least for me.
<br />I've also been able to inbin a file, but I've been unable to incbin a file and assign it to a label, a variable or anything. It just suck. I ask myself if it is really a good idea to want to use NESHLA... Maybe I should perseverate a bit.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Sun Oct 09, 2005 1:20 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The problem with NESHLA is it's way too confusing and stuff, and there's way too many macros! and I don't really know what I'm doing. You know, I wish that NESASM had more options, because I would really use it if it did. Right now I'm making a demo of the menu, and so far it's turning out really well, I have all the character's portraits there, and I have the hand moving up and down the thing just right, and it stops when it gets to the top, and it will only let you move one menu option down per press, which I think is good and unbuggy. And I took out the "order" option from the menu, because there was not enough space on the name table for it, and you will be able to just press left, and it will allow you to switch positions like it did on FF3. I don't think that's too bad. There is a little glitchybuggyunreliablemethod type thing I use, but it's hardly even noticable, and I think we'll be fine. There's a variable that's called mflag (materia flag) that will go up when a is pressed while the finger is over "materia", and it will start increasing the flag from that point, and since it increases at like 50000 miles an hour, as soon as you press a, it will already have gone from 0 to 3, and if you hold it too long, the hand will go to the first picture and since you're holding a, the flag is still increasing. And when the flag goes past a value of 6, it will load the materia screen. I made it so it will stop on 7 though. But, another problem comes with that. You could tap a when it's over materia really really fast, and select somone's portrait, and tap a again really fast, and it wouldn't load the materia screen because the value might not be 6 yet. You know? Well, I'm just rambling. But yeah I'm doing it in NESASM, and then I'm converting it to another assembler. What I really like about NESASM is that it's somewhat easy to use. Wla-dx is SO CONFUSING! I don't even know how to like assemble anything with it. It's documentation is like CRAP. NESHLA is way too hard to use. I like that NESASM allows an easy set up for an ines header and it's really just easy to use, and I appreciate that. I don't think it would be powerful enough for FFVII, so we're deciding on another assembler. Is there just an assembler that's like NESASM with more options?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sun Oct 09, 2005 2:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, WLA DX is not that confusing. It's not too well documented, however it's still decent. I think you have to spend a small amount of time to change your habbits. For example, locals labels are "_label" instead of ".label" that were in NesASM.
<br />You can split all you code in sections, section are a amount of bytes (of code or data) that are packed together in the final rom file, but section between them seems to be assembled in the alphabetical order of theese labels (I'm not sure, but it useless to know that).
<br />There is also ramsections for variables. I think that system is exellent, because you know exacly whitch piece of code/variables can be packed toghether with witch one, and you can force section to a specific adress as you like (vectors for rom sections, or SpriteDMA for ram sections), and you can let it choose where it will be in the bank, but force the bank number/ram slot, or eventually put if in any bank, where there is room.
<br />You can define your system architecture, where ROM slots are swapped in, and where you would define your different RAM slots. This enables you to define your system's architecture, scince the assembler is multi-system compatible. You can do library files, where you store bunch of code, and call it from various projects. Then, only used code will be compiled in the output.
<br />Eventually, WlaDX has more calculations and flexibility possible than NESAsm. If you have a feature request or a bug report, you can post it on Wla-DX forums and the author will fix it or examine your demand.
<br />Eventually, the day where you want to move to GBC dev, SNES dev, or whatever, you can still use Wla-DX.
<br />All that stuff makes me love Wla-DX. The only inconvegniant is the forced .w after word adresses. For example :
<br />lda Buffer.w,X
<br />sta $2006.w
<br />lda Buffer+1.w,X
<br />sta $2006.w
<br />This is not forced, but highly recommanded, and you may have bugs if you don't do it (it is at least needed for word variables, it can be skipped on a sta $xxxx, but not for a stx $xxxx or sty $xxxx) Theese last two were bugging in the original version, and I taught the author, and he fixed it.
<br />
<br />PS: I didn't undestand how you load your materia screen at all. I think you just need to load it when the player clicks on a face (with A button), you should turn the screen off for a frame, just like FF1 does. You're trying to load it in the second name table when the player press A ? If you really don't want to turn the screen off, you can load it step-by-step during VBlank like FF2, FF3.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Sun Oct 09, 2005 4:14 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yeah, I explained that crappy. Now when I say click in this next section, it means press a. I have a flag called mflag, which is short for materia flag. This is a variable that is incremented when you click on materia, which is something I should change. when you click on materia, the hand will go and point to the first character's portrait, where you know, you can move it up and down to select a different portrait if you want. When you click the character's portrait, the mflag variable will increment a little more until it reaches a value of 6, then the materia screen will be loaded. The problem is, you can hold "a" a little too long, and it will just select the first character's portrait, and load that character's materia screen. It's kind of like some SNES games where you can hold the pause button, and it will quick like pause, and unpause, because you have to tap it really really fast to pause. It's like that if you hold "a" too long, but it's not that extreme. But there's also another problem where you can click on materia really really fast, then click on a portrait really really fast, and it may not load it, so you have to press it again, or at least until mflag is 6. Does that make sense?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Quietust</b> [ Sun Oct 09, 2005 6:34 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The problem sounds like you are directly checking the button states to perform your actions, which won't work. You need to detect when a button state CHANGES; fortunately, there is a very convenient way to handle this:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">curctrl: .res 1<br />lastctrl: .res 1<br />hitctrl: .res 1<br /><br />readctrl:<br />&nbsp; &nbsp;LDX #$09<br />&nbsp; &nbsp;STX $4016<br />&nbsp; &nbsp;DEX<br />&nbsp; &nbsp;STX $4016<br />:&nbsp; &nbsp;LDA $4016<br />&nbsp; &nbsp;LSR A<br />&nbsp; &nbsp;ROL curctrl<br />&nbsp; &nbsp;DEX<br />&nbsp; &nbsp;BNE :-<br />&nbsp; &nbsp;LDA curctrl<br />&nbsp; &nbsp;EOR lastctrl<br />&nbsp; &nbsp;AND curctrl<br />&nbsp; &nbsp;STA hitctrl<br />&nbsp; &nbsp;RTS<br /></div>
<br />
<br />Check bits in 'curctrl' to see which buttons are currently pressed (i.e. for walking and running), and check 'hitctrl' to see which buttons the user JUST pressed (for stuff like menu navigation).

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>4</strong> of <strong>4</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>