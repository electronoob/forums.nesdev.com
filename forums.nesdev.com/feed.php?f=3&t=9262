<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=9262" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2013-07-26T13:13:28-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=9262</id>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2013-07-26T13:13:28-07:00</updated>
<published>2013-07-26T13:13:28-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115689#p115689</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115689#p115689"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115689#p115689"><![CDATA[
Just read the earlier comments about large static array vs. dynamic allocation (malloc, new, etc.). I didn't notice for me the key reason: bounds checking with a debugger. Dynamic allocations have better support for catching out-of-bounds accesses in debuggers than static arrays, due to the ability of the debugger to exert more control over how the allocation is made so that it has larger padding around it, etc.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Fri Jul 26, 2013 1:13 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ulfalizer]]></name></author>
<updated>2013-07-25T19:54:05-07:00</updated>
<published>2013-07-25T19:54:05-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115679#p115679</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115679#p115679"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115679#p115679"><![CDATA[
<div class="quotetitle">lidnariq wrote:</div><div class="quotecontent"><br />This is a fairly goofy way to do it, but: the Xvideo extension does seem to reliably do vsync synchronized page flipping.<br /></div><br /><br />Looks interesting. Seems it can do hardware scaling too.<br /><br />I wonder what the gotchas might be, since this isn't exactly intended use. <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5911">ulfalizer</a> — Thu Jul 25, 2013 7:54 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2013-07-23T12:40:51-07:00</updated>
<published>2013-07-23T12:40:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115584#p115584</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115584#p115584"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115584#p115584"><![CDATA[
This is a fairly goofy way to do it, but: the Xvideo extension does seem to reliably do vsync synchronized page flipping.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Tue Jul 23, 2013 12:40 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2013-07-23T08:53:28-07:00</updated>
<published>2013-07-23T08:53:28-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115579#p115579</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115579#p115579"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115579#p115579"><![CDATA[
I was under the impression that a compositing desktop would offer applications some way to support windowed mode without tearing, seeing as the compositor itself can see vsync. Perhaps the free desktop really does lack essential features.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Tue Jul 23, 2013 8:53 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ulfalizer]]></name></author>
<updated>2013-07-22T19:26:05-07:00</updated>
<published>2013-07-22T19:26:05-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115553#p115553</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115553#p115553"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115553#p115553"><![CDATA[
I guess other refresh rates would be acceptable too, to at least get rid of tearing. Unlikely that you'd be able to muck around with refresh rates in windowed mode anyway, or maybe even fullscreen...<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5911">ulfalizer</a> — Mon Jul 22, 2013 7:26 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ulfalizer]]></name></author>
<updated>2013-07-22T19:22:30-07:00</updated>
<published>2013-07-22T19:22:30-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115552#p115552</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115552#p115552"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115552#p115552"><![CDATA[
<div class="quotetitle">lidnariq wrote:</div><div class="quotecontent"><br />&quot;What are you really trying to do?&quot;<br />SDL provides SDL_Flip()<br />There's the XDoubleBufferExtension; an example is Xscreensaver's &quot;deluxe&quot; screenhack which uses xdbe_get_backbuffer and XdbeSwapBuffers.<br />GL provides its own stuff, but I don't have a reference handy.<br /><br />This will vary so much by application and library it's almost meaningless to ask the generic form.<br /></div><br /><br />I'm trying to get a 60 Hz vsynced display (i.e., one without tearing) if supported (with slightly adjusted emulation speed to match). SDL_Flip() does not appear to wait for vertical retrace on Linux, making it equivalent to SDL_UpdateRect().<br /><br />Can those APIs be made to wait for the vertical retrace? Couldn't find anything at a quick glance.<br /><br />Just found <!-- m --><a class="postlink" href="https://github.com/chjj/compton/issues/7">https://github.com/chjj/compton/issues/7</a><!-- m -->. The commit it links to seems to use glXWaitVideoSyncSGI().<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5911">ulfalizer</a> — Mon Jul 22, 2013 7:22 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2013-07-22T18:19:54-07:00</updated>
<published>2013-07-22T18:19:54-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115548#p115548</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115548#p115548"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115548#p115548"><![CDATA[
&quot;What are you really trying to do?&quot;<br />SDL provides SDL_Flip()<br />There's the XDoubleBufferExtension; an example is Xscreensaver's &quot;deluxe&quot; screenhack which uses xdbe_get_backbuffer and XdbeSwapBuffers.<br />GL provides its own stuff, but I don't have a reference handy.<br /><br />This will vary so much by application and library it's almost meaningless to ask the generic form.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Mon Jul 22, 2013 6:19 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ulfalizer]]></name></author>
<updated>2013-07-22T17:17:20-07:00</updated>
<published>2013-07-22T17:17:20-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115545#p115545</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115545#p115545"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=115545#p115545"><![CDATA[
Anyone has any experience with getting vsync (windowed or otherwise) working on Linux/X11 (and yeah, that's a bit vague, but work with me - think common setups <img src="http://forums.nesdev.com/images/smilies/icon_razz.gif" alt=":P" title="Razz" />)? Googled around a bit, and it looks bleak.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5911">ulfalizer</a> — Mon Jul 22, 2013 5:17 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2013-04-13T06:10:33-07:00</updated>
<published>2013-04-13T06:10:33-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110921#p110921</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110921#p110921"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110921#p110921"><![CDATA[
<div class="quotetitle">koitsu wrote:</div><div class="quotecontent"><br />Tell me: what do you think happens when &quot;the global data allocated by the OS at exe init time&quot; fails?  What happens when do something like [a statically allocated array in the tens of MiB] and the allocation by the ELF loader (or the &quot;executable loader&quot;) fails?  I can tell you what happens: undefined behaviour<br /></div><br />What happens when the executable itself fails to load? Unless you're trying to get something running on an embedded or ancient handheld device, the ELF loader or PE loader will cause about 32 MiB of swapping when building a 32 MiB zeroed array. So you can expect that at least half the operating system's system requirements will be available for allocation. Even Android devices tend to come with 1 GB of RAM nowadays, though their OOM killer is far different from that of GNU/Linux because of a desire to avoid swapping.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Sat Apr 13, 2013 6:10 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[rainwarrior]]></name></author>
<updated>2013-04-12T23:08:19-07:00</updated>
<published>2013-04-12T23:08:19-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110915#p110915</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110915#p110915"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110915#p110915"><![CDATA[
<div class="quotetitle">koitsu wrote:</div><div class="quotecontent"><br />The behaviour if the allocation is too large (exceeds system limits, etc.) is undefined however; on some systems it might segfault right off the bat, but on others it might do god-knows-what or just lock up.  The risk isn't worth it -- allocate &quot;large chunks&quot; (see those freebsd.org mailing list threads) dynamically so your program can always start/run and can elegantly handle situations where memory pressure is an issue.  You should not depend on the ELF/executable loader to do this for you.<br /></div><br /><br />Well, actually you can. This thread is about a windows-only application, and this particular error, if I'm not mistaken, will result in a popup that says &quot;out of memory&quot;. I'm not sure because it's very rare and hard to trigger (need to open many, many programs to fill up virtual swap space). You actually have to run out of virtual memory space on disk for it to occur.<br /><br />In this case, I'm not able to trigger it because MSVC limits the maximum size of any static array to 2GB, and also limits the executable + static memory to 2GB.<br /><br />Windows will very happily run an executable with 2GB of code + static allocations. This will really be perfectly fine for almost any modern operating system with a hard drive (or suitable amount of virtual swap space). I think the advice to avoid doing this is completely wrong. It is not likely to cause any problem on any intended platform. Even if it did cause a problem, most modern operating systems are able to give usable error reporting when a program cannot be allocated enough system memory-- this is a case they can meaningfully detect! We've come a long way since DOS.<br /><br />Valid reasons not to use the static allocation:<br />1. the bitmap is only needed temporarily, and you would like to release the memory when the program is doing other things.<br />2. you're targeting an embedded platform, or something else with very little RAM and no virtual RAM, and no error reporting, so you want to check the allocation for an error manually so you can report it to the user.<br />3. you want to use an array wrapper class like std::vector to aid debugging with things like bounds checking.<br /><br />In the given case there's no much reason to do something other than the static allocation. This kind of out-of-memory error is practically impossible on the intended platform, and even if it did happen, the OS should report it properly. Having the programmer check for an error that won't happen and report it to the user is pointless busy-work.<br /><br /><br />One thing I would recommend about it, though, is using symbolic constants for the bitmap dimension, so that if you ever need to change it you don't accidentally do something like change the loop numbers, but not the bitmap size. The consequences of that mistake could be annoyingly strange/subtle and hard to diagnose/fix.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5165">rainwarrior</a> — Fri Apr 12, 2013 11:08 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[koitsu]]></name></author>
<updated>2013-04-12T22:39:10-07:00</updated>
<published>2013-04-12T22:39:10-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110914#p110914</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110914#p110914"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110914#p110914"><![CDATA[
<div class="quotetitle">Jarhmander wrote:</div><div class="quotecontent"><br />What about <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">#include &lt;vector&gt;</tt>, <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">std::vector&lt;SBitmap&gt; Bitmap&#40;size&#41;;</tt> ? No new, no delete. When you need a pointer, use the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">Bitmap.data&#40;&#41;</tt> method. All methods are inline, so it's as fast as a regular &quot;malloc'ed&quot; array.<br /><br />… but I think it's enough noise with what Bitmap could have been.<br /></div><br />I don't do C++.  Someone else can talk about that.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3">koitsu</a> — Fri Apr 12, 2013 10:39 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[koitsu]]></name></author>
<updated>2013-04-12T22:38:51-07:00</updated>
<published>2013-04-12T22:38:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110913#p110913</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110913#p110913"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110913#p110913"><![CDATA[
<div class="quotetitle">Zepper wrote:</div><div class="quotecontent"><br />What about creating a BITMAP <strong>structure</strong>, and then... BITMAP *bmp = malloc( foo ) ?<br /></div><br />Sure you can do that.  You might need to force-cast the return value from malloc (to <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">BITMAP *</tt>), and you would want to pass the size of the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">BITMAP</tt> structure to <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">malloc&#40;&#41;</tt> (e.g. <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">malloc&#40;sizeof&#40;BITMAP&#41;&#41;</tt>).  That just allocates enough for one structure, however, so if you want an &quot;array of BITMAPs&quot;, you need to allocate (and free) them all yourself.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3">koitsu</a> — Fri Apr 12, 2013 10:38 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Jarhmander]]></name></author>
<updated>2013-04-12T19:37:11-07:00</updated>
<published>2013-04-12T19:37:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110909#p110909</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110909#p110909"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110909#p110909"><![CDATA[
What about <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">#include &lt;vector&gt;</tt>, <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">std::vector&lt;SBitmap&gt; Bitmap&#40;size&#41;;</tt> ? No new, no delete. When you need a pointer, use the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">Bitmap.data&#40;&#41;</tt> method. All methods are inline, so it's as fast as a regular &quot;malloc'ed&quot; array.<br /><br />… but I think it's enough noise with what Bitmap could have been.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=336">Jarhmander</a> — Fri Apr 12, 2013 7:37 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2013-04-12T18:59:18-07:00</updated>
<published>2013-04-12T18:59:18-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110908#p110908</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110908#p110908"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110908#p110908"><![CDATA[
What about creating a BITMAP <strong>structure</strong>, and then... BITMAP *bmp = malloc( foo ) ?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Fri Apr 12, 2013 6:59 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[koitsu]]></name></author>
<updated>2013-04-12T17:53:30-07:00</updated>
<published>2013-04-12T17:53:30-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110907#p110907</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110907#p110907"/>
<title type="html"><![CDATA[Re: Windowed VSync]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=9262&amp;p=110907#p110907"><![CDATA[
<div class="quotetitle">Zelex wrote:</div><div class="quotecontent"><br />wait wait, how does a global variable have anything to do with the size of your stack? Is this some kind of &quot;this is how it works with some compiler on some obscure embedded platform?&quot;<br /><br />Also global data is allocated by the OS at exe init time. Its not allocated on first use. You may be thinking of a local static variable. For example,<br /><br />int foo() {<br /> static int bar = 0;<br /> return bar++;<br />}<br /><br />bar in this example is allocated at program startup by the OS, it is however only initialized to 0 when foo is first run. (watch out for multi-threading issues)<br /></div><br />That code does nothing and is mostly irrelevant to the discussion.  Are we talking past one another?  I'm not sure.<br /><br />Tell me: what do you think happens when &quot;the global data allocated by the OS at exe init time&quot; fails?  What happens when do something like <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">char buf[1024*1024*32];</tt> (scope doesn't matter) and the allocation by the ELF loader (or the &quot;executable loader&quot;) fails?  I can tell you what happens: undefined behaviour, based on too many situations/scenarios/variables.  Instead, allocate memory during runtime and you can handle this situation elegantly.<br /><br />Edit: Okay, it looks like scope does matter, at least on *IX systems.  With <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">char buf[1024*1024*32];</tt> declared outside of <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">main&#40;&#41;</tt>, the allocation ends up being part of the processes active datasize.  If declared inside of <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">main&#40;&#41;</tt>, it ends up being part of the processes active stacksize.  If inside of a sub-function, the allocation only happens when that function is called and is part of the processes active stacksize.  If inside of a sub-function that isn't used, the allocation never happens.<br /><br />The behaviour if the allocation is too large (exceeds system limits, etc.) is undefined however; on some systems it might segfault right off the bat, but on others it might do god-knows-what or just lock up.  The risk isn't worth it -- allocate &quot;large chunks&quot; (see those freebsd.org mailing list threads) dynamically so your program can always start/run and can elegantly handle situations where memory pressure is an issue.  You should not depend on the ELF/executable loader to do this for you.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3">koitsu</a> — Fri Apr 12, 2013 5:53 pm</p><hr />
]]></content>
</entry>
</feed>