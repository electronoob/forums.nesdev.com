<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=580" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2005-09-25T12:39:56-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=580</id>
<entry>
<author><name><![CDATA[Anes]]></name></author>
<updated>2005-09-25T12:39:56-07:00</updated>
<published>2005-09-25T12:39:56-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4902#p4902</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4902#p4902"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4902#p4902"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />The real point that I am making is that I never intended to make my NES emulator 100% accurate, I just did it for fun, like most people<br /></div><br /><br />I think doing it for fun doest mean that an emulator should display only a window with a title saying "my emulator" or if you are progamming in a console OS says "my emulator" and exits, you should be the more accurate you need, i do it for fun too, but some games that i owned when i was child doesnt work and that becouse accuracy, so i try to fix it.<br /><br />The point is there is nothing to "fun" do with "accuracy". <br /><br />P.D= or isnt FUNNY to do it ACCURATTLY?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=72">Anes</a> — Sun Sep 25, 2005 12:39 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2005-09-25T11:13:18-07:00</updated>
<published>2005-09-25T11:13:18-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4897#p4897</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4897#p4897"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4897#p4897"><![CDATA[
Thanks for letting me know. For the time being i'll stick with my scanline engine, just so I can play some of the more basic ROMs. But in the future I will write an accurate PPU renderer. The real point that I am making is that I never intended to make my NES emulator 100% accurate, I just did it for fun, like most people.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Sun Sep 25, 2005 11:13 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Disch]]></name></author>
<updated>2005-09-25T11:05:21-07:00</updated>
<published>2005-09-25T11:05:21-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4894#p4894</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4894#p4894"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4894#p4894"><![CDATA[
When you light up an orb in Final Fantasy, the game does timed code to create a "beam of light" which makes sort of a slanted rectangled from the top-left corner of the screen to the player's position.  The game accomplishes this by toggling monochrome mode at certain points in the scanline.  With a typical scanline renderer... you will either not show this effect at all... or you will show every scanline in monochrome mode.<br /><br />Marble Madness swaps CHR midscanline for the race titles.  If you remember playing this game in NESticle back in the day, you know how a scanline renderer will display it (shows garbage tiles where there should be text).<br /><br />Micro Machines does VERY weird things in the title screen... relying on the PPU address to be incremented at a very specific time.  The specific glitch I have in mind is minor and hard to explain... but it's still worth mentioning.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=33">Disch</a> — Sun Sep 25, 2005 11:05 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2005-09-25T10:58:30-07:00</updated>
<published>2005-09-25T10:58:30-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4893#p4893</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4893#p4893"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4893#p4893"><![CDATA[
I am currently emulating accurate CPU timing so that may help. What kind of effect does Final Fantasy etc. use that may effect my emulator?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Sun Sep 25, 2005 10:58 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Disch]]></name></author>
<updated>2005-09-25T10:56:03-07:00</updated>
<published>2005-09-25T10:56:03-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4892#p4892</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4892#p4892"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4892#p4892"><![CDATA[
He means you'll have issues with games which do mid-scanline effects like Final Fantasy, Marble Madness, Micro Machines, and several others.<br /><br />Rounding off when Sprite-0 hit happens could affect games as well... if you're rounding off to the start or end of the scanline which sprite 0 hit happens, several games will have display problems.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=33">Disch</a> — Sun Sep 25, 2005 10:56 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2005-09-25T10:40:12-07:00</updated>
<published>2005-09-25T10:40:12-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4891#p4891</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4891#p4891"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4891#p4891"><![CDATA[
WedNESday can do both vertical and horizontal scrolling including split screen scrolling no problem. Also, WedNESday ignores the PPU documents (341 ppu cc etc.) and just renders the scanline normally (i.e. it just fetches 1 tile every 8 pixels and renders it). I know that some of you may think that this would make the emulator run incorrectly but most (90%) NROM games (no mapper support yet) run perfectly (still some PPU work to do).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Sun Sep 25, 2005 10:40 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anes]]></name></author>
<updated>2005-09-25T10:27:50-07:00</updated>
<published>2005-09-25T10:27:50-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4889#p4889</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4889#p4889"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4889#p4889"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />WedNESday draws the screen on a scanline for scanline basis.<br /></div><br />mmm... scanline rendering (if you are rendering optimized) will give you a liittle more speed in the emulator, but it will not be accurate, there are some programs or games that do H split effects and you will not detect that.<br />Another thing is cc calc, its a little more complicated when its by scanline.<br /><br />I suggest you change by pixel. I ussed scanline basis in my emulator dev beggining and i gave a lot of problems regarding cycles calc and those things.<br /><br />Sprite 0 hit is another issue can you detect exactly when its hited.<br /><br />And remember that a scanline is 341/3 cpu cc not 256 ppu cc.<br />256 is for rendering the playfield and the other falls in hblank.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=72">Anes</a> — Sun Sep 25, 2005 10:27 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2005-09-25T10:23:43-07:00</updated>
<published>2005-09-25T10:23:43-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4888#p4888</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4888#p4888"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4888#p4888"><![CDATA[
WedNESday draws the screen (and has no issues with priority or anything else) by drawing the scanline and then going back and drawing the sprites on a pixel for pixel basis. When it has found 8 sprites it then stops. So far this method is very simple and proves very accurate.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Sun Sep 25, 2005 10:23 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anes]]></name></author>
<updated>2005-09-25T10:16:06-07:00</updated>
<published>2005-09-25T10:16:06-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4887#p4887</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4887#p4887"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4887#p4887"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Fx3 escribió: <br />Supposely, you evaluate ALL the sprites at clock cycle 256. ^_^;; <br />Yes, there's a 8-sprites buffer, indeed, which follows the same rule for priority. <br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">No you don't, but that's how most emulators do it. If you want to do it 100% correctly, you evaluate them while the scanline is rendered using a procedure I described in a topic somewhere around here...<br /></div><br /></div><br /><br />Thats right if you read brad doc it says that sprites are evaluated during scanline render wich gives you 256cc / 64sprites: 4cc takes each evaluation. so you should have a counter that when 4 cc pass evaluate sprites 0.. etc. Which i really dont know if scanline cc 0 evaluates first i mean:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent"><br />static BYTE cc = 0;<br /><br /> if &#40;cc_sprites == 0&#41;<br />   //Check Sprite In Rage and test how many <br />   cc = 3;<br /> else<br />   cc--;<br /><br /></div><br /><br />OR<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent"><br />static BYTE cc = 0<br /> if &#40;cc_sprites == 3&#41;<br />   //Check Sprite In Rage and test how many <br />   cc = 0;<br /> else<br />   cc++;<br /><br /></div><br /><br />Checking all 64 sprites in a sinlge cc, is not accuratest at al (maybe some games uses it WedNESDay) and if you keep checking after a 8+ has been found its a waste of time to your emulator, you should stop checking when sprite 7 (0 - 7) is in range and reset you "csprites in ranges" var.<br /><br />I really dont know if games take adventage of it, but the only thing i know is that when i uses the method i explained above, battletoads didnt hang and when i use the "one cc check all sprites" battletoads started to hang (altmost for me).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=72">Anes</a> — Sun Sep 25, 2005 10:16 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Muchaserres]]></name></author>
<updated>2005-09-25T09:35:28-07:00</updated>
<published>2005-09-25T09:35:28-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4879#p4879</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4879#p4879"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4879#p4879"><![CDATA[
Are there any NES programs who behave differently depending on which of those two methos is used to emulate the PPU?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=41">Muchaserres</a> — Sun Sep 25, 2005 9:35 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Quietust]]></name></author>
<updated>2005-09-24T20:41:26-07:00</updated>
<published>2005-09-24T20:41:26-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4867#p4867</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4867#p4867"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4867#p4867"><![CDATA[
<div class="quotetitle">Fx3 wrote:</div><div class="quotecontent"><br /><strong>Supposely</strong>, you evaluate ALL the sprites at clock cycle 256. ^_^;;<br />Yes, there's a 8-sprites buffer, indeed, which follows the same rule for priority.<br /></div><br /><br />No you don't, but that's how most emulators do it. If you want to do it 100% correctly, you evaluate them while the scanline is rendered using a procedure I described in a topic somewhere around here...<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=7">Quietust</a> — Sat Sep 24, 2005 8:41 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2005-09-24T19:16:20-07:00</updated>
<published>2005-09-24T19:16:20-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4866#p4866</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4866#p4866"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4866#p4866"><![CDATA[
<div class="quotetitle">Anes wrote:</div><div class="quotecontent"><br />Maybe i missunderstood something fx3, but you are advicing him to go from sprite 0 to 63?<br />If it is that the case the emulation will not be ok.<br />Sprites have temporary memories that only can hold 8 sprites and 2002.5<br />is set if its found one more and the other are not drawn on the screen (thats becouse a real nes show flickering whem 8+ sprites are in the same scanline).<br /></div><br /><br /><strong>Supposely</strong>, you evaluate ALL the sprites at clock cycle 256. ^_^;;<br />Yes, there's a 8-sprites buffer, indeed, which follows the same rule for priority.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sat Sep 24, 2005 7:16 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2005-09-24T10:44:39-07:00</updated>
<published>2005-09-24T10:44:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4849#p4849</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4849#p4849"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4849#p4849"><![CDATA[
Thanks for all of the replies but I have managed to solve the problem now.<br /><br />Btw, WedNESday draws the screen on a scanline for scanline basis.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Sat Sep 24, 2005 10:44 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2005-09-24T04:52:05-07:00</updated>
<published>2005-09-24T04:52:05-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4843#p4843</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4843#p4843"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4843#p4843"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Trying to draw all 64 sprites will give (of course) a better sprite image on screen (no flickering) but will not behave like a real NES.<br /></div><br /><br />Remember, the NES sprites <em>do not inherently flicker</em>; all flicker is done intentionally in software (as an alternative to having some (portions of) sprites just disappear). Also, not emulating the limit of 8 sprites per scanline enhances some games, but causes graphical errors on others which use some sprites to mask others (you could allow the user to choose which they want).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sat Sep 24, 2005 4:52 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anes]]></name></author>
<updated>2005-09-23T20:50:34-07:00</updated>
<published>2005-09-23T20:50:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4837#p4837</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4837#p4837"/>
<title type="html"><![CDATA[Sprite Priorities (Again...)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=580&amp;p=4837#p4837"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />You must track the visible sprites, the drawed sprites. Go from 0 to 3Fh - a solid sprite is pattern AND 3. If true, check the priority bit - for LOW priority, you allow a new sprite pixel only if there's no pixel (sprite OR background at current location); else, if HIGH priority, you draw it.<br /></div><br /><br />Maybe i missunderstood something fx3, but you are advicing him to go from sprite 0 to 63?<br />If it is that the case the emulation will not be ok.<br />Sprites have temporary memories that only can hold 8 sprites and 2002.5<br />is set if its found one more and the other are not drawn on the screen (thats becouse a real nes show flickering whem 8+ sprites are in the same scanline).<br /><br />WedNESDay: i dont know if your engine is pixel by pixel or whatever, but you should limit the sprites that are visible.<br />Trying to draw all 64 sprites will give (of course) a better sprite image on screen (no flickering) but will not behave like a real NES.<br /><br />fx3: as i said if i missunderstood something take it if i had say nothing. <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=72">Anes</a> — Fri Sep 23, 2005 8:50 pm</p><hr />
]]></content>
</entry>
</feed>