<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=9&amp;t=6144" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2010-03-11T20:56:02-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=9&amp;t=6144</id>
<entry>
<author><name><![CDATA[jwdonal]]></name></author>
<updated>2010-03-11T20:56:02-07:00</updated>
<published>2010-03-11T20:56:02-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=58030#p58030</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=58030#p58030"/>
<title type="html"><![CDATA[darn]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=58030#p58030"><![CDATA[
I can't find a 3.3V-compatible 14.318M osc in-stock anywhere.  Does anyone know a good source for these?  Digi-key only has 5V-only versions.  It also needs to be a 4-pin half-size can package.<br /><br /><br />UPDATE: I found some!!  In fact, I bought 10!  Haha, just to be safe.  I'm going to be doing this NES stuff for a loooooooooong time.  The extra will likely come in very handy.<br /><br />Pz!<br /><br />Jonathon <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3962">jwdonal</a> — Thu Mar 11, 2010 8:56 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[jwdonal]]></name></author>
<updated>2010-03-11T11:25:13-07:00</updated>
<published>2010-03-11T11:25:13-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57992#p57992</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57992#p57992"/>
<title type="html"><![CDATA[RGB]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57992#p57992"><![CDATA[
My NES emulator uses an RGB display driver.  It works really well - as far as I can tell.  Are there certain things I should be doing (or can do) to make the colors more realistic since I'm not using a composite video signal like the original NES?<br /><br />EDIT: Btw, my video driver does not use any of the clock rates I listed before.  The video module's clock rate is based on the resolution you want to display on the LCD - just like with any LCD driver.<br /><br />Pz! <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3962">jwdonal</a> — Thu Mar 11, 2010 11:25 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2010-03-11T11:22:11-07:00</updated>
<published>2010-03-11T11:22:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57991#p57991</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57991#p57991"/>
<title type="html"><![CDATA[Still possible to buy a 21.47727MHz Oscillator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57991#p57991"><![CDATA[
<div class="quotetitle">kyuusaku wrote:</div><div class="quotecontent"><br />I don't see why NTSC simulation couldn't be synthesized in hardware.<br /></div><br />If you plan to have exclusively RGB or component output, then yes, you could directly generate NTSC, decode NTSC, and output RGB or YPbPr. But for a composite output, the process of directly generating NTSC at the wrong rate, decoding it to YPbPr, and reencoding it to composite at the right rate sounds like it would produce even muddier video output.<br /><br />jwdonal: What kind of video output do you plan to have on your clone of the PPU?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Thu Mar 11, 2010 11:22 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kyuusaku]]></name></author>
<updated>2010-03-11T10:16:07-07:00</updated>
<published>2010-03-11T10:16:07-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57985#p57985</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57985#p57985"/>
<title type="html"><![CDATA[Still possible to buy a 21.47727MHz Oscillator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57985#p57985"><![CDATA[
I don't see why NTSC simulation couldn't be synthesized in hardware.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=20">kyuusaku</a> — Thu Mar 11, 2010 10:16 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2010-03-11T09:30:01-07:00</updated>
<published>2010-03-11T09:30:01-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57980#p57980</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57980#p57980"/>
<title type="html"><![CDATA[Still possible to buy a 21.47727MHz Oscillator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57980#p57980"><![CDATA[
<div class="quotetitle">kyuusaku wrote:</div><div class="quotecontent"><br />This is true, but the frequency is RGB/YCbCr palette-safe.<br /></div><br />In that case, it just depends on whether you want your FPGA's color encoder to act like that of an NTSC PPU or that of an RGB PPU. The NTSC PPU in the NES directly generates the composite signal with a shortcut that results in luma/chroma crosstalk artifacts. These artifacts make some games look worse and others look better. The RGB PPU in the PlayChoice and Famicom Titler doesn't have these artifacts, but it has a different one. Its internal HSV to RGB table has a few slightly mismeasured colors; Google says it affects Pit's hair in Kid Icarus.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Thu Mar 11, 2010 9:30 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kyuusaku]]></name></author>
<updated>2010-03-11T08:39:39-07:00</updated>
<published>2010-03-11T08:39:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57979#p57979</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57979#p57979"/>
<title type="html"><![CDATA[Still possible to buy a 21.47727MHz Oscillator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57979#p57979"><![CDATA[
This is true, but the frequency is RGB/YCbCr palette-safe.<br /><br /><div class="quotetitle">jwdonal wrote:</div><div class="quotecontent"><br />Anyway, thanks again for the help kyuusaku!<br /></div><br />Pshh it was nothing!<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=20">kyuusaku</a> — Thu Mar 11, 2010 8:39 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2010-03-11T07:24:39-07:00</updated>
<published>2010-03-11T07:24:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57976#p57976</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57976#p57976"/>
<title type="html"><![CDATA[Still possible to buy a 21.47727MHz Oscillator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57976#p57976"><![CDATA[
<div class="quotetitle">kyuusaku wrote:</div><div class="quotecontent"><br />That minimum seems crazy, most of the time it's a couple MHz. Also, if the minimum frequency is 32 MHz, you can't DCM the 25 MHz osc? At the very least you could use use your 100 MHz: 100 / 14 * 3 = 21.43 MHz. It's not exact, but SIGNIFICANTLY more accurate than PC emulators and not perceivable anyway.<br /></div><br />The NTSC color subcarrier frequency is defined as 39.375/11 = 3.579545 MHz, and you propose using a frequency of 100/28 = 3.571429 MHz, a difference of 0.224%. If you generate subcarrier from an incorrect crystal, you'll get hue-shifted colors toward the right side of the screen. The picture is 256*2/3 = about 170 color subcarrier cycles wide, so at the right side of the screen, pixels will end up hue-shifted by 1-(100/28/39.375*11)*170*100 = 38.5%. In fact, <a href="http://www.tpub.com/content/armycomsystems/SS0606/SS06060025.htm" class="postlink">the recommendation</a> is that the frequency be accurate to 0.0003 percent, or plus or minus 10 Hz, in order to keep hue shifting to a minimum.<br /><br />If at all possible, I'd recommend starting from the 14.32 MHz oscillator, which is specially designed to generate a signal exactly four times the rate of the NTSC color subcarrier. Or just bite the proverbial bullet and put an RC around the same 21.47 MHz crystal that the original NES used.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Thu Mar 11, 2010 7:24 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[jwdonal]]></name></author>
<updated>2010-03-11T01:37:43-07:00</updated>
<published>2010-03-11T01:37:43-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57960#p57960</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57960#p57960"/>
<title type="html"><![CDATA[thanks!]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57960#p57960"><![CDATA[
So it turns out kyuusaku is The Man!  I swapped out my 100M osc for a 25M osc and my NES clocking is now much more accurate!!<br /><br />With 100M the best I could get was:<br />DCM Output = 44MHz<br />2A03 = 44M / 24 = 1.83 MHz (~2.23% faster than original NES)<br />2C02 = 44M /  8 = 5.50 MHz (~2.23% faster than original NES)<br /><br />With 25M I've got:<br />DCM Output = 21.4286 MHz<br />2A03 = 21.4286M / 12 = 1.786 MHz (~0.227% slower)<br />2C02 = 21.4286M /  4 = 5.357 MHz (~0.227% slower)<br /><br />As you can see the 25M option is MUCH better!!  Nice little upgrade!<br /><br />I am still sacrificing the clock feedback correction loop but it doesn't seem to matter from what I can tell so far - this is certainly only because I am clocking at such low rates though.  I will need to check the timing analyzer output but I've been playing my NES for a while now with a bunch of different games at this new frequency and it seems fine.  If there were any major timing issues I probably would have seen it by now.<br /><br />I'm not even sure that I will bother getting the 14.318M osc cause the 25M option is already so close.  If I purchased a 14.318M osc I could get the following:<br /><br />DCM Output = 21.477 MHz<br />2A03 = 21.477M / 12 = 1.789 MHz (~0.001% slower)<br />2C02 = 21.477M /  4 = 5.369 MHz (~0.001% slower)<br /><br />Anyway, thanks again for the help kyuusaku!<br /><br />Jonathon <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3962">jwdonal</a> — Thu Mar 11, 2010 1:37 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[jwdonal]]></name></author>
<updated>2010-03-10T21:37:44-07:00</updated>
<published>2010-03-10T21:37:44-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57949#p57949</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57949#p57949"/>
<title type="html"><![CDATA[hmmm]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57949#p57949"><![CDATA[
Ok, so I went back and looked in the datasheet for the V5 to be sure I had the correct min input freq.  The min I specified is correct.  I also ran the architecture clocking wizard to see if it would let me specify anything less than 32 - it would not.<br /><br />!HOWEVER! In looking at the extremely fine print in the datasheet I found that there is a "special" mode that you can put the DCM into which will allow for a minimum input clock freq of 1MHz!  I have never used this mode before so I never knew about it until now.  I'm used to designing for 100MHz+ systems at my job so I never had to use this mode.  A concern I have however is that this mode does not allow you to utilize the clock feedback loop of the DCM which is used to help with real-time adjustments to clock skew/phase shifts.  I'm going to give it a shot anyway and see what happens.  First, I will try it using the 25MHz osc, then if that works fine I guess I will be on my way to buying a 14.318MHz osc!  This will be really cool if this works! <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />I'm very glad we had this discussion! It seems I still learn something new almost every day about these Xilinx devices and I've been using them for over 8 years!<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3962">jwdonal</a> — Wed Mar 10, 2010 9:37 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kyuusaku]]></name></author>
<updated>2010-03-10T21:10:39-07:00</updated>
<published>2010-03-10T21:10:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57946#p57946</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57946#p57946"/>
<title type="html"><![CDATA[Still possible to buy a 21.47727MHz Oscillator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57946#p57946"><![CDATA[
That minimum seems crazy, most of the time it's a couple MHz. Also, if the minimum frequency is 32 MHz, you can't DCM the 25 MHz osc? At the very least you could use use your 100 MHz: 100 / 14 * 3 = 21.43 MHz. It's not exact, but SIGNIFICANTLY more accurate than PC emulators and not perceivable anyway.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=20">kyuusaku</a> — Wed Mar 10, 2010 9:10 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[jwdonal]]></name></author>
<updated>2010-03-10T20:31:17-07:00</updated>
<published>2010-03-10T20:31:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57943#p57943</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57943#p57943"/>
<title type="html"><![CDATA[Still possible to buy a 21.47727MHz Oscillator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57943#p57943"><![CDATA[
Virtex-5 LXT<br /><br />2 onboard oscillators available: 100MHz and 25MHz<br /><br />There is also 1 open oscillator socket (which is what I wanted to put the 21.47727MHz oscillator in).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3962">jwdonal</a> — Wed Mar 10, 2010 8:31 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kyuusaku]]></name></author>
<updated>2010-03-10T20:31:53-07:00</updated>
<published>2010-03-10T20:29:38-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57941#p57941</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57941#p57941"/>
<title type="html"><![CDATA[Still possible to buy a 21.47727MHz Oscillator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57941#p57941"><![CDATA[
Which chip and osc. frequency are you currently using?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=20">kyuusaku</a> — Wed Mar 10, 2010 8:29 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[jwdonal]]></name></author>
<updated>2010-03-10T20:40:48-07:00</updated>
<published>2010-03-10T20:09:35-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57936#p57936</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57936#p57936"/>
<title type="html"><![CDATA[ok]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57936#p57936"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />I really don't see what it has to do with code portability, for each board you target, you still need to specify hardware constraints<br /></div><br /><br />There is some truth in that.  I suppose requiring the user to figure out how they want to generate the input clock to the system is not really asking that much.  Haha.  Either way, it would still be nice if I just had to divide by 12 and 4 using some logic and be done.  It would greatly simplify my clock generation block.<br /><br />-----<br /><br />So my DCMs minimum input clock frequency is 32MHz.  No help there.  My PLLs min CLKIN * (M/N) value is 400MHz.  With a min CLKIN freq of 19MHz. The N divider value for the final output freq can be a pretty large number however.  But that still doesn't really help.<br /><br />So what is your suggestion for this situation?  I really like your 14.318 MHz solution - I wasn't aware that that was a popular frequency.  Good to know for sure.  But...I don't see how it helps me with my particular setup.<br /><br />I'm certainly open to any suggestions.  Maybe there is some way of doing this that i just haven't thought of.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3962">jwdonal</a> — Wed Mar 10, 2010 8:09 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kyuusaku]]></name></author>
<updated>2010-03-10T19:35:44-07:00</updated>
<published>2010-03-10T19:35:44-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57933#p57933</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57933#p57933"/>
<title type="html"><![CDATA[Still possible to buy a 21.47727MHz Oscillator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57933#p57933"><![CDATA[
It's not that big of an issue, which devices by Xilinx, Altera and Lattice CAN'T handle simple integer multiplication? I really don't see what it has to do with code portability, for each board you target, you still need to specify hardware constraints; think of clock generation as another constraint. As you can see 21.477 MHz oscillators are just not sustainable, so this is really the best option. I use 14.318 MHz oscillators since after being used in the IBM PC, they aren't going away.<br /><br />The NES has a discrete crystal oscillator, so that won't be much use. 14.318 MHz osc I'm tellin' ya!<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=20">kyuusaku</a> — Wed Mar 10, 2010 7:35 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[jwdonal]]></name></author>
<updated>2010-03-10T19:07:45-07:00</updated>
<published>2010-03-10T19:07:45-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57929#p57929</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57929#p57929"/>
<title type="html"><![CDATA[not that simple]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6144&amp;p=57929#p57929"><![CDATA[
It's not that simple.  In Xilinx devices the DCMs (what you're calling a DLL) and PLLs are restricted to certain minimum/maximum input/output clock frequencies.  You are also restricted to certain M / N values based on those frequencies.  In my case with my particular boards it is not possible to achieve a really good approximation of the 21.47727MHz rate of the original NES.<br /><br />Also, using a device primitive to generate the clock is not what I really want since it makes my code architecture/device specific.  I want the appropriate oscillator frequency coming right into the FPGA and then just some generic clock divider logic that can be used on any device.  This will keep my code the most portable.<br /><br />So with that said, anyone know where I can buy one still?  I was thinking if all else failed I could buy an NES online and steal the oscillator from it.  But I don't know if the NES used an all in one oscillator or if it used a crystal with additional on-board analog components to create the oscillator.  Does anyone know which it is?<br /><br />Pz!<br /><br />Jonathon <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3962">jwdonal</a> — Wed Mar 10, 2010 7:07 pm</p><hr />
]]></content>
</entry>
</feed>