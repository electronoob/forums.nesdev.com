<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=637" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2010-04-22T20:23:15-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=637</id>
<entry>
<author><name><![CDATA[ReaperSMS]]></name></author>
<updated>2010-04-22T20:23:15-07:00</updated>
<published>2010-04-22T20:23:15-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=60262#p60262</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=60262#p60262"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=60262#p60262"><![CDATA[
Please, let the dead threads lie. What did they ever do to you?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=8">ReaperSMS</a> — Thu Apr 22, 2010 8:23 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[aphex]]></name></author>
<updated>2010-04-22T20:19:48-07:00</updated>
<published>2010-04-22T20:19:48-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=60261#p60261</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=60261#p60261"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=60261#p60261"><![CDATA[
A n00b question is<br /><br />"How to write emulator? Plz give source!"<br /><br />This is a question about a commonly misunderstood flag in the 6502 processor.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4348">aphex</a> — Thu Apr 22, 2010 8:19 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2005-10-10T11:55:48-07:00</updated>
<published>2005-10-10T11:55:48-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5350#p5350</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5350#p5350"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5350#p5350"><![CDATA[
I will defend the question of proper V flag behavior as not being a newbie question. Before replying I checked the original Rockwell manual and it was not at all clear about V flag behavior. It's similar to adding the extra clock to a branch instruction when it "crosses pages". I've just investigated this on my NES and I imagine many people would answer wrong as to when it actually occurs (start a new thread if you're wondering).<br /><br />But I'll also defend attempts to preserve the use of this section's usefulness by directing basic questions to the newbie forum, but not using put-downs. The best solution is for a few mini-moderators to be allowed to (silently) move topics if they would be better placed elsewhere.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Mon Oct 10, 2005 11:55 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2005-10-10T11:26:35-07:00</updated>
<published>2005-10-10T11:26:35-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5347#p5347</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5347#p5347"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5347#p5347"><![CDATA[
Yeah yeah, whatever.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Mon Oct 10, 2005 11:26 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anes]]></name></author>
<updated>2005-10-10T11:20:11-07:00</updated>
<published>2005-10-10T11:20:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5344#p5344</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5344#p5344"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5344#p5344"><![CDATA[
thanks james and blargg now i have correct emulation.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=72">Anes</a> — Mon Oct 10, 2005 11:20 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[James]]></name></author>
<updated>2005-10-10T16:40:52-07:00</updated>
<published>2005-10-10T11:01:10-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5342#p5342</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5342#p5342"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5342#p5342"><![CDATA[
I use the following code to check for an overflow w/ ADC:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">SR.V = &#40;~&#40;A^M&#41;&#41; &amp; &#40;A^result&#41; &amp; 0x80 ? true : false;</div><br />and for SBC:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">SR.V = &#40;A^M&#41; &amp; &#40;A^result&#41; &amp; 0x80 ? true : false;</div><br /><br />result = A + M + carry, or A - M - ~carry<br /><br />In plain english, for ADC, if the high bit of the accumulator and memory are the same (i.e. they are both positive/negative) and the accumulator and the result have different signs, set the overflow flag.  For SBC, set the flag if accumulator and memory are of opposite signs.  File this under 'more complex than it needs to be'  <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />I can't take the credit for this -- I saw this technique used elsewhere before, and I thought it was a clever solution, so I stuck with it.<br /><br />James<br /><br />edit: FWIW, I benchmarked the solutions posted here.  This method is a few percent (2-7%) faster than the others.  YM(or architecture)MV.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=88">James</a> — Mon Oct 10, 2005 11:01 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[teaguecl]]></name></author>
<updated>2005-10-10T10:18:39-07:00</updated>
<published>2005-10-10T10:18:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5338#p5338</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5338#p5338"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5338#p5338"><![CDATA[
Wednesday, there's no need to call the problem "pathetically easy".  Maybe this should go in the newbie forum, but if not it certainly belongs here.  This is the same forum where you asked how to load a value into a shift register, which not only is easy, but is well documented elsewhere, and nobody gave you grief about it. <br /><a href="http://nesdev.com/bbs/viewtopic.php?p=5123&amp;highlight=&amp;sid=970ed6d0c3d0b8645b9fc9d536ee0cde#5123" class="postlink">http://nesdev.com/bbs/viewtopic.php?p=5123&amp;highlight=&amp;sid=970ed6d0c3d0b8645b9fc9d536ee0cde#5123</a><br />Plus, this is the second time your etiquette has been questionable in the 25 days you've been a member here:<br /><a href="http://nesdev.com/bbs/viewtopic.php?p=5086&amp;highlight=#5086" class="postlink">http://nesdev.com/bbs/viewtopic.php?p=5086&amp;highlight=#5086</a><br /><br />Your enthusiasm is great, and I'm sure you don't mean any harm, but please be respectful to other people regardless of their level of knowledge.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=29">teaguecl</a> — Mon Oct 10, 2005 10:18 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[never-obsolete]]></name></author>
<updated>2005-10-10T10:08:01-07:00</updated>
<published>2005-10-10T10:08:01-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5337#p5337</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5337#p5337"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5337#p5337"><![CDATA[
it's a legitimate question and i know by personal experience that not having the flags set correctly for each instruction is a pain.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=187">never-obsolete</a> — Mon Oct 10, 2005 10:08 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2005-10-10T07:34:52-07:00</updated>
<published>2005-10-10T07:34:52-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5333#p5333</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5333#p5333"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5333#p5333"><![CDATA[
Well isn't it? By now you should have phased out pathetically easy bugs like that.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Mon Oct 10, 2005 7:34 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[James]]></name></author>
<updated>2005-10-10T06:34:57-07:00</updated>
<published>2005-10-10T06:34:57-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5332#p5332</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5332#p5332"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5332#p5332"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Btw this is rather a noob question and does not belong in this section.<br /></div><br /><br /> <img src="http://forums.nesdev.com/images/smilies/icon_rolleyes.gif" alt=":roll:" title="Rolling Eyes" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=88">James</a> — Mon Oct 10, 2005 6:34 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2005-10-10T04:54:21-07:00</updated>
<published>2005-10-10T04:54:21-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5331#p5331</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5331#p5331"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5331#p5331"><![CDATA[
Here is how I do mine:<br /><br />if( (char)Accumulator + (char)Data + Carry &lt; -128 || (char)Accumulator + (char)Data + Carry &gt; 127 )<br />SetOverflow<br /><br />Btw this is rather a noob question and does not belong in this section.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Mon Oct 10, 2005 4:54 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2005-10-09T18:43:43-07:00</updated>
<published>2005-10-09T18:43:43-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5318#p5318</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5318#p5318"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5318#p5318"><![CDATA[
Maybe you aren't taking the carry into account?<br /><br />The overflow flag is set based on the sum of the two signed 8-bit values and carry being outside the inclusive range of -128 to 127. One way is simple:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">int result = &#40;signed char&#41; source + &#40;signed char&#41; mem + carry;<br />overflow = &#40;result &lt; -128 || result &gt; 127&#41;;<br />overflow = &#40;result + 128&#41; &amp; 0x100; // equivalent; possibly faster<br /></div><br /><br />The signed char casts are essential. Note that the previous value of the overflow flag is always replaced with the new value. As for SBC, I just XOR the operand with 0xFF and then treat it as an ADC.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sun Oct 09, 2005 6:43 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anes]]></name></author>
<updated>2005-10-09T17:50:55-07:00</updated>
<published>2005-10-09T17:50:55-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5314#p5314</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5314#p5314"/>
<title type="html"><![CDATA[cpu V flag]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=637&amp;p=5314#p5314"><![CDATA[
it seems im having problems with V Flag in ADC Y SBC my cpu emu. Can somebody tell my if what im doing is OK?:<br /><br />ADC:<br /><br /> - if source and mem are + and result is - : Set Flag<br /> - if source and mem are - and result is +: Set Flag<br /><br />SBC:<br /><br /> The same above instead we change the mem to ~mem<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=72">Anes</a> — Sun Oct 09, 2005 5:50 pm</p><hr />
]]></content>
</entry>
</feed>