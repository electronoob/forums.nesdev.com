<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - PC to NES Transfer Cable</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">PC to NES Transfer Cable</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=9&amp;t=631">http://forums.nesdev.com/viewtopic.php?f=9&amp;t=631</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DrNES</b> [ Fri Oct 07, 2005 1:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>PC to NES Transfer Cable</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Im wondering about a couple of things with the PC to NES Transfer cable modification.
<br />
<br /><!-- m --><a class="postlink" href="http://wwwk.heltech.edu.hel.fi/koti/sepi/nes/nes.htm#4">http://wwwk.heltech.edu.hel.fi/koti/sepi/nes/nes.htm#4</a><!-- m -->
<br />
<br />I can not make any sense of the schematics, they read like hyroglyphics. 
<br />
<br />After reading a few other topics about this on other forums, im begining to think that you need a dev/custom cartridge for the transfer cable to work. Is this the case?
<br />
<br />It would be nice to see a picture or two of a completed cable.
<br />
<br />Thanks.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>sepi</b> [ Sat Oct 08, 2005 4:29 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You should use EDIT to view the schematic, don't use notepad. It says so in the beginning of the document  <img src="./images/smilies/icon_wink.gif" alt=":wink:" title="Wink" />
<br />
<br />As for the irq.prg, it's just a simple test program, i used it to test if the host PC program is cabable to trap all gamepad pollings. It's not required to build the transfer cable.
<br />
<br />PC to NES transfer cable was originally designed to be bi-directional, due the complexity of the NES to PC comm. this feature was removed. If you are looking for a way to communicate from NES to PC you should see the NES to UART schematics by Memblers.
<br />
<br />Nesdev is currently hosting the updates of lptnes.exe, due the antivirus restrictions i can't upload .exe | .zip | .rar files to my homesite.
<br />Memblers told me that he is going upload stuff to nesdev pretty soon, then the latest version of lptnes.exe (1.10) should be available.
<br />
<br />- Sepi

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DrNES</b> [ Sat Oct 08, 2005 12:39 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I had checked out the schematics with edit, still a little complicated for me. I wasn't really interested in NES to PC communication, just the ability to control the NES games with a PC peripheral.
<br />
<br />On another forum I had come accross a post where some individual had found one of these cables at a flea market for $1, but sadly it did not work. They had explained to me that it was just a straight through cable, no breakout box or IC's in there!?! Now I know this can't be right... can it?
<br />
<br />From what I understand about the schematics, there are a few IC's, some resistors and a few other things in there.
<br />
<br />Thanks.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Memblers</b> [ Sat Oct 08, 2005 6:40 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><a href="http://nesdev.com/lptnes.zip" class="postlink">http://nesdev.com/lptnes.zip</a>
<br />
<br />I uploaded the file, haven't updated the site index yet though.
<br />
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">On another forum I had come accross a post where some individual had found one of these cables at a flea market for $1, but sadly it did not work.</div>
<br />
<br />It might've been a Miracle piano adapter, I found one of those too and wondered what it was for a while.  I think there is a circuit inside it, looking in one of the tiny holes on the DB25 shell I can see some green (probably a PCB).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DrNES</b> [ Sat Oct 08, 2005 10:40 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The instructions and schematic in that version are a bit easier to understand. The only concept im not grasping is the whole /IRQ [LPT] thing. Were does that connection come from? Its not listed on the LPT pinout.
<br />
<br />Wondering if these wire colors are right:
<br />
<br />Brown = GND
<br />Yellow = CLK
<br />Orange = P/L
<br />Red = Q1
<br />White = +5v
<br />
<br />Thanks.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>sepi</b> [ Sun Oct 09, 2005 3:06 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Doh! it's supposed to be /ACK (pin.9) instead of /IRQ <img src="./images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /> 
<br />
<br />I'm not sure about those colors, you should probably check them with multimeter.
<br />- Sepi

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DrNES</b> [ Sun Oct 09, 2005 9:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, now it all makes sense!  <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />
<br />
<br />Im pretty sure the colors are correct, I checked over a few other pinouts and the colors match the functions.
<br />
<br />I looked up the 4021 datasheet and compiled this out of it:
<br />
<br /><em>Updating Diagram</em>
<br />
<br />Does this wiring look correct?
<br />
<br />Edit: Well, I wired up my cable just like I laid it out in my wiring diagram. When I load up lptnes.exe on my PC and select R to record an NES movie, it asks me for a file name and then to hold reset. I do that and lptnes.exe responds when I release reset saying "Released". This is as far as I can get it to go. The NES does not respond to any keyboard keys pressed, and the log files generated by lptnes.exe are empty.
<br />
<br />Any ideas what maybe wrong with my wiring?
<br />
<br />Edit: When I change the properties of my LPT port from bi-directional (which gives me 0k .NCL files) to ECC or any other setting, I get information being logged into the .NCL file. One .NCL file I logged was 23k in size. Still no response from the NES in any LPT mode.
<br />
<br />Edit: Well, I just spent the last hour or so re-wiring my cable and this time it worked. I am able to control the NES with the keyboard, am able to record NES movies and am able to playback NES movies (they de-sync but thats ok). Now im going to wire up a brand new cable and see if I can reproduce the same results.
<br />
<br />Thanks.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>sepi</b> [ Mon Oct 10, 2005 12:52 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That's great if it works! 
<br />Do you have parasite-power and pull-up resistor connected to /ACK?
<br />for me the internal pull-up was insufficient. Does the reset trapping say ok?
<br />
<br />By the way, which deck you have PAL or NTSC?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DrNES</b> [ Mon Oct 10, 2005 10:40 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have yet to wire in the parasite power and the pull up resistor, I am planning on doing this when I get a few diodes.
<br />
<br />The purpose of the parasite power and pull up resistor is for more acurate reset trapping, is it not? 
<br />
<br />Yes, the reset trapping does say ok. Its kind of neat to release the reset button on the NES and have the PC respond!
<br />
<br />Im using a NTSC console for this modification.
<br />
<br />Now im wondering if it would be possible to get the lptnes.exe source, I would like to be able to re-map my keyboard buttons, and a few other tweaks.
<br />
<br />Edit: Sepi, would you mind posting one of your .NCL files?
<br />
<br />Thanks.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>sepi</b> [ Mon Oct 10, 2005 11:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yup, parasite power keeps the /ACK line in high state even if you press RESET or Power-off, when you release reset button, the pseudo-random numbers get (hopefully) exactly same seed number. However, there is numerous games that still fail sync, even if you trap the reset.
<br />
<br />Actually, i got the idea for the reset trapping from Memblers! They were talking about this at cherryroms hardware forum.
<br />
<br />I'm planning to update the lptnes.exe in future, custom gamekeys is one the features that i'm going to implement. If you have some ideas, it would be great to hear about them!
<br />
<br />I'm not releasing the lptnes.exe source, not just yet. I'm still considering if i'll release it or not.
<br />
<br />Yeah, i'll post few .ncl files to my homepage shortly. They have been recorded with PAL deck/games, there's a change they don't work at all.
<br />
<br />DrNES, i don't have a NTSC deck available, and i need someone with NTSC deck to test if the PAL/NTSC detecting works correctly, would you like to be beta-tester?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>blargg</b> [ Tue Oct 11, 2005 6:45 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I was also thinking of making a movie playback device for my NES and plan on synchronizing by monitoring the joypad clear ($4016.0). Each high-to-low transition would register as a "read current joypad state" event, and these would be the only events that count for anything. This way the timing doesn't matter when playing back, just that the game reads the joypad the same number of times. Maybe this is what you're already doing; if so, what is causing the synchronization problems? If it's random power-on values, on my NES turning the power off for several seconds yields the same initial values in memory.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DrNES</b> [ Tue Oct 11, 2005 9:47 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Im not sure why movies de-sync so often, I remember reading somthing about random resets within the game itself cause this effect.
<br />
<br />Perhaps if the software logged key presses on a strict timeline basis, then it could be played back based on the timing of the key presses. Or if the software could detect these "resets" within the game and adjust the log file to suit more accurate playback.
<br />
<br />Thanks.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>sepi</b> [ Wed Oct 12, 2005 1:10 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yes, that the lptnes does. As the NES transmits a P/S, /ACK line is pulled low thus generating a interrupt.
<br />
<br />For reasons unknown, Bregalad pointed out that some games poll (such as smb3) gamepads twice.
<br />
<br />In the current lptnes version, there's all sort if crap in the interrupt vector. This may cause desyncing, if there is more than one polling in the NMI. Next revision will have "clean" interrupt vector, this might fix some games (or not).
<br />
<br />I belive that the random number generators are the biggest problem; if the random number generator is located off NMI, and|or the gamepad is polled faster than 1/50|60. Maybe i should perform some benchmarking with issue, how fast P/S transients lptnes is cabable to intercept?
<br />
<br />
<br />Tetris is a excellent example; i have never succeeded replaying a movie correctly.
<br />-sepi

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DrNES</b> [ Wed Oct 12, 2005 10:28 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Which version of Tetris have you tested with?
<br />
<br />I tested Tengen Tetris with my cable, it seemed to work rather well. I wasn't recording it like I would play Tetris myself, I was only using 1 or 2 buttons at a time and placing the blocks very slowly.
<br />
<br />Im sure if I kicked it up to full playing speed that it would de-sync very quickly.
<br />
<br />Thanks.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Oct 12, 2005 3:17 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Tetris != Tet—èis. I'd guess that sepi was talking about Nintendo Tetris, the only NES tetramino game to use "Dance of the Sugarplum Fairy" as the background music.
<br />
<br />And does it desync with <a href="http://pics.pineight.com/nes/tetramino%20%28for%20DreamEmulation%29.nes" class="postlink">Tetramino (for DreamEmulation) (PD)</a>?

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>