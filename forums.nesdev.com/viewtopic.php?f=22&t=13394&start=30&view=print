<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - 240p test suite</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">240p test suite</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=22&amp;t=13394">http://forums.nesdev.com/viewtopic.php?f=22&amp;t=13394</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>3</strong> of <strong>12</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Nov 14, 2015 8:13 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />A few days, mikejmoffitt and I were brainstorming alternatives to the Green Hill Zone background for the <a href="http://junkerhq.net/xrgb/index.php/240p_test_suite#Scroll_Test" class="postlink">Scroll Test</a>. This is what I have so far.<br /><br />It could use better clouds and a mountain backdrop. So far I've only used three of the palettes:<br />backdrop: 22<br />grass: 08 1A 29<br />dirt: 08 18 28<br />sky: 08 32 20

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<img src="./download/file.php?id=4423" alt="greenhillzone.png" /><br />
			<span class="gensmall">greenhillzone.png [ 3.73 KiB | Viewed 3390 times ]</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Sat Nov 14, 2015 8:42 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You can always draw inspiration from the reduced complexity renditions of Green Hill Zone from games like Sonic 1 and 2 (GHZ in this game is pretty different though) on the Master System, or Sonic Pocket Adventure on the Neo Geo Pocket, if you want to stay close to the original theme. If you're going for something more original, I think you're on the right track, although the colors could be a little more vibrant.<br /><br />If you're gonna include background mountains, be sure to make them look way less saturated than the foreground. Since you don't have parallax scrolling (unless you plan on adding that?), this is kind necessary to properly convey distance.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Nov 14, 2015 9:00 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">Since you don't have parallax scrolling (unless you plan on adding that?), this is kind necessary to properly convey distance.</div><br />Yes, I have parallax scrolling. Currently the topmost cloud is still (to act as the sprite 0 trigger), the rest of the clouds are at 1/8 speed, the mountains/water is at 1/4 speed, and the ground is at full speed. It'll be a b#### to get right on PAL though. I haven't made anything PAL-friendly yet.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Sat Nov 14, 2015 9:19 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Yes, I have parallax scrolling.</div><br />Ah, cool.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">It'll be a b#### to get right on PAL though.</div><br />Really? If you're interested, I have a &quot;WaitScanlines&quot; function that receives a scanline count in X and waits that many scanlines, adjusting itself automatically to PAL or NTSC based on a flag. I planned on using it for raster effects but haven't had the chance yet. Let me know if you want it and I'll post it. It's nothing out of this world, but since it's ready...<br /><br />BTW, are you using any sprites or can you consider using them for the foreground trees (blowing your sprite budget)?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Nov 14, 2015 10:18 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">If you're interested, I have a &quot;WaitScanlines&quot; function that receives a scanline count in X and waits that many scanlines, adjusting itself automatically to PAL or NTSC based on a flag.</div><br />I'd have to adjust the other parts of the loop as well, such as reading the breakpoint list, dividing the X position by 8, and doing that thing where I combine the current strip's fine scroll with the next strip's coarse scroll to fully avoid glitches. I lack confidence in releasing anything that races the beam that I haven't tested on hardware, and I own no PAL NES.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">BTW, are you using any sprites or can you consider using them for the foreground trees (blowing your sprite budget)?</div><br />I could put foreground trees in &quot;Scroll test&quot;, but they'd blow the sprite budget in &quot;Drop shadow sprite&quot;.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Sat Nov 14, 2015 10:31 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">I'd have to adjust the other parts of the loop as well, such as reading the breakpoint list, dividing the X position by 8, and doing that thing where I combine the current strip's fine scroll with the next strip's coarse scroll to fully avoid glitches.</div><br />Assuming all of that takes a constant amount of time, shouldn't it just be a matter of doing all that, compensating for the scanline duration difference the same way it's done in the &quot;WaitScanlines&quot; subroutine, and then waiting n scanlines until the next split?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">that thing where I combine the current strip's fine scroll with the next strip's coarse scroll to fully avoid glitches</div><br />Not really sure what you mean here.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I lack confidence in releasing anything that races the beam that I haven't tested on hardware, and I own no PAL NES.</div><br />You can always take your best shot with emulators, make it clear that PAL support is experimental, and have people with the proper equipment test it for you, no? Otherwise you're never going to support PAL consoles.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Nov 14, 2015 11:10 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent"><div class="quotetitle">tepples wrote:</div><div class="quotecontent">I'd have to adjust the other parts of the loop as well, such as reading the breakpoint list, dividing the X position by 8, and doing that thing where I combine the current strip's fine scroll with the next strip's coarse scroll to fully avoid glitches.</div><br />Assuming all of that takes a constant amount of time</div><br />The table specifies a right shift of 0, 2, or 3 bits. Currently I loop, but making this take constant time is doable if necessary.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">that thing where I combine the current strip's fine scroll with the next strip's coarse scroll to fully avoid glitches</div><br />Not really sure what you mean here.</div><br />Because I'm not changing the vertical scroll, I'm writing only to $2000 and $2005. Changes to the coarse horizontal scroll ($2000 bit 0 and $2005 first write bits 7-3) have to go in before horizontal blanking, but changes to the fine horizontal scroll ($2005 first write bits 2-0) have to go in after horizontal blanking. So on the last line of a strip, the line immediately before the split, I write the current strip's fine scroll with the next strip's coarse scroll, then later (during vblank), I write the next strip's complete scroll.<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">;;<br />; Sets the horizontal scroll position to A:X.<br />.proc set_xscroll_midscreen<br />onesplit:<br />&nbsp; and #$01<br />&nbsp; ora #VBLANK_NMI|BG_0000|OBJ_1000<br />&nbsp; sta PPUCTRL<br />&nbsp; txa<br />&nbsp; and #$F8<br />&nbsp; ora lastfinex<br />&nbsp; ; Set the current fine scroll with the next coarse scroll, because<br />&nbsp; ; fine scroll takes effect immediately whereas coarse scroll waits<br />&nbsp; ; for x=256<br />&nbsp; sta PPUSCROLL<br />&nbsp; sta PPUSCROLL<br />&nbsp; ; Now waste a bit of time waiting for hblank<br />&nbsp; txa<br />&nbsp; and #$07<br />&nbsp; sta lastfinex<br />&nbsp; jsr waste12<br />&nbsp; stx PPUSCROLL&nbsp; ; Set the fine scroll during hblank<br />&nbsp; stx PPUSCROLL<br />waste12:<br />&nbsp; rts<br />.endproc<br /></div><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">You can always take your best shot with emulators, make it clear that PAL support is experimental, and have people with the proper equipment test it for you, no? Otherwise you're never going to support PAL consoles.</div><br />I am willing to support this iff there are both A. demand and B. a willing tester who can load builds immediately. But with the reduced prestige of PAL NES, getting it feature complete for NTSC takes priority. After all, it's not called the 288p test suite.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Sat Nov 14, 2015 11:39 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Oh, I get it now. Since you're not using $2006, the coarse scroll doesn't change when you finish the writes, but when the PPU does v:0000010000011111=t:0000010000011111, so you have to do the $2005 write before that, but since the fine X scroll changes immediately, you can't update that part at the same time. Got it.<br /><br />Anyway, landing a couple of PPU writes on hblank shouldn't be so hard, there's quite a bit of tolerance there.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Nov 16, 2015 12:06 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Here's what mikejmoffitt did to my pseudo green hill zone.<div class="attachtitle">Attachment:</div><div class="attachcontent">
			<img src="./download/file.php?id=4432" alt="greenhillzone.png" /><br />
			<span class="gensmall">greenhillzone.png [ 5.83 KiB | Viewed 3291 times ]</span>
		

		<br />
	</div><br /><br />I have only a few final checks before I release 0.04.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Nov 16, 2015 12:53 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />With new graphics in hand, I announce <strong>240p test suite 0.04</strong><br /><br />0.04 (2015-11-16)<br /><br /><ul><li>IRE: Added emphasis and $2D/$3D grays </li><li>Shadow sprite: Added full functionality </li><li>Added Hill zone scroll test with Green Hill Zone-inspired background by mikejmoffitt </li><li>Sound test: Added pulse beep (requested by mikejmoffitt) </li><li>Full README file </li></ul><br />We seek experts in the following:<br /><br /><ul><li>Testing on PAL NES </li><li>Testing on Dendy </li><li>Testing with high-quality displays and scalers </li><li>Measuring the actual IRE levels of NES video with an oscilloscope </li><li>Putting 27C512 onto an UNROM-compatible board </li></ul>

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=4438">240pee-0.04.zip</a> [129.95 KiB]
			</span><br />
			<span class="gensmall">Downloaded 133 times</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Mon Nov 16, 2015 1:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Measuring the actual IRE levels of NES video with an oscilloscope<br /></div>Make me a subset/variant that I can flash onto an 8KiB PRG EEPROM on a mapper 218 (CHRless) card and I will do this.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Mon Nov 16, 2015 2:45 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Testing on PAL NES</div><br />Was there anything in particular that you wanted to be tested?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Nov 16, 2015 8:43 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />In the current build, you can try these:<br /><ul><li>Color bleed to see what PAL does with horizontal, vertical, and diagonal lines </li><li>Linearity to see whether it recognizes PAL's aspect ratio </li><li>Overscan to confirm that 2 pixels on the left and right are already hidden </li><li>Shadow sprite: Press A+Up to switch to a striped shadow, then press A to switch among horizontal, vertical, and diagonal stripe patterns and see what they do to the portrait. </li></ul><br />Here's a tentative list of changes I'll need to make for PAL support in the next build:<br /><ul><li>Color bleed, Full screen stripes: Wrap frame counter at 50 instead of 60 on PAL NES and Dendy </li><li>Stopwatch: Wrap frame counter at 50 instead of 60 on PAL NES and Dendy </li><li>Hill zone scroll test: Reduce all delays by 6.25% on PAL NES only </li><li>Sound test: Decrease tone period slightly to more closely approximate 1 kHz on PAL NES only </li></ul><br />I hope to get to PAL over the next few days.<br /><br />Here's a 1K IRE-only test, compatible with mapper 7 and (presumably) 218. The copy of FCEUX on my PC doesn't appear to support 218 at all.

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=4441">iretiny-0.01.zip</a> [14.91 KiB]
			</span><br />
			<span class="gensmall">Downloaded 117 times</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Mon Nov 16, 2015 9:42 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Here's the measurements into the 75.1Ω of my television:<br /><br />SYNC: 48 mV / -37 IRE <br />CBL: 148 mV / -23 IRE<br />0D: 228 mV / -12 IRE<br />1D: 312 mV / ≡ 0 IRE<br />CBH: 524 mV / 30 IRE<br />2D: 552 mV / 34 IRE<br />00: 616 mV / 43 IRE<br />10: 840 mV / 74 IRE<br />3D: 880 mV / 80 IRE<br />20: 1100 mV / 110 IRE<br />0Dem: 192 mV / -17 IRE<br />1Dem: 256 mV / -8 IRE<br />2Dem: 448 mV / 19 IRE<br />00em: 500 mV / 26 IRE<br />10em: 676 mV / 51 IRE<br />3Dem: 712 mV / 56 IRE<br />20em: 896 mV / 82 IRE<br /><br />There was about 10mV of noise (and 4mV of quantization error) that I could never quite fully get rid of, so the numbers here should be taken as having an error of ± 2 IRE.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Tue Nov 17, 2015 4:04 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: 240p test suite</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Putting 27C512 onto an UNROM-compatible board<br /></div>I'm curious: why are you specifically calling this out?<br /><br />This is a very simple thing, so why explicitly mention the 'PROM technology?

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>3</strong> of <strong>12</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>