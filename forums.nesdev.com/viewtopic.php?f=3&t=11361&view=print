<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Nestopia and Ninja Gaiden/Burai Fighter</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Nestopia and Ninja Gaiden/Burai Fighter</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=11361">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=11361</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>7</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Tue Jun 24, 2014 11:07 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Just trying to figure out what nestopia could be doing wrong here. In the Japanese version of Burai Fighter the status bar at the bottom of the screen is as it should be. On Burai Fighter american version you get this:<br /><br /><br /><div class="attachtitle">Attachment:</div><div class="attachcontent">
			<img src="./download/file.php?id=1661" alt="9a35d62c-f9ee-11e3-8c2f-025d77e34ca7.png" /><br />
			<span class="gensmall">9a35d62c-f9ee-11e3-8c2f-025d77e34ca7.png [ 2.83 KiB | Viewed 716 times ]</span>
		

		<br />
	</div><br /><br /><br /><br />Also on ninja gaiden (u) you also have a chunk of the moon missing in the first cutscene while in the japanese version you do not. Any chance these two games with issues could be related. Weird how the japanese versions work great and the us not so great. I backtracked through all the nestopia releases i could and NOT ONE has ever played burai fighter correctly with the whole status bar showing. Seems like something is clipping the edges off.<br /><br />Maybe some other devs can possibly shed some light on this issue. I also wonder if this has anything to do with some of the timer being clipped on hard drivin as well.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>zxbdragon</b> [ Tue Jun 24, 2014 7:58 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">*Spitfire_NES* wrote:</div><div class="quotecontent">Just trying to figure out what nestopia could be doing wrong here. In the Japanese version of Burai Fighter the status bar at the bottom of the screen is as it should be. On Burai Fighter american version you get this:<br /><br /><br /><div class="attachtitle">Attachment:</div><div class="attachcontent"><!-- ia0 -->9a35d62c-f9ee-11e3-8c2f-025d77e34ca7.png<!-- ia0 --></div><br /><br /><br /><br />Also on ninja gaiden (u) you also have a chunk of the moon missing in the first cutscene while in the japanese version you do not. Any chance these two games with issues could be related. Weird how the japanese versions work great and the us not so great. I backtracked through all the nestopia releases i could and NOT ONE has ever played burai fighter correctly with the whole status bar showing. Seems like something is clipping the edges off.<br /><br />Maybe some other devs can possibly shed some light on this issue. I also wonder if this has anything to do with some of the timer being clipped on hard drivin as well.</div><br /><br /><br />...........You are joepogo ?<br /><br />Compare fceumm and fceux the ppu....

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Wed Jun 25, 2014 3:48 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">*Spitfire_NES* wrote:</div><div class="quotecontent">Just trying to figure out what nestopia could be doing wrong here. In the Japanese version of Burai Fighter the status bar at the bottom of the screen is as it should be. On Burai Fighter american version you get this:<br /><div class="attachtitle">Attachment:</div><div class="attachcontent"><!-- ia0 -->9a35d62c-f9ee-11e3-8c2f-025d77e34ca7.png<!-- ia0 --></div><br /></div><br />Looks like the 2nd scanline IRQ is firing too early. Maybe the game depends on a specific MMC3 IRQ behavior? Just a random guess. puNES 0.63 has the exact same problem<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Also on ninja gaiden (u) you also have a chunk of the moon missing in the first cutscene while in the japanese version you do not. Any chance these two games with issues could be related. Weird how the japanese versions work great and the us not so great. I backtracked through all the nestopia releases i could and NOT ONE has ever played burai fighter correctly with the whole status bar showing. Seems like something is clipping the edges off.</div><br />I doubt this is related to the first issue. In this case, a single byte in the attribute table gets messed up for some reason. Same bug shows up in Nintendulator, with slightly different results. The game may be doing something unorthodox, like writing to PPU with rendering on, causing each emulator to interpret the situation slightly differently.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Wed Jun 25, 2014 2:04 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">thefox wrote:</div><div class="quotecontent"><div class="quotetitle">*Spitfire_NES* wrote:</div><div class="quotecontent">Just trying to figure out what nestopia could be doing wrong here. In the Japanese version of Burai Fighter the status bar at the bottom of the screen is as it should be. On Burai Fighter american version you get this:<br /><div class="attachtitle">Attachment:</div><div class="attachcontent"><!-- ia0 -->9a35d62c-f9ee-11e3-8c2f-025d77e34ca7.png<!-- ia0 --></div><br /></div><br />Looks like the 2nd scanline IRQ is firing too early. Maybe the game depends on a specific MMC3 IRQ behavior? Just a random guess. puNES 0.63 has the exact same problem<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Also on ninja gaiden (u) you also have a chunk of the moon missing in the first cutscene while in the japanese version you do not. Any chance these two games with issues could be related. Weird how the japanese versions work great and the us not so great. I backtracked through all the nestopia releases i could and NOT ONE has ever played burai fighter correctly with the whole status bar showing. Seems like something is clipping the edges off.</div><br />I doubt this is related to the first issue. In this case, a single byte in the attribute table gets messed up for some reason. Same bug shows up in Nintendulator, with slightly different results. The game may be doing something unorthodox, like writing to PPU with rendering on, causing each emulator to interpret the situation slightly differently.</div><br /><br />Thanks fox for answering. Please excuse my noobness, but does it have anything to do with this at least regarding the burai figher issue? I think this discovery will fix mickeys safari in letterland no doubt as well with the status bar being jumpy. <br /><br /><!-- l --><a class="postlink-local" href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=10439">viewtopic.php?f=3&amp;t=10439</a><!-- l -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Wed Jun 25, 2014 2:20 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">*Spitfire_NES* wrote:</div><div class="quotecontent">Thanks fox for answering. Please excuse my noobness, but does it have anything to do with this at least regarding the burai figher issue? I think this discovery will fix mickeys safari in letterland no doubt as well with the status bar being jumpy.</div><br />No idea. Every emulator I have tried has the same problem with Mickey (puNES, Nintendulator, Nestopia).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Wed Jun 25, 2014 2:24 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />sorry i did not clarify what i was asking better.  <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />  I guess what i mean is regarding the link i posted, is this something that will benefit the burai fighter issue? Seems like james found undocumented behavior but maybe that is only regarding the rambo mapper. Nestopia is hard to navigate through for me, but maybe the i need to be looking at the mmc3 code, since i think burai fighter is mmc3 IIRC.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>James</b> [ Wed Jun 25, 2014 2:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That linked behavior won't help with this game.<br /><br />Mickey's Safari in Letterland works fine with nemulator. It requires really precise IRQ timing.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Wed Jun 25, 2014 2:31 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">James wrote:</div><div class="quotecontent">That linked behavior won't help with this game.<br /><br />Mickey's Safari in Letterland works fine with nemulator. It requires really precise IRQ timing.</div><br /><br /><br />Thank you james, thats what i was thinking. Im going to find a way to get these fixes in for those 3 above mentioned games. As far as burai fighter goes, this will prob help me:<br /><br /><!-- m --><a class="postlink" href="http://sourceforge.net/p/fceultra/bugs/382/">http://sourceforge.net/p/fceultra/bugs/382/</a><!-- m --><br /><br />ill start from here since these 2 issues seem to be the same, or used to be until fce fixed it. Just trying to pinpoint exactly what the issue is regarding burai fighter first, thats all. <br /><br />and by the way GREAT WORK on everything you have done for the emulation scene james!  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" />   <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>FHorse</b> [ Wed Jun 25, 2014 4:59 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">thefox wrote:</div><div class="quotecontent">No idea. Every emulator I have tried has the same problem with Mickey (puNES, Nintendulator, Nestopia).</div>Strange, I thought I had fixed this problem several versions ago. Thefox  which version of puNES have you tried? The latest (0.89)?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>vuehbwhq</b> [ Wed Jun 25, 2014 10:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">FHorse wrote:</div><div class="quotecontent"><div class="quotetitle">thefox wrote:</div><div class="quotecontent">No idea. Every emulator I have tried has the same problem with Mickey (puNES, Nintendulator, Nestopia).</div>Strange, I thought I had fixed this problem several versions ago. Thefox  which version of puNES have you tried? The latest (0.89)?</div><br />Indeed, it's working fine in puNES. But Burai Fighter isn't.<br /><br /><img src="http://copy.com/2hb3RDi22Os4/IRQ.GIF" alt="Image" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Thu Jun 26, 2014 5:01 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">FHorse wrote:</div><div class="quotecontent"><div class="quotetitle">thefox wrote:</div><div class="quotecontent">No idea. Every emulator I have tried has the same problem with Mickey (puNES, Nintendulator, Nestopia).</div>Strange, I thought I had fixed this problem several versions ago. Thefox  which version of puNES have you tried? The latest (0.89)?</div><br />Yeah sorry, I was using an old version.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>James</b> [ Thu Jun 26, 2014 2:48 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">*Spitfire_NES* wrote:</div><div class="quotecontent">and by the way GREAT WORK on everything you have done for the emulation scene james!  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" />   <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div><br />Thanks!  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" /><br /><br />Burai Fighter is broken in nemulator too.  I'll look into it when I have some time.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Thu Jun 26, 2014 5:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">James wrote:</div><div class="quotecontent"><div class="quotetitle">*Spitfire_NES* wrote:</div><div class="quotecontent">and by the way GREAT WORK on everything you have done for the emulation scene james!  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" />   <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div><br />Thanks!  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" /><br /><br />Burai Fighter is broken in nemulator too.  I'll look into it when I have some time.</div><br /><br />sweet! in the meantime i decided to start with ninja gaiden diffing code between 1.39 and 1.40, in 1.39 and have a question for whoever can or may put some light on this. <br /><br />At initial glance at the code, the mmc1 mapper was not modified going into 1.39 to 1.40, in other words the code was left unchanged, regarding the missing chunk of moon should i move efforts to diff code to the ppu instead? This does have changes going from 1.39 to 1.40, im not sure where else he could have done something to mess up the intro like that., also he did make some changes to the apu as well going from 1.39 to 1.40.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>James</b> [ Sat Jun 28, 2014 8:43 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Burai Fighter has two MMC3 IRQs per frame: one at the top of the status bar and another at the bottom. In between, there are a couple of reads to PPU memory &gt; $3000 via $2006/$2007. These reads, if not properly mirrored to $2xxx, will cause A12 to go high and clock the IRQ counter, making the second IRQ fire a couple of scanlines too early.  I fixed this mirroring in my emulator and Burai Fighter looks good now:<br /><br /><img src="http://nemulator.com/images/burai.png" alt="Image" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Sat Jun 28, 2014 1:09 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thank you james for sharing that. Im going to try to implement this into nestopia. Pm sent. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />It sounds easy to do and id like to get this fix into nestopia as well. Thank you for sharing this info. Im working on trying to sort out these 3 games as we speak.  <img src="./images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" />

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>7</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>