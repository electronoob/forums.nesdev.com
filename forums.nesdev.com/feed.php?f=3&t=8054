<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=8054" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2011-08-25T20:44:10-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=8054</id>
<entry>
<author><name><![CDATA[Jarhmander]]></name></author>
<updated>2011-08-25T20:44:10-07:00</updated>
<published>2011-08-25T20:44:10-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83123#p83123</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83123#p83123"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83123#p83123"><![CDATA[
<div class="quotetitle">James wrote:</div><div class="quotecontent"><br /><div class="quotetitle">thefox wrote:</div><div class="quotecontent">but that glitching might actually be correct behaviour<br /></div><br />it is</div><br />Confirmed with the original game in my toaster. Bad scanline.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=336">Jarhmander</a> — Thu Aug 25, 2011 8:44 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[jwdonal]]></name></author>
<updated>2011-08-23T11:29:38-07:00</updated>
<published>2011-08-23T11:29:38-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83046#p83046</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83046#p83046"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83046#p83046"><![CDATA[
<div class="quotetitle">tepples wrote:</div><div class="quotecontent"><br />From <a href="http://wiki.nesdev.com/w/index.php/Game_bugs" class="postlink">Game bugs</a>: "On the boss select screen, the scanline above Shadow Man looks wrong."<br /></div><br />Oh dang, I didn't even know that page existed.  Awesome.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3962">jwdonal</a> — Tue Aug 23, 2011 11:29 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2011-08-23T11:23:11-07:00</updated>
<published>2011-08-23T11:23:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83045#p83045</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83045#p83045"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83045#p83045"><![CDATA[
From <a href="http://wiki.nesdev.com/w/index.php/Game_bugs" class="postlink">Game bugs</a>: "On the boss select screen, the scanline above Shadow Man looks wrong."<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Tue Aug 23, 2011 11:23 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[James]]></name></author>
<updated>2011-08-23T11:19:01-07:00</updated>
<published>2011-08-23T11:19:01-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83044#p83044</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83044#p83044"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83044#p83044"><![CDATA[
<div class="quotetitle">thefox wrote:</div><div class="quotecontent"><br />but that glitching might actually be correct behaviour<br /></div><br />it is<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=88">James</a> — Tue Aug 23, 2011 11:19 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[thefox]]></name></author>
<updated>2011-08-23T11:13:24-07:00</updated>
<published>2011-08-23T11:13:24-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83043#p83043</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83043#p83043"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83043#p83043"><![CDATA[
<div class="quotetitle">plasturion wrote:</div><div class="quotecontent"><br />I noticed that nestopia has something maybe similar bad, but boss selection screen has one shaking line like this (probably on split screen)... <br /><img src="http://www.detach.republika.pl/rockman3.gif" alt="Image" /><br />...do you think is this similar IRQ timing issue (so what exactly you corrected, what is current value) or is this more scrolling issue?<br /></div><br />It's definitely related to IRQ timing, but that glitching might actually be correct behaviour. Nintendulator also renders it exactly the same way as Nestopia. I would wait for somebody with the actual cart to confirm it's not supposed to look like that before trying to "fix" it. There are a lot of games which have glitches like this when using the original carts (SMB3, for instance).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=80">thefox</a> — Tue Aug 23, 2011 11:13 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[plasturion]]></name></author>
<updated>2011-08-23T10:46:51-07:00</updated>
<published>2011-08-23T10:46:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83040#p83040</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83040#p83040"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83040#p83040"><![CDATA[
I noticed that nestopia has something maybe similar bad, but boss selection screen has one shaking line like this (probably on split screen)... <br /><img src="http://www.detach.republika.pl/rockman3.gif" alt="Image" /><br />...do you think is this similar IRQ timing issue (so what exactly you corrected, what is current value) or is this more scrolling issue?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4887">plasturion</a> — Tue Aug 23, 2011 10:46 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[beannaich]]></name></author>
<updated>2011-08-23T00:20:08-07:00</updated>
<published>2011-08-23T00:20:08-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83022#p83022</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83022#p83022"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83022#p83022"><![CDATA[
@Tokumaru: I wasn't asking how to get an attribute byte address, I am already loading them <img src="http://forums.nesdev.com/images/smilies/icon_razz.gif" alt=":P" title="Razz" /> The problem is that when I scroll, the attribute bytes don't scroll along with the bit planes when I render.<br /><br />@jwdonal: I fixed the error, I just had to fix the timing of the IRQ.<br /><br />EDIT: Fixed the problem, I just render the tiles normally, and apply x scroll to the index of the color buffer that pixel is assigned to. Works like butter now <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> Thanks for the help, as always!<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4320">beannaich</a> — Tue Aug 23, 2011 12:20 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[jwdonal]]></name></author>
<updated>2011-08-22T16:23:17-07:00</updated>
<published>2011-08-22T16:23:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83008#p83008</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83008#p83008"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83008#p83008"><![CDATA[
<div class="quotetitle">Dwedit wrote:</div><div class="quotecontent"><br />Looks more like an MMC3 IRQ glitch than a scrolling glitch.<br /></div><br />I use to have the exact same glitch in the same game in my emu and it was indeed a problem with the MMC3 IRQ.  But I don't remember precisely what I had to do to fix it. Sorry. <img src="http://forums.nesdev.com/images/smilies/icon_sad.gif" alt=":(" title="Sad" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3962">jwdonal</a> — Mon Aug 22, 2011 4:23 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tokumaru]]></name></author>
<updated>2011-08-22T15:34:06-07:00</updated>
<published>2011-08-22T15:34:06-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83003#p83003</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83003#p83003"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83003#p83003"><![CDATA[
If you know the address of the tile you are rendering (and you have to!) you can easily compute the address of the attribute byte that affects it. Tile addresses have the following format:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0010NNYYYYYXXXXX<br /><br />XXXXX - X coordinate &#40;0 to 31&#41;<br />YYYYY - Y coordinate &#40;0 to 29&#41;<br />NN - name table;</div><br /><br />And here's the format for attribute table addresses:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0010NN1111YYYXXX<br /><br />XXX - upper bits of the X coordinate;<br />YYY - upper bits of the Y coordinate;<br />NN - name table;</div><br /><br />All you have to do is convert addresses from one format to the other, using bit shifts and logical operations.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=95">tokumaru</a> — Mon Aug 22, 2011 3:34 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[3gengames]]></name></author>
<updated>2011-08-22T14:54:07-07:00</updated>
<published>2011-08-22T14:54:07-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83000#p83000</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83000#p83000"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=83000#p83000"><![CDATA[
You just need some extra math. If the tile your rendering is off the next name table to the right, add 1KB to the location you grab it from. If below, add 2KB. If both, add 3KB too the value. Something like that should work, of course there's more conditions for rendering, but it should work just fine....<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4311">3gengames</a> — Mon Aug 22, 2011 2:54 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[beannaich]]></name></author>
<updated>2011-08-22T14:37:24-07:00</updated>
<published>2011-08-22T14:37:24-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82999#p82999</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82999#p82999"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82999#p82999"><![CDATA[
<div class="quotetitle">3gengames wrote:</div><div class="quotecontent"><br />How about generate the screens as 1 giant bitmap and scroll over that? Would that be too hard?<br /></div><br /><br />It wouldn't be hard, but I am developing in C#.. So speed and shortcuts trump everything! <img src="http://forums.nesdev.com/images/smilies/icon_razz.gif" alt=":P" title="Razz" /> I know I either need to come up with a different solution to this, or make the attributes scroll with the tiles.. How? I have no idea.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4320">beannaich</a> — Mon Aug 22, 2011 2:37 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[3gengames]]></name></author>
<updated>2011-08-22T14:30:39-07:00</updated>
<published>2011-08-22T14:30:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82998#p82998</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82998#p82998"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82998#p82998"><![CDATA[
How about generate the screens as 1 giant bitmap and scroll over that? Would that be too hard?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4311">3gengames</a> — Mon Aug 22, 2011 2:30 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[beannaich]]></name></author>
<updated>2011-08-22T14:30:47-07:00</updated>
<published>2011-08-22T14:27:05-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82996#p82996</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82996#p82996"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82996#p82996"><![CDATA[
Nice call, Dwedit! <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br />Now I need to figure out this Attribute artifacting, I know _why_ it's happening, but I don't really know how to fix it :/<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">private void FetchBkgAttr&#40;&#41;<br />&#123;<br />    this.bkgData&#91;2&#93;.Attr = this.PpuRam&#91;addr: this.bkgData&#91;2&#93;.AttrAddr&#93;;<br />    this.bkgData&#91;2&#93;.Attr = this.bkgData&#91;2&#93;.Attr &gt;&gt; &#40;&#40;this.bkgData&#91;2&#93;.NameAddr &gt;&gt; 4 &amp; 0x04&#41; | &#40;this.bkgData&#91;2&#93;.NameAddr &amp; 0x02&#41;&#41;;<br />&#125;<br />private void FetchBkgBit0&#40;&#41;<br />&#123;<br />    var data = this.PpuRam&#91;addr: this.bkgData&#91;2&#93;.Bit0Addr&#93;;<br /><br />    this.bkgData&#91;1&#93;.Bit0 |= &#40;data &gt;&gt; &#40;8 - scrollX&#41;&#41;;<br />    this.bkgData&#91;2&#93;.Bit0  = &#40;data &lt;&lt; scrollX&#41;;<br />&#125;<br />private void FetchBkgBit1&#40;&#41;<br />&#123;<br />    var data = this.PpuRam&#91;addr: this.bkgData&#91;2&#93;.Bit1Addr&#93;;<br /><br />    this.bkgData&#91;1&#93;.Bit1 |= &#40;data &gt;&gt; &#40;8 - scrollX&#41;&#41;;<br />    this.bkgData&#91;2&#93;.Bit1 = &#40;data &lt;&lt; scrollX&#41;;<br />&#125;</div><br /><br />I know the way I'm handling fine x scrolling is probably completely screwed up (Fusing 2 tiles together seemed to be the only workable solution); is there a better way to go about this, that will in turn remedy the attribute artifact issue?<br /><br />EDIT: Here is the background tile rendering routine:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">private int RenderBkgPixel&#40;&#41;<br />&#123;<br />    var palAddr =<br />        &#40;bkgData&#91;0&#93;.Attr &lt;&lt; 0x02 &amp; 0x0C&#41; |<br />        &#40;bkgData&#91;0&#93;.Bit0 &gt;&gt; 0x07 &amp; 0x01&#41; |<br />        &#40;bkgData&#91;0&#93;.Bit1 &gt;&gt; 0x06 &amp; 0x02&#41;;<br /><br />    bkgData&#91;0&#93;.Bit0 = bkgData&#91;0&#93;.Bit0 &lt;&lt; 1;<br />    bkgData&#91;0&#93;.Bit1 = bkgData&#91;0&#93;.Bit1 &lt;&lt; 1;<br /><br />    return palAddr;<br />&#125;</div><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4320">beannaich</a> — Mon Aug 22, 2011 2:27 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Dwedit]]></name></author>
<updated>2011-08-22T13:28:13-07:00</updated>
<published>2011-08-22T13:28:13-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82992#p82992</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82992#p82992"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82992#p82992"><![CDATA[
Looks more like an MMC3 IRQ glitch than a scrolling glitch.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=53">Dwedit</a> — Mon Aug 22, 2011 1:28 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[3gengames]]></name></author>
<updated>2011-08-22T13:06:11-07:00</updated>
<published>2011-08-22T13:06:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82991#p82991</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82991#p82991"/>
<title type="html"><![CDATA[PPU Glitches (FIXED)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8054&amp;p=82991#p82991"><![CDATA[
I am not sure, but is it possible that the scroll changing for that bottom row is making your PPU code mess up somewhere and do the same output twice?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4311">3gengames</a> — Mon Aug 22, 2011 1:06 pm</p><hr />
]]></content>
</entry>
</feed>