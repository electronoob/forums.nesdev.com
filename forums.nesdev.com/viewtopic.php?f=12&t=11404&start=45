<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - BGMODE or parameter changes during scanline</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - SNESdev" href="http://forums.nesdev.com/feed.php?f=12" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - BGMODE or parameter changes during scanline" href="http://forums.nesdev.com/feed.php?f=12&amp;t=11404" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '4');
	var per_page = '15';
	var base_url = './viewtopic.php?f=12&amp;t=11404';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



	/**
	* Play quicktime file by determining it's width/height
	* from the displayed rectangle area
	*
	* Only defined if there is a file block present.
	*/
	function play_qt_file(obj)
	{
		var rectangle = obj.GetRectangle();

		if (rectangle)
		{
			rectangle = rectangle.split(',')
			var x1 = parseInt(rectangle[0]);
			var x2 = parseInt(rectangle[2]);
			var y1 = parseInt(rectangle[1]);
			var y2 = parseInt(rectangle[3]);

			var width = (x1 < 0) ? (x1 * -1) + x2 : x2 - x1;
			var height = (y1 < 0) ? (y1 * -1) + y2 : y2 - y1;
		}
		else
		{
			var width = 200;
			var height = 0;
		}

		obj.width = width;
		obj.height = height + 16;

		obj.SetControllerVisible(true);

		obj.Play();
	}


// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=register"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Mon May 11, 2015 2:30 am<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=25">Other</a> &#187; <a href="./viewforum.php?f=12">SNESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />

<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=12&amp;t=11404&amp;start=45">BGMODE or parameter changes during scanline</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=12"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=12&amp;t=11404"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>4</strong> of <strong>8</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 111 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=12&amp;t=11404&amp;start=30">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=12&amp;t=11404">1</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=15">2</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=30">3</a><span class="page-sep">, </span><strong>4</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=60">5</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=75">6</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=90">7</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=105">8</a> &nbsp;<a href="./viewtopic.php?f=12&amp;t=11404&amp;start=60">Next</a></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=12&amp;t=11404&amp;start=45&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=12&amp;t=11404&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=12&amp;t=11404&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p131624"></a>
				<b class="postauthor">byuu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131624">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131624#p131624"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jul 27, 2014 11:09 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Mar 27, 2006 5:23 pm<br /><b>Posts:</b> 871
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Not that surprising that the '90s homebrew scene would do wild stuff like this.<br /><br />It's a shame all they were capable of were shitty text scrollers and trainers. They could have made some awesome games if they were able to get past their leet-speak and put their skills to productive use.<br /><br />Anyway ... is anyone willing to record a video of this being run on real hardware? I don't want to dig out my copier gear, and I don't understand AB's explanation of &quot;left 9 1's&quot;, but I'd like to see how close I am.<br /><br />No surprise I don't emulate it properly, though. It's ... really, really extreme to change the BGMODE mid-scanline, and there was zero chance in hell I was going to guess the right way to do it with no actual testing.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=375"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p131625"></a>
				<b class="postauthor" style="color: #AA0000">koitsu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131625">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131625#p131625"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jul 27, 2014 11:31 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Site Admin</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3.png" width="100" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 9:28 pm<br /><b>Posts:</b> 2391<br /><b>Location:</b> Mountain View, CA, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">byuu wrote:</div><div class="quotecontent">Anyway ... is anyone willing to record a video of this being run on real hardware? I don't want to dig out my copier gear, and I don't understand AB's explanation of &quot;left 9 1's&quot;, but I'd like to see how close I am.</div><br />I can get around to doing this during the coming week (my SNES, AV S-Video cable, SWC DX2, and USB floppy drive are all readily available.  I just gotta find working floppies... :-) ).<br /><br />I remember the demo in question, but it's been over 20 years since I've seen it.  True nostalgia, ahhhh!  I just hope it doesn't utilise any of the high-res stuff, because I don't think my USB-based capture device will work with that.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p131627"></a>
				<b class="postauthor">Augustus Blackheart</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131627">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131627#p131627"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jul 27, 2014 12:43 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Jul 26, 2014 9:50 am<br /><b>Posts:</b> 22
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">byuu wrote:</div><div class="quotecontent">Anyway ... is anyone willing to record a video of this being run on real hardware? I don't want to dig out my copier gear, and I don't understand AB's explanation of &quot;left 9 1's&quot;, but I'd like to see how close I am.</div><br /><br />Here's a picture, the yellow stripe is the part of the screen that is messed up.<br /><br /><img src="http://www.morganleahrecords.com/augustus/blackheart/tmp/mtest.png" alt="Image" /><br /><br />Here's some shaky cam video:<br /><br /><a href="http://www.morganleahrecords.com/augustus/blackheart/tmp/mtest.mp4" class="postlink">http://www.morganleahrecords.com/augustus/blackheart/tmp/mtest.mp4</a><br /><a href="http://www.morganleahrecords.com/augustus/blackheart/tmp/horiz.mp4" class="postlink">http://www.morganleahrecords.com/augustus/blackheart/tmp/horiz.mp4</a><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">No surprise I don't emulate it properly, though. It's ... really, really extreme to change the BGMODE mid-scanline, and there was zero chance in hell I was going to guess the right way to do it with no actual testing.</div><br /><br />Snes9x just shows the large logo on the left, the sprites and the scroll text; no plasma effect.   ZSNES just shows the large logo very, very slowly moving.  It is rather nice how much higan gets right.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6621"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p131650"></a>
				<b class="postauthor">psycopathicteen</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131650">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131650#p131650"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jul 27, 2014 7:55 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed May 19, 2010 6:12 pm<br /><b>Posts:</b> 1106
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">This is great news!  This means you can have huge rotating and scaling bosses, with a background behind it, by mid-screen mode changes, and using sprites to patch up the background.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4383"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p131651"></a>
				<b class="postauthor">KungFuFurby</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131651">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131651#p131651"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jul 27, 2014 8:20 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Jul 09, 2008 8:46 pm<br /><b>Posts:</b> 156
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Excellent. Now I can give in to temptation to have more than one zoom level per scanline...  <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br />I can see why there is chaos when the BGMODE is being changed mid-scanline. There's only four cycles per dot, and it looks like the effects are near-instantaneous or instantaneous once the register is written to.<br /><br />I can see that type of graphcal chaos coming into some sort of use... maybe after blacking it out first. Kind of like some sort of weird rip in the fabric of time.<br /><br />Edit: I got another lightbulb! This glitchy effect can also be masked if you have matching colors between both tiles where you intend on performing your mid-scanline magic.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3572"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p131683"></a>
				<b class="postauthor">93143</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131683">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131683#p131683"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Jul 28, 2014 3:19 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Jul 04, 2014 9:31 pm<br /><b>Posts:</b> 214
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Hmm...  It looks like my test program has about three tiles worth of garbage, but the Anthrox demo seems to have five.<br /><br />I hope this has more to do with the HDMA &quot;plasma&quot; effect than the fact that the Mode 7 layer is actually doing something, or the fact that actual code is running in between BGMODE writes...<br /><br />Also, it occurs to me that I may want to be able to change the scroll position on BG1 during the interrupt.  I have to focus on work for a bit, but it doesn't seem like an especially difficult modification to make, so I will probably try it anyway...</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6595"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p131685"></a>
				<b class="postauthor">byuu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131685">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131685#p131685"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Jul 28, 2014 4:09 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Mar 27, 2006 5:23 pm<br /><b>Posts:</b> 871
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">&gt; I can get around to doing this during the coming week<br /><br />Thank you! That'll definitely be helpful.<br /><br />&gt; Here's a picture, the yellow stripe is the part of the screen that is messed up.<br /><br />Oh, those are indeed 1's. Didn't notice. Okay, your initial response makes sense now. But I was actually referring to the Anthrox demo, atx2. I was wondering how that is supposed to look on hardware. The text isn't really readable with higan. I can't imagine they'd release it if the text were unreadable.<br /><br />EDIT: oh, horiz.mp4 is Anthrox. But ... there's no sprite border in the middle, and almost all of the text written on the right-hand side is gone. Are you using the same MODE7.SMC file? If not, where can I get the ROM you are running, or could you please do a video of the ROM I am using (the one pictured in your screenshot)?<br /><br />&gt; Snes9x just shows the large logo on the left, the sprites and the scroll text; no plasma effect. ZSNES just shows the large logo very, very slowly moving. It is rather nice how much higan gets right.<br /><br />Nobody ever took me seriously on the importance of a dot-based PPU renderer. I figured we'd find some interesting new effects nobody had previously noticed if we tried it, so finding these are always a treat.<br /><br />[Fun tangent: find the first release of VSMC. Ignore the racist pro-KKK demo ROM (no, I am unfortunately not joking about that), and look at the other one. The author tried to emulate a fade screen effect by having a tight loop that writes to INIDISP between 15 - 0, back to 15, repeat. But he thinks it changes the entire screen instantly, as that's how his emulator handles it. Only with higan do you see what the true effect of that brings: an absolutely chaotic screen effect where the brightness changes every few pixels, and the affected pixels changes every frame, resulting in an interference-like pattern that's quite fun.]<br /><br />But aside from me timing out the OAM access patterns for the sake of Uniracers, two or three test ROM demonstrations of my own (eg writing text onscreen using only the display brightness register), and a few tweaks to fix games that exhibited problems, I haven't done much more than the basic timing mechanic.<br /><br />Getting things exactly right will mean tracking down timings of when the SNES reads in and latches every single register bit. And I bet those timings change based on which settings are enabled. It's not going to be fun.<br /><br />&gt; I can see why there is chaos when the BGMODE is being changed mid-scanline. There's only four cycles per dot, and it looks like the effects are near-instantaneous or instantaneous once the register is written to.<br /><br />The big concern is that there's a lot of caching involved. Mode 7, for instance, isn't actually multiplying every pixel, it's adding a step value each pixel; but re-multiplying each scanline. So if you switch the right-hand side of the screen to mode 7, you can imagine that initial computation will likely not have happened.<br /><br />Messing with certain sprite registers and the big-guns display-disable-bit is known to break things for the rest of the scanline.<br /><br />&gt; or the fact that actual code is running in between BGMODE writes...<br /><br />You really don't have time for this sort of thing. Even the fastest possible instruction is equivalent to three PPU pixels. On average it's more like six pixels per useful instruction.<br /><br />And I need to again stress that there's a big gaping 10-pixel &quot;hole&quot; in the middle of the screen thanks to DRAM refresh. You'll never be able to do raster effects there, no matter what you do. And I also need to bring up that the SNES Jr radically changes the internals of the PPU rendering. A lot of the mid-scanline effect demos I make break in horrifying ways on it. The SNES Jr is more like an SNES clone than a minor process revision. So if you use these effects, you're limiting yourself to the original SNES units and higan (at least for now.) No Jrs/Minis, no clone consoles, no other emulators.<br /><br />&gt; Also, it occurs to me that I may want to be able to change the scroll position on BG1 during the interrupt.<br /><br />Air Strike Patrol does that mid-scanline. It works pretty well.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=375"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p131695"></a>
				<b class="postauthor">Augustus Blackheart</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131695">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131695#p131695"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Jul 28, 2014 6:08 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Jul 26, 2014 9:50 am<br /><b>Posts:</b> 22
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">byuu wrote:</div><div class="quotecontent">Oh, those are indeed 1's. Didn't notice. Okay, your initial response makes sense now. But I was actually referring to the Anthrox demo, atx2. I was wondering how that is supposed to look on hardware. The text isn't really readable with higan. I can't imagine they'd release it if the text were unreadable.<br /><br />EDIT: oh, horiz.mp4 is Anthrox. But ... there's no sprite border in the middle, and almost all of the text written on the right-hand side is gone. Are you using the same MODE7.SMC file? If not, where can I get the ROM you are running, or could you please do a video of the ROM I am using (the one pictured in your screenshot)?</div><br /><br />Sorry, I should have been more clear there.<br /><br />The rom I used for horiz.mp4 was the snesmod2 example from the sneskit archive. I turned the sprites  off just so everyone could see what was happening under them.<br /><br />The sprites do display correctly when enabled.  The only thing that is wonky is the scrolltext.  Both higan and snes9x are displaying it as it appears on the real hardware.<br /><br />I have run the original horiz demo before and everything displays great.  If nobody else gets around to it I'll post video of that specific rom when I can.</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=6621">Augustus Blackheart</a> on Tue Aug 19, 2014 10:49 pm, edited 1 time in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6621"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p131697"></a>
				<b class="postauthor">93143</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131697">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131697#p131697"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Jul 28, 2014 6:20 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Jul 04, 2014 9:31 pm<br /><b>Posts:</b> 214
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">byuu wrote:</div><div class="quotecontent">&gt; or the fact that actual code is running in between BGMODE writes...<br /><br />You really don't have time for this sort of thing. Even the fastest possible instruction is equivalent to three PPU pixels. On average it's more like six pixels per useful instruction.</div><br />I don't mean trying to fit in code during the garbage area or anything.  I just mean that the Anthrox demo seems to have graphical manipulation code going on during the rest of the screen, whereas my test code just sits there and waits for the interrupt.  I figured that was why I <em>almost</em> managed to hit the same pixel every line...<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">And I need to again stress that there's a big gaping 10-pixel &quot;hole&quot; in the middle of the screen thanks to DRAM refresh. You'll never be able to do raster effects there, no matter what you do.</div><br />Now that you mention it, I wonder if that could be part of the reason for the extended garbage area in the Anthrox demo.  A write that slipped past the start of the DRAM refresh would happen 10 pixels late, and combined with the larger timing variance due to interrupting nontrivial code, the resulting disturbance could easily be closer to five tiles wide instead of the roughly three my code seems to show.<br /><br />Or not...<br /><br />Fortunately, I don't have to do anything in the literal middle of the screen; the mode change in my test code is actually pretty much where I want it.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">And I also need to bring up that the SNES Jr radically changes the internals of the PPU rendering. A lot of the mid-scanline effect demos I make break in horrifying ways on it. The SNES Jr is more like an SNES clone than a minor process revision. So if you use these effects, you're limiting yourself to the original SNES units and higan (at least for now.) No Jrs/Minis, no clone consoles, no other emulators.</div><br />I think I'm okay with this (hey, the Satellaview didn't work with the SFC Jr. either).  But it's good to be aware of, especially since it looks like I'm not the only one considering using this technique...<br /><br />I wonder what exactly a SNES Jr. does in this case?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6595"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p131739"></a>
				<b class="postauthor" style="color: #AA0000">koitsu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131739">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131739#p131739"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jul 29, 2014 2:14 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Site Admin</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3.png" width="100" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 9:28 pm<br /><b>Posts:</b> 2391<br /><b>Location:</b> Mountain View, CA, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Getting a clear video capture is gonna take me a bit more work.  I thought my capture device was USB but it's actually DV/Firewire (just goes to show how long ago it was that I last used it!).  Will work on getting a working capture device this week.<br /><br />Edit: Son of a bitch -- my SNES AC adapter is missing.  *Not* happy.  Have a pretty good idea where it went (ex-roommate likely stole it as part of his massive game console collection), so I've had to order another one and should be here Saturday.  Capture device should be here later this week as well.  *still ticked off about AC adapter*</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p131820"></a>
				<b class="postauthor">Sik</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131820">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131820#p131820"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Jul 30, 2014 10:51 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Aug 12, 2010 3:43 am<br /><b>Posts:</b> 846
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">How common is the SNES Jr. in the first place? It seems to be the SNES counterpart to the Mega Drive 3 (except that in Sega's case incompatibilities aren't anywhere as big since it's based on the old ASIC, most issues come from having some bugs fixed, not complete timing changes).</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4526"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p131822"></a>
				<b class="postauthor">93143</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131822">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131822#p131822"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Jul 30, 2014 11:48 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Jul 04, 2014 9:31 pm<br /><b>Posts:</b> 214
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Okay, apparently it is possible to speed-write to the scroll registers by splitting the values and doing two 16-bit writes to the first one.  I could be misunderstanding what's going on, I suppose...<br /><br />I was going to use DMA, but I can't get it to work without having to set up the registers all over again every scanline, which eats a huge chunk of the available CPU time...  Surely this can't be impossible?<br /><br />Also, the horizontal scroll change doesn't seem to work in higan in this case; the ones should be shunted right 4 pixels as well as up 4 pixels.<br /><br /><div class="attachtitle">Attachment:</div><div class="attachcontent">
			<img src="./download/file.php?id=1799" alt="modeswitch_higan094_scroll.png" /><br />
			<span class="gensmall">modeswitch_higan094_scroll.png [ 5.21 KiB | Viewed 474 times ]</span>
		

		<br />
	</div><br /><br />Also attached is the basic test reversed; with Mode 1 switching to Mode 7 partway through the scanline.  It works exactly as well as the original in higan.  I don't know if basic 2x scaling is enough to identify any matrix issues, though; maybe I should try something fancier...<br /><br />...<br /><br />Oh.  Also, I think I just got the Mode 7 data to DMA properly.  It was a question of memory mapping, no doubt; I had it at the very beginning of the bank, in HiROM mode, and it wasn't working, so I removed all the trailing zeros (since VRAM is initialized to zero in this code anyway) and just stuck it at HEADER_OFF SEMIFREE, which worked.  The attached files do not reflect this change; they still load the Mode 7 tile manually.<br /><br />Apparently I need to read up on this...</div>

					
						<br clear="all" /><br />

						<table class="tablebg" width="100%" cellspacing="1">
						<tr>
							<td class="row3"><b class="genmed">Attachments: </b></td>
						</tr>
						
							<tr>
								<td class="row2">
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=1798">mtest_reverse.rar</a> [92.99 KiB]
			</span><br />
			<span class="gensmall">Downloaded 18 times</span>
		

		<br />
	</td>
							</tr>
						
							<tr>
								<td class="row1">
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=1797">mtest_scroll.rar</a> [93.39 KiB]
			</span><br />
			<span class="gensmall">Downloaded 19 times</span>
		

		<br />
	</td>
							</tr>
						
						</table>
					

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6595"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p131834"></a>
				<b class="postauthor">byuu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131834">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131834#p131834"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Jul 31, 2014 11:30 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Mar 27, 2006 5:23 pm<br /><b>Posts:</b> 871
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Okay, mtest and atx2 revealed to me that the PPU::Background::run() tile counter needs to be run even in mode 7. That was the cause of the shaky video on the right-hand side.<br /><br />atx2 further revealed something interesting ... BG2 in mode 7 non-extbg doesn't seem to be inactive. I sincerely doubt this is a special case, so it looks like the tile counter, X coordinate and probably mosaic computations run even if the BG doesn't actually render anything on screen.<br /><br />Here's a rough patch for higan v094+:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">void PPU::Background::run(bool screen) {<br />&nbsp; if(self.vcounter() == 0) return;<br />&nbsp; bool hires = (self.regs.bgmode == 5 || self.regs.bgmode == 6);<br /><br />&nbsp; if(screen == Screen::Sub) {<br />&nbsp; &nbsp; output.main.priority = 0;<br />&nbsp; &nbsp; output.sub.priority = 0;<br />&nbsp; &nbsp; if(hires == false) return;<br />&nbsp; }<br /><br />//if(regs.mode == Mode::Inactive) return;<br />//if(regs.mode == Mode::Mode7) return run_mode7();<br /><br />&nbsp; if(tile_counter-- == 0) {<br />&nbsp; &nbsp; tile_counter = 7;<br />&nbsp; &nbsp; get_tile();<br />&nbsp; }<br /><br />&nbsp; if(regs.mode == Mode::Mode7) return run_mode7();<br /><br />&nbsp; uint8 palette = get_tile_color();<br />&nbsp; if(x == 0) mosaic.hcounter = 1;<br />&nbsp; if(x &gt;= 0 &amp;&amp; --mosaic.hcounter == 0) {<br />&nbsp; &nbsp; mosaic.hcounter = regs.mosaic + 1;<br />&nbsp; &nbsp; mosaic.priority = priority;<br />&nbsp; &nbsp; mosaic.palette = palette ? palette_index + palette : 0;<br />&nbsp; &nbsp; mosaic.tile = tile;<br />&nbsp; }<br />&nbsp; if(screen == Screen::Main) x++;<br />&nbsp; if(mosaic.palette == 0) return;<br /><br />&nbsp; if(regs.mode == Mode::Inactive) return;<br />&nbsp; if(hires == false || screen == Screen::Main) if(regs.main_enable) output.main = mosaic;<br />&nbsp; if(hires == false || screen == Screen::Sub ) if(regs.sub_enable ) output.sub&nbsp; = mosaic;<br />}</div><br /><br />Result:<br /><br /><img src="http://i.imgur.com/2ADPvFO.png" alt="Image" /><br /><br /><img src="http://i.imgur.com/JNOmDgV.png" alt="Image" /><br /><br />Still recovering a bit too soon from the mode switch compared to the video, most likely due to the exact cycle at which we start the PPU rendering being off just enough to grab one more tile.<br /><br />Unfortunately the mtest.mp4 isn't long enough to see if offset-per-tile was being applied to the screen or not. Gonna have to wait for a longer video of that one running on real hardware.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=375"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p131840"></a>
				<b class="postauthor" style="color: #AA0000">koitsu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131840">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131840#p131840"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Jul 31, 2014 2:22 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Site Admin</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3.png" width="100" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 9:28 pm<br /><b>Posts:</b> 2391<br /><b>Location:</b> Mountain View, CA, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Got my new video capture device (crossing fingers it doesn't wig out with older consoles or interlaced stuff, sigh, always a crap shoot with these things), just waiting on the AC adapter which should be here tomorrow according to USPS.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p131849"></a>
				<b class="postauthor">tokumaru</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p131849">Re: BGMODE or parameter changes during scanline</a></div><div style="float: right;"><a href="./viewtopic.php?p=131849#p131849"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Jul 31, 2014 8:09 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=95.png" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Feb 12, 2005 9:43 pm<br /><b>Posts:</b> 7356<br /><b>Location:</b> Rio de Janeiro - Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">koitsu wrote:</div><div class="quotecontent">Got my new video capture device (crossing fingers it doesn't wig out with older consoles or interlaced stuff, sigh, always a crap shoot with these things)</div><br />I'm pretty sure all cheap capture devices you can find nowadays will display/capture NES video as interlaced, at least with the bundled software. But you can use VirtualDub or some other tool to convert it back to 60Hz 240p after capturing.<br /><br />There is a free (open source?) capture software though, that is able to display and capture the video correctly. I can't remember its name right now... I'll see if I can find it again, if I do I'll post the name here. Anyway, this program treated the video correctly, but it was far from perfect... It was pretty unstable, crashed a lot. While setting it up, 50% of the choices I made caused the program to close.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=95"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=12&amp;t=11404&amp;start=45"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=12"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=12&amp;t=11404"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>4</strong> of <strong>8</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 111 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=12&amp;t=11404&amp;start=30">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=12&amp;t=11404">1</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=15">2</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=30">3</a><span class="page-sep">, </span><strong>4</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=60">5</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=75">6</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=90">7</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11404&amp;start=105">8</a> &nbsp;<a href="./viewtopic.php?f=12&amp;t=11404&amp;start=60">Next</a></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=25">Other</a> &#187; <a href="./viewforum.php?f=12">SNESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 5 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="11404" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;Reproduction</option>
		
			<option value="11">&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="12" selected="selected">&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;GBDev</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>

<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>