<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - How do you disassemble GB/GBC ROMS?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">How do you disassemble GB/GBC ROMS?</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=20&amp;t=13333">http://forums.nesdev.com/viewtopic.php?f=20&amp;t=13333</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mugenfighter</b> [ Mon Oct 05, 2015 12:43 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I guess this is kind of a stupid question, but I want to make sure I'm doing it right. The main questions I have are: what are the tools required, what processes are required to get the best results, and is there anything else besides those two things I need to know.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>dougeff</b> [ Mon Oct 05, 2015 1:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />These are the only disassemblers I could find in 5 minutes of google searching. They all look old.<br /><br /><!-- m --><a class="postlink" href="http://www.devrs.com/gb/software.php#disass">http://www.devrs.com/gb/software.php#disass</a><!-- m --><br /><br />Will probably give you a long list of Z80 ASM without understandable labels. And probably don't distinguish between code and data. If you don't know what all the Z80 ASM opcodes do, then these utilities will be a waste of time.<br /><br />If these are really all there is for GB, then somebody needs to write a better disassembler. Please.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>dougeff</b> [ Mon Oct 05, 2015 1:35 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />BGB Emulator looks like it has a good debugger, which is like a disassembler, in a way.<br /><br /><!-- m --><a class="postlink" href="http://bgb.bircd.org/">http://bgb.bircd.org/</a><!-- m --><br /><br />And No cash's GB Emulator too...<br /><br /><!-- m --><a class="postlink" href="http://problemkaputt.de/gmb.htm">http://problemkaputt.de/gmb.htm</a><!-- m --><br /><br />Though, I haven't used them.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lazigamer</b> [ Mon Oct 05, 2015 4:12 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I disassemble gameboy games by writing an emulator with a code/data logger and then write a gbz80 disassembler to take that cdl data and create a disassembled text file.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>dougeff</b> [ Mon Oct 05, 2015 4:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Do you mean write a parser that goes line by line through the code, or write an actual emulator?<br /><br />If you have written an emulator with CDL and written a disassembler...would you be willing to share it with the other kids?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lazigamer</b> [ Mon Oct 05, 2015 9:29 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />There are a few things I need to fix on it to make it more user friendly. Once that's done ill post it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mugenfighter</b> [ Tue Oct 06, 2015 9:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The one sort of confident disassember I found recommended using No Cash's debugger for any serious work. So yeah, that kind of says something.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>AWJ</b> [ Tue Oct 06, 2015 10:43 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It's common in GB software to have inline data (function arguments, in high-level language terms) after certain <strong>call</strong> or <strong>rst</strong> instructions. Code/data logging in an emulator can help identify this to some extent, but when dealing with a large and complex game such as an RPG it's unrealistic to expect to log every bit of code in a ROM (especially since many games contain <em>unused</em> code--hello, TCRF!)  It's handy just to be able to give the disassembler rules such as &quot;after every <strong>call 017d</strong> or <strong>call 04bf</strong>, the next three bytes are the address and bank number of a routine to call&quot; or &quot;after every <strong>rst 18</strong> the next byte is a signature byte, and if that byte is 05 then the 16 bytes after that are a jump table&quot;.<br /><br />I've been working on a GB disassembler that supports this kind of extension (actually a whole series of disassemblers--currently GB, 6502 family, and uPD772x family) but it's not a standalone application, it's a python module designed to be called from a script that provides the game-specific rules along with code/data labelling, ROM-offset-to-CPU-address mapping, etc.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>adam_smasher</b> [ Tue Oct 06, 2015 11:04 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Can you give an example of this? I'm curious as to how these routines access their arguments and fix the return address.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lazigamer</b> [ Tue Oct 06, 2015 12:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Alright I have fixed what I needed to fix and here it is.

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=4194">Gameboy Disasm Tools.rar</a> [610.66 KiB]
			</span><br />
			<span class="gensmall">Downloaded 491 times</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>AWJ</b> [ Tue Oct 06, 2015 1:23 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">adam_smasher wrote:</div><div class="quotecontent">Can you give an example of this? I'm curious as to how these routines access their arguments and fix the return address.</div><br /><br />Both the examples I gave were from real games. call 017d is Final Fantasy Legend 2, and rst 18 is Final Fantasy Legend 3.<br /><br />Accessing the arguments is pretty simple. FFL3 just does this, since there's only one argument byte and it doesn't care about preserving registers at this point:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">pop hl<br />ldi a,(hl)<br />push hl</div><br /><br />FFL2 is a bit more complicated:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">push af<br />push hl<br />push de<br />ld hl,sp+06<br />ld a,(hl) ; LSB of return address<br />ld e,a<br />add a,03<br />ldi (hl),a ; adjusted return address<br />ld d,(hl) ; MSB of return address<br />jr nc,+<br />inc (hl) ; adjust MSB if carry occurred<br />+<br />ld l,e<br />ld h,d ; hl now points to the first argument byte</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>adam_smasher</b> [ Tue Oct 06, 2015 1:35 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: How do you disassemble GB/GBC ROMS?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Neat, thanks. The FFL3 trick is pretty classy but the FFL2 code is about as nasty as I expected this would be.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>