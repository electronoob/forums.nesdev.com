<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="https://forums.nesdev.com/feed.php?f=3&amp;t=3831" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="https://forums.nesdev.com/index.php" />
<updated>2018-08-30T14:25:39-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>https://forums.nesdev.com/feed.php?f=3&amp;t=3831</id>
<entry>
<author><name><![CDATA[HastatusXXI]]></name></author>
<updated>2018-08-30T14:25:39-07:00</updated>
<published>2018-08-30T14:25:39-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=224674#p224674</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=224674#p224674"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=224674#p224674"><![CDATA[
<div class="quotetitle">Zepper wrote:</div><div class="quotecontent"><br />Version 6.  <img src="https://forums.nesdev.com/images/smilies/icon_cool.gif" alt="8-)" title="Cool" /><br /></div><br /><br />Thank you, man.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9396">HastatusXXI</a> — Thu Aug 30, 2018 2:25 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2018-08-30T12:52:50-07:00</updated>
<published>2018-08-30T12:52:50-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=224668#p224668</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=224668#p224668"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=224668#p224668"><![CDATA[
Version 6.  <img src="https://forums.nesdev.com/images/smilies/icon_cool.gif" alt="8-)" title="Cool" /><p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Thu Aug 30, 2018 12:52 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[HastatusXXI]]></name></author>
<updated>2018-08-30T11:05:02-07:00</updated>
<published>2018-08-30T11:05:02-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=224653#p224653</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=224653#p224653"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=224653#p224653"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />I've been working on a new test framework that can run multiple groups of tests and give better feedback. As a first use of it, here's a set of CPU tests that do most instructions, testing several edge cases. If it fails, it prints the opcode and instruction name. It only tests official instructions right now.<br /><br /><a href="http://h1.ripway.com/blargg/temp/blargg_nes_cpu_test5.zip" class="postlink">blargg_nes_cpu_test5.zip</a><br /><br />These tests work like <a href="http://mdfs.net/Software/Z80/Exerciser/" class="postlink">zexall</a>, trying each instruction with all interesting combinations of inputs and checksumming the registers afterwards. After all the different combinations have been fed to a particular instruction, the checksum is compared with the correct one to determine pass/fail.<br /><br /><strong>EDIT</strong>: Replaced with version that doesn't stop on failure, so you get a list of all the instructions that failed.<br /></div><br /><br />The link is down. Could you reupload it, please?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9396">HastatusXXI</a> — Thu Aug 30, 2018 11:05 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ulfalizer]]></name></author>
<updated>2013-06-16T05:26:29-07:00</updated>
<published>2013-06-16T05:26:29-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=113343#p113343</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=113343#p113343"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=113343#p113343"><![CDATA[
Implementing it like that does make the tests pass. <img src="https://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />If we cross over into a new page, then the calculated <em>addr_high + 1</em> gets used, but for these opcodes <em>addr_high + 1</em> is corrupted (prolly due to the result being put on the same bus as <em>x</em>/<em>y</em>), and the target address for e.g. SYA becomes <em>((y &amp; (addr_high + 1)) &lt;&lt; 8) | addr_low</em> instead of the normal <em>((addr_high + 1) &lt;&lt; 8) | addr_low</em>. If we don't wrap to a new page, then the corrupted value doesn't get used for the address, so nothing special happens.<br /><br />I'm guessing it works like that for all the instructions where the value is influenced by <em>addr_high + 1</em>, but confirmation would be nice.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5911">ulfalizer</a> — Sun Jun 16, 2013 5:26 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ulfalizer]]></name></author>
<updated>2013-06-16T04:58:32-07:00</updated>
<published>2013-06-16T04:58:32-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=113340#p113340</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=113340#p113340"/>
<title type="html"><![CDATA[Re:]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=113340#p113340"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />I just tested and 9C and 9E are screwey. I need to take them off the test. Depending on X and Y they sometimes write to $700, among other things. Maybe someone else can figure them out properly.<br /></div><br /><br />Stumbled upon this thread after noticing that those fail in my emu (&quot;9C SYA  abs,X&quot;, &quot;9E SXA abs,Y&quot;).<br /><br />My guess is that the &quot;AND addr_high + 1&quot; behavior comes from always calculating addr_high + 1, regardless of whether its needed to correct the address. In that case, maybe the screwy behavior occurs when the value is actually used, i.e. when &quot;addr + x&quot; or &quot;addr + y&quot; crosses into a new page.<br /><br />Maybe it affects AXA and TAS in addition to SYA and SXA in that case.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5911">ulfalizer</a> — Sun Jun 16, 2013 4:58 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[CaptainMuscles]]></name></author>
<updated>2009-07-21T20:40:11-07:00</updated>
<published>2009-07-21T20:40:11-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49103#p49103</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49103#p49103"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49103#p49103"><![CDATA[
<div class="quotetitle">NESICIDE wrote:</div><div class="quotecontent"><br /><div class="quotetitle">qeed wrote:</div><div class="quotecontent">Yes thats the errors you should be looking at, the list of opcodes displayed in each section. Successful opcode is not printed.<br /></div><br />That doesn't make any sense...there are so many opcodes printed that I couldn't possibly have a working emulator if that were the case.<br /><br />Implied NOP is listed as failing...and about 20 other implied instructions (DEX, DEY, INX, INY)  <br /><br />I must be a complete idiot.<br /><br />EDIT: I thought perhaps a failing opcode would have an asterisk next to it or something...but couldn't see anything like that in the output.<br /><br />Perhaps we should let the test author explain it?  I do not at all intend to suggest that his test is bunk...</div><br /><br />I understand what you mean.  My emulator seemed to be working almost completely with a couple of games and it passed all nestest.nes tests, but listed massive failures in Blargg's CPU test.  I assumed at first that it was listing each opcode tested.<br /><br />I figured out what the problem with mine was though.  I was not setting status flags 5 and 6 properly for NMI/BRK/PHP.  Since the status register is included in all of the checksums, a single incorrect bit can through all of the tests off.  Once I fixed those according to a thread I found searching these boards, nearly all of my tests passed and only a few opcodes were listed.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3982">CaptainMuscles</a> — Tue Jul 21, 2009 8:40 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[cpow]]></name></author>
<updated>2009-07-21T18:09:11-07:00</updated>
<published>2009-07-21T18:09:11-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49098#p49098</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49098#p49098"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49098#p49098"><![CDATA[
<div class="quotetitle">qeed wrote:</div><div class="quotecontent"><br />Yes thats the errors you should be looking at, the list of opcodes displayed in each section. Successful opcode is not printed.<br /></div><br />That doesn't make any sense...there are so many opcodes printed that I couldn't possibly have a working emulator if that were the case.<br /><br />Implied NOP is listed as failing...and about 20 other implied instructions (DEX, DEY, INX, INY)  <br /><br />I must be a complete idiot.<br /><br />EDIT: I thought perhaps a failing opcode would have an asterisk next to it or something...but couldn't see anything like that in the output.<br /><br />Perhaps we should let the test author explain it?  I do not at all intend to suggest that his test is bunk...<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3705">cpow</a> — Tue Jul 21, 2009 6:09 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[qeed]]></name></author>
<updated>2009-07-21T08:38:55-07:00</updated>
<published>2009-07-21T08:38:55-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49087#p49087</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49087#p49087"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49087#p49087"><![CDATA[
<div class="quotetitle">CaptainMuscles wrote:</div><div class="quotecontent"><br /><div class="quotetitle">qeed wrote:</div><div class="quotecontent">Error 1 just gets printed whenever your emu fails a group opcodes, just ignore it, instead focus on what opcode that fails, the test tells you the opcode number that fails...<br /></div><br /><br />Thanks for the response.  I am afraid I still do not understand how to interpret the results.  The final part of the output displays:<br /><br />Errors:  10<br />Failed<br /><br />Does this mean that opcode $10, BPL, failed?  I am confused because it also happens that it says I am failing each of the 10 groups, and I don't see any other indicator that could be interpreted as an opcode.<br /><br />EDIT:<br />Is the list of opcodes displayed in each section showing those that failed?  That would make the most sense, but that would also mean that most, if not all, of my opcodes are failing, which I'm hoping is not the case.</div><br /><br />Yes thats the errors you should be looking at, the list of opcodes displayed in each section. Successful opcode is not printed.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3551">qeed</a> — Tue Jul 21, 2009 8:38 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[CaptainMuscles]]></name></author>
<updated>2009-07-21T06:50:35-07:00</updated>
<published>2009-07-21T06:50:35-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49086#p49086</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49086#p49086"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49086#p49086"><![CDATA[
<div class="quotetitle">qeed wrote:</div><div class="quotecontent"><br />Error 1 just gets printed whenever your emu fails a group opcodes, just ignore it, instead focus on what opcode that fails, the test tells you the opcode number that fails...<br /></div><br /><br />Thanks for the response.  I am afraid I still do not understand how to interpret the results.  The final part of the output displays:<br /><br />Errors:  10<br />Failed<br /><br />Does this mean that opcode $10, BPL, failed?  I am confused because it also happens that it says I am failing each of the 10 groups, and I don't see any other indicator that could be interpreted as an opcode.<br /><br />EDIT:<br />Is the list of opcodes displayed in each section showing those that failed?  That would make the most sense, but that would also mean that most, if not all, of my opcodes are failing, which I'm hoping is not the case.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3982">CaptainMuscles</a> — Tue Jul 21, 2009 6:50 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[qeed]]></name></author>
<updated>2009-07-21T05:10:43-07:00</updated>
<published>2009-07-21T05:10:43-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49084#p49084</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49084#p49084"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49084#p49084"><![CDATA[
<div class="quotetitle">CaptainMuscles wrote:</div><div class="quotecontent"><br />What does error 1 mean?  I get error 1 ten times with a group of several opcodes listed each time.  Also, is instruction timing tested by this ROM?<br /></div><br /><br />Error 1 just gets printed whenever your emu fails a group opcodes, just ignore it, instead focus on what opcode that fails, the test tells you the opcode number that fails, it does not test instruction timing, although blargg has made another test that specifically tests timing, you can get it at his site.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3551">qeed</a> — Tue Jul 21, 2009 5:10 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[CaptainMuscles]]></name></author>
<updated>2009-07-20T06:46:28-07:00</updated>
<published>2009-07-20T06:46:28-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49057#p49057</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49057#p49057"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49057#p49057"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />Replaced with version that doesn't stop on failure, so you get a list of all the instructions that failed.<br /></div><br /><br />What does error 1 mean?  I get error 1 ten times with a group of several opcodes listed each time.  Also, is instruction timing tested by this ROM?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3982">CaptainMuscles</a> — Mon Jul 20, 2009 6:46 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[cpow]]></name></author>
<updated>2009-07-19T19:16:52-07:00</updated>
<published>2009-07-19T19:16:52-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49048#p49048</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49048#p49048"/>
<title type="html"><![CDATA[Re: New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=49048#p49048"><![CDATA[
It's not obvious to me how to tell what is failing when it says there are errors?  I get no errors from nestest on either official or unofficial instructions.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3705">cpow</a> — Sun Jul 19, 2009 7:16 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2009-01-12T14:10:06-07:00</updated>
<published>2009-01-12T14:10:06-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=41790#p41790</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=41790#p41790"/>
<title type="html"><![CDATA[New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=41790#p41790"><![CDATA[
Yeah, I make no claim to test the unofficial instructions thoroughly. I don't care about them enough to bother figuring out their full behavior (which could be very involved, no telling).<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Mon Jan 12, 2009 2:10 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[judge]]></name></author>
<updated>2009-01-12T11:53:42-07:00</updated>
<published>2009-01-12T11:53:42-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=41785#p41785</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=41785#p41785"/>
<title type="html"><![CDATA[New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=41785#p41785"><![CDATA[
<div class="quotetitle">hap wrote:</div><div class="quotecontent"><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Specifically, do problems show up during page boundary crossing, when there's no page crossing, or both? I suspect that since the store value is affected by the upper byte of the target address (the "fixed" version, with 1 added to it), it's possible that a page crossing would also cause an issue with the upper address lines during the store cycle.<br /></div>You're right. Not that I've verified this on the NES, but blargg_nes_cpu_test5 passes on my emu if I mask the high address byte with $00 if there's a page crossing on SYA or SXA. Simply ignoring the write on page crossing made it pass too. Though, ORing it with $700 on page crossing (making it sometimes write to $700 like blargg said), makes it fail.</div><br /><br />Could it be that the index gets shifted to the right when crossing a boundary on those instruction? That would explain the behavior although the test set is too limited to tell for sure.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3792">judge</a> — Mon Jan 12, 2009 11:53 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-12-27T21:46:38-07:00</updated>
<published>2008-12-27T21:46:38-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=41071#p41071</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=41071#p41071"/>
<title type="html"><![CDATA[New CPU test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3831&amp;p=41071#p41071"><![CDATA[
Here's what my NES seems to be doing for ARR flag calculation (the undocumented_opcodes.txt is correct for A, that is, A = (A &amp; mask) &gt;&gt; 1):<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">// a = A, f = flags, imm = immediate byte. Returns new flags.<br />int arr&#40; int a, int f, int imm &#41;<br />&#123;<br />    a = &#40;a &amp; imm&#41; &gt;&gt; 1;<br />    <br />    if &#40; f &amp; z02 &#41;<br />        f &amp;= ~z02;<br />    else if &#40; a == 0 &#41;<br />        f |= z02;<br />    <br />    f &amp;= ~&#40;v40 | c01&#41;;<br />    <br />    switch &#40; a &amp; 0x60 &#41;<br />    &#123;<br />    case 0x00:                 break;<br />    case 0x20: f |= v40;       break;<br />    case 0x40: f |= v40 | c01; break;<br />    case 0x60: f |=       c01; break;<br />    &#125;<br />    <br />    return f;<br />&#125;</div><br />The only difference from undocumented_opcodes.txt is the Z flag. If Z was already set before ARR executes, then Z is cleared regardless of A. If Z was clear before ARR, then it's set based on A after ARR finishes.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sat Dec 27, 2008 9:46 pm</p><hr />
]]></content>
</entry>
</feed>