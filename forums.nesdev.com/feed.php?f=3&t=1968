<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=1968" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2006-09-04T09:07:44-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=1968</id>
<entry>
<author><name><![CDATA[Bregalad]]></name></author>
<updated>2006-09-04T09:07:44-07:00</updated>
<published>2006-09-04T09:07:44-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16908#p16908</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16908#p16908"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16908#p16908"><![CDATA[
<div class="quotetitle">mattmatteh wrote:</div><div class="quotecontent"><br />i had read that but was just asking for more info about what logic would actually win.  this kinda went off topic.  thanks for the replies.<br /></div><br />Then this acrticle on wikipedia may help you :<a href="http://en.wikipedia.org/wiki/Push-pull_output" class="postlink">http://en.wikipedia.org/wiki/Push-pull_output</a><br />As I mentionned above, two push-pull outputs, if one tries to pull the output high and the other to push it down, I think the push-down will rather win, because usually the output is connected to ground via a single transistor, but is connected to the supply voltage via a couple of transistors and other diode/resistors componnant, that allow more flexibility to the output voltage.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> — Mon Sep 04, 2006 9:07 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[dXtr]]></name></author>
<updated>2006-09-03T21:13:22-07:00</updated>
<published>2006-09-03T21:13:22-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16904#p16904</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16904#p16904"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16904#p16904"><![CDATA[
<div class="quotetitle">mattmatteh wrote:</div><div class="quotecontent"><br />(i tried to use the quote button and it doenst look as nice as everyone else's.  i dont know why.)<br /></div><br /><br />Go to your profile and make sure "Always allow BBCode:" is set yo "yes"<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=15">dXtr</a> — Sun Sep 03, 2006 9:13 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mattmatteh]]></name></author>
<updated>2006-09-03T21:03:06-07:00</updated>
<published>2006-09-03T21:03:06-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16903#p16903</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16903#p16903"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16903#p16903"><![CDATA[
tepples wrote:<br />Everything said in this topic has already been said in [[Bus conflict]].<br /><br />(i tried to use the quote button and it doenst look as nice as everyone else's.  i dont know why.)<br /><br />i had read that but was just asking for more info about what logic would actually win.  this kinda went off topic.  thanks for the replies.<br /><br />matt<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=170">mattmatteh</a> — Sun Sep 03, 2006 9:03 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2006-09-03T11:52:22-07:00</updated>
<published>2006-09-03T11:52:22-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16883#p16883</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16883#p16883"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16883#p16883"><![CDATA[
<div class="quotetitle">Bregalad wrote:</div><div class="quotecontent"><br />Well, a bus conflict could happen on the following cases :<br /></div><br />Thanks for the explanations.<br /><br />blargg: Thanks for the suggestion to summarize them to [[<a href="http://nesdevwiki.ath.cx/index.php/Bus_conflict" class="postlink">Bus conflict</a>]], which I just finished. But the explanations of the timing issues should probably go in some page about bank switching in general.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Sun Sep 03, 2006 11:52 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2006-09-03T11:26:32-07:00</updated>
<published>2006-09-03T11:26:32-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16880#p16880</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16880#p16880"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16880#p16880"><![CDATA[
<div class="quotetitle">tepples wrote:</div><div class="quotecontent"><br />Everything said in this topic has already been said in [[<a href="http://nesdevwiki.ath.cx/index.php/Bus_conflict" class="postlink">Bus conflict</a>]].<br /></div><br /><br />Heh, including what Bregalad said after your comment. But not really; the Wiki page doesn't discuss the instruction timing or fact that most bus conflicts are due to NES-incompatible code hacks. There are only a couple of paragraphs on that page.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sun Sep 03, 2006 11:26 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Bregalad]]></name></author>
<updated>2006-09-03T00:41:55-07:00</updated>
<published>2006-09-03T00:41:55-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16863#p16863</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16863#p16863"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16863#p16863"><![CDATA[
The method of avoiding bus conflicts depend of what you want to do.<br />If you want to swap only fixed bank at fixed points, go with the "instruction+1" method.<br />If you want to swap variable banks, and have a function that does it instead of doing it inline, you're forced to use a table (8 bytes typically for UNROM is nothing).<br />You may also use this method, especially to swap CHR banks in a CNROM or whatever board :<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">ldy StageIndex<br />lda StageCHRTable,Y<br />sta StageCHRTable,Y</div><br />This typically represent a table containing the CHR bank to be used in each respective stage. Since this is a variable number, insted of having a second table to write over it, it is easier to just write over the original data, and if of course prevent bus conflicts.<br /><br />About mapper 2 hacked ROMs, I agree that modern emulators doesn't HAVE to emulate them, because proper MMC1 versions are available, and that they do run on a NES only with a MMC1. (Yeah in theory anybody could build another mapper doing more than the UNROM mapper with discrete logic chips, but this would be nothing but a kind of simplified MMC1 emulator with discrete logic chips. One could use the <a href="http://nesdev.com/bbs/viewtopic.php?t=1866" class="postlink">non-simplified one</a> instead).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> — Sun Sep 03, 2006 12:41 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[FyberOptic]]></name></author>
<updated>2006-09-02T20:34:40-07:00</updated>
<published>2006-09-02T20:34:40-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16855#p16855</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16855#p16855"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16855#p16855"><![CDATA[
I don't think of myself as some master genius of any sort, but there's always that tiny bit of letdown when one thinks of something on their own, only to realize everyone else already knew it already.  lol.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=884">FyberOptic</a> — Sat Sep 02, 2006 8:34 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2006-09-02T19:54:08-07:00</updated>
<published>2006-09-02T19:54:08-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16852#p16852</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16852#p16852"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16852#p16852"><![CDATA[
Everything said in this topic has already been said in [[<a href="http://nesdevwiki.ath.cx/index.php/Bus_conflict" class="postlink">Bus conflict</a>]].<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Sat Sep 02, 2006 7:54 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2006-09-02T17:52:51-07:00</updated>
<published>2006-09-02T17:52:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16849#p16849</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16849#p16849"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16849#p16849"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />But it was one of those possibly too good to be true types of things, since I wasn't completely sure of the consequence of swapping the same page the code was executing on. So even though it worked for me on the hardware that particular time, I thought I'd suggest the more foolproof method of a table.<br /></div><br /><br />Good to be cautious about things that might be working only due to bad luck (it wouldn't be good luck if it worked by chance, because then you'd have a nasty hidden bug!). The write for STA occurs one cycle before the read of the next instruction opcode, and the mapper hardware should respond almost instantaneously, so I think this is a solid (and elegant) technique.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sat Sep 02, 2006 5:52 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[FyberOptic]]></name></author>
<updated>2006-09-02T17:19:34-07:00</updated>
<published>2006-09-02T17:19:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16848#p16848</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16848#p16848"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16848#p16848"><![CDATA[
<div class="quotetitle">tepples wrote:</div><div class="quotecontent"><br />It's even easier:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">instruction:<br />  lda #5<br />  sta instruction+1<br /></div><br /></div><br /><br />I actually tried that just yesterday, when trying to figure out the best way to squeeze some code into a small gap in a rom.  But it was one of those possibly too good to be true types of things, since I wasn't completely sure of the consequence of swapping the same page the code was executing on.  So even though it worked for me on the hardware that particular time, I thought I'd suggest the more foolproof method of a table.  But I'm glad to see the instruction + 1 method is apparently fine.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=884">FyberOptic</a> — Sat Sep 02, 2006 5:19 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2006-09-02T16:56:10-07:00</updated>
<published>2006-09-02T16:56:10-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16846#p16846</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16846#p16846"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16846#p16846"><![CDATA[
<div class="quotetitle">FyberOptic wrote:</div><div class="quotecontent"><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.org $C000<br />.db $00, $01, $02, $03, $04, $05, $06, $07, $08, $09, $0A, $0B, $0C, $0D, $0E, $0F</div><br /><br />So then if you want to switch to like, bank 5, you'd just write..<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">lda #5<br />sta $C005</div><br /><br />..and so on.<br /></div><br />It's even easier:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">instruction:<br />  lda #5<br />  sta instruction+1<br /></div><br /><br />Further proof that iNES is a jungle, but it's the best jungle we've got:<br /><div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />I'll buy that, as long as it specifies this custom mapper in the iNES/UNIF file.<br /></div><br />Yes it is possible to specify this board in one of the extensions to iNES, by saying "Mapper 2 with bus conflicts turned off". I don't know whether UNIF has a name for this board.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Sat Sep 02, 2006 4:56 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2006-09-02T16:24:29-07:00</updated>
<published>2006-09-02T16:24:29-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16845#p16845</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16845#p16845"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16845#p16845"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Sure it runs on a NES, just not a UOROM board.<br /></div><br /><br />I'll buy that, as long as it specifies this custom mapper in the iNES/UNIF file. And if it does that, then it shouldn't have any problem running on an emulator (as long as it supports this custom mapper you describe).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sat Sep 02, 2006 4:24 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Calpis]]></name></author>
<updated>2006-09-02T15:08:09-07:00</updated>
<published>2006-09-02T15:08:09-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16841#p16841</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16841#p16841"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16841#p16841"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />In other words, it's a ROM that does not run on a NES. Whether an emulator author wants to accommodate this is up to the author, but it's not in the realm of NES emulation anymore.<br /></div><br />Sure it runs on a NES, just not a UOROM board. It should be thought of as a hack for a UOROM-like mapper with WRAM, mirroring and more which is directly compatible with UOROM games.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=19">Calpis</a> — Sat Sep 02, 2006 3:08 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2006-09-02T14:43:34-07:00</updated>
<published>2006-09-02T14:43:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16839#p16839</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16839#p16839"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16839#p16839"><![CDATA[
<div class="quotetitle">Bregalad wrote:</div><div class="quotecontent"><br />Well, a bus conflict could happen on the following cases : <br />- The ROM is a hack from another mapper, and had originally no bus conflicts. The hackers didn't take care of bus conflicts, and now there is some on the new version (typically Final Fantasy II and so) <br />- [etc...]<br /></div><br />In other words, it's a ROM that does not run on a NES. Whether an emulator author wants to accommodate this is up to the author, but it's not in the realm of NES emulation anymore.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />In my case though it just means looking for a "1" somewhere, since I usually only need to switch banks the one time (to bank 1), which is generally easy to find at some location or another in the rom's code.<br /></div><br />Heh, I had to do this when dumping cartridges that used this mapping method (and I imagine CopyNES has to do similar). Have the code scan the ROM for a compatible byte in the current bank.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sat Sep 02, 2006 2:43 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[FyberOptic]]></name></author>
<updated>2006-09-02T13:44:32-07:00</updated>
<published>2006-09-02T13:44:32-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16836#p16836</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16836#p16836"/>
<title type="html"><![CDATA[how do i code for bus conflicts ?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1968&amp;p=16836#p16836"><![CDATA[
All I do in my NROM to UNROM conversions is just write to the rom address space in an area which holds the same value as what I'm trying to write, that way the correct value ends up on the data bus despite the conflict.  In my case though it just means looking for a "1" somewhere, since I usually only need to switch banks the one time (to bank 1), which is generally easy to find at some location or another in the rom's code.<br /><br />You might want to use a "lookup table" at a particular place in your rom, making it simple to know exactly where the values you want are located at.  For example, using some generic NESASM-ish code:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.org $C000<br />.db $00, $01, $02, $03, $04, $05, $06, $07, $08, $09, $0A, $0B, $0C, $0D, $0E, $0F</div><br /><br />So then if you want to switch to like, bank 5, you'd just write..<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">lda #5<br />sta $C005</div><br /><br />..and so on.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=884">FyberOptic</a> — Sat Sep 02, 2006 1:44 pm</p><hr />
]]></content>
</entry>
</feed>