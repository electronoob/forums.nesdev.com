<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - upernes</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">upernes</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=13229">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=13229</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>6</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Patrick FR</b> [ Fri Sep 11, 2015 11:25 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hi<br /><br />I posted in 2011 about a program to disassemble NES games and make SNES roms nearly automaticly. It was not finished, the assembler code replacing the PPU calls and the code for the interrupt vectors is not working. Many test roms did not pass and I stoped here.<br />Today a friend told me to put something in GitHub before tonight, so I have chosen this project, nothing to lose.<br />I have released it with a GPL licence and uploaded it to Github at <a href="https://github.com/mandraga/upernes" class="postlink">https://github.com/mandraga/upernes</a>.<br />For now it is mostly a tech demo but the C code works fine, it is the asm files who do not work that much any more.<br /><br />Edit: I worked on it for 6 month and I have encouraging results on the snes.<br />Edit: Super Mario Bros nearly completed, it needs a proper sprite 0 emulation and a fast background refresh.<br />Edit: Sprite 0 is ok, sound and bg update in progress.<br />Edit: Sound is working and Super Mario Bros, Excite Bike, Balloon fight are emulated.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Hamtaro126</b> [ Sat Sep 12, 2015 3:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Is it possible for you to include windows (32bit and 64bit) binaries as well?<br /><br />I do not want to have to install flex-mingw or something similar because Sourceforge seems to hate using adblockers, and no other trusted mirrors exist right now for flex-mingw!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Patrick FR</b> [ Sun Sep 13, 2015 3:13 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hello<br /><br />I have MSYS2 on my windows and it will not be difficult to &quot;port&quot; it. I will port it maybe in a week or two when I can work with my computer with windows and MSYS2. But you can try MSYS2 (has an installer) and then adding all the tools and all the libs like flex and bison using pacman in command line. Porting from linux to windows is much more easier recently.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mikejmoffitt</b> [ Sun Sep 13, 2015 8:45 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />This is a great idea. I will build it later tonight and see how it works. If you give it sensitivity to mapper PRG bankswitching, maybe my dream of seeing Gimmick on the SNES can come true.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Patrick FR</b> [ Thu Oct 08, 2015 9:45 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hi<br />Today I ported it to windows64 using MSYS2.<br />Recompilation works except if a PORT is accessed by other means than absolute. Indirect port accessed may be used by some rom's audio program SNDSQR1 SNDSQR2.<br /><br />The binary is called upernes.exe in the source folder.<br /><br />Usage is: ./upernes.exe romname.nes<br />The new source code and CHR files are in  outsrc/. Copy them to asm/ and build the snes rom.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Patrick FR</b> [ Sat Oct 10, 2015 10:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It looks like the exes compiled with MSYS are not easy to redistribute. Because when you do not have MSYS installed, they lack a lot of DLLs and good luck to find what dll is needed. But I will try to get the proper Dlls in the bin directory.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mikejmoffitt</b> [ Sat Oct 10, 2015 11:24 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I think you can link to libgcc statically with mingw. You should be able to static link to others as well, and this is a good situation for static linking.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Patrick FR</b> [ Sun Oct 11, 2015 1:59 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yes I have seen this while resolving this problem yesterday. However, I pushed the dlls needed in source/binw64/<br />Add a outsrc/ fodler to binw64 and you should be able to call &quot;upernes.exe romname.nes&quot;. What you see in the graphic window is the code already parsed. I do not remember the color meaning, it should be data/code areas, maybe I will add audio port and graphic port accesses in other colors.<br /><br />I do not know if it is current usage to keep compiled binaries in a git repository? Is it better to put that on another web page? I was used to sourceforge where you have both source and binaries. Can someone clarify this?<br /><br />Currently upernes.exe exits if it finds a non absolute address access to an hardware port. It means that if a rom writes in a port using the port adress it is transformed into a call to an emulation routine on the snes. But if a rom writes the port using an indexed something then the code to replace this indexed call needs to be added to the cpp asm rewriting functions.<br /><br />However, currently, the basic test roms must pass the tests again. upernes.exe rewrites the code but the called routines from the assembler files are not working properly. So the plan is to fix the asm port routines and then add the non absolute port read/writes.<br /><br />Btw, now that it works on windows, do you know an snes emulator with a good assembler trace and breakpoints? This is crucial to be able to work properly on port emulation. Being too often lost in asm routines was what made me stop working on it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Oct 11, 2015 5:27 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />cc65 keeps source on GitHub and binaries on SourceForge.net.<br /><br />(I keep wanting to type SourceForget.)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mikejmoffitt</b> [ Sun Oct 11, 2015 10:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I tried to build this under Debian Linux 64-bit. I had to modify the makefile to specify Linux. It would be better to make your different OS choices for cross-compilation different targets, rather than rely on editing the Makefile.<br /><br />There are some serious permissions issues in your source folder, too. Everything was marked executable, and I was unable to touch any of the source subdirectories from permissions issues. I had to manually fix permissions before I could use this.<br /><br />When I ran upernes on Donkey Kong (PRG1), a lot of text went by, a window with a strange red smear on it popped up for a second, then I got this output:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">upernes: recompileIO.cpp:133: void CRecompilateur::outReplaceIOport(FILE*, t_pinstr, Copcodes*): Assertion `addressing = Abs' failed.<br />Aborted<br /></div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Patrick FR</b> [ Mon Oct 12, 2015 4:09 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hi<br /><br />I will check those permission issues right after this post.<br /><br />The text is the rom source code plus the count to ports and memory accesses, this is normal, look to it. The image is the rom being disassembled as I said before.<br />And yes, it fails if it finds an indirect access to an hardware PORT.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Patrick FR</b> [ Mon Oct 12, 2015 7:45 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I updated the repository, no more x rights (I liked how it appeared green in the console <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /> ). I used a trick from a slashdot post for the makefile that detects windows using an environment variable.<br />Thanks for your comments.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mikejmoffitt</b> [ Mon Oct 12, 2015 9:00 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I see, thanks for the quick clarification. <br /><br />Are there any commercial titles which use only absolute port access? Or will we just have to wait for this functionality to be implemented?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Patrick FR</b> [ Mon Oct 12, 2015 11:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I checked those addressing modes and I found an old folder where I already added Absolute X indexed and Absolute Y indexed. And I merged with the current branch.<br />Ballonfight passes the recompilation process (however, without adding the indirect jumps if any).<br /><br />Now I must merge the assembler files containing the new routines, and this is far from working. But I have seen that snes9x debug version was ported to linux, this may be great for passing the tests roms.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Oct 12, 2015 12:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: upernes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />NO$SNS also works in Wine 1.6.2 in Xubuntu 14.04 LTS.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>6</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>