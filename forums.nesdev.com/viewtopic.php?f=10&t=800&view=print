<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - FDS Project</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">FDS Project</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=10&amp;t=800">http://forums.nesdev.com/viewtopic.php?f=10&amp;t=800</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>X-or</b> [ Sun Dec 04, 2005 3:33 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>FDS Project</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'm intending to write a dat file for the Nintendo FDS system.
<br />Unfortunately most FDS known dumps have an altered SRAM
<br />Is there an utility to cleanse the SRAM (or better yet, to restore the original data before any save was done)
<br />
<br />Thanks

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>kyuusaku</b> [ Sun Dec 04, 2005 9:58 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Floppy disks don't contain SRAM, the saves are data written to the disks, so no you cannot cleanse the disk. The only way to get clean dumps is to redump untouched games (hard to detect without buying new games)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>X-or</b> [ Wed Dec 07, 2005 11:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />As expected I'll have to hack every single rom with hexed. and remove saved data. I'm halfway done thro it. The set will be a bit cleaner but it won't replace dump of sealed carts. Several bytes will probably be wrong but that's the best I can do for now.
<br />
<br />Btw when possible I tried to use Nestopia to delete the saves but i'm even more confused now:
<br />
<br />I loaded a saveless ROM of Hikari Shinwa - Palatina no Kagami (v1.1) in Nestopia and browsed a bit in the saving screen (just browsed, didn't even created a save), and Nestopia generated an IPS file and I don't understand the meaning of the altered bytes
<br />
<br />screenshots of altered bytes can be found here
<br /><a href="http://x.or.internet.free.fr/misc/hikari.zip" class="postlink">http://x.or.internet.free.fr/misc/hikari.zip</a>
<br />
<br />I'd be very grateful to anyone who could enlighten me <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>kyuusaku</b> [ Wed Dec 14, 2005 10:19 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Ehrm, FDS games don't all save in the same place (if they had, you still wouldn't have the data to restore), a hex editor will get you nowhere unless you're just trying to put together a hack of a clean collection. Like I said, there is no way to determine a clean dump without dumping a brand new disk without saves. That may even mean dumping a brand new disk before it's played because the game can alter the disk at any time unless you write-protect it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Guest</b> [ Thu Dec 15, 2005 8:53 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You get an IPS file whenever anything is written to on disk, whether it's save data or otherwise.  According to BT's doc, some games have a copy protect feature where the number of files on disk is larger than the file count (that is, the byte on disk that says how many files are present is less than the actual number).  These games would write to disk to change the file count, then reload the disk in order to get the extra data, then change the file count back to the smaller value.  This is a form of copy protection because some copiers use the file count presented on disk and assume that's all there is without scanning the disk for more files.
<br />
<br />There are probably other reasons why a game might write to disk that don't have to do with saving, but that's the one I know of personally.
<br />
<br />As for cleaning out a disk, you may be able to find where saved data is located on disk by monitoring what the game does at runtime, seeing where in RAM it looks when checking for saved game data, and then looking at the FDS image for a file that loads to that location.  Be careful though, as there may be several files involved here instead of just one.  As for cleaning it out, that's a whole different issue - simply setting all data to zeroes (for example) will robably not work, as some games expect very specific values in certain areas in order to work properly.  If one were to reverse-engineer the game in full and analyze how everything is used, it might be possible to determine possible default values for each byte in the save game data, but that's the best one can do - you cannot restore the true starting condition of the game.
<br />
<br />Having said all that, I would imagine that if you were to (within the game itself) erase every file and verify that there are no lingering effects (such as unlockables that appear after a game is beaten), that would be sufficiently close enough to the original condition (although certainly not in the true original state, as often erased games aren't really erased - they are just removed from the list of available saved games).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>kyuusaku</b> [ Thu Dec 15, 2005 12:40 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I should point out that some games don't let you erase the save "files" such as Doki Doki Panic and IIRC Metroid.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>X-or</b> [ Sat Dec 17, 2005 6:18 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Firstly thanks for the replies
<br />
<br />I am aware that by cleaning the saves, I probably won't get a ROM which match a sealed cart data. But as mentionned before that's the best we could get.
<br />
<br />I was just looking for help to figure out the meaning of the altered bytes in order to understand a bit better (hopefully) how the system alter a sealed cart. But oddly, even mcfly80 (nestopia author) doesn't seem to have a clue.
<br />
<br />I suppose it varies from a program rom to another and there is no general behavior of the system when it writes the saves.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>X-or</b> [ Wed Mar 08, 2006 9:08 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />bump
<br />no one can help here?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>kyuusaku</b> [ Fri Mar 10, 2006 6:06 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />There is no way to automagically restore games to their clean state, period.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>