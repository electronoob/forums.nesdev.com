<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - Some questions about C in CC65</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - NESdev" href="http://forums.nesdev.com/feed.php?f=2" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Some questions about C in CC65" href="http://forums.nesdev.com/feed.php?f=2&amp;t=13856" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en&amp;sid=afe973a4fcf521285047090654207f28" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '2');
	var per_page = '15';
	var base_url = './viewtopic.php?f=2&amp;t=13856&amp;sid=afe973a4fcf521285047090654207f28';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php?sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<!--<div style="float: right;">
					<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick">
					<input type="hidden" name="hosted_button_id" value="X2HM4WNR5YT8S">
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
					<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
					</form>
				</div>-->
				<a href="./faq.php?sid=afe973a4fcf521285047090654207f28"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php?sid=afe973a4fcf521285047090654207f28"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=minion&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Mon Nov 07, 2016 7:09 pm<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered&amp;sid=afe973a4fcf521285047090654207f28">View unanswered posts</a> | <a href="./search.php?search_id=active_topics&amp;sid=afe973a4fcf521285047090654207f28">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php?sid=afe973a4fcf521285047090654207f28">Board index</a> &#187; <a href="./viewforum.php?f=24&amp;sid=afe973a4fcf521285047090654207f28">NES / Famicom</a> &#187; <a href="./viewforum.php?f=2&amp;sid=afe973a4fcf521285047090654207f28">NESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />
	

					<center>
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- NesDev Forums -->
					<ins class="adsbygoogle"
						 style="display:block"
						 data-ad-client="ca-pub-7801010229099644"
						 data-ad-slot="7979066809"
						 data-ad-format="auto"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>
					</center>
	<br />


<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=2&amp;t=13856&amp;start=15&amp;sid=afe973a4fcf521285047090654207f28">Some questions about C in CC65</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320&amp;sid=afe973a4fcf521285047090654207f28">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=2&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=2&amp;t=13856&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>2</strong> of <strong>2</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 27 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=2&amp;t=13856&amp;sid=afe973a4fcf521285047090654207f28&amp;start=0">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=2&amp;t=13856&amp;sid=afe973a4fcf521285047090654207f28">1</a><span class="page-sep">, </span><strong>2</strong></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=2&amp;t=13856&amp;start=15&amp;sid=afe973a4fcf521285047090654207f28&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=2&amp;t=13856&amp;view=previous&amp;sid=afe973a4fcf521285047090654207f28">Previous topic</a> | <a href="./viewtopic.php?f=2&amp;t=13856&amp;view=next&amp;sid=afe973a4fcf521285047090654207f28">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p164712"></a>
				<b class="postauthor" style="color: #AA0000">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164712">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164712&amp;sid=afe973a4fcf521285047090654207f28#p164712"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Feb 18, 2016 8:07 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 17206<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">The standard requires that <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">*&#40;p + i&#41;</tt> and <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">p[i]</tt> have the same effect when defined. But performance is an aspect of quality of implementation, and the standard does not address quality of implementation beyond the minimum needed to conform. A compiler can generate efficient code for one syntax and inefficient code for another, so long as they have the same effect. And historically, there hasn't been enough money to pay developers to improve the quality of implementation of cc65.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p164713"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164713">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164713&amp;sid=afe973a4fcf521285047090654207f28#p164713"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Feb 18, 2016 8:24 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=6156_1471126672.png" width="100" height="88" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 999
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">I asked this question because you came into this thread asking about the performance differences of two types of array access. When you responded with something that is not array access, I was trying to make sure that you understood that this is a completely different situation than the one you were initially asking about.</div><br />Weeell, actually, it <em>is</em> some kind of an array access when you have a look at the overall context:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">memcpy(destinationArray, sourceArray + 3, 5);<br />/* Copies five items from sourceArray into destinationArray,<br />&nbsp; &nbsp;starting with the item at index 3. */</div><br /><br />Yes, from a technical point of view, this is mere pointer calculation. But the logical intention is that memcpy takes addresses that are connected to arrays.</div>

					
						<div class="postbody"><br />_________________<br />Coming soon (hopefully December 2016):<br />&quot;City Trouble&quot; for the NES, developed by me, published by Mega Cat Studios.<br /><!-- w --><a class="postlink" href="http://www.megacatstudios.com/collections/coming-soon/products/city-trouble">www.megacatstudios.com/collections/comi ... ty-trouble</a><!-- w --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p164714"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164714">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164714&amp;sid=afe973a4fcf521285047090654207f28#p164714"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Feb 18, 2016 8:39 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 4298<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">DRW wrote:</div><div class="quotecontent">Weeell, actually, it <em>is</em> some kind of an array access...</div><br />I've clarified already exactly what I meant when I said &quot;array access&quot;. I don't see the purpose of making this semantic argument. You already know this alternative interpretation of the words has nothing to do with what I was saying.<br /><br />Yes of course pointer arithmetic is related to arrays. Why do you bring it up? I thought you started this thread to ask a question about performance.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p164715"></a>
				<b class="postauthor" style="color: #AA0000">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164715">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164715&amp;sid=afe973a4fcf521285047090654207f28#p164715"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Feb 18, 2016 8:48 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 17206<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">And on an in-order, shallow-pipeline architecture such as the 6502, performance for a particular function is easy to see by just trying it both ways, reading the resulting assembly language, and reporting any noticeable discrepancy on <a href="https://github.com/cc65/cc65/issues" class="postlink">the project's GitHub issues page</a>.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p164746"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164746">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164746&amp;sid=afe973a4fcf521285047090654207f28#p164746"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Feb 19, 2016 1:47 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=6156_1471126672.png" width="100" height="88" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 999
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">Yes of course pointer arithmetic is related to arrays. Why do you bring it up?</div><br />Because your statement still tried to make it seem like I asked for something completely different than what I actually wanted:<br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">When you responded with something that is not array access</div><br /><br />As said by tepples: Pointer arithmetic with pointers that reference simple non-array variables is undefined behavior.<br />So, even if my second post only referenced pointer address calculation, it is clear that it's still related to arrays simply because there just is no other way where pointer arithmetic is a valid, defined, non-hacky action. (Do you know any?)<br />Pointer arithmetic in a non-undefined behavior can <em>only</em> occur with arrays, so my second post was a logical follow up to the first one.<br /><br />The statement<div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">you responded with something that is not array access</div>is simply not true. <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">array + offset</tt> <em>is</em> array access. Where else do you find this construction?<br /><br /><em>That's</em> why I still brought this up: Because you still make it seem like my second post looked like it's a completely different topic than what I asked in my first post.<br /><br /><br /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">And on an in-order, shallow-pipeline architecture such as the 6502, performance for a particular function is easy to see by just trying it both ways, reading the resulting assembly language, and reporting any noticeable discrepancy on <a href="https://github.com/cc65/cc65/issues" class="postlink">the project's GitHub issues page</a>.</div><br />O.k., I'll have a look. I asked because I wanted to find out if there's some definite explanation on why one of them is always and definitely worse than the other one. But it really seems to be an internal implementation detail.</div>

					
						<div class="postbody"><br />_________________<br />Coming soon (hopefully December 2016):<br />&quot;City Trouble&quot; for the NES, developed by me, published by Mega Cat Studios.<br /><!-- w --><a class="postlink" href="http://www.megacatstudios.com/collections/coming-soon/products/city-trouble">www.megacatstudios.com/collections/comi ... ty-trouble</a><!-- w --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p164750"></a>
				<b class="postauthor">lidnariq</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164750">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164750&amp;sid=afe973a4fcf521285047090654207f28#p164750"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Feb 19, 2016 2:20 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Apr 13, 2008 11:12 am<br /><b>Posts:</b> 4963<br /><b>Location:</b> ZÃ¼rich (temporarily)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">DRW wrote:</div><div class="quotecontent">why one of them is always and definitely worse than the other one<br /></div>I really don't see that. (using -Oirs and --add-source)<br /><em>declarations in global scope: <br />char * x;<br />char y[10];<br />char z;<br /></em><br />generated code:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">;<br />; foo(&amp;x&#91;z&#93;) , foo(&amp;y&#91;z&#93;) , foo(x+z);<br />;<br />&nbsp; &nbsp; &nbsp; &nbsp; lda&nbsp; &nbsp; &nbsp;_x<br />&nbsp; &nbsp; &nbsp; &nbsp; ldx&nbsp; &nbsp; &nbsp;_x+1<br />&nbsp; &nbsp; &nbsp; &nbsp; clc<br />&nbsp; &nbsp; &nbsp; &nbsp; adc&nbsp; &nbsp; &nbsp;_z<br />&nbsp; &nbsp; &nbsp; &nbsp; bcc&nbsp; &nbsp; &nbsp;L0010<br />&nbsp; &nbsp; &nbsp; &nbsp; inx<br />L0010:&nbsp; jsr&nbsp; &nbsp; &nbsp;_foo<br />;<br />; foo(y+z);<br />;<br />&nbsp; &nbsp; &nbsp; &nbsp; lda&nbsp; &nbsp; &nbsp;_z<br />&nbsp; &nbsp; &nbsp; &nbsp; clc<br />&nbsp; &nbsp; &nbsp; &nbsp; adc&nbsp; &nbsp; &nbsp;#&lt;(_y)<br />&nbsp; &nbsp; &nbsp; &nbsp; tay<br />&nbsp; &nbsp; &nbsp; &nbsp; lda&nbsp; &nbsp; &nbsp;#$00<br />&nbsp; &nbsp; &nbsp; &nbsp; adc&nbsp; &nbsp; &nbsp;#&gt;(_y)<br />&nbsp; &nbsp; &nbsp; &nbsp; tax<br />&nbsp; &nbsp; &nbsp; &nbsp; tya<br />&nbsp; &nbsp; &nbsp; &nbsp; jsr&nbsp; &nbsp; &nbsp;_foo<br /></div>where, for some reason, the slower form occurs only when adding an offset to an array.<br /><br />When using fixed offsets, it's solely a function of whether the compiler can know the location the memory at compile time, or whether it has to dereference the pointer at runtime:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">;<br />; foo(&amp;x&#91;3&#93;), foo(x+3);<br />;<br />&nbsp; &nbsp; &nbsp; &nbsp; lda&nbsp; &nbsp; &nbsp;_x<br />&nbsp; &nbsp; &nbsp; &nbsp; ldx&nbsp; &nbsp; &nbsp;_x+1<br />&nbsp; &nbsp; &nbsp; &nbsp; clc<br />&nbsp; &nbsp; &nbsp; &nbsp; adc&nbsp; &nbsp; &nbsp;#$03<br />&nbsp; &nbsp; &nbsp; &nbsp; bcc&nbsp; &nbsp; &nbsp;L0007<br />&nbsp; &nbsp; &nbsp; &nbsp; inx<br />L0007:&nbsp; jsr&nbsp; &nbsp; &nbsp;_foo<br />;<br />; foo(&amp;y&#91;3&#93;), foo(y+3);<br />;<br />&nbsp; &nbsp; &nbsp; &nbsp; lda&nbsp; &nbsp; &nbsp;#&lt;(_y+3)<br />&nbsp; &nbsp; &nbsp; &nbsp; ldx&nbsp; &nbsp; &nbsp;#&gt;(_y+3)<br />&nbsp; &nbsp; &nbsp; &nbsp; jsr&nbsp; &nbsp; &nbsp;_foo<br /><br /></div></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3512&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p164754"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164754">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164754&amp;sid=afe973a4fcf521285047090654207f28#p164754"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Feb 19, 2016 6:19 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 4298<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">lidnariq wrote:</div><div class="quotecontent">where, for some reason, the slower form occurs only when adding an offset to an array.</div><br />If it used the immediate <em>y</em> in the former construction it could be faster, but curiously in this case both are roughly the same number of cycles? (Off by one depending on branch.)<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">;<br />; foo(&amp;x&#91;z&#93;) , foo(&amp;y&#91;z&#93;) , foo(x+z);<br />;<br />&nbsp; &nbsp; &nbsp; &nbsp; lda&nbsp; &nbsp; &nbsp;_x&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 4<br />&nbsp; &nbsp; &nbsp; &nbsp; ldx&nbsp; &nbsp; &nbsp;_x+1&nbsp; &nbsp; &nbsp; &nbsp;; 8 (+4)<br />&nbsp; &nbsp; &nbsp; &nbsp; clc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 10 (+2)<br />&nbsp; &nbsp; &nbsp; &nbsp; adc&nbsp; &nbsp; &nbsp;_z&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 14 (+4)<br />&nbsp; &nbsp; &nbsp; &nbsp; bcc&nbsp; &nbsp; &nbsp;L0010&nbsp; &nbsp; &nbsp; ; 16/17 (+2/3)<br />&nbsp; &nbsp; &nbsp; &nbsp; inx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 18 (+2), 13 bytes<br />L0010:&nbsp; jsr&nbsp; &nbsp; &nbsp;_foo<br />;<br />; foo(y+z);<br />;<br />&nbsp; &nbsp; &nbsp; &nbsp; lda&nbsp; &nbsp; &nbsp;_z&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 4<br />&nbsp; &nbsp; &nbsp; &nbsp; clc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 6 (+2)<br />&nbsp; &nbsp; &nbsp; &nbsp; adc&nbsp; &nbsp; &nbsp;#&lt;(_y)&nbsp; &nbsp; &nbsp; ; 8 (+2)<br />&nbsp; &nbsp; &nbsp; &nbsp; tay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 10 (+2)<br />&nbsp; &nbsp; &nbsp; &nbsp; lda&nbsp; &nbsp; &nbsp;#$00&nbsp; &nbsp; &nbsp; &nbsp; ; 12 (+2)<br />&nbsp; &nbsp; &nbsp; &nbsp; adc&nbsp; &nbsp; &nbsp;#&gt;(_y)&nbsp; &nbsp; &nbsp; ; 14 (+2)<br />&nbsp; &nbsp; &nbsp; &nbsp; tax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 16 (+2)<br />&nbsp; &nbsp; &nbsp; &nbsp; tya&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 18 (+2), 13 bytes<br />&nbsp; &nbsp; &nbsp; &nbsp; jsr&nbsp; &nbsp; &nbsp;_foo<br /></div><br />So really, you've highlighted a missed optimization opportunity here for the compiler, but at the same time you've also demonstrated that all versions tried are pretty much the same speed.<br /><br />Either way doesn't seem to make a significant performance difference on this compiler, i.e. not worth worrying about (at least in the kind of &quot;best practices&quot; question that DRW was asking).<br /><br /><br /><div class="quotetitle">DRW wrote:</div><div class="quotecontent"><tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">array + offset</tt> <em>is</em> array access</div><br />I already defined what I meant by &quot;array access&quot; in the context I said it. You're clearly not confused about what I meant at this point, so I don't know what you're trying to tell me here. Of course the words &quot;array access&quot; could mean other things. All words can mean other things, but I didn't mean <em>that</em> when I said it, and you know this, don't you?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p164755"></a>
				<b class="postauthor">dougeff</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164755">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164755&amp;sid=afe973a4fcf521285047090654207f28#p164755"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Feb 19, 2016 7:46 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7008_1468718093.png" width="67" height="85" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri May 08, 2015 7:17 pm<br /><b>Posts:</b> 1103<br /><b>Location:</b> Call me Doug
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">memcpy(destinationArray, sourceArray + 3, 5);</div><br /><br />Quicker =<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Ldx #5<br />:<br />Lda (sourceArray + 3), x<br />Sta destinationArray, x<br />Dex<br />Bne :-</div><br /><br />Could be done with inline assembly, or as a call to an assembly function.<br /><br />On a side note, a large project I'm working on...in C...is just loaded with inline assembly. I feel like it's not really in the spirit of &quot;writing an NES game in C&quot;<br /><br />Another side question...<br />Do any of you guys use the MACPACK macros? Branch Long, for example.</div>

					
						<div class="postbody"><br />_________________<br /><a href="http://nesdoug.com" class="postlink">nesdoug.com</a> -- blog/tutorial on programming for the NES</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7008&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p164761"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164761">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164761&amp;sid=afe973a4fcf521285047090654207f28#p164761"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Feb 19, 2016 9:08 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=6156_1471126672.png" width="100" height="88" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 999
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">dougeff wrote:</div><div class="quotecontent">Quicker =</div><br />This was just a very simplified example to demonstrate my question. I don't <em>actually</em> have an array that I want to fill with the value 5, starting at index 3.<br /><br />Also, since my memcpy function (I actually have my own one and don't use the one from the C standard library since I never copy more than 255 items, so the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">size_t</tt> of the official memcpy is unnecessary for me) is used several times in the game, I have to use pointers and cannot just put the absolute address there. Unless I implement the same function many times, one time per source and destination array.<br />(And yes, I know I can use macros even in assembly to type the function only once, but to declare it multiple times with multiple variables. But it would still occupy duplicate ROM space.)<br /><br /><br /><div class="quotetitle">dougeff wrote:</div><div class="quotecontent">On a side note, a large project I'm working on...in C...is just loaded with inline assembly. I feel like it's not really in the spirit of &quot;writing an NES game in C&quot;</div><br />What do you use the inline assembly for?<br /><br />I was surprised to find out that in my game, I didn't need any assembly for the game logic. The only parts that are written in assembly are the really basic, general things:<br />NES initialization<br />NMI<br />Background update in NMI from a buffer array<br />Sprite update into the DMA location<br />General functions like CopyArray, FillArray, ShiftArray<br />Music (which is an external library anyway)<br /><br />Everything else is pure C. I never got into the situation where I had to rewrite parts of the general game logic (like MovePlayer or CheckCollision or CalculateNexLevelColumn) in assembly.<br /><br />Even filling the background array with the correct tile values etc. is done in C (well, with the help of CopyArray and FillArray of course). Only the actual low level PPU update function that gets called during NMI and that reads this background array is written in assembly.<br /><br />I even had the disadvantage that I have a status bar and parallax scrolling, so I had to split my game logic into three different parts which means of course that I lose some of the rendering time because I don't always manage to fill each of the three sections to the very end with stuff.<br /><br />And my game has six moving meta sprites at once on the screen:<br />2 x 2 tiles<br />2 x 3 tiles<br />2 x 1 tiles<br />2 x 5 tiles<br />2 x 5 tiles<br />2 x 2 tiles<br />And it never lags.<br /><br />So, I really don't understand why people have problems with creating games in C and think it's slow and need to optimize their code by filling it with assembly here and there.<br /><br />Tell me what you use the inline assembly for. Maybe I have an idea how to improve it.</div>

					
						<div class="postbody"><br />_________________<br />Coming soon (hopefully December 2016):<br />&quot;City Trouble&quot; for the NES, developed by me, published by Mega Cat Studios.<br /><!-- w --><a class="postlink" href="http://www.megacatstudios.com/collections/coming-soon/products/city-trouble">www.megacatstudios.com/collections/comi ... ty-trouble</a><!-- w --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p164763"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164763">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164763&amp;sid=afe973a4fcf521285047090654207f28#p164763"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Feb 19, 2016 9:39 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 4298<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">DRW wrote:</div><div class="quotecontent">(And yes, I know I can use macros even in assembly to type the function only once, but to declare it multiple times with multiple variables. But it would still occupy duplicate ROM space.)</div><br />dougeff's &quot;inline memcpy&quot; would use less ROM space than a function call to a memcpy. The code he's posted is 10 bytes long. For a function call, the jsr is already 3 bytes, and I'm pretty sure you're not going to be able to fill 2 pointers and 1 size parameter in less than 7 bytes.<br /><br />I probably still wouldn't do the inline approach just because I tend to leave optimizations like that until later when I've identified a performance problem, but the idea that it would take up more ROM space is incorrect in this case. If the arrays are static the inline version is faster and smaller.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p164766"></a>
				<b class="postauthor">dougeff</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164766">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164766&amp;sid=afe973a4fcf521285047090654207f28#p164766"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Feb 19, 2016 10:20 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7008_1468718093.png" width="67" height="85" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri May 08, 2015 7:17 pm<br /><b>Posts:</b> 1103<br /><b>Location:</b> Call me Doug
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">What do you use the inline assembly for?</div><br /><br />It's usually stuff like this... indexing arrays.<br /><br />(edit, removed bad example)<br /><br />And anything thats time sensitive... Basically anything that happens during V-blank...writes to the PPU.<br /><br />(second edit)...<br />Upon review, of &quot;why do I inline assembly?&quot;...I suppose most of my inlined assembly was unnecessary. The only place it makes sense is my UPDATE_PPU loop. The rest could have been written nearly as fast in C...and been easier to read, and shorter to type.<br /><br />I may be prematurely optimizing...<br /><!-- m --><a class="postlink" href="http://c2.com/cgi/wiki?PrematureOptimization">http://c2.com/cgi/wiki?PrematureOptimization</a><!-- m --></div>

					
						<div class="postbody"><br />_________________<br /><a href="http://nesdoug.com" class="postlink">nesdoug.com</a> -- blog/tutorial on programming for the NES</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7008&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p164804"></a>
				<b class="postauthor">DRW</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p164804">Re: Some questions about C in CC65</a></div><div style="float: right;"><a href="./viewtopic.php?p=164804&amp;sid=afe973a4fcf521285047090654207f28#p164804"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Feb 19, 2016 10:24 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=6156_1471126672.png" width="100" height="88" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Sep 07, 2013 2:59 pm<br /><b>Posts:</b> 999
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">dougeff wrote:</div><div class="quotecontent">It's usually stuff like this... indexing arrays.</div><br />What kinds of arrays do you index?<br /><br />The only loops that I have are the following:<br />One for moving all the characters by iterating from 0 to CharactersNumber - 1.<br />One for rendering all the characters.<br />(In both cases, I need the counting variable throughout multiple functions, so putting it into the X register would be a hazzle anyway.)<br />One for recalculating the score, which is stored in decimal numbers.<br />One for calculating how many pixels the character may fall in the next frame (either the full height or just as many pixels as there are between him and the platform below him).<br /><br />Other than that, there are no counting loops in the action parts of my game. (Level creation isn't time critical, so it doesn't matter that the code isn't the fastest.)<br /><br /><div class="quotetitle">dougeff wrote:</div><div class="quotecontent">And anything thats time sensitive... Basically anything that happens during V-blank...writes to the PPU.</div><br />For this kind of stuff, I wouldn't suggest inline assembly. I would write this in <em>pure</em> assembly.<br /><br />For example, the background update is nothing more than this:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">_UpdatePpu:<br />.export _UpdatePpu<br />&nbsp; &nbsp;LDX _PpuUpdate<br />&nbsp; &nbsp;BEQ @skipUpdatePpu<br />&nbsp; &nbsp;LDA _PpuUpdate + 1<br />&nbsp; &nbsp;STA PpuCtrl<br />&nbsp; &nbsp;LDA PpuStatus<br />&nbsp; &nbsp;LDA _PpuUpdate + 2<br />&nbsp; &nbsp;STA PpuAddr<br />&nbsp; &nbsp;LDA _PpuUpdate + 3<br />&nbsp; &nbsp;STA PpuAddr<br />&nbsp; &nbsp;LDY #$04<br />@writeSingleItemLoop:<br />&nbsp; &nbsp;LDA _PpuUpdate, Y<br />&nbsp; &nbsp;INY<br />&nbsp; &nbsp;STA PpuData<br />&nbsp; &nbsp;DEX<br />&nbsp; &nbsp;BNE @writeSingleItemLoop<br />&nbsp; &nbsp;STX _PpuUpdate<br />@skipUpdatePpu:<br />&nbsp; &nbsp;RTS</div><br /><br />And the NMI itself is just that:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Nmi:<br />&nbsp; &nbsp;PHA<br />&nbsp; &nbsp;TXA<br />&nbsp; &nbsp;PHA<br />&nbsp; &nbsp;TYA<br />&nbsp; &nbsp;PHA<br />&nbsp; &nbsp;LDA WaitForNmi<br />&nbsp; &nbsp;BEQ @nmiEnd<br />@nmiStart:<br />&nbsp; &nbsp;LDA #false<br />&nbsp; &nbsp;STA WaitForNmi<br />&nbsp; &nbsp;LDA _PpuMaskValue<br />&nbsp; &nbsp;STA PpuMask<br />&nbsp; &nbsp;BEQ @nmiEnd<br />&nbsp; &nbsp;LDA #&lt;_Sprites<br />&nbsp; &nbsp;STA $2003<br />&nbsp; &nbsp;LDA #&gt;_Sprites<br />&nbsp; &nbsp;STA $4014<br />&nbsp; &nbsp;JSR _UpdatePpu<br />&nbsp; &nbsp;LDA #$00<br />&nbsp; &nbsp;STA PpuScroll<br />&nbsp; &nbsp;STA PpuScroll<br />&nbsp; &nbsp;LDA #PpuCtrlDefault<br />&nbsp; &nbsp;STA PpuCtrl<br />@nmiEnd:<br />&nbsp; &nbsp;JSR FamiToneUpdate<br />&nbsp; &nbsp;PLA<br />&nbsp; &nbsp;TAY<br />&nbsp; &nbsp;PLA<br />&nbsp; &nbsp;TAX<br />&nbsp; &nbsp;PLA<br />&nbsp; &nbsp;RTI</div><br /><br />So, no need to clutter your C code with inline assembly. Just use a bunch of dedicated assembly files that include whole functions.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">dougeff's &quot;inline memcpy&quot; would use less ROM space than a function call to a memcpy. The code he's posted is 10 bytes long. For a function call, the jsr is already 3 bytes, and I'm pretty sure you're not going to be able to fill 2 pointers and 1 size parameter in less than 7 bytes.</div><br />O.k., I'll have a further look at it. Maybe it's indeed better.</div>

					
						<div class="postbody"><br />_________________<br />Coming soon (hopefully December 2016):<br />&quot;City Trouble&quot; for the NES, developed by me, published by Mega Cat Studios.<br /><!-- w --><a class="postlink" href="http://www.megacatstudios.com/collections/coming-soon/products/city-trouble">www.megacatstudios.com/collections/comi ... ty-trouble</a><!-- w --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6156&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=2&amp;t=13856&amp;start=15&amp;sid=afe973a4fcf521285047090654207f28"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=2&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=2&amp;t=13856&amp;sid=afe973a4fcf521285047090654207f28"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>2</strong> of <strong>2</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 27 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=2&amp;t=13856&amp;sid=afe973a4fcf521285047090654207f28&amp;start=0">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=2&amp;t=13856&amp;sid=afe973a4fcf521285047090654207f28">1</a><span class="page-sep">, </span><strong>2</strong></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php?sid=afe973a4fcf521285047090654207f28">Board index</a> &#187; <a href="./viewforum.php?f=24&amp;sid=afe973a4fcf521285047090654207f28">NES / Famicom</a> &#187; <a href="./viewforum.php?f=2&amp;sid=afe973a4fcf521285047090654207f28">NESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: <span style="color: #9E8DA7;" class="username-coloured">Exabot [Bot]</span>, <span style="color: #9E8DA7;" class="username-coloured">Yahoo [Bot]</span> and 5 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php?sid=afe973a4fcf521285047090654207f28"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="13856" />
<input type="hidden" name="sf" value="msgonly" />
<input type="hidden" name="sid" value="afe973a4fcf521285047090654207f28" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php?sid=afe973a4fcf521285047090654207f28" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2" selected="selected">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="32">&nbsp; &nbsp;&nbsp; &nbsp;2016 NESdev Competition</option>
		
			<option value="31">&nbsp; &nbsp;&nbsp; &nbsp;2014 NESdev Competition</option>
		
			<option value="30">&nbsp; &nbsp;&nbsp; &nbsp;2011 NESdev Competition</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;&nbsp; &nbsp;Reproduction</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="11">&nbsp; &nbsp;&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="12">&nbsp; &nbsp;&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;&nbsp; &nbsp;GBDev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>


<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>