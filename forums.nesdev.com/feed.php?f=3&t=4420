<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=4420" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2009-02-10T08:30:37-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=4420</id>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2009-02-10T08:30:37-07:00</updated>
<published>2009-02-10T08:30:37-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=43182#p43182</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=43182#p43182"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=43182#p43182"><![CDATA[
<div class="quotetitle">byuu wrote:</div><div class="quotecontent"><br />Yeah, the file-roller approach would work. Just tacky to have a bunch of executables like that.<br /></div><br />It's not tacky to have a lot of EXEs. Look at how many EXEs come with CC65. It's no worse than the dozen DLLs that some apps ship with, except a defect in an EXE is less likely to make an unrelated part of a program crash.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Tue Feb 10, 2009 8:30 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[polaco]]></name></author>
<updated>2009-02-10T06:33:17-07:00</updated>
<published>2009-02-10T06:33:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=43180#p43180</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=43180#p43180"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=43180#p43180"><![CDATA[
Cool, I was looking for this <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":-)" title="Smile" /><br /><br />Thanks blargg<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3813">polaco</a> — Tue Feb 10, 2009 6:33 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[byuu]]></name></author>
<updated>2008-10-02T14:22:41-07:00</updated>
<published>2008-10-02T14:22:41-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37989#p37989</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37989#p37989"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37989#p37989"><![CDATA[
<div class="quotetitle">tepples wrote:</div><div class="quotecontent"><br />The GNU GPL's copyleft restriction <a href="http://www.gnu.org/licenses/gpl-faq.html#MereAggregation" class="postlink">generally stops at the boundary between one process and another</a>. If you keep anything that touches a RAR file in a separate process that communicates with the main process through a pipe (like fUnZip does), and you can keep the rest of the program pure GPL.<br /></div><br /><br />Yeah, the file-roller approach would work. Just tacky to have a bunch of executables like that.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />It supports reading archives from anything, using an abstract base class, so one could provide a custom Windows file reader.<br /></div><br /><br />Awesome. It figures you'd have thought of everything ;)<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=375">byuu</a> — Thu Oct 02, 2008 2:22 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[MottZilla]]></name></author>
<updated>2008-10-02T13:57:19-07:00</updated>
<published>2008-10-02T13:57:19-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37987#p37987</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37987#p37987"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37987#p37987"><![CDATA[
Thanks alot Blargg. My emulator now has zip loading support and it only took a few minutes. It was extremely easy to add using your File_Extractor package. =) I disabled 7zip (and never enabled RAR) because I was getting a linking error. But anyway it loads zipped ROMs no problem now so I'm happy.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1726">MottZilla</a> — Thu Oct 02, 2008 1:57 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-10-02T13:42:57-07:00</updated>
<published>2008-10-02T13:42:57-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37986#p37986</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37986#p37986"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37986#p37986"><![CDATA[
<div class="quotetitle">byuu wrote:</div><div class="quotecontent"><br />Does your library support automatic UTF-8 -&gt; UTF-16 conversion for Windows? If not, there's no way to open Unicode file names; unless of course you also have a wchar_t interface (yuck.)<br /></div><br />It supports reading archives from anything, using an abstract base class, so one could provide a custom Windows file reader.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Thu Oct 02, 2008 1:42 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2008-10-02T13:35:01-07:00</updated>
<published>2008-10-02T13:35:01-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37984#p37984</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37984#p37984"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37984#p37984"><![CDATA[
The GNU GPL's copyleft restriction <a href="http://www.gnu.org/licenses/gpl-faq.html#MereAggregation" class="postlink">generally stops at the boundary between one process and another</a>. If you keep anything that touches a RAR file in a separate process that communicates with the main process through a pipe (like fUnZip does), and you can keep the rest of the program pure GPL.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Thu Oct 02, 2008 1:35 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[byuu]]></name></author>
<updated>2008-10-02T11:59:27-07:00</updated>
<published>2008-10-02T11:59:27-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37983#p37983</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37983#p37983"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37983#p37983"><![CDATA[
Well, using RAR means you can't release your code as GPL (or let others do so), or make a WinRAR competitor. If you're not planning on doing either, yeah, may as well keep it in there.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=375">byuu</a> — Thu Oct 02, 2008 11:59 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[MottZilla]]></name></author>
<updated>2008-10-02T11:51:42-07:00</updated>
<published>2008-10-02T11:51:42-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37982#p37982</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37982#p37982"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37982#p37982"><![CDATA[
I'll try out your File Extractor blargg. I see no reason why I'd need to remove GZ,7Z, or RAR support, even if I'm just going to use Zip.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1726">MottZilla</a> — Thu Oct 02, 2008 11:51 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Dwedit]]></name></author>
<updated>2008-10-01T20:56:34-07:00</updated>
<published>2008-10-01T20:56:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37972#p37972</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37972#p37972"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37972#p37972"><![CDATA[
Oh noes!  It doesn't support those really old "Exploding..." ZIP files!<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=53">Dwedit</a> — Wed Oct 01, 2008 8:56 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[byuu]]></name></author>
<updated>2008-10-01T15:45:51-07:00</updated>
<published>2008-10-01T15:45:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37971#p37971</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37971#p37971"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37971#p37971"><![CDATA[
Wow, that's really cool. The 7-zip support is really tempting. I love the simple API to it, too.<br /><br />Does your library support automatic UTF-8 -&gt; UTF-16 conversion for Windows? If not, there's no way to open Unicode file names; unless of course you also have a wchar_t interface (yuck.)<br /><br />Too bad JMA is GPL, and RAR is ... anti-competitive? Getting those both in there as LGPL would make this one killer all-purpose library for emulators.<br /><br />I wonder if it's possible to clean-room unrar and implement that as pure LGPL ... doubt he has a patent on the algorithm.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=375">byuu</a> — Wed Oct 01, 2008 3:45 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-10-01T14:54:51-07:00</updated>
<published>2008-10-01T14:54:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37970#p37970</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37970#p37970"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37970#p37970"><![CDATA[
Take a look at my not-officially-released <a href="http://h1.ripway.com/blargg/temp/File_Extractor-0.4.3.tbz" class="postlink">File_Extractor</a>. It supports ZIP, GZ, 7Z, and RAR. If you want just ZIP support, the rest can be removed completely. One thing, it only supports "deflate" and "none" as compression methods for ZIP, which are the most commonly used compression types.<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">int main&#40;&#41;<br />&#123;<br />    fex_err_t err;<br />    File_Extractor* fex = fex_open&#40; &quot;test.zip&quot;, &amp;err &#41;;<br />    if &#40; !fex &#41;<br />        error&#40; err &#41;;<br />    <br />    while &#40; !fex_done&#40; fex &#41; &#41;<br />    &#123;<br />        const char* name = fex_name&#40; fex &#41;;<br />        long size = fex_size&#40; fex &#41;;<br />        if &#40; is_name_we_want&#40; name &#41; &#41;<br />        &#123;<br />            /* Either have FEX read data into memory and give us a<br />            pointer to it... */<br />            const unsigned char* data = fex_data&#40; fex, &amp;err &#41;;<br />            if &#40; !data &#41;<br />                error&#40; err &#41;;<br />            <br />            /* ...or read it ourselves, in however many chunks we like. */<br />            error&#40; fex_read&#40; fex, my_buffer1, first_size &#41; &#41;;<br />            error&#40; fex_read&#40; fex, my_buffer2, second_size &#41; &#41;;<br />            /* ... */<br />        &#125;<br />        error&#40; fex_next&#40; fex &#41; &#41;;<br />    &#125;<br />    fex_close&#40; fex &#41;;<br />    return 0;<br />&#125;</div><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Wed Oct 01, 2008 2:54 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[byuu]]></name></author>
<updated>2008-09-30T15:55:23-07:00</updated>
<published>2008-09-30T15:55:23-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37938#p37938</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37938#p37938"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37938#p37938"><![CDATA[
If you're okay with the zlib license, Nach made some modifications to zlib and let me use it for my emu ... it extracts ZIP files. You're more than welcome to use it. Extractor looks like this:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">uint8_t* ZipReader::read&#40;unsigned length&#41; &#123;<br />  uint8_t *data = 0;<br /><br />  if&#40;!filesize&#41; return 0;<br /><br />  if&#40;length &lt;= filesize&#41; &#123;<br />    //read the entire file into RAM<br />    data = new&#40;zeromemory&#41; uint8_t&#91;filesize&#93;;<br />    unzReadCurrentFile&#40;zipfile, data, filesize&#41;;<br />  &#125; else if&#40;length &gt; filesize&#41; &#123;<br />    //read the entire file into RAM, pad the rest with 0x00s<br />    data = new&#40;zeromemory&#41; uint8_t&#91;length&#93;;<br />    unzReadCurrentFile&#40;zipfile, data, filesize&#41;;<br />  &#125;<br /><br />  return data;<br />&#125;<br /><br />ZipReader::ZipReader&#40;const char *fn&#41; : filesize&#40;0&#41;, zipready&#40;false&#41; &#123;<br />  unz_file_info cFileInfo; //Create variable to hold info for a compressed file<br />  char cFileName&#91;sizeof&#40;cname&#41;&#93;;<br /><br />  if&#40;zipfile = unzOpen&#40;fn&#41;&#41; &#123; //Open zip file<br />    for&#40;int cFile = unzGoToFirstFile&#40;zipfile&#41;; cFile == UNZ_OK; cFile = unzGoToNextFile&#40;zipfile&#41;&#41; &#123;<br />      //Gets info on current file, and places it in cFileInfo<br />      unzGetCurrentFileInfo&#40;zipfile, &amp;cFileInfo, cFileName, sizeof&#40;cname&#41;, 0, 0, 0, 0&#41;;<br /><br />      if&#40;&#40;cFileInfo.uncompressed_size &lt;= MAXROM+512&#41; &amp;&amp; &#40;cFileInfo.uncompressed_size &gt; filesize&#41;&#41; &#123;<br />        strcpy&#40;cname, cFileName&#41;;<br />        filesize = cFileInfo.uncompressed_size;<br />      &#125;<br />    &#125;<br /><br />    if&#40;filesize&#41; &#123;<br />      unzLocateFile&#40;zipfile, cname, 1&#41;;<br />      unzOpenCurrentFile&#40;zipfile&#41;;<br />      zipready = true;<br />    &#125;<br />  &#125;<br />&#125;<br /><br />ZipReader::~ZipReader&#40;&#41; &#123;<br />  if&#40;zipfile&#41; &#123;<br />    unzCloseCurrentFile&#40;zipfile&#41;;<br />    unzClose&#40;zipfile&#41;;<br />  &#125;<br />&#125;</div><br /><br />The zlib library itself is all in pure C89, and you could thus write your interface to it the same way, but it's pretty bulky at ~513kb.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=375">byuu</a> — Tue Sep 30, 2008 3:55 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2008-09-30T15:39:56-07:00</updated>
<published>2008-09-30T15:39:56-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37936#p37936</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37936#p37936"/>
<title type="html"><![CDATA[Re: Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37936#p37936"><![CDATA[
<div class="quotetitle">MottZilla wrote:</div><div class="quotecontent"><br />I searched and there was no topic about this. What are some ways to go about loading Zipped ROM files? I've know about ZLIB however it doesn't actually handle ZIP archives.<br /></div><br />I seem to remember that <a href="http://www.info-zip.org/UnZip.html" class="postlink">Info-ZIP UnZip</a> can be built as a library.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />So can anyone recommend a relatively easy way to pass some library a file path and get it to decompress the ROM inside the zip to some free memory area for me?<br /></div><br />Even if you can't get Info-ZIP UnZip to work as a library, you could still run Info-ZIP fUnZip through a pipe, using popen() or your platform's equivalent.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Tue Sep 30, 2008 3:39 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[MottZilla]]></name></author>
<updated>2008-09-30T14:58:14-07:00</updated>
<published>2008-09-30T14:58:14-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37930#p37930</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37930#p37930"/>
<title type="html"><![CDATA[Loading Zipped ROMs]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4420&amp;p=37930#p37930"><![CDATA[
I searched and there was no topic about this. What are some ways to go about loading Zipped ROM files? I've know about ZLIB however it doesn't actually handle ZIP archives. So can anyone recommend a relatively easy way to pass some library a file path and get it to decompress the ROM inside the zip to some free memory area for me?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1726">MottZilla</a> — Tue Sep 30, 2008 2:58 pm</p><hr />
]]></content>
</entry>
</feed>