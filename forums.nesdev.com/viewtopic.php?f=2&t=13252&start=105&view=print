<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Revisiting the quest for the most accurate NES palette:</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Revisiting the quest for the most accurate NES palette:</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=13252">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=13252</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>8</strong> of <strong>9</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Tue Jan 10, 2017 8:34 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Do you have a flashcart?</div>Nope. I don't really have an overview of which one to get for a 60-pin system.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Tue Jan 10, 2017 8:57 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />For a 60-pin system, the EverDrive N8 should be good enough.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Tue Jan 10, 2017 9:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent">color $31 at 319.9 degrees (nominal: 330)<br />color $36 at 113.1 degrees (nominal: 120)<br /></div>Since I bothered to play around with the Pac-Land image and write down some numbers:<br />Blue $31 at 316-323° (nom: 330)<br />Blue $11 at 323-335° (nom: 330)<br />Magenta $15 at 84-90° (nom: 90)<br />Peach $36 at 109-117° (nom: 120)<br />Brown $07 at 150-158° (nom: 150)<br />Orange $27 at 140-146° (nom: 150)<br />Green $1B at 268-274° (nom: 270)<br /><br />I clearly need to put more effort into filter design to reduce those ranges.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Wed Jan 11, 2017 7:57 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I don't use Matlab, but I can post the C source to my NTSC decoder that takes the .raw captured file and outputs a .rawraw RGB file, if that helps you.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Wed Jan 11, 2017 2:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Do you have a flashcart?</div>Nope. I don't really have an overview of which one to get for a 60-pin system.</div><br />The Everdrive N8 has a Famicom 60-pin option, though I can also confirm that the PowerPak and Everdrive N8 72-pin both work on a Famicom using simple 72-60 pin converters.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Great Hierophant</b> [ Wed Jan 11, 2017 6:37 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You need to perform two simple soldering mods to get the most out of your PowerPak with just about all 72-to-60 pin converters and it the stacked PowerPak and converter can get a bit wobbly, but otherwise you will be good.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Wed Jan 11, 2017 8:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent">I don't use Matlab, but I can post the C source to my NTSC decoder that takes the .raw captured file and outputs a .rawraw RGB file, if that helps you.<br /></div>Eh, the matlab/octave fragment was more for proving to myself that your methodology is correct. It clearly is, and now I think the only remaining parameter to be explored is just how much variation we should anticipate across all the hardware variants.<br /><br />Is there an easy way to calculate how &quot;non-ideal&quot; either not a square wave or not a sine wave this is? Is the &quot;skewness&quot; test the right one? <br /><br />Skewness of 10000 points of a sampled ideal sine wave appears to be approximately 0, but skewness of the huge patch of color $31 is 0.126 and the mean is very slightly higher than the median (Δ=0.336).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Thu Jan 12, 2017 5:27 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Skewness is a measure of asymmetry. A square wave with non-equal duty cycles is indeed asymmetrical, though I am not sure how this translates to the phase of the fundamental frequency. Tepples suggested hue-specific phase shifts resulting from hue-specific duty cycles. If non-equal duty cycles of a square wave translate into phase shifts at the subcarrier (fundamental) frequency, then the phase shift amount should be correlated with skewness in sign and magnitude. <br /><br />For the record, I have used the same setup to measure the composite video output of a Tandy 1000 computer. It can output six hues at two luminance levels. The two levels are different for each of the hues. I measure no level-specific phase shift beyond the noise level between the two luminance levels of each hue:<div class="codetitle"><b>Code:</b></div><div class="codecontent">Color 1: 0.008638 (blue, nominal: 0)<br />Color 2: 223.742996 (green, nominal: 225)<br />Color 3: 269.025116 (cyan, nominal: 270)<br />Color 4: 92.503235 (red, nominal: 90)<br />Color 5: 46.509937 (magenta, nominal: 45)<br />Color 6: 180.940750 (yellow, nominal: 180)<br />Color 9: 359.858380 (blue, nominal: 0)<br />Color A: 223.127350 (green, nominal: 225)<br />Color B: 268.470940 (cyan, nominal: 270)<br />Color C: 91.619957 (red, nominal: 90)<br />Color D: 46.090595 (magenta, nominal: 45)<br />Color E: 179.678253 (yellow, nominal: 180)</div> This tells me that whatever I am measuring from the Famicom is not an artifact introduced by my capturing hardware, otherwise I would be measuring level-specific phase shifts in the the Tandy 1000's composite video output as well. I have attached that capture as well, in case you want to try your skewness test on that file.

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=7562">RGBI16.zip</a> [162.59 KiB]
			</span><br />
			<span class="gensmall">Downloaded 54 times</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Fri Jan 20, 2017 11:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have received my Everdrive N8. I have used &quot;Blargg's Full Palette&quot; to make raw capture files that show all 52 colors. The attached archive contains three files:<ul><li>Palette-RP2C02E-RCA.raw: Signal from the yellow RCA socket at the back of the Sharp Twin Famicom AN-500B (PPU: RP2C02E-0)</li><li>Palette-RP2C02G-PPU.raw: Signal from the PPU's output pin of the Sharp Twin Famicom AN-505BK (PPU: RP2C02G-0)</li><li>Palette-RP2C02G-RCA.raw: Signal from the yellow RCA socket at the back of the Sharp Twin Famicom AN-505BK (PPU: RP2C02G-0)</li></ul>I was unable to get any signal from the output pin of the RP2C02E-0.<br /><br />I am posting these files without comment for now, because I am curious about what conclusions other people draw from them, before I share mine.

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=7660">FullPaletteRaw.zip</a> [604.33 KiB]
			</span><br />
			<span class="gensmall">Downloaded 54 times</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Fri Jan 20, 2017 12:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />My biggest observation is what I see in the first scanline of the 2C02E output of colors $1x :<br /><br />At this point, I have no idea what to think any more. Colors $12, $16, and $1A are a different phase offset than the other ones, not restricted to just even or odd phases.

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<a href="./download/file.php?id=7662&amp;mode=view"><img src="./download/file.php?id=7662&amp;t=1" alt="RP2C02E-scanline41.png" /></a><br />
			<span class="gensmall">RP2C02E-scanline41.png [ 35.7 KiB | Viewed 2279 times ]</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Fri Jan 20, 2017 12:57 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Do the affected colors remain $12, $16, and $1A even across resets? Perhaps the phase might get distorted more when signal level transitions coincide with the pixel clock.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Sat Jan 21, 2017 6:23 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />As far as I can tell, they remain the same. Attached find four different capture files from the RP2C02E, each taken after another RESET. Note that the Everdrive UI appears between the RESET and the palette test program.

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=7677">Palette-RP2C02E-RCA-4times.zip</a> [756.13 KiB]
			</span><br />
			<span class="gensmall">Downloaded 55 times</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Sat Jan 21, 2017 1:27 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have captured the output (see attachment) of a PAL NES with an RP2C07 PPU, from the yellow RCA socket. I have not modified the capture program itself, which is why it only captures five sixths of the 1000 ms/50Hz field. Note how the RP2C07, unlike the RP2C02, never illuminates the border area with background color 0.<br /><br />The first picture shows the result I get when I use my &quot;Simple PAL&quot; decoder --- properly accounting for the phase shift in the V channel from scanline to scanline, but not averaging each scanline's demodulated chroma signal with the delayed previous scanline's demodulated chroma signal. If the signal is affected by phase distortion, then we should see <a href="https://en.wikipedia.org/wiki/Hanover_bars" class="postlink">Hanover bars</a> - opposite hue errors from scanline to scanline:<br /><img src="http://symphoniae.com/nrs/nesdev/SMB-SimplePAL.png" alt="Image" /><br />The second picture shows the result I get when I use my &quot;Full PAL&quot; decoder --- averaging each scanline's demodulated chroma signal with the delayed previous scanline's demodulated chroma signal:<br /><img src="http://symphoniae.com/nrs/nesdev/SMB-FullPAL.png" alt="Image" /><br />These results indicate to me that the PAL NES is just as susceptible to considerable phase shifts as the NTSC NES, but because the PAL system is designed to eliminate the effects of phase shifts, PAL televisions will display colors that are almost exactly the nominal hues minus 15.0 degrees.<br /><br />Capturing regular television pictures and decoding them with my &quot;Simple PAL&quot; decoder exhibits only very slight Hanover bars, indicating little phase distortion:<br /><img src="http://symphoniae.com/nrs/nesdev/Trapattoni.png" alt="Image" />

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=7698">SMB-Title-RP2C07.zip</a> [163.84 KiB]
			</span><br />
			<span class="gensmall">Downloaded 65 times</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Wed Jan 25, 2017 6:19 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />RAW... OK... but how to parse the file, as RGB or any other format?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Jan 25, 2017 6:22 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Revisiting the quest for the most accurate NES palette:</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />In case it isn't obvious to others reading this, the reason you don't get Hanover bars from a broadcast signal is the 90 degree swing of broadcast TV's color burst compared to the nonstandard 120 degree swing from the 2C07.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>8</strong> of <strong>9</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>