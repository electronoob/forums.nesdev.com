<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Next console to emulate?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Next console to emulate?</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=5&amp;t=7936">http://forums.nesdev.com/viewtopic.php?f=5&amp;t=7936</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ehguacho</b> [ Fri Jul 01, 2011 9:06 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Next console to emulate?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hi everyone! Now I have a stable NES emulator, I want to move to another project a little more complex. I think Game Boy and Super NES are both good options, but I need some advices in choosing one to them. A good point to be considered is the amount and quality of the enabled technical documentation. On the other hand, i don't know wich of them is more complex. Wich console do you recommend and why?
<br />
<br />Cheers and thank you all in advance!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Shiru</b> [ Sat Jul 02, 2011 2:23 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'd say it is quite obvious that SNES is more complex than GB.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mic_</b> [ Sat Jul 02, 2011 4:24 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I would say the GB is even easier to write an emulator for than the NES. The GBC adds a bit of extra complexity, but it's still not a huge project.
<br />
<br />You could try writing a GBA emulator. That's a fairly large project, but still entirely feasible for one person. And there's very good documentation available for it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Sat Jul 02, 2011 7:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Next console to emulate?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">ehguacho wrote:</div><div class="quotecontent">Hi everyone! Now I have a stable NES emulator, I want to move to another project a little more complex.</div>
<br />
<br />Do you plan to release it into public domain?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ehguacho</b> [ Sat Jul 02, 2011 9:12 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Next console to emulate?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zepper wrote:</div><div class="quotecontent"><div class="quotetitle">ehguacho wrote:</div><div class="quotecontent">Hi everyone! Now I have a stable NES emulator, I want to move to another project a little more complex.</div><br /><br />Do you plan to release it into public domain?</div>
<br />
<br />No, I just do it as a hobby <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />
<br />
<br />thank you all for your responses!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>MottZilla</b> [ Sat Jul 02, 2011 8:42 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I wrote a GB emulator after my NES emulator. You should definitely try that and probably look into GBC support too. SNES is far more complex as the CPU certainly takes more effort than GB or NES and the PPU is extremely complex. Atleast it can be if you fully emulate it. Also the SPC audio chip might be a challenge as well, I'm not sure though.
<br />
<br />If I were to just guess I'd say this would be easiest to hardest.
<br />NES, GB/GBC, Genesis (ignoring add-ons), SNES.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ehguacho</b> [ Sun Jul 03, 2011 12:38 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'm on GB emulation now, and I can say that the jump from NES to GB is quite big. Anyway, I'm in the same condition that when started to develop my NES emulator, so I know it's all about time and effort <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />
<br />
<br />Some day I'll care about SNES (hopefully!).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>kevtris</b> [ Tue Jul 05, 2011 9:28 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">mic_ wrote:</div><div class="quotecontent">I would say the GB is even easier to write an emulator for than the NES. The GBC adds a bit of extra complexity, but it's still not a huge project.<br /><br />You could try writing a GBA emulator. That's a fairly large project, but still entirely feasible for one person. And there's very good documentation available for it.</div>
<br />
<br />
<br />Do not underestimate the GB like I did.  Its VDP (PPU, whichever you wish to call it) is extremely complex in its behaviour vs. the NES, which is much more rigidly timed.
<br />
<br />
<br />The GB video is extremely complex if you wish to accurately cycle time it.  The VDP stalls writing pixels to the display while it fetches sprites as they are needed, and it will stop clocking the display sometimes while it continues to shift pixels out (for fine X scrolling).  The way the sprites, scroll, and window interact are extremely complex and I am still unraveling the mysteries of how this works.
<br />
<br />The number of cycles it takes to render a single scanline to the LCD can take as few as 173 cycles to possibly over 300 cycles, depending on window position, xscroll, and the number and position of sprites.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>MottZilla</b> [ Tue Jul 05, 2011 9:58 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />While that's true, I don't think his goal is to emulate the system with 100% accuracy, but enough for fairly high game compatibility/playability.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>kevtris</b> [ Wed Jul 06, 2011 9:11 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">MottZilla wrote:</div><div class="quotecontent">While that's true, I don't think his goal is to emulate the system with 100% accuracy, but enough for fairly high game compatibility/playability.</div>
<br />
<br />I had a question about how necessary it is to emulate the GB to that level of accuracy...  how many games rely on close LCD timing to function properly?  Are there only a few games that use it, or do many games need careful timing to function?  The obvious case I know of is Prehistorik Man which has a pretty insane title screen (but amusingly,  pretty bland and boring in-game compared).
<br />
<br />Speaking of, does anyone know how that game performs that black bouncing text on the title screen?  I have not been able to figure it out, even using the debugger on an emulator.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>MottZilla</b> [ Wed Jul 06, 2011 10:18 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I think very few games need that accurate of timing. I think unlike NES fewer if any games use timed loops and instead rely on interrupts. But I'm not 100% on that. I'm sure there are some examples of edge cases but I would think the vast majority of commercial software would not be that sensitive to it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Jul 06, 2011 10:23 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">kevtris wrote:</div><div class="quotecontent">Speaking of, does anyone know how that game performs that black bouncing text on the title screen?  I have not been able to figure it out, even using the debugger on an emulator.</div>
<br />Might it be related to the so-called "Demotronic trick"?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>kevtris</b> [ Thu Jul 07, 2011 10:17 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent"><div class="quotetitle">kevtris wrote:</div><div class="quotecontent">Speaking of, does anyone know how that game performs that black bouncing text on the title screen?  I have not been able to figure it out, even using the debugger on an emulator.</div><br />Might it be related to the so-called "Demotronic trick"?</div>
<br />
<br />Yeah that is possible... I was thinking they might've been writing to the LCD in real time, but it'd be pretty tricky to do.  There's a few things about it that bug me though.
<br />
<br />The resolution appears to be 8 pixels across (i.e. 1 character) and seems to have some modicum of fine scroll in either direction.  This would require them writing a new value to the LCD control register(s) every 8 pixels, which is every 2 instructions.  Possible I guess, if a load (LD A,value) and store (LD lcdreg,A) takes 4 cycles each.  (or LD A,B and LD A,C for the "on" and "off" values).
<br />
<br />I *did* find this....
<br />
<br /><!-- m --><a class="postlink" href="http://www.mobygames.com/developer/sheet/view/developerId,207764/">http://www.mobygames.com/developer/shee ... Id,207764/</a><!-- m -->
<br />
<br />which has the following:
<br />
<br />"Prehistorik Man identified sprites likely to cause incorrect graphics and replaced them with software sprites copied into the video ram. "
<br />
<br />"It also ported an Amstrad CPC trick to draw big scrolling messages."
<br />
<br />I have not been able to find any information on this "cpc trick" that he's talking about.
<br />
<br />I watched that demotronic demo, and their trick appears to be writing to Yscroll during rendering, which is combinatorial.  This causes stretching and other Y effects, which is what their demo appears to be showcasing.
<br />It seems they get character granularity which is possible, if it's running on a GBC because there will be 16 CPU cycles per character, which should be plenty to update yscroll each character cell.
<br />
<br />
<br />On checking CPU cycle timings for the possible Prehistorik tricks, it looks like there IS a way to do this.  You can write to the LCD control register 2 different values using LD (hl),n.   This instruction takes 8 cycles. They appear to play with the palette register.  So, to write the scrolling message they could simply do something like this:
<br />
<br />ld b,normalpalette  ;this is the normal background palette
<br />ld c,0ffh                ;solid black palette
<br />ld hl,0ff47h           ;palette register
<br />
<br />ld (hl),b      ;normal palette
<br />ld (hl),c      ;black palette
<br />ld (hl),b      ;normal palette
<br />ld (hl),c      ;black palette
<br />ld (hl),b      ;normal palette
<br />ld (hl),c      ;black palette
<br />ld (hl),b      ;normal palette
<br />ld (hl),c      ;black palette
<br />ld (hl),b      ;normal palette
<br />ld (hl),c      ;black palette
<br />ld (hl),b      ;normal palette
<br />ld (hl),c      ;black palette
<br />
<br />This code will theoretically draw alternating black bands on the LCD.  This is also how the demotronic probably works, but I suspect they do something like this:
<br />
<br />ld hl,scrollvalues    ;place where Y scroll values are stored
<br />ld de,yscroll          ;LCD Y scroll register
<br />
<br />ld a(hl+)
<br />ld (de),a
<br />ld a(hl+)
<br />ld (de),a
<br />ld a(hl+)
<br />ld (de),a
<br />ld a(hl+)
<br />ld (de),a
<br />ld a(hl+)
<br />ld (de),a
<br />ld a(hl+)
<br />ld (de),a
<br />ld a(hl+)
<br />ld (de),a
<br />... repeated 20 times total 
<br />
<br />That will take 16 cycles per character, but on the GBC that's exactly how many cycles there are when the CPU is in 2x speed mode.
<br />
<br />One other thing-  for P.Man's fine scrolling on the large text, this is fairly easy to do using sprites.  Since the sprite delays the rendering 6-11 cycles, it's possible to use them to fine tune the position on the screen where the palette changes occur.  This would be required to compensate for the background scroll (which "eats" up to 7 cycles in and of itself).  2 sprites can be used then to fix the position where the palette changes occur, because a single sprite can only do 6 pixels' worth of change.
<br />
<br />So, that's how I am guessing both tricks are done.   I don't know all the ins and outs of GB yet so this is all just supposition.  comments?

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>