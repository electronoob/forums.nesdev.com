<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - How to program a NINTENDO POWER Cartridge ?</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - SNESdev" href="http://forums.nesdev.com/feed.php?f=12" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - How to program a NINTENDO POWER Cartridge ?" href="http://forums.nesdev.com/feed.php?f=12&amp;t=11453" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '9');
	var per_page = '15';
	var base_url = './viewtopic.php?f=12&amp;t=11453';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<!--<div style="float: right;">
					<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick">
					<input type="hidden" name="hosted_button_id" value="X2HM4WNR5YT8S">
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
					<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
					</form>
				</div>-->
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=minion"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Fri Aug 17, 2018 12:30 am<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=25">Other</a> &#187; <a href="./viewforum.php?f=23">Other Retro Dev</a> &#187; <a href="./viewforum.php?f=12">SNESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />
	

					<center>
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- NesDev Forums -->
					<ins class="adsbygoogle"
						 style="display:block"
						 data-ad-client="ca-pub-7801010229099644"
						 data-ad-slot="7979066809"
						 data-ad-format="auto"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>
					</center>
	<br />

	<div class="forumrules">
		
			<h3>Forum rules</h3><br />
			Related:<br /><ul><li>For making cartridges of your Super NES games, see <a href="http://forums.nesdev.com/viewforum.php?f=28" class="postlink">Reproduction</a>.</li></ul>
		
	</div>

	<br clear="all" />


<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=12&amp;t=11453&amp;start=120">How to program a NINTENDO POWER Cartridge ?</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=12"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=12&amp;t=11453"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>9</strong> of <strong>14</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 199 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=12&amp;t=11453&amp;start=105">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=12&amp;t=11453">1</a><span class="page-dots"> ... </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=75">6</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=90">7</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=105">8</a><span class="page-sep">, </span><strong>9</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=135">10</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=150">11</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=165">12</a><span class="page-dots"> ... </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=195">14</a> &nbsp;<a href="./viewtopic.php?f=12&amp;t=11453&amp;start=135">Next</a></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=12&amp;t=11453&amp;start=120&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=12&amp;t=11453&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=12&amp;t=11453&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p158800"></a>
				<b class="postauthor">nocash</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p158800">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=158800#p158800"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Nov 10, 2015 3:32 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Feb 24, 2012 12:09 pm<br /><b>Posts:</b> 602
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">BennVenn wrote:</div><div class="quotecontent">Success! A big thanks to skaman!!  <br />(must write 0x77 twice)</div><br />How did you do that exactly? And does it work stable?<br /><br />I am assuming that &quot;write 0x77&quot; does mean a AA-55-77 sequence like this:<div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp; &nbsp; &nbsp;mov&nbsp; a,0aah // mov&nbsp; &#91;far 0c0aaaah&#93;,a&nbsp; ;\<br />&nbsp; &nbsp; &nbsp; &nbsp;mov&nbsp; a,055h // mov&nbsp; &#91;far 0c05554h&#93;,a&nbsp; ; causes ALL bytes = C8h (sometimes FFh, or CAh)<br />&nbsp; &nbsp; &nbsp; &nbsp;mov&nbsp; a,077h // mov&nbsp; &#91;far 0c0aaaah&#93;,a&nbsp; ;/</div><br />Right? That is, using SNES addressing, with the C00000h as base address for HIROM area, and with the 5555h/2AAAh values multiplied by two for the 16bit FLASH chips being used in SNES.<br /><br />Whenever executing the above sequence (once, or twice, or several times), and then reading from [C0FFxxh], I am just receiving C8h bytes from the chip (occassionally with a few CAh or FFh bytes inserted on some reads).When reading from [C000xxh], I am getting C0h instead C8h. Anyways, that are just garbage or status values, not the hidden data.<br />Another odd thing is that, after sending the above sequence, the chip stops responding to any normal commands (eg. command AA-55-F0 doesn't return to normal FLASH data read mode anymore).<br /><br />However, if I remove the whole write AA-55-77 stuff, and re-upload my test program to the SNES, then it does <em>sometimes</em> pop up with the hidden data - although I haven't issued the AA-55-77 stuff (nor the 38h,D0h stuff) in that situations at all.<br />So, it does look as if the 77h is <em>starting</em> to enter the hidden data mode on SNES, but it does still require whatever random bus traffic before completely reaching the hidden data read state.<br />I've tried to insert extra reads &amp; writes &amp; delays here and there, but haven't been able to reproduce that effect yet.<br /><br />EDIT: Thinking about it. When I re-upload (and reboot) my test program, then MX15001 chip might automatically issue the 38h,D0h stuff (if it's doing so when receiving a /RESET from SNES side). So that might also explain where the hidden data is coming from even when NOT requesting it (ie. on the SNES, the AA-55-77 <em>might</em> be just causing the FLASH chip to fail to return to normal data mode after having received the 38h,D0h stuff from the MX15001).</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5211"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p158805"></a>
				<b class="postauthor">nocash</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p158805">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=158805#p158805"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Nov 10, 2015 3:59 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Feb 24, 2012 12:09 pm<br /><b>Posts:</b> 602
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Btw, does the SNES-sytle method for reading hidden data work on gameboy, too?<br /><br />On SNES, with 16bit FLASH chips, it works like this:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &#91;0AAAAh&#93;=AAh, &#91;05554h&#93;=55h, &#91;0AAAAh&#93;=F0h&nbsp; &nbsp;;FLASH read/reset command<br />&nbsp; &#91;00000h&#93;=38h, &#91;00000h&#93;=D0h, &#91;00000h&#93;=71h&nbsp; &nbsp;;FLASH request chip info part 1<br />&nbsp; dummy=&#91;00004h&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;Read Ready-status (bit7=1=ready)<br />&nbsp; &#91;00000h&#93;=72h, &#91;00000h&#93;=75h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;FLASH request chip info part 2<br />&nbsp; read=&#91;0FF00h+(0..FFh)&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;Read hidden data<br />&nbsp; &#91;0AAAAh&#93;=AAh, &#91;05554h&#93;=55h, &#91;0AAAAh&#93;=F0h&nbsp; &nbsp;;FLASH read/reset command<br /></div><br /><br />For the gameboy's 8bit FLASH chips, one would probably need to divide the 0AAAAh, 05555h, and 00004h values by two, so it should work as so:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &#91;05555h&#93;=AAh, &#91;02AAAh&#93;=55h, &#91;05555h&#93;=F0h&nbsp; &nbsp;;FLASH read/reset command<br />&nbsp; &#91;00000h&#93;=38h, &#91;00000h&#93;=D0h, &#91;00000h&#93;=71h&nbsp; &nbsp;;FLASH request chip info part 1<br />&nbsp; dummy=&#91;00002h&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;Read Ready-status (bit7=1=ready)<br />&nbsp; &#91;00000h&#93;=72h, &#91;00000h&#93;=75h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;FLASH request chip info part 2<br />&nbsp; read=&#91;0FF00h+(0..FFh)&#93;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;Read hidden data<br />&nbsp; &#91;05555h&#93;=AAh, &#91;02AAAh&#93;=55h, &#91;05555h&#93;=F0h&nbsp; &nbsp;;FLASH read/reset command<br /></div><br />Does that work?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5211"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p158809"></a>
				<b class="postauthor">BennVenn</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p158809">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=158809#p158809"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Nov 10, 2015 4:16 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Mar 29, 2014 10:01 pm<br /><b>Posts:</b> 107<br /><b>Location:</b> Australia
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I call these functions, then read 256 bytes from address 0x0000<br />    main_JPN_F2()<br />    main_JPN_F4()<br />    main_JPN_F5(0x77)<br />    main_JPN_F5(0x77)<br />    <br /> Where F2() is the WE line enable, F4() is the WP disable. You don't need to do this on the SNES, it doesn't have the little brain inside the MBC.<br /><br />F5(0x77) is a write to 0x5555&lt;0xAA, 0x2AAA&lt;0x55, 0x5555&lt;0x77<br /><br />And yes, after issuing that command I am unable to perform a chip erase, write byte etc without first issuing a F5(0xF0) command.<br /><br />I'll try your 0x38,0xD0,0x71 sequence now and report back</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6460"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p158811"></a>
				<b class="postauthor">BennVenn</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p158811">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=158811#p158811"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Nov 10, 2015 4:25 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Mar 29, 2014 10:01 pm<br /><b>Posts:</b> 107<br /><b>Location:</b> Australia
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">And no, that command sequence enabled nothing. Also, reading from 0xFF00 on a GBcart is not valid, I bank switched to access 0xFF00 and still it was just ROM data being read out. Likewise from 0x0000. There was no status byte returned either so I don't think the flash IC recognises that command set as valid.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6460"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p158900"></a>
				<b class="postauthor">skaman</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p158900">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=158900#p158900"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Nov 11, 2015 11:52 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Oct 24, 2014 1:56 am<br /><b>Posts:</b> 76
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">In a way, the SF magic &quot;0x38&quot; does show up in the GB sequence.  The flash commands that allow overwriting of the GB NP Register is a sequence with 0x60 (sector unprotect/protect) and 0xE0 (sequential load to page buffer).  Following the 0xE0 command, 0x3 and 0x8 are sent to 0x120.  See the last section of BennVenn's post (<!-- l --><a class="postlink-local" href="http://forums.nesdev.com/viewtopic.php?f=12&amp;t=11453&amp;start=105#p158687">viewtopic.php?f=12&amp;t=11453&amp;start=105#p158687</a><!-- l -->).</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6741"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p158944"></a>
				<b class="postauthor">BennVenn</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p158944">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=158944#p158944"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Nov 11, 2015 5:20 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Mar 29, 2014 10:01 pm<br /><b>Posts:</b> 107<br /><b>Location:</b> Australia
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">In regards to the 256byte NP register write - it is unusual that the MBC allows a flash write through where every other command write to the flash needs to be done using command 0x0F... I might look into this, could make for faster cart flashing</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6460"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p158992"></a>
				<b class="postauthor">nocash</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p158992">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=158992#p158992"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Nov 12, 2015 4:00 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Feb 24, 2012 12:09 pm<br /><b>Posts:</b> 602
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">skaman wrote:</div><div class="quotecontent">In a way, the SF magic &quot;0x38&quot; does show up in the GB sequence.</div><br />I can't see a 38 in there. If you meant the 3 and 8 bytes, that are three different things: 3 and 8 isn't 38, the 3 and 8 are written to the mx15002 chip (not to the flash chip), and the 3 and 8 were used with the hidden-write sequence (not the hidden read sequence).<br /><br /><div class="quotetitle">BennVenn wrote:</div><div class="quotecontent">write to 0x5555&lt;0xAA, 0x2AAA&lt;0x55, 0x5555&lt;0x77<br />And yes, after issuing that command I am unable to perform a chip erase, write byte etc without first issuing a F5(0xF0) command.</div><br />That seems to be different on SNES. After command 70, I can't send any further commands, specifically: even F0 doesn't work anymore.<br /><br /><div class="quotetitle">BennVenn wrote:</div><div class="quotecontent">Also, reading from 0xFF00 on a GBcart is not valid, I bank switched to access 0xFF00 and still it was just ROM data being read out. Likewise from 0x0000.</div><br />Yup, the gameboy would need some sort of bank switching for reading/writing FF00h. Maybe also for writing 0000h (assuming that writes to first 16K might be passed to the mx15002/mbc registers, instead of to flash).<br /><br />I am still miles away from having an idea how the flash addressing would work on gameboy. For example, if you wanted to write a byte to flash address 8000h, then you would need writes to flash addresses 5555,2AAA,8000, which would be three different 16K banks. Assuming the gameboy address 0000-3FFF is reserved for mx/mbc I/O ports, then you would probably need to squeeze all three writes through gameboy address 4000-7FFF, each preceeded by a write to the mbc rom bank register (at 2180 or the like)?<br />Or wait, you mentioned something about special mx/mbc addresses for writing to 5555,2AAA, so that registers could be written at any time, regardless of the current bank for data access?<br /><br />The purpose of the special write command (that with lo,hi,data parameters) isn't clear to me. If the flash chip connects directly to the gameboy databus, then it should be possible to do direct writes without needing that command... unless nintendo has totally screwed up the mx15002 chip design. Seeing the pinout of the mx15002 chip would be very interesting to figure out how the hardware works - and if there is any good (or bad) reason for using direct or indirect writes.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5211"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p159020"></a>
				<b class="postauthor">BennVenn</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p159020">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=159020#p159020"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Nov 12, 2015 2:14 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Mar 29, 2014 10:01 pm<br /><b>Posts:</b> 107<br /><b>Location:</b> Australia
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Flash addressing is a pain, and yes, it involves lots of writes to the flash, bank swapping, flash, bank swapping. And here lies the problem. If you write say 5555,AA, then bank swap, if the flash IC see's the bank swap write it will abort the instruction you are trying to pass to it.<br /><br />This is why most flash carts use an unused pin on the edge connector to control the flash WE, so you are free to bank switch as you like and issue flash commands only to the flash IC.<br /><br />Nintendo seem to have got around this by using the MBC IC to do all flash commands. The NP IC works like this:<br /><br />You write the command instruction to the IC (0x0F), then load registers with the Address and data you wish to send to the flash IC, then write the execute command [0x013F]. Then the IC takes over, it waits 1 R/C constant as defined by the external RC circuit, by this stage it expects the gameboy bus to be high impedance. It then takes over the bus, sends the Address to the Flash Address bus, the data to the data bus, then triggers the flash WE pin for a few nS.<br /><br />Using this technique, you can address the full 16bit ROM size, with the extra bits controlled via the bank controller.<br /><br />I haven't looked into it yet, but command 0x03 and 0x08 must pass the Gameboy's WE signal straight through to the Flash IC, or else it wouldnt be able to send the NP data to the flash buffer... There must be complementary instructions to stop this.<br /><br />Some older flash carts will respond to address 0x555 and 0x2AA which means no bank switching is required for the flash preamble. This is how the SharkMX cart works.<br /><br />Looks like the SFC and GB flash chips are similar but very different. I'd day the NP structure would be the same though.<br /><br />Looking forward to the dumps Skaman is working on!</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6460"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p160269"></a>
				<b class="postauthor">skaman</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p160269">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=160269#p160269"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 06, 2015 3:29 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Oct 24, 2014 1:56 am<br /><b>Posts:</b> 76
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I hooked up a logic analyzer to my GB cart interface that sits between the GB cart and the GB XChanger.<br /><br />Here's the command sequences used when loading a new NP register:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">120, 09 (WR LOW)<br />121, AA (WR LOW)<br />122, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, CF (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 08 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 09 (WR LOW)<br />121, AA (WR LOW)<br />122, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, C0 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 08 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 09 (WR LOW)<br />121, AA (WR LOW)<br />122, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0A (WR LOW)<br />125, 62 (WR LOW)<br />126, 04 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 01 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 02 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, 60 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, 40 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />REPEAT 242X<br />0000, 02 (RD LOW)<br />0000, 03 (WR LOW)<br /><br />0000, 80 (RD LOW)<br />0000, 03 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, 60 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, 04 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />REPEAT 256X<br />0000, 00 (RD LOW)<br />0000, 03 (WR LOW)<br /><br />0000, 80 (RD LOW)<br />0000, 03 (WR LOW)<br /><br />120, 08 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 09 (WR LOW)<br />121, AA (WR LOW)<br />122, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0A (WR LOW)<br />125, 62 (WR LOW)<br />126, 04 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 01 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 02 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, A0 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 00 (WR LOW)<br />126, 00 (WR LOW)<br />127, FF (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 00 (WR LOW)<br />126, 00 (WR LOW)<br />127, FF (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, 60 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, E0 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 00 (WR LOW)<br /><br />120, 10 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 08 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />0000, B4 (WR LOW) (NEW REGISTER FILE BEGINS)<br />0001, 00 (WR LOW)<br />0002, 00 (WR LOW)<br />0003, FF (WR LOW)<br /></div><br /><br />This sequence loads the first 0x80 bytes of the new NP register.</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=6741">skaman</a> on Sat Dec 12, 2015 4:18 am, edited 4 times in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6741"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p160273"></a>
				<b class="postauthor">skaman</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p160273">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=160273#p160273"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 06, 2015 6:50 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Oct 24, 2014 1:56 am<br /><b>Posts:</b> 76
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Now to the end of the 1st half of the new register file:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">007D, FF (WR LOW)<br />007E, 00 (WR LOW)<br />007F, 00 (WR LOW) (LAST BYTE OF FIRST HALF OF REGISTER)<br />007F, FF (WR LOW)<br /><br />REPEAT 90X<br />0000, 00 (RD LOW)<br />0000, 03 (WR LOW)<br /><br />0000, 80 (RD LOW)<br />0000, 03 (WR LOW)<br /><br />120, 09 (WR LOW)<br />121, AA (WR LOW)<br />122, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0A (WR LOW)<br />125, 62 (WR LOW)<br />126, 04 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 01 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 02 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, A0 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 00 (WR LOW)<br />126, 00 (WR LOW)<br />127, FF (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 00 (WR LOW)<br />126, 00 (WR LOW)<br />127, FF (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, 60 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, E0 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 00 (WR LOW)<br /><br />120, 10 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 08 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />0080, FF (WR LOW) (START OF SECOND HALF OF NEW REGISTER FILE)<br />0081, FF (WR LOW)<br />0082, FF (WR LOW)<br />0083, FF (WR LOW)<br /></div></div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=6741">skaman</a> on Sat Dec 12, 2015 4:20 am, edited 5 times in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6741"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p160282"></a>
				<b class="postauthor">skaman</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p160282">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=160282#p160282"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 06, 2015 7:52 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Oct 24, 2014 1:56 am<br /><b>Posts:</b> 76
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Here's the end of the &quot;Load NP Register&quot; sequence.  This code section starts with writing the end of the 2nd half of the new register file (all FFs).  The subsequent commands read the entire new register file back (uses the 0x77 command).<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">00FC, FF (WR LOW)<br />00FD, FF (WR LOW)<br />00FE, FF (WR LOW)<br />00FF, FF (WR LOW) (LAST BYTE OF SECOND HALF OF REGISTER)<br />00FF, FF (WR LOW)<br /><br />0000, 00 (RD LOW)<br />0000, 03 (WR LOW)<br /><br />0000, 80 (RD LOW)<br />0000, 03 (WR LOW)<br /><br />120, 09 (WR LOW)<br />121, AA (WR LOW)<br />122, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, 77 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />2100, 01 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, AA (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 2A (WR LOW)<br />126, AA (WR LOW)<br />127, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 0F (WR LOW)<br />125, 55 (WR LOW)<br />126, 55 (WR LOW)<br />127, 77 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 08 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />3000, 00 (WR LOW)<br /><br />2100, 00 (WR LOW)<br /><br />0000, B4 (RD LOW) (READ BACK THE NEW REGISTER FILE)<br />0001, 00 (RD LOW)<br />0002, 00 (RD LOW)<br />0003, FF (RD LOW)<br />..<br />00FC, FF (RD LOW)<br />00FD, FF (RD LOW)<br />00FE, FF (RD LOW)<br />00FF, FF (RD LOW) (LAST BYTE OF THE NEW REGISTER FILE)<br /><br />0000, C0 (WR LOW)<br /><br />120, 09 (WR LOW)<br />121, AA (WR LOW)<br />122, 55 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, C0 (WR LOW)<br />13F, A5 (WR LOW)<br /><br />120, 08 (WR LOW)<br />13F, A5 (WR LOW)<br /></div></div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=6741">skaman</a> on Sat Dec 12, 2015 4:23 am, edited 3 times in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6741"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p160356"></a>
				<b class="postauthor">BennVenn</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p160356">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=160356#p160356"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Dec 09, 2015 4:32 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Mar 29, 2014 10:01 pm<br /><b>Posts:</b> 107<br /><b>Location:</b> Australia
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><!-- m --><a class="postlink" href="http://www.datasheet4u.com/datasheet/2/9/D/29DL32BF_SPANSION.pdf.html">http://www.datasheet4u.com/datasheet/2/ ... N.pdf.html</a><!-- m --></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6460"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p160880"></a>
				<b class="postauthor">skaman</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p160880">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=160880#p160880"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Dec 18, 2015 6:46 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Oct 24, 2014 1:56 am<br /><b>Posts:</b> 76
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Using the commands that I posted previously, I was able to write a new mapping sequence to the GB Memory cart.  In the summary below, F# is BennVenn's function numbering as posted earlier in the thread.<br /><br />Here's a summary:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">First section erases the register to FFs:<br />F2<br />F4<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, 60<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, 40<br />Loop (0x100 times):&nbsp; <br />Read 0x0000, Write 0x03 to 0x0000 until 0x0000 reads 0x80 then write 0x03 one last time<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, 60<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, 04<br />Loop (0x100 times):&nbsp; <br />Read 0x0000, Write 0x03 to 0x0000 until 0x0000 reads 0x80 then write 0x03 one last time<br />F3<br />----------------------<br />Second section writes the new mapping:<br />F2<br />F4<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, A0<br />F1: 0000, FF<br />F1: 0000, FF<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, 60<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, E0<br />0x2100, 0x00<br />F5<br />F3<br />Write the 1st 0x80 bytes of the new mapping (0x00-0x7F)<br />0x007F, 0xFF (Write to 0x7F for a 2nd time)<br />Loop (0x100 times):&nbsp; <br />Read 0x0000, Write 0x03 to 0x0000 until 0x0000 reads 0x80 then write 0x03 one last time<br />F2<br />F4<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, A0<br />F1: 0000, FF<br />F1: 0000, FF<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, 60<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, E0<br />0x2100, 0x00<br />F5<br />F3<br />Write the 2nd 0x80 bytes of the new mapping (0x80-0xFF)<br />0x00FF, 0xFF (Write to 0xFF for a 2nd time)<br />Loop (0x100 times):&nbsp; <br />Read 0x0000, Write 0x03 to 0x0000 until 0x0000 reads 0x80 then write 0x03 one last time<br />----------------------<br />Third section reads back the new register (not mandatory):<br />F2<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, 77<br />0x2100, 0x01<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, 77<br />F3<br />0x3000, 0x00<br />0x2100, 0x00<br />Read back the register from 0x0000<br />F2<br />0x120, 0xC0<br />0x13F, 0xA5<br />F3<br /></div><br /><br />Some other stuff I learned working with the code:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">The standard flash command 0x90 can retrieve the flash ID C2/89:<br />F2<br />F1: 5555, AA<br />F1: 2AAA, 55<br />F1: 5555, 90<br /><br />To return the cart to the normal (menu) mode:<br />F2<br />0x120, 0xC0<br />0x13F, 0xA5<br />F3<br /><br />Addressing an individual game in multigame mode is done:<br />F2<br />0x120, 0xC#<br />0x13F, 0xA5<br />F3<br /><br />Where # is the slot (0..7).&nbsp; &nbsp;C0 is the menu or the game in single game mode (no menu).&nbsp; The cart also uses 0xCF which I assume addresses the entire flash (more testing needed).<br /></div><br /><br />I'm going to look into fully decoding the mapping.  I think I've figured out most of it except for the 8-byte sequence at 0x70.<br /><br />Now let's hope that some of this applies to the SF Memory carts.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6741"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p160973"></a>
				<b class="postauthor">nocash</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p160973">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=160973#p160973"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 20, 2015 9:21 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Feb 24, 2012 12:09 pm<br /><b>Posts:</b> 602
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Cool, congrats on getting that working!<br /><br />I am trying to figure out the memory map of the gameboy cart - just guessing - but it seems to look like so:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">For Reading:<br />&nbsp; 0000h..3FFFh --&gt; FLASH Chip address 000000h..003FFFh<br />&nbsp; 4000h..7FFFh --&gt; FLASH Chip address 000000h..003FFFh+RomBank*4000h<br />For Writing:<br />&nbsp; 0000h..00FFh --&gt; FLASH Chip address 000000h..0000FFh<br />&nbsp; 0120h..013Fh --&gt; Special Nintendo Power registers (among others used to access FLASH Chip address 2AAAh,5555h)<br />&nbsp; 2100h&nbsp; &nbsp; &nbsp; &nbsp; --&gt; MBC-like RomBank LSBs<br />&nbsp; 3000h&nbsp; &nbsp; &nbsp; &nbsp; --&gt; MBC-like RomBank MSB or so<br />&nbsp; xxxxh&nbsp; &nbsp; &nbsp; &nbsp; --&gt; MBC-like other stuff, like RAM bank etc.<br />&nbsp; 4000h..7FFFh --&gt; FLASH Chip address 000000h..003FFFh+RomBank*4000h<br />Observe that some MBC-chips do also have write-able registers at 4000h..7FFFh, if the Nintendo Power cart is<br />supporting that kind of MBC mapping too, then it might conflict with FLASH writes via 4000h..7FFFh, unless<br />there's some way to switch the 4000h..7FFFh write-behaviour via some command/register at 0120h..013Fh.<br /></div><br />If that's right, then you would need to write to 2100h and 3000h only when accessing the memory window at 4000h..7FFFh. The code that you've posted isn't doing that at all - so I guess you could completely remove the 2100h/3000h stuff from it, right?<br /><br />The hidden erase function consists of two (almost) identical steps: The first with [5555h]=40h, the second with [5555h]=04h. What's that about? One erasing the first 80h bytes of the 100h-byte hidden data, and the other one erasing the remaining 80h bytes?<br /><br />The hidden write function is using not less than <em>three</em> writes to 5555h-2AAAh-5555h, that's a bit more than usually. Looking closer at it, the first write with data &quot;AA-55-A0-FF-FF&quot; isn't a hidden command at all! It's just the standard write command (writing two FFh bytes to addresss 0000h, which means it's just a dummy write; since writing FFh won't change any bits from &quot;1-to-0&quot;).<br />The next two commands, with data &quot;AA-55-60&quot; and &quot;AA-55-E0&quot; seem to be invoking the actual hidden write.<br />What happens if you remove the &quot;AA-55-A0-FF-FF&quot; part? It looks like a useless dummy thing... unless it's some secret prefix needed to unlock the following secret hidden write command.<br /><br />For both the dummy command (writing one dummy byte to 0000h), and the hidden write command (writing 80h bytes to 0000h), your code is having that &quot;write-last-byte-twice&quot; effect in it. That's unexpected because, as far as I remember, BennVenn said that the gameboy cart wouldn't need that effect (and wouldn't work at all when trying to do so).<br />If you are writing normal flash sectors (not the hidden sectors), are you getting that working with and/or without &quot;last-byte-twice&quot;?<br />EDIT: Sorry, I've misunderstood what you were saying. The extra write to last address is needed, but the data must be other than F0h, so, for the gameboy version, it would be &quot;write-a-value-other-than-F0h-to-last-address&quot; instead &quot;write-last-byte-twice&quot;.<br /><br />Oh, and about the actual mapping: Currently you can only map the menu, or alternately map a selected game (which works only for memory regions that ARE defined in the hidden sector).<br />But there's no way to map the WHOLE memory yet (like the HIROM:ALL feature in SNES version)? Having such a feature could be useful in several cases.</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=5211">nocash</a> on Sat Jan 23, 2016 4:24 am, edited 1 time in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5211"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p161012"></a>
				<b class="postauthor">skaman</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p161012">Re: How to program a NINTENDO POWER Cartridge ?</a></div><div style="float: right;"><a href="./viewtopic.php?p=161012#p161012"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 20, 2015 4:39 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Oct 24, 2014 1:56 am<br /><b>Posts:</b> 76
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">nocash wrote:</div><div class="quotecontent">Cool, congrats on getting that working!<br /><br />I am trying to figure out the memory map of the gameboy cart - just guessing - but it seems to look like so:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">For Reading:<br />&nbsp; 0000h..3FFFh --&gt; FLASH Chip address 000000h..003FFFh<br />&nbsp; 4000h..7FFFh --&gt; FLASH Chip address 000000h..003FFFh+RomBank*4000h<br />For Writing:<br />&nbsp; 0000h..00FFh --&gt; FLASH Chip address 000000h..0000FFh<br />&nbsp; 0120h..013Fh --&gt; Special Nintendo Power registers (among others used to access FLASH Chip address 2AAAh,5555h)<br />&nbsp; 2100h&nbsp; &nbsp; &nbsp; &nbsp; --&gt; MBC-like RomBank LSBs<br />&nbsp; 3000h&nbsp; &nbsp; &nbsp; &nbsp; --&gt; MBC-like RomBank MSB or so<br />&nbsp; xxxxh&nbsp; &nbsp; &nbsp; &nbsp; --&gt; MBC-like other stuff, like RAM bank etc.<br />&nbsp; 4000h..7FFFh --&gt; FLASH Chip address 000000h..003FFFh+RomBank*4000h<br />Observe that some MBC-chips do also have write-able registers at 4000h..7FFFh, if the Nintendo Power cart is<br />supporting that kind of MBC mapping too, then it might conflict with FLASH writes via 4000h..7FFFh, unless<br />there's some way to switch the 4000h..7FFFh write-behaviour via some command/register at 0120h..013Fh.<br /></div><br />If that's right, then you would need to write to 2100h and 3000h only when accessing the memory window at 4000h..7FFFh. The code that you've posted isn't doing that at all - so I guess you could completely remove the 2100h/3000h stuff from it, right?</div>I removed the 2100/3000 stuff and the code still works.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The hidden erase function consists of two (almost) identical steps: The first with [5555h]=40h, the second with [5555h]=04h. What's that about? One erasing the first 80h bytes of the 100h-byte hidden data, and the other one erasing the remaining 80h bytes?<br /></div>I thought that too but the functions appear to do different things.  If I use only 0x40, then the contents of the register becomes the result of merging the two register files (original and new) like using a bitwise AND.  If I use only 0x04, then the register get erased to FFs but only 0x80-0xFF is written the first time.  I have to add another 0x04, then 0x0-0x7F is written.  It looks like the 0x40 function can be replaced by a 2nd 0x04 function.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The hidden write function is using not less than <em>three</em> writes to 5555h-2AAAh-5555h, that's a bit more than usually. Looking closer at it, the first write with data &quot;AA-55-A0-FF-FF&quot; isn't a hidden command at all! It's just the standard write command (writing two FFh bytes to addresss 0000h, which means it's just a dummy write; since writing FFh won't change any bits from &quot;1-to-0&quot;).<br />The next two commands, with data &quot;AA-55-60&quot; and &quot;AA-55-E0&quot; seem to be invoking the actual hidden write.<br />What happens if you remove the &quot;AA-55-A0-FF-FF&quot; part? It looks like a useless dummy thing... unless it's some secret prefix needed to unlock the following secret hidden write command.<br /></div>I removed the 0xA0 flash command sequence and the code still works.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">For both the dummy command (writing one dummy byte to 0000h), and the hidden write command (writing 80h bytes to 0000h), your code is having that &quot;write-last-byte-twice&quot; effect in it. That's unexpected because, as far as I remember, BennVenn said that the gameboy cart wouldn't need that effect (and wouldn't work at all when trying to do so).<br />If you are writing normal flash sectors (not the hidden sectors), are you getting that working with and/or without &quot;last-byte-twice&quot;?<br /></div>I haven't written to the regular flash yet.  I'm still working on getting the reader code working for normal carts.  I've got a good base for the normal mappers so I'll build off it to work with the NP cart.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Oh, and about the actual mapping: Currently you can only map the menu, or alternately map a selected game (which works only for memory regions that ARE defined in the hidden sector).<br />But there's no way to map the WHOLE memory yet (like the HIROM:ALL feature in SNES version)? Having such a feature could be useful in several cases.</div>The program appears to use 0xCF (1st command sequence in the original list) so that might address the entire flash.  I haven't tested it yet.<br /><br />More testing to do.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6741"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=12&amp;t=11453&amp;start=120"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=12"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=12&amp;t=11453"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>9</strong> of <strong>14</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 199 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=12&amp;t=11453&amp;start=105">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=12&amp;t=11453">1</a><span class="page-dots"> ... </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=75">6</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=90">7</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=105">8</a><span class="page-sep">, </span><strong>9</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=135">10</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=150">11</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=165">12</a><span class="page-dots"> ... </span><a href="./viewtopic.php?f=12&amp;t=11453&amp;start=195">14</a> &nbsp;<a href="./viewtopic.php?f=12&amp;t=11453&amp;start=135">Next</a></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=25">Other</a> &#187; <a href="./viewforum.php?f=23">Other Retro Dev</a> &#187; <a href="./viewforum.php?f=12">SNESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 2 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="11453" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="34">&nbsp; &nbsp;&nbsp; &nbsp;2018 NESdev Competition</option>
		
			<option value="33">&nbsp; &nbsp;&nbsp; &nbsp;2017 NESdev Competition</option>
		
			<option value="32">&nbsp; &nbsp;&nbsp; &nbsp;2016 NESdev Competition</option>
		
			<option value="31">&nbsp; &nbsp;&nbsp; &nbsp;2014 NESdev Competition</option>
		
			<option value="30">&nbsp; &nbsp;&nbsp; &nbsp;2011 NESdev Competition</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;&nbsp; &nbsp;Reproduction</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="11">&nbsp; &nbsp;&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="12" selected="selected">&nbsp; &nbsp;&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;&nbsp; &nbsp;GBDev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>


<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>