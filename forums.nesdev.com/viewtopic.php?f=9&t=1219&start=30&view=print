<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Reverse Engineering the CIC</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Reverse Engineering the CIC</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=9&amp;t=1219">http://forums.nesdev.com/viewtopic.php?f=9&amp;t=1219</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>3</strong> of <strong>27</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Mar 19, 2006 12:20 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent"><div class="quotetitle">tepples wrote:</div><div class="quotecontent">You could always open a Game Pak, cut pin 4 on the CIC, and then wire up two Game Paks' CICs in a lock/key configuration.</div><br />I think you'll need to wire the pin to VCC, not just cut it.</div><br />I intended that to be implicit in "wire up two CICs in lock/key". You cut pin 4 so that you can turn a key into a lock. Or you can just desolder the two CICs completely and put them in a breadboard.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">And yeah, that is a great idea</div>
<br />Thanks.
<br />
<br />Has anybody tried to photograph the insides of the Rabbit chip from Tengen games yet?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sun Mar 19, 2006 12:58 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">I intended that to be implicit in "wire up two CICs in lock/key". You cut pin 4 so that you can turn a key into a lock. Or you can just desolder the two CICs completely and put them in a breadboard.</div>
<br />Disolver a 14 pin DIL chip on a PCB with solver on both sides without doing serious damage to the chip is nearly impossible.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Quietust</b> [ Sun Mar 19, 2006 1:34 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Assuming "disolver" is supposed to be "desolder", you're wrong - you can most certainly desolder a 14-pin DIL chip from a double-sided board without damaging it <strong>IF</strong> you have the proper tools. With a decent desoldering iron, it's quite easy, though it's still doable with a spring-loaded solder-sucker (but slow) or even copper braid solder wick (though it'd take a LONG time).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>drk421</b> [ Sun Mar 19, 2006 1:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />This works very well, I've done many carts:
<br />
<br /><!-- m --><a class="postlink" href="http://www.radioshack.com/product/index.jsp?productId=2062731">http://www.radioshack.com/product/index ... Id=2062731</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>kevtris</b> [ Sun Mar 19, 2006 2:00 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zack S wrote:</div><div class="quotecontent">I tried to get my parallel port to log the CIC in action but had no luck. Not sure what the problem is. I'm sure I'll get it right eventually. Or maybe I'll just do what Kevin suggested and break out a FPGA.<br /></div><br /><br />The problem is, you must reset the CIC for it to start working.  If you don't, the CIC will get very hot!  I dunno why this is, but it does.  When working normally, the CIC does not get warm.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">While messing with the CIC logger I was trying to make, I got an idea on another way to beat this system. When no cart is in the NES, the system isn't in reset the whole time. If we could disrupt the clock signal going to the Lock while the system is on, the lock won't be able to function and the NES will stay on. Ofcourse for this to work it would require messing the clock signal up enough to halt the MPU in the lock. But at the same time it can't damage the oscillator. Would this be possible?<br /></div><br /><br />That won't work.  They use two separate inverters on the 74HCU04 to individually buffer CLK to each CIC.  <br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I got it to work on the bread board pretty easily by just removing the clock signal wire. Anybody know a good way to stop the clock without damage? I have no problem with testing this on one of my nintendos, worst case scenario I have to remove the CIC altogether.</div>
<br />
<br />Just remove two CICs from two cartridges and use those...  Though I am unclear if you can use the 6113 CICs back to back.  
<br />
<br />Speaking of this, I am kinda confused about why nintendo did this.  The console *always* has a 3193 CIC in it (US console), while the carts have a 3193 (older) or 6113 (newer).  I was wondering if the 6113 was a "key only" cost-reduced version or something... Even the very last versions of the front loader have the 3193 in it... So there must be some reason the 6113 is not usable as a lock.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zack S</b> [ Sun Mar 19, 2006 3:49 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">kevtris wrote:</div><div class="quotecontent">The problem is, you must reset the CIC for it to start working.  If you don't, the CIC will get very hot!  I dunno why this is, but it does.  When working normally, the CIC does not get warm.</div><br /><br />I had a Reset signal going to the Lock and a Clock signal going to both CIC's.  It's probably just something wrong with my code or I misswired something.<br /><br /><div class="quotetitle">kevtris wrote:</div><div class="quotecontent">That won't work.  They use two separate inverters on the 74HCU04 to individually buffer CLK to each CIC.</div><br /><br />Guess it's back to trying to RE it.<br /><br /><div class="quotetitle">kevtris wrote:</div><div class="quotecontent">Just remove two CICs from two cartridges and use those...  Though I am unclear if you can use the 6113 CICs back to back.</div><br /><br />That's excactlt what I did. Both of the CIC's are 6113's that I took out of game carts. They work fine back to back, at least they seem to. Without the key connected it produce the reset squarewave for the NES. With the key connected it kept the NES out of reset.<br /><br /><div class="quotetitle">Bredalad wrote:</div><div class="quotecontent">Disolver a 14 pin DIL chip on a PCB with solver on both sides without doing serious damage to the chip is nearly impossible.</div>
<br />
<br />I used a 15$ desoldering iron to pull two CIC's off of PCB's, it took about a minute each. They worked fine in the breadboard so it didn't damage them. I usually do every 3rd pin or so, as opposed to just going down the line. That way each area of the chip has time to cool.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>WhoaMan</b> [ Sun Mar 19, 2006 4:49 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />has anyone logged what the lock and key do when they are not connected to each other? also... has anyone logged the response from the key when given only part of the sequence from the lock and vice versa?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Memblers</b> [ Sun Mar 19, 2006 5:01 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The legal docs from the Nintendo vs Tengen case mentioned that Nintendo modified the lockout code in 1987 ("deleted some instructions"), maybe that's when they changed the part #s for the chip?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zack S</b> [ Sun Mar 19, 2006 8:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">WhoaMan wrote:</div><div class="quotecontent">has anyone logged what the lock and key do when they are not connected to each other? also... has anyone logged the response from the key when given only part of the sequence from the lock and vice versa?</div>
<br />
<br />I haven't yet but plan to as soon as I get my data logger working. I got an oscilliscope toady so that should help me figure out whats not working.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Mar 19, 2006 9:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zack S wrote:</div><div class="quotecontent">I got an oscilliscope toady so that should help me figure out whats not working.</div>
<br />
<br /><img src="http://pics.pineight.com/nes/oscope_toadies.png" alt="Image" />
<br />Oscilloscope toadies from <em>Yoshi's Island 2: Reverse Engineering</em>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zack S</b> [ Sat Mar 25, 2006 3:48 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Quick update on my Parallel port data logger project. This will simply not work. I hooked up the O-scope and found that the parallel port can't go fast enough for the CIC. I'm guessing that the part of the chip depends on dynamic RAM, that isn't getting refreshed fast enough with the slow clock cycle I'm giving it.
<br />
<br />I'm still learning to work with FPGA's so it could be some time before I make a data logger for it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>blargg</b> [ Sat Mar 25, 2006 12:34 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I really doubt it has dynamic RAM in it. It could be some other asynchronous element in it like the older time-delay digital logic design that uses resistors and capacitor (RC) elements instead of clocked logic.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Quietust</b> [ Sun Mar 26, 2006 6:00 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Moved from <em>NESdev</em> to <em>NES Hardware / CopyNES</em>, as the CIC's functionality isn't really related to NES programming.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>teaguecl</b> [ Mon Mar 27, 2006 4:46 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">kevtris wrote:</div><div class="quotecontent">One interesting thing is that there are no runs shorter than 87 clocks I believe it was.  In all my testing, one "clock" was made up of 4 clock cycles to the lockout chips. </div>
<br />
<br />I was thinking about this, comparing it to the patent document, and it doesn't make sense to me.  According to the document there is the initial exchange, to seed the first random number (select the sequence) and then there is a transaction once per 4 clocks.  I'll explain:
<br />The 4Mhz clock is divided by 4 and split into four separate clocks in each of the four possible phases - and they are called phi1 through phi4.  The patent suggests that on phi1 data is read in from the IO port.  The next two cycles (phi2 and phi3) are used for "predetermined arithmetic operations".  Then, on phi4 the data is output to IO.  This sequence is repeated indefinately.
<br />If I'm understanding this correctly, the data that is read in on phi1 as well as the data output in phi4 can't be anything other than 1 bit in size.  It seems unlikely that the distribution would allow for runs of 87 cycles and longer without a single result of "1".  Am I missing something here?  Are the patent documents not quite accurate?  I'm very suspicious of the explaination of the synchronization explained in there, it doesn't match the logic analyzer logs posted.
<br />
<br />edit: I just realized that the "1" in the logs from Kev's tester are 3 clocks long.... which is a big clue.  It indicates it's operating on the divided clocks and not on the original.  I'm thinking there's some kind of "pipeline" going on here.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>teaguecl</b> [ Tue Apr 04, 2006 11:18 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">bunnyboy wrote:</div><div class="quotecontent">I put all my text files in a new directory at <a href="http://www.nesmuseum.com/10nes" class="postlink">www.nesmuseum.com/10nes</a>  <br /><br /><a href="http://www.nesmuseum.com/10nes/nescicrom.txt" class="postlink">nescicrom.txt</a> - nes lockout rom dump, directly from rom array.  Bits and bytes are interleaved, figuring out how it is actually arranged is part of the problem.<br /></div>
<br />
<br />I had downloaded the photos taken by Nevitski with the microscope of the NES CIC, and started to decode them myself.  I didn't make it all the way through - only 144 bytes in.  However, comparing what I have against what you posted I found a discrepancy.  Below I will paste the content of your nescicrom.txt, but will put an "X" in the location where I came up with a different value than you did. You have a "1" in that spot, and I read it as "0".  In the 1152 bits that I decoded, we only differ by one bit... which means we're either reading it correctly, or at least consistantly incorrect.
<br />
<br />1111100010111010001110100111111001111110010111000011101011101110
<br />0110011110111111001101011111X11101100101011011010011010111011111
<br />
<br />Unfortunately one bit difference out of over 1000 doesn't help us decode it at all.  But it points out having several people decode it independently might help us reduce errors in it.  If I get time, I'll try to keep decoding more.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>3</strong> of <strong>27</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>