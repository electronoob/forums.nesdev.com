<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Nintendulator,Nestopia?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Nintendulator,Nestopia?</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=6257">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=6257</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>3</strong> of <strong>6</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>byuu</b> [ Mon Apr 05, 2010 4:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nintendulator,Nestopia?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Denine wrote:</div><div class="quotecontent">Why game is working with nintendulator,but not with nesto-pia if both have a "most accurate emulation" state?</div>
<br />
<br />Because neither are 100% perfect. In fact, perfection is practically impossible.
<br />
<br />Given the massive complexity of emulators at this low a level, there's bound to be differences even between two very highly accurate emulators.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Mon Apr 05, 2010 4:52 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Denine wrote:</div><div class="quotecontent">I absolutly have no idea why in the world  grafics is not showing up...</div>
<br />Well, you are obviously handling this problem in a very chaotic way. You are just trying whatever we suggest without even understanding why. Add that to the fact that our suggestions are limited, because there are several critical parts of the code you are not showing, and I say it will be a miracle if this thing works correctly. Even if by some miracle it appears to run correctly, if you get that result by pure luck there will probably still be problems, just not so severe to the point of breaking everything.
<br />
<br />Maybe you are holding some code back because you're preparing some kind of surprise or something, but if you expect to fix this the good way you'll have to show more code. We need to see some of your main loop, and anything related to PPU updates. Or else it will be like going to the doctor and not wanting to take your clothes off... the doctor might not be able to help you much!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Denine</b> [ Mon Apr 05, 2010 5:19 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent"> You are just trying whatever we suggest without even understanding why.</div>Well,that is almost true,I try to understand how it work,and even looking in wiki about it,to understand better.But...yeah i don't really understand everything.
<br />About the code...Yep it's decided...it may be a little too much,but...you can see almost whole code:(I cut off Main game loop,because even title screen is not showing up so showing main code won't help,right?)
<br /><!-- m --><a class="postlink" href="http://paste.org/pastebin/view/17080">http://paste.org/pastebin/view/17080</a><!-- m -->
<br />And sorry about making you angry <img src="./images/smilies/icon_cry.gif" alt=":cry:" title="Crying or Very sad" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Mon Apr 05, 2010 6:34 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'm not angry, just a bit frustrated with all the guessing that has been going on, from you (that a lot of times don't understand what you are doing) and from us (who don't have a broader view of the problem).
<br />
<br />As a personal rule, I don't consider anything I make "done" until I understand perfectly how it works. If I'm just guessing and the thing happens to work by luck, I can't consider it a good program. Just like things sometimes don't work by accident, sometimes they work by accident too, and that's not good. Honestly, if I were you, I'd be working on something simpler that I'd be able to understand better.
<br />
<br />I think you are jumping ahead of yourself... You didn't even master how to work with graphics and the NMI yet, and are already complicating stuff by using a mapper like the VRC6.
<br />
<br />I'm looking at your code though. I'll let you know if I see anything weird.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Mon Apr 05, 2010 6:59 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />- One hint: you setup a VRC6 mapper (24) with CHR-RAM. Supposedly, VRC6 uses CHR-ROM. I could trap writes to the CHR-RAM in RockNES; that's why it crashes.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Apr 05, 2010 7:33 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zepper wrote:</div><div class="quotecontent">Supposedly, VRC6 uses CHR-ROM.</div>
<br />And supposedly, NROM uses CHR ROM, but every popular NES emulator treats mapper 0 with 0 bytes CHR ROM data as a board from which one has desoldered the CHR ROM chip and rewired it to take a 6264 SRAM.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Mon Apr 05, 2010 8:48 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">And supposedly, NROM uses CHR ROM, but every popular NES emulator treats mapper 0 with 0 bytes CHR ROM data</div>
<br />
<br />- What's the point with my previous statement? Anyway, nope, AFAIK, every NES emulator checks the number of CHR ROM pages specified in the iNES header; if it's zero, the game uses CHR RAM... but not only for mapper 0, but every other mapper.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Mon Apr 05, 2010 9:48 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I agree with what Tokumaru said. Before you go forward in your project, you should go a step back and understand the part that you have difficulty with. If you don't, your project will never go forward smoothly.
<br />
<br />By quick reading of the code, I see sometime you use the register directly, sometime you use the constant I made. This imply cut &amp; paste code and make it not uniform. One of the line say in english that it set the NMI flag with #010000 but there is no %, which mean it's not a binary number. And the NMI flag is the 7th bit so it would not work too.
<br />
<br />So my suggestion is:
<br />- Remove music engine, go back with mapper 0 for the time being
<br />- Clean up your code, make it uniform
<br />- Understand every part you code
<br />- Part you don't understand, ask questions
<br />- Once code is clean-up and stable on all emulator, start VRC6 music
<br />
<br />As for CHR-RAM inside VRC6, no cart supported it so it's not sure that it would work. It could but not tested.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Tue Apr 06, 2010 8:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Banshaku wrote:</div><div class="quotecontent">As for CHR-RAM inside VRC6, no cart supported it so it's not sure that it would work. It could but not tested.</div>
<br />AFAIK, taking a real cart and replacing its CHR chip by an 8KB RAM chip is a simple modification that should work in any board, so I don't think this is something to be worried about (unless emulators specifically refuse to use this mapper with CHR-RAM, which they shouldn't).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Tue Apr 06, 2010 9:13 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent"><div class="quotetitle">Banshaku wrote:</div><div class="quotecontent">As for CHR-RAM inside VRC6, no cart supported it so it's not sure that it would work. It could but not tested.</div><br />AFAIK, taking a real cart and replacing its CHR chip by an 8KB RAM chip is a simple modification that should work in any board, so I don't think this is something to be worried about (unless emulators specifically refuse to use this mapper with CHR-RAM, which they shouldn't).</div>
<br />
<br />- It's just non-standard, much like having mapper 3 with CHR RAM. But ok, I'll fix this potential bug. I have to thanks the guy. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Denine</b> [ Tue Apr 06, 2010 9:19 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"> you setup a VRC6 mapper (24) with CHR-RAM. Supposedly, VRC6 uses CHR-ROM.</div><br />Well,was thinking that VRC6 can use either of them.I can remember someone saying that...<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">So my suggestion is:<br />- Remove music engine, go back with mapper 0 for the time being<br />- Clean up your code, make it uniform<br />- Understand every part you code<br />- Part you don't understand, ask questions<br />- Once code is clean-up and stable on all emulator, start VRC6 music </div>
<br />Umm...getting back after all troubles?Hmm...but..ehh,maybe you're right..I have to think about it..at the other hand,maybe i would be much beter if I start making a all new game.And this time no copy pasting code...
<br />[quote]
<br />As for CHR-RAM inside VRC6, no cart supported it so it's not sure that it would work. It could but not tested.]/quote]
<br />You can consider this as a miracle...(I mean..only 3 games is for VRC6,right?)My friend can write games to carts,and he have "Mouryou Senki Madara" game which is VRC6 game,I send already a DRD binary to him.
<br />EDIT:
<br />OK,he checked Dizzy Rainy Day...acording to what he said,it look like Grafics is still loaded from CHR ROM...After that he cleaned CHR ROM,tried play,and took a photo:
<br /><img src="http://img534.imageshack.us/img534/8193/040425122121.jpg" alt="Image" />
<br />Yeah,game is loading grafics from CHR ROM,unfortunelly...But game is 100% working.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Tue Apr 06, 2010 2:48 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have a VRC-6 dev cart and know about CHR-ROM only. But like Tokumaru said, if you would modify it and add RAM in the CHR-ROM socket, it should work. I never tried it thought.
<br />
<br />If you don't want to go back to mapper 0, this is up to you but you should try to clean-up at least your code, part by part and figure out what you don't understand: you don't have to figure out the code of the sound driver, this is not your code and is already tested.  And by code of the sound driver I mean only the part located in soundDrv since the rest is my code to use it and it you re-use some of it, you have to understand it. The bank switching and music code is such a little part of what will be happening in your current game that it won't think it would be such an issue to go back. You decide.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Wed Apr 07, 2010 5:38 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />- If he's using CHR RAM, there's no reason to write into VRC6 CHR registers. That's why it crashes my emulator.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Apr 07, 2010 6:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zepper wrote:</div><div class="quotecontent">- If he's using CHR RAM, there's no reason to write into VRC6 CHR registers.</div>
<br />Many mappers allow bankswitching of CHR RAM by design. These include MMC1, MMC3, and CPROM. A ROM-to-6264 rewire job on a board with a VRC6 would operate the same way.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Wed Apr 07, 2010 6:54 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />For example, if you don't set the banks for CHR-RAM on an MMC3, all banks will be at 0. I proved it more than 1 year ago.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>3</strong> of <strong>6</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>