<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - I still think VirtuaNES is the best NES emulator</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">I still think VirtuaNES is the best NES emulator</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=9873">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=9873</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>2</strong> of <strong>3</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sat Mar 02, 2013 1:09 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yes, since Simon has to be maked &quot;horizontally&quot; when he enters the door, this trick can't be done by abusing 8-sprite per line limit.<br />Castlevania does it by placing high priority sprites in front of Simon, but behind the background, therefore the wall is still visible.<br />This technique could be called &quot;sprite priority reversal&quot; or something like that. Quite a few NES, SNES and GBA games uses this trick (not only Castlevania).<br /><br />This technique uses only 2 sprites instead of 8 so I can only think it has advantages. I wonder why they didn't use this one in Simon's Quest instead - but then again the sequel is inferior to the original on almost every possible aspect.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Why is it 99% of nesdev threads go off-topic by about post #4?</div><br />Because it's full of active and passionate people. Forums who are dead and unfrequented does not go off topic, except when there is a spammer that comes post his shit that doesn't get removed because the mods don't even go there any longer.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Sat Mar 02, 2013 1:51 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Why is it 99% of nesdev threads go off-topic by about post #4?</div><br /><br />The thread was entirely on-topic until this post. The OP directly brought up the sprite limit issue, and has since asked more questions about it which are being answered.<br /><br />...sorry for continuing the off-topic discussion.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Sat Mar 02, 2013 2:59 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">Yes, since Simon has to be maked &quot;horizontally&quot; when he enters the door, this trick can't be done by abusing 8-sprite per line limit.<br />Castlevania does it by placing high priority sprites in front of Simon, but behind the background, therefore the wall is still visible.<br />This technique could be called &quot;sprite priority reversal&quot; or something like that. Quite a few NES, SNES and GBA games uses this trick (not only Castlevania).</div><br />Ah you're right -- I just tested it.  Chances are what I'm remembering is from the days of earlier/older emulators where the sprite priority stuff wasn't implemented (emulated) correctly.  In these cases Simon always walked in front of the door.  I really should just bow out and let you guys comment on things instead of opening my old, often incorrect, mouth.  :-)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Mr. Blah</b> [ Sat Mar 02, 2013 4:15 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That's an in-depth description for a hack, tepples. Nevertheless, thanks for the insight, though I'm math retarded.<br /><br /><em>&gt;The games listed above (by multiple people) are the ones I know of, with the addition of one:</em><br /><br />Ah! That's okay. No doubt there are others, but I think I'll leave it on unaware of the anomalies it will cause. As long as it's few and not many.<br /><br />I'll go off-topic here. I was wondering, all older games are 4:3 ratio and all modern games are 16:9, but the data to expand most older games to widescreen is available in-game. Isn't it possible to hack, say, Super Mario Bros. into a natural 16:9 game rather than stretching it? Like what modern HD ports of games are doing. They're able to naturally make the games 16:9 because the data is there, except for anything involving video. Or not, correct me if I'm wrong. <img src="./images/smilies/icon_razz.gif" alt=":P" title="Razz" /><br /><br />But if it's possible, how much effort would it take to do so?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Sat Mar 02, 2013 4:52 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, most NES games tend to be doing a lot of work &quot;just off screen&quot;.<br /><br />To make them 16:9 it's not like you can just display the background tiles that are sitting in VRAM currently. You'd need to reimplement the game (on a non-NES platform) and adjust everything that deals with whether the edges of the screen are. For instance, there's no way on an NES game to specify a sprite that is outside of the 4:3 screen.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Mar 02, 2013 5:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The visible portion of the NTSC NES or Super NES picture is 256x224 with 8:7 pixel aspect ratio, or 256/224*8/7 = 1.31:1 display aspect ratio, close to the 4:3 of classic CRT SDTVs. I can think of two ways to get closer to the desired 1.77:1 DAR of HDTVs without compromising proportion: expand the visible area to 336x224 or crop to 256x164.<br /><br /><strong>Zooming in</strong><br />PocketNES, an NES emulator for Game Boy Advance, had to squeeze the screen into 240x160 pixels. It had a <a href="http://www.pocketnes.org/res.html" class="postlink">scaled mode</a> that would compress 213 lines into 160, looking much like what you get when you stretch the standard NES picture to fill an HDTV. It also had an unscaled mode that would follow a location in the NES's RAM that stores the vertical coordinate of the player character and pan the entire emulated display up and down based on this position.<br /><br />Ports of NES games to Game Boy use essentially the same technique, often with a rearrangement of the status bar to open more space for the action. These include Balloon Kid (GB port of Hello Kitty World for Famicom with all the Sanrio trademarks filed off) and Super Mario Bros. Deluxe. And in some cases, the status bar is made transparent and overlapping part of the playfield, as in Super Mario Advance 4 (GBA port of Super Mario Advance 3).<br /><br /><strong>Zooming out</strong><br />The NES background display can be set to 512x240 pixels (&quot;horizontal arrangement&quot; or &quot;vertical mirroring&quot;) or 256x480 pixels (&quot;vertical arrangement&quot; or &quot;horizontal mirroring&quot;). Scrolling operates by <a href="http://wiki.nesdev.com/w/index.php/PPU_scrolling#The_common_case" class="postlink">updating the part of the background plane that's offscreen with tiles that will soon become visible</a>.<br /><br /><a href="http://wiki.nesdev.com/w/index.php/File:SMB1_scrolling_seam.gif" class="postlink"><img src="http://wiki.nesdev.com/w/images/a/ae/SMB1_scrolling_seam.gif" alt="Image" /><br />Animation of updating in Super Mario Bros.</a><br /><br />Games using vertical mirroring, such as Super Mario Bros. or Contra, may allow a cheap modification to support widescreen operation. Running the PPU at four pixels per CPU cycle instead of three would allow drawing an extra 40 pixels of background on each side totaling 336x224. Games that make their updates near the edge of the screen, rather than in the center of the offscreen part of the plane, will need to be modified. And as rainwarrior mentioned, sprites will pop in and out of visibility as they go through the extended background.<br /><br />There is one slight inaccuracy in the animation above: Super Mario Bros. is actually well behaved in this respect, updating in the middle of the offscreen area rather than near the edge.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Mr. Blah</b> [ Sat Mar 02, 2013 6:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><em>&gt;Well, most NES games tend to be doing a lot of work &quot;just off screen&quot;.</em><br /><br />What kind of work? Preparing code and loading it from the VRAM?<br /><br />You're very knowledgeable with your consoles/handhelds, tepples. Expanding sounds like the better option, but that's probably an illusion.<br /><br />In that case, you'd have to be desperate for portability when you're aware of that and still use PocketNES.<br /><br /><em>&gt;Scrolling operates by updating the part of the background plane that's offscreen with tiles that will soon become visible.</em><br /><br />Yes, that's why I was initially thinking it should be possible. The data for horizontal exists, but for some vertical and all stationary games it wouldn't be possible. Like racing games or puzzle games. Is this correct?<br /><br /><em>&gt;And as rainwarrior mentioned, sprites will pop in and out of visibility as they go through the extended background.</em><br /><br />Why's this? Imperfect extending? <br /><br />Modifying the PPU is all it takes?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Kasumi</b> [ Sat Mar 02, 2013 6:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Yes, that's why I was initially thinking it should be possible. The data for horizontal exists,</div><br />I wouldn't say that. In my game, I only update 8 pixels passed the border. And the leftmost eight pixels that ARE on the screen are hidden (because they're &quot;wrong&quot;), so the resolution is still only 256 pixels. Even if my game were capable of drawing more off screen horizontally (right now it has that ability vertically), you'd still only be able to extend by 8 or 16 pixels because I'd do things in roughly the same way. (If not clear, I only draw one tile past the border vertically even though I could technically do an entire screen. I would only do one tile horizontally even if I could technically do the entire screen horizontally.).<br /><br />Most games do it like this. It's pretty rare to draw far enough passed the border to do what you're asking.<br /><br />Even in a game that does draw more as far as background tiles, you still run into an issue with sprites.<br /><br />They can't be drawn offscreen horizontally. A value of 0 for a hardware sprite's X position is pixel aligned with the left border. A value of 255 is 1 pixel on the right of the screen. You can't do more or less than that. So if the screen is longer than 256 pixels, all the space is inaccessible with the way sprites are mapped. Making a hardware sprite have two bytes for horizontal position could be done, but no existing game would make use of it. They all expect and use one byte.<br /><br />Edit: NES hardware can be extended via mappers or whatever else, but there's no way I can think of to do this without hacking each individual game you want to extend. Reading again maybe that's what you want to do. I'd say good luck, hacking is a lot of work.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Sat Mar 02, 2013 7:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It's also worth noting that the PAL NES and Dendy native aspect ratio already stretches the screen to look like a letterboxed ≈3:2 DAR. (precisely 1.478613̅)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Sat Mar 02, 2013 7:57 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Increasing the horizontal resolution of NES games is much, much harder than getting rid of sprite flicker. Only a handful of games counted on sprites being dropped, but ALL of them counted on the screen being 256 pixels wide.<br /><br />Like has been said, sprite coordinates are 8-bit, so the highest possible X coordinate of a sprite is 255. If you extend the screen past that, no sprites could ever be in the extended area, unless the emulator was modified to support 9-bit sprite coordinates, and the ROM was hacked to use this feature.<br /><br />Concerning the background, even though horizontally scrolling games have data to show in the extended area, most games weren't coded to keep more than 1 screen worth of backgrounds active in the PPU. Some games didn't even have that option, because they arranged the VRAM available for backgrounds as a 256x480-pixel area (as opposed to 512x240, which is the other possible configuration), so they didn't have any extra space horizontally. <em>Super Mario Bros. 3</em> is a good example of such game. All of these games would need to have their background rendering code heavily hacked. This would need to be done for each game individually, it can't be done at the emulator side.<br /><br />Even if you hacked game by game, there are certain things that would be hard to adapt. For example, what to about boss fights that happen in locked screens? Will there be invisible walls keeping sprites in the center of the screen or will they be able to use the extra space? What if the mechanics of the fights depend on the layout of the background?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zelex</b> [ Sat Mar 02, 2013 8:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Here is a thought. Is there any way to heuristically deduce that a sprite overflow is intentional or not? If its intentional then hide the sprites, if not, then show them. Obviously wouldn't work in all games, but is there a way that would work for many?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>3gengames</b> [ Sat Mar 02, 2013 8:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'd guess 8 blank sprites in a row/behind background with the same Y+X coord would work. I put all 8 sprites in my projects right on top of each other.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Sat Mar 02, 2013 8:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zelex wrote:</div><div class="quotecontent">Is there any way to heuristically deduce that a sprite overflow is intentional or not?</div><br />If there are a bunch of sprites using the same tile index and the same Y coordinate, I'd say the chances of them being used to cause an overflow are pretty high.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Sat Mar 02, 2013 9:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Gremlins 2 uses sprite overflow masking in a cutscene, and doesn't put them at the same X position, but they do use the same tile and Y coordinate.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Sat Mar 02, 2013 11:01 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: I still think VirtuaNES is the best NES emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Same tile and same Y coordinate could just be one or more moving platforms though...

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>2</strong> of <strong>3</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>