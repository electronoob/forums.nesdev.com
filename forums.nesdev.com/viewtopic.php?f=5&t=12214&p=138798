<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - GBA sound quality...</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - General Stuff" href="http://forums.nesdev.com/feed.php?f=5" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - GBA sound quality..." href="http://forums.nesdev.com/feed.php?f=5&amp;t=12214" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '1');
	var per_page = '';
	var base_url = '';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=register"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Sun May 10, 2015 10:52 am<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=25">Other</a> &#187; <a href="./viewforum.php?f=5">General Stuff</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />

<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=5&amp;t=12214">GBA sound quality...</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=5"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=5&amp;t=12214"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 7 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=5&amp;t=12214&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=5&amp;t=12214&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=5&amp;t=12214&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p138756"></a>
				<b class="postauthor">Espozo</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p138756">GBA sound quality...</a></div><div style="float: right;"><a href="./viewtopic.php?p=138756#p138756"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Jan 05, 2015 10:50 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=6683_1410824489.gif" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Sep 15, 2014 4:35 pm<br /><b>Posts:</b> 888<br /><b>Location:</b> Nacogdoches, Texas
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Although I think that the graphical capabilities of the GBA are certainly spectacular for a sprite based system (quite possibly the best I've seen), I always felt that the audio quality was lacking, especially when you compare it to the graphics. I have a few gba video cartridges, and although muffled, the sound quality was much better than what I would hear in 90% of GBA games. I've read that the GBA has 6 sound channels (aside from lack column scrolling, this seems to be the only thing worse about the GBA than the SNES) And although 4 channels are apparently about as good as the Gameboy, it says there are 2 &quot;Direct Sound&quot; channels, which I assume play back actual recorded music. (You can probably tell I have no knowledge of audio hardware. <img src="./images/smilies/icon_razz.gif" alt=":P" title="Razz" /> )<br /><br /><!-- m --><a class="postlink" href="http://www.coranac.com/tonc/text/sndsqr.htm">http://www.coranac.com/tonc/text/sndsqr.htm</a><!-- m --><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The GBA has six sound channels. The first four are roughly the same as the original GameBoy had: two square wave generators (channels 1 and 2), a sample player (channel 3) and a noise generator (channel 4). Those are also referred to as the DMG channels. New are two Direct Sound channels A and B (not to be confused with Microsoft's Direct Sound, the DirectX component). These are 8bit digital channels.</div><br />Is the reason we don't get near cd quality sound with the GBA because there would only be 1 sound channel left for sound effects, or is it because of space constraints? (I know bickering won't change how the system was designed, but I figure there has to be some way to have it sound better)<br /><br />Two more questions I just thought of: If the GBA is using the GBZ80 (how is this different than a normal Z80?) solely for the 4 sound channels, (I think I remember hearing that the &quot;Direct Sound&quot; channels are controlled by the main CPU) than why aren't there more sound channels or higher quality existing ones? I understand that it had to do other things than just sound on the GB, but here it isn't being used for anything else.<br /><br />Lastly, (though off topic) why didn't the Gameboy Micro or the DS play GB games? I heard that they still have the GBZ80, as it is required for sound on GBA games.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6683"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p138759"></a>
				<b class="postauthor">lidnariq</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p138759">Re: GBA sound quality...</a></div><div style="float: right;"><a href="./viewtopic.php?p=138759#p138759"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Jan 05, 2015 11:34 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Apr 13, 2008 11:12 am<br /><b>Posts:</b> 2999<br /><b>Location:</b> zurich for this week
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Espozo wrote:</div><div class="quotecontent">it says there are 2 &quot;Direct Sound&quot; channels, which I assume play back actual recorded music. [...] is it because of space constraints?<br /></div>That. The largest GBA game is 32 MiB, which isn't all that much time for compressed audio. The 17MHz ARM in the GBA isn't fast enough to do real-time decoding on MP3 or similar, and a lighter codec (like ADPCM) doesn't get very good compression per quality. (3 bits per sample, 32 KiHz, would match, and fit about 45 minutes of audio on a cartridge and nothing else. No disc-based-console style &quot;fit 10 hours of music&quot; on this cartridge without additional hardware)<br /><br />Additionally, I think I remember reading that the output stage of the GBA drops the LSB of the 8 bit bytes sent on the DirectSound channels, further degrading it into two 7-bit channels.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">how is the [GBZ80] different than a normal Z80?<br /></div>GBZ80 is actually an 8080 with a small handful of instructions added from the Z80 instruction set. And officially, Nintendo used the Z80 mnemonics instead of Intel's 8080 mnemonics.<br /><span style="font-size: 50%; line-height: normal">EDIT: typo</span><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">higher quality existing ones?<br /></div>How would you make the classic gameboy sound channels higher quality? I suppose you could add more choices of duty cycle and/or volume, but it's still fundamentally pulse waves.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Lastly, (though off topic) why didn't the Gameboy Micro or the DS play GB games?<br /></div>For the Micro, cost savings. For the DS ... not clear. Maybe also cost savings, in a more price-sensitive market.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I heard that they still have the GBZ80, as it is required for sound on GBA games.<br /></div>Not necessarily. They have to include the audio hardware, but that's a lot simpler than the 8080 core.<br /><br />That said, the Micro <em>does</em> still have the GBZ80 core in it, and Dwedit found a way to trigger it, but never any reliable way to execute code in that mode.</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> on Tue Jan 06, 2015 1:49 am, edited 1 time in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3512"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p138761"></a>
				<b class="postauthor">Espozo</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p138761">Re: GBA sound quality...</a></div><div style="float: right;"><a href="./viewtopic.php?p=138761#p138761"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jan 06, 2015 12:20 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=6683_1410824489.gif" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Sep 15, 2014 4:35 pm<br /><b>Posts:</b> 888<br /><b>Location:</b> Nacogdoches, Texas
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">lidnariq wrote:</div><div class="quotecontent">Quote:higher quality existing ones?How would you make the classic gameboy sound channels higher quality? I suppose you could add more choices of duty cycle and/or volume, but it's still fundamentally pulse waves.</div><br />I don't know why, but I thought that it could produce better quality sound if it did not have to process game mechanics and graphics like it had to on the Gameboy. There are separate types of audio though in these audio in these systems, right and I guess each chip is specifically designed to play a certain format? Isn't there FM that was used in the Genesis and plenty of other arcade machines and PCM that was similar to recorded sound effects that was used in the SNES and Neo Geo? Like I said, I have zero knowledge of audio hardware. (It doesn't help that the audio portion of the SNES is practically a different system.  <img src="./images/smilies/icon_razz.gif" alt=":P" title="Razz" /> )<br /><br /><div class="quotetitle">lidnariq wrote:</div><div class="quotecontent">No disc-based-console style &quot;fit 10 hours of music&quot; on this cartridge without additional hardware</div><br />What kind of additional hardware? Hardware for bank switching?<br /><br /><div class="quotetitle">lidnariq wrote:</div><div class="quotecontent">Additionally, I think I remember reading that the output stage of the GBA drops the LSB of the 8 bit bytes sent on the DirectSound channels, further degrading it into two 7-bit channels.</div><br />It doesn't matter, but I am curious. Do you know what for?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6683"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p138762"></a>
				<b class="postauthor">lidnariq</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p138762">Re: GBA sound quality...</a></div><div style="float: right;"><a href="./viewtopic.php?p=138762#p138762"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jan 06, 2015 1:47 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Apr 13, 2008 11:12 am<br /><b>Posts:</b> 2999<br /><b>Location:</b> zurich for this week
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Espozo wrote:</div><div class="quotecontent">There are separate types of audio though in these audio in these systems, right and I guess each chip is specifically designed to play a certain format?<br /></div>Right. The reason that the GBA provides the game boy's sound channels is because it contains a game boy. Whatever they provide has to be compatible with that, so while they could have extended it, there was no real utility in doing so.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">What kind of additional hardware [to fit lots of recorded music]? Hardware for bank switching?<br /></div>Hardware MP3/AAC decoder or comparable. Also when the GBA was current, 32 MiB of flash was still really expensive.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">It doesn't matter, but I am curious. Do you know [why the PCM channels lost another bit of depth]<br /></div>I think I misremembered. Rereading GBATEK:<br /><div class="quotetitle"><a href="http://problemkaputt.de/gbatek.htm#gbasoundcontrolregisters" class="postlink">GBATEK</a> wrote:</div><div class="quotecontent"><strong>Max Output Levels (with max volume settings)</strong><br />Each of the two FIFOs can span the FULL output range (<span style="color: #FF0000">+/-200h</span>).<br />Each of the four PSGs can span one QUARTER of the output range (+/-80h).<br />The current output levels of all six channels are added together by hardware.<br />So together, the FIFOs and PSGs, could reach THRICE the range (+/-600h).<br />The BIAS value is added to that signed value. With default BIAS (200h), the possible range becomes -400h..+800h, however, values that exceed the unsigned 10bit output range of 0..3FFh are clipped to MinMax(0,3FFh).<br /><br /><strong>Resampling to 32.768kHz / 9bit (default)</strong><br />The PSG channels 1-4 are internally generated at 262.144kHz, and DMA sound A-B could be theoretically generated at timer rates up to 16.78MHz. However, the final sound output is resampled to a rate of 32.768kHz, at 9bit depth <span style="color: #FF0000">(the above 10bit value, divided by two).</span> If necessary, rates higher than 32.768kHz can be selected in the SOUNDBIAS register, that would result in a depth smaller than 9bit though.<br /><br /><strong>PWM (Pulse Width Modulation) Output 16.78MHz / 1bit</strong><br />Okay, now comes the actual output. The GBA can output only two voltages (low and high), these 'bits' are output at system clock speed (16.78MHz). If using the default 32.768kHz sampling rate, then 512 bits are output per sample (512*32K=16M). Each sample value (9bit range, N=0..511), would be then output as N low bits, followed by 512-N high bits. The resulting 'noise' is smoothed down by capacitors, by the speaker, and by human hearing, so that it will effectively sound like clean D/A converted 9bit voltages at 32kHz sampling rate.<br /></div>I thought the output of the two FIFOs weren't prescaled, and so the division by two would have lost that LSB. But according to GBATEK, it looks like it's premultiplied by 4 before being divided by 2, so there's no loss there.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3512"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p138763"></a>
				<b class="postauthor">Bregalad</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p138763">Re: GBA sound quality...</a></div><div style="float: right;"><a href="./viewtopic.php?p=138763#p138763"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jan 06, 2015 1:59 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=38.jpg" width="60" height="60" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Nov 12, 2004 2:49 pm<br /><b>Posts:</b> 6321<br /><b>Location:</b> Jongny, VD, Switzerland
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">First, you must understand that the 2 &quot;Direct Sound&quot; channels are typically used to simulate more sound channels by software mixing (99.99% of GBA games uses them that way). Thus it is roughly equivalent to SNES hardware. In my FF5-Sound Restoration hack I was even able to get SNES-style reverb (this just costed a lot of RAM, which was unused by the game anyway).<br /><br />However, the loss of quality comes from the fact most developers wanted &quot;economic&quot; music replayers with few channels and features to save CPU usage for something better. Golden Sun games are without doubt the ones that got the closest to &quot;high quality&quot; sound on the GBA, because they wrote their own remixer which was at the bast of my FF5-sound restoration hack.<br /><br />The GBA doesn't contain a proper DAC and does this by the way of PWM. There is a tradeoff between PWM frequency and # of bits. In order to mix a Direct Sound channel + some PSG audio, at least 9 bits are required, however, using 9 bits makes the PWM only 32kHz, and at this rate a lot of aliasing appears and it sounds absolutely terrible. So most game uses 8-bits and 64kHz instead, which sounds better, even if more noise is here because of the bit loss, there is at least less aliasing. This is yet another reason why they didn't want to spend time on GBA sound mixer : The hardware would ruin it afterwards anyway.<br /><br />The &quot;best practice&quot; would be to run a sound engine that updates at exactly 32768 Hz or 16384 kHz, so that we would get no aliasing due to DAC and full 9-bit sound (except on GBC channels). But then it is impossible to update the sound engine in VBlank, and IRQs should be used.<br /><br />The GBZ80 is not usable in the GBA when it is in GBA mode. The first 4 sound channels is the only GBC &quot;component&quot; that is usable.<br /><br />Sound channel 3 was made better quality by allowing double buffering and 2-bit volume control (for a great total of 4 possible volumes). However, the sound engine 90% of commercial GBA uses doesn't appear allow to use both buffers.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I don't know why, but I thought that it could produce better quality sound if it did not have to process game mechanics and graphics like it had to on the Gameboy.</div><br />Yes, by updating the sound engine at a higher rate than 60Hz it becomes possible to get better sound quality, i.e. more precise/accurate pitch and volume change. However, few games used this possibility.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=38"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p138776"></a>
				<b class="postauthor" style="color: #AA0000">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p138776">Re: GBA sound quality...</a></div><div style="float: right;"><a href="./viewtopic.php?p=138776#p138776"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jan 06, 2015 12:20 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=9_1426464006.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 13837<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Espozo wrote:</div><div class="quotecontent">I have a few gba video cartridges, and although muffled, the sound quality was much better than what I would hear in 90% of GBA games. I've read that the GBA has 6 sound channels (aside from lack column scrolling, this seems to be the only thing worse about the GBA than the SNES) And although 4 channels are apparently about as good as the Gameboy, it says there are 2 &quot;Direct Sound&quot; channels, which I assume play back actual recorded music. (You can probably tell I have no knowledge of audio hardware. <img src="./images/smilies/icon_razz.gif" alt=":P" title="Razz" /> )</div><br />In practice, due to ROM size limits and desire to change tempo at runtime, games play sequenced samples mixed in software. But it's possible to decompress recorded music, as seen in my <a href="http://pineight.com/gba/gsm/" class="postlink">GSM player application</a>, in my <a href="http://pineight.com/lu/" class="postlink">Luminesweeper tech demo</a>, and in GBA Video.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Two more questions I just thought of: If the GBA is using the GBZ80 (how is this different than a normal Z80?)</div><br />The Game Boy 8-bit CPU is an 8080 clone with some (but not all) Z80 features and a &quot;direct page&quot; at $FF00-$FFFF.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">solely for the 4 sound channels</div><br />The Game Boy 8-bit CPU is turned off during GBA games. Only its APU remains on.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">than why aren't there more sound channels or higher quality existing ones?</div><br />One DAC for left and one for right &quot;ought to be enough for anyone&quot;, as people have misquoted Bill Gates. Software can synthesize or mix into those DACs.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Lastly, (though off topic) why didn't the Gameboy Micro or the DS play GB games?</div><br />Neither system generates the 5.0 V needed to run Game Boy Game Paks.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I heard that they still have the GBZ80, as it is required for sound on GBA games.</div><br />The Game Boy micro has the Game Boy 8-bit CPU because it would have been more expensive to cut it off the die. The DS has only the Game Boy APU, not the Game Boy 8-bit CPU.<br /><br /><div class="quotetitle">lidnariq wrote:</div><div class="quotecontent">Additionally, I think I remember reading that the output stage of the GBA drops the LSB of the 8 bit bytes sent on the DirectSound channels, further degrading it into two 7-bit channels.</div><br />Only when the DAC is clocked faster than 64 kHz.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p138798"></a>
				<b class="postauthor">mikejmoffitt</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p138798">Re: GBA sound quality...</a></div><div style="float: right;"><a href="./viewtopic.php?p=138798#p138798"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jan 06, 2015 5:13 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="http://mikejmoffitt.com/img/moft.png" width="96" height="96" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun May 27, 2012 8:43 pm<br /><b>Posts:</b> 729
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">tepples wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I heard that they still have the GBZ80, as it is required for sound on GBA games.</div><br />The Game Boy micro has the Game Boy 8-bit CPU because it would have been more expensive to cut it off the die. The DS has only the Game Boy APU, not the Game Boy 8-bit CPU.<br /></div><br /><br />Was any progress made on seeing if this is usable at all? If I get my hands on a Micro I'll see if it is pulsing the address lines as expected when forced into GBC mode, and maybe try giving it a (separately powered) Game Boy cartridge to read. I remember the thread from PocketHeaven about it, and I think when I last checked it years ago nothing conclusive really came about.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5314"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=5&amp;t=12214"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=5"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=5&amp;t=12214"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 7 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=25">Other</a> &#187; <a href="./viewforum.php?f=5">General Stuff</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: <a href="./memberlist.php?mode=viewprofile&amp;u=4526">Sik</a> and 8 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="12214" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;Reproduction</option>
		
			<option value="11">&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="25">Other</option>
		
			<option value="5" selected="selected">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="12">&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;GBDev</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>

<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>