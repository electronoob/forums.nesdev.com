<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Getting extra VBLANK</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Getting extra VBLANK</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=10324">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=10324</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>3</strong> of <strong>3</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Thu Aug 01, 2013 1:48 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I still don't get your point. Of course you can cover more area with 8x16 sprites than with 8x8, and this is true no matter if your &quot;limit&quot; is 55 sprites or 64.<br /><br />Therefore, scarifying 9 sprites is exactly the same in both cases, it's not a bigger sacrifice in one case than in another.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">and games that use 8x16 sprites often do, otherwise they'd use 8x8</div><br />I'm not that sure. Apparently Konami simply used 8x16 sprites in all their games without asking them too much questions. On the other side, Capcom always used 8x8 sprites in all their games. Only Nintendo actually switched between 8x8 and 8x16 for different games.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Thu Aug 01, 2013 7:52 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />NES Play Action Football switched between 8x8 and 8x16 sprites at a scanline split.  Yay TOSE programmers!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>infiniteneslives</b> [ Thu Aug 01, 2013 11:19 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">I still don't get your point. Of course you can cover more area with 8x16 sprites than with 8x8, and this is true no matter if your &quot;limit&quot; is 55 sprites or 64.<br /><br />Therefore, scarifying 9 sprites is exactly the same in both cases, it's not a bigger sacrifice in one case than in another.<br /></div><br /><br />Not sure how you can't see the difference here Bregalad...<br /><br />The limit is 64 sprites, you get to pick how big they are.  The cost of this method is 9 sprites.  Games using 8x8 sprites would presumably need more sprites since they're half as big.<br /><br />Analogy:<br /><br />You're painting a house.  I'm giving you 64 cans of paint, you pick if they're 1 liter or 2 liter cans.  After getting your paint you accidentally spill 9 of the cans, you have 55 cans left.  You tell me which situtation that loss of 9 cans was a bigger loss/sacrafice.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Thu Aug 01, 2013 11:20 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">I still don't get your point. Of course you can cover more area with 8x16 sprites than with 8x8, and this is true no matter if your &quot;limit&quot; is 55 sprites or 64.<br /><br />Therefore, scarifying 9 sprites is exactly the same in both cases, it's not a bigger sacrifice in one case than in another.<br /></div>Mario takes eight 8x8 sprites. Or he might take four 8x16 sprites. It only takes two (and a quarter) such 16x32 actors to make up for the loss of nine sprites to deliberately trigger the overflow flag.<br /><br />On the other hand, something like tepples's &quot;64 cans of sprite&quot; demo would be different if it were &quot;55 cans of sprite&quot;.<br /><br />Regardless, it's clearly NOT the same.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Thu Aug 01, 2013 11:45 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Sprite overflow flag is really really easy to trigger unintentionally, especially with the PPU's bugs, so just never use it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Nioreh</b> [ Thu Aug 01, 2013 12:00 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Dwedit wrote:</div><div class="quotecontent">Sprite overflow flag is really really easy to trigger unintentionally, especially with the PPU's bugs, so just never use it.</div><br /><br />I have seen this in lots of places. But I am using it for a project now to know when to flicker. It seems to work just fine, and it saves a lot of CPU since I don't have to manually keep track of when there are too many sprites on one scanline.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>3gengames</b> [ Thu Aug 01, 2013 12:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />When there are more than 8 sprites on a line, it's very easy to have it fail, don't use it. I use it in one project to do 2 splits mid-frame without IRQ's, but you have to make sure the data after the 8 sprites that do the split don't make the data after it make it unclear the flag, as that happens.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Aug 01, 2013 12:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The only way you could unintentionally trigger overflow is if you're using it for a mid- or bottom-screen split. Otherwise, if you keep sprites 1-9 eight lines above the top of the active playfield, and there's nothing above those sprites, those sprites are the only thing that could turn on the overflow flag. And you don't necessarily &quot;lose&quot; these 9 sprites; you can use them to display a status bar above the playfield.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Thu Aug 01, 2013 1:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Dwedit wrote:</div><div class="quotecontent">Sprite overflow flag is really really easy to trigger unintentionally, especially with the PPU's bugs, so just never use it.</div><br />What tepples said. I use it at the very top of the screen before any game objects have a chance to accidentally trigger it. It's pretty safe in that situation.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sat Aug 03, 2013 1:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Not sure how you can't see the difference here Bregalad...</div><br />Well it depends.<br />We already established that the reducted area in precentage is absolutely the same in all cases.<br /><br />Now if you look at the absolute area that is loss by wasting 9 tall sprites (or 9 2l paint cans in your analogy), the loose of area is BIGGER than if you choose short sprites (or 1l paint cans in your analogy).<br /><br />The third way of looking as it, is the raw area that you can draw. Of course it's smaller with 55 short sprites (or 55 1l paint cans) than with 55 tall sprites (or 55 2l pain cans). But that's the case as well if you replace both 55s with 64s.<br /><br />The last way to look at it, which makes me understand your point, is that if you need to draw some given area, your chances are bigger with 55 2l cans than with 55 1l cans. In this regard, the probability that you will *need* to use 2l cans instead of being satisfied with 1l is bigger.<br /><br />In summary, it all depends in which angle you look at it. I don't think it's obvious the loss is more or less acceptable with small or tall sprites. In both cases it's a small loss that should be accounted for.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">What tepples said. I use it at the very top of the screen before any game objects have a chance to accidentally trigger it. It's pretty safe in that situation.</div><br />As long as you are 100% sure that the flag gets set, I think it's okay (used to detect the end of VBlank only, not to do any raster timing synchronisation).<br />Now if somehow the flag could remain clear because of some PPU glitch, then it would freeze your game.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Aug 03, 2013 2:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Getting extra VBLANK</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">Now if somehow the flag could remain clear because of some PPU glitch, then it would freeze your game.</div><br />We discussed timeout techniques for sprite 0 in <a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=10104" class="postlink">that topic about occasional horizontal line glitches in SMB1</a>. The same techniques would work for overflow: a momentary flicker is better than a freeze.<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; lda #%00100000<br />loop:<br />&nbsp; bit $2002<br />&nbsp; bmi did_not_trigger<br />&nbsp; beq loop<br />&nbsp; ; at this point, we know the overflow triggered, so wait 8 scanlines,<br />&nbsp; ; set sprite size to 8x16 if needed, and turn on bg rendering<br />&nbsp; ; (omitted)<br /><br />did_not_trigger:<br />&nbsp; ; The PPU hit the bottom of the picture instead of the 9 sprites.<br />&nbsp; ; Log this situation for debugging.&nbsp; if there are too many<br />&nbsp; ; glitches in a short time, assume something is broken, and<br />&nbsp; ; disable raster effects so as not to trigger a seizure.<br />&nbsp; inc glitch_count<br /></div>

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>3</strong> of <strong>3</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>