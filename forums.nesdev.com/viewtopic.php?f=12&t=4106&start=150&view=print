<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - SPC7110 Reverse Engineering Project</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">SPC7110 Reverse Engineering Project</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=12&amp;t=4106">http://forums.nesdev.com/viewtopic.php?f=12&amp;t=4106</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>11</strong> of <strong>21</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Andreas Naive</b> [ Wed Jun 25, 2008 11:05 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">For a long string of LPS, the 0th and 4th bitplane seem to be treated differently as their mps is changed for the second bit from that bitplane, while it is not for the other six bitplanes. </div><br /><br />I had seen something different with the 0th bitplane compared with the following ones. Nice to know i wasn't the unique; i hadn't looked at it enough to see the same thing for the 4th one.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">One last question about context modeling.<br /><br />Let's say we have a basic frequency counter (8-width image):<br />freq_0[2][2] and freq_1[2][2] for above/left pixels.<br /><br />Is that practically an 'industrial-strength' solution?</div>
<br />
<br />It depends on the kind of data you are going to compress... it can be a good solution in many cases, however. As i'm not sure about the sense of your question, i should clarify that the contexts neviksti and me have been talking about are, by now, not taking into account the pixels surrounding the current one (though i still keep this idea in mind) , but only the bitplane numbering (from 0 to 7).
<br />
<br />I should apologize by not answering adequately many questions; i'm having some strange days in RL so most times i only can work on this and/or connect to the Internet intermitently. <img src="./images/smilies/icon_razz.gif" alt=":P" title="Razz" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Andreas Naive</b> [ Wed Jun 25, 2008 11:41 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Okay, to get second bit of bitplane1 (get first 10 bits to decode correct)<br />CÃ³digo:<br />if the _immediately_previous_ symbol was correct (not related to current bitplane at all)<br />   prob=$25<br />   if last bit from this bitplane was guessed wrong<br />        mps=1<br />   endif<br />else<br />   prob=$5A<br />endif<br /><br /></div>
<br />
<br />After cross-comparing this with my tests, it seems we are on the same page now. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /> As you say, there are many ways we can explain this... . Just to make sure you don't miss it, take into account that the number of contexts is probably a multiple of 8, but not necessarily 8. <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" />  So the fact that the mps and prob seems to depend on previous bits is not necessarily a strange thing. After all, when we studied the "lots of zeros plus one 1" thing, the previous bits were always 0, so whatever distinction between contexts made by previous bits was lost in that case.
<br />
<br />Now i have to leave, as my wife is dropping me away from the computer. Have fun. <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>jolly_codger</b> [ Wed Jun 25, 2008 2:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />EDIT:
<br />
<br />Here's bit 11 (hmm...)
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">if&#40; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&#123;<br />&nbsp; &nbsp;PROB = 0x25;<br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br />&nbsp; &nbsp;&#125;<br />&#125;<br />else<br />&#123;<br />&nbsp; &nbsp;PROB = 0x5A;<br />&#125;<br /></div><br /><br /><br />EDIT:<br /><br />Here's bit 12 (huh!)<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">if&#40; &#40;&#40;PREDICT&gt;&gt;2&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&#123;<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;10&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp;&nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp;&nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp;&nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;PROB = 0x5A;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;else<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;PROB = 0x25;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br />&nbsp; &nbsp;&#125;<br />&#125;<br />else<br />&#123;<br />&nbsp; &nbsp;PROB = 0x5A;<br />&#125;<br /></div><br /><br /><br />EDIT:<br /><br />bit 13 WIP. Definitely last for tonight.<br />ie. First 8-bits = 'xxxx0xxx'.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">PROB = 0x25;<br /></div>
<br />
<br />o_O..?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>caitsith2</b> [ Wed Jun 25, 2008 9:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />SPL4 and MDH based tests are now possible.  SPL4 mirrors its data rom at banks 0x10, 0x20, 0x30, 0x80, 0x90, 0xA0, and 0xB0,   MDH mirrors its datarom to 0x20, 0x80, and 0xA0.    Banks 0x40-0x7F, and 0xC0-0xFF decompress as all 0.  I can run tests for all 3 games. Neviksti can only run tests for FEoEZ.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>neviksti</b> [ Wed Jun 25, 2008 10:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">jolly_codger wrote:</div><div class="quotecontent">bit 13 WIP. Definitely last for tonight.<br />ie. First 8-bits = 'xxxx0xxx'.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">PROB = 0x25;<br /></div><br /><br />o_O..?</div><br />Thanks for all the info.<br /><br />Due to the "only LPS" tests showing bitplane 0 and 4 seemed different.  I tried a hunch that they only are depending on their previous values.  Yep, at least for now that appears to be true.<br /><br />Here's the rest to get that 13th bit (using your notation)<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">prob=0x25;<br />if&#40; &#40;&#40;predict&gt;&gt;7&#41;&amp;1&#41; == 0 &#41; <br />&nbsp; &nbsp; mps=1;<br /></div><br /><br /><div class="quotetitle">caitsith2 wrote:</div><div class="quotecontent">SPL4 and MDH based tests are now possible.  SPL4 mirrors its data rom at banks 0x10, 0x20, 0x30, 0x80, 0x90, 0xA0, and 0xB0,   MDH mirrors its datarom to 0x20, 0x80, and 0xA0.    Banks 0x40-0x7F, and 0xC0-0xFF decompress as all 0.  I can run tests for all 3 games. Neviksti can only run tests for FEoEZ.</div>
<br />Alright!  Good to hear you got everything running.
<br />
<br />EDIT: I'll be pretty much gone until Monday.  Maybe I can poke back on here and there, but nothing substantial.  Who knows, maybe I'll come back and the whole mystery will be solved and I'll have missed all the fun (both sad and good all at the same time).
<br />
<br />Oh well, have fun everyone.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>jolly_codger</b> [ Thu Jun 26, 2008 5:01 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks for the tips!
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">// bit 14 ~ bit 10<br />if&#40; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&#123;<br />&nbsp; &nbsp;PROB = 0x25;<br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br />&nbsp; &nbsp;&#125;<br />&#125;<br />else<br />&nbsp; &nbsp;PROB = 0x5A;<br /><br /><br />// bit 15 ~ bit 11<br />if&#40; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp;&nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&#123;<br />&nbsp; &nbsp;PROB = 0x25;<br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br />&#125;<br />else<br />&nbsp; &nbsp;PROB = 0x5A;<br /></div><br /><br /><br />EDIT:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">// bit 16<br />if&#40; &#40;&#40;PREDICT&gt;&gt;2&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp;&nbsp; &nbsp;&#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&#123;<br />&nbsp; &nbsp;PROB = 0x25;<br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br />&#125;<br />else<br />&nbsp; &nbsp;PROB = 0x5A;<br /></div><br /><br />EDIT:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">// bit 17<br />PROB = 0x25;<br /><br />if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&#123;<br />&nbsp; &nbsp;MPS = 1;<br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;PROB = 0x5A;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 0;<br />&nbsp; &nbsp;&#125;<br />&#125;<br /></div><br /><br /><br />EDIT:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">// bit 18<br />if&#40; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&#123;<br />&nbsp; &nbsp;// 1-1<br />&nbsp; &nbsp;PROB = 0x25;<br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;PROB = 0x11;<br /><br /><br /><br />&nbsp; &nbsp;// 1-0<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;PROB = 0x5A;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;PROB = 0x25;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MPS = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;// 0-1<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MPS = 0;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;// 0-0<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 0;<br />&#125;<br />else<br />&#123;<br />&nbsp; &nbsp;// 1-1<br />&nbsp; &nbsp;PROB = 0x5A;<br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;PROB = 0x25;<br /><br /><br /><br />&nbsp; &nbsp;// 1-0<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br /><br /><br /><br />&nbsp; &nbsp;// 0-1<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MPS = 0;<br />&nbsp; &nbsp;&#125;<br /><br /><br /><br />&nbsp; &nbsp;// 0-0<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 0;<br />&#125;<br /></div>
<br />
<br />
<br />That's bits 1-18 now.
<br />
<br />If someone sees a way to reduce / re-organize any of code, PLEASE do! xx(  xx(  xx(
<br />
<br />
<br />EDIT:
<br />out_count = printf output counter (all references deleted)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Andreas Naive</b> [ Thu Jun 26, 2008 11:16 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><div class="codetitle"><b>Code:</b></div><div class="codecontent">// bit 17<br />if&#40; out_count==0 &#41;<br />&#123;<br />&nbsp; &nbsp;PROB = 0x25;<br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp; &nbsp; MPS = 1;<br /><br />&nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PROB = 0x5A;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MPS = 0;<br />&nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp;&#125;<br />&#125;<br /><br /></div></div>
<br />
<br />What is "out_count"?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>neviksti</b> [ Fri Jun 27, 2008 5:45 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">jolly_codger wrote:</div><div class="quotecontent"><div class="codetitle"><b>Code:</b></div><div class="codecontent">// bit 16<br />if&#40; &#40;&#40;PREDICT&gt;&gt;2&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp;&nbsp; &nbsp;&#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&#123;<br />&nbsp; &nbsp;PROB = 0x25;<br /><br />&nbsp; &nbsp;if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;MPS = 1;<br />&#125;<br />else<br />&nbsp; &nbsp;PROB = 0x5A;<br /></div></div><br />I haven't had time to play with all the new info yet, but I got a plane ride coming up and was hoping to incorporate your info before leaving so I could try to figure it out while sitting around.<br /><br />Unfortunately, I can't get the above code to work.<br />What are you defaulting mps to?<br />I tried 0 (which is also the previous value), or even the mps of the previous bit, and it fails.<br /><br />EDIT:<br />In case our core decompressor is differing on some border case, here's the 'debug output' on my side (all that matters are the cutoff values really)<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">ERR: input&#91;A617626E F9F6AA9F&#93;&nbsp; &nbsp; test=&#91;808015B1&#93;&nbsp; &nbsp; real out=&#91;80810017 A5B72523&#93;<br /><br /><br />&nbsp; cutoff=A6000000&nbsp; &nbsp; top=FF cut=A5 prob=5A val=A6&nbsp; mps=0 -&gt; 1&nbsp; shift&#40;1,0&#41;<br />&nbsp; cutoff=D3000000&nbsp; &nbsp; top=B3 cut=59 prob=5A val=00&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br />&nbsp; cutoff=BC800000&nbsp; &nbsp; top=B3 cut=59 prob=5A val=00&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br />&nbsp; cutoff=B1400000&nbsp; &nbsp; top=B3 cut=59 prob=5A val=00&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br />&nbsp; cutoff=ABA00000&nbsp; &nbsp; top=B3 cut=59 prob=5A val=01&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br />&nbsp; cutoff=A8D00000&nbsp; &nbsp; top=B3 cut=59 prob=5A val=02&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br />&nbsp; cutoff=A7680000&nbsp; &nbsp; top=B3 cut=59 prob=5A val=05&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br />&nbsp; cutoff=A6B40000&nbsp; &nbsp; top=B3 cut=59 prob=5A val=0B&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br /><br />&nbsp; cutoff=A68F0000&nbsp; &nbsp; top=B3 cut=8E prob=25 val=17&nbsp; mps=1 -&gt; 1&nbsp; shift&#40;0&#41;<br />&nbsp; cutoff=A66A0000&nbsp; &nbsp; top=8E cut=69 prob=25 val=17&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br />&nbsp; cutoff=A6578000&nbsp; &nbsp; top=D3 cut=AE prob=25 val=2E&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;0&#41;<br />&nbsp; cutoff=A6450000&nbsp; &nbsp; top=AE cut=89 prob=25 val=2E&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;0&#41;<br />&nbsp; cutoff=A6328000&nbsp; &nbsp; top=89 cut=64 prob=25 val=2E&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br />&nbsp; cutoff=A6294000&nbsp; &nbsp; top=C9 cut=A4 prob=25 val=5D&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;0&#41;<br />&nbsp; cutoff=A6200000&nbsp; &nbsp; top=A4 cut=7F prob=25 val=5D&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;1&#41;<br />&nbsp; cutoff=A61B6000&nbsp; &nbsp; top=FF cut=DA prob=25 val=BB&nbsp; mps=0 -&gt; 0&nbsp; shift&#40;0&#41;</div>
<br />
<br />EDIT: 
<br />Yep, it is a weird border case.
<br />If the top of the range has the high bit 0, I figured it was good to shift everything one bit.  The weird border case is if the range is 00... to 7F... they don't shift.
<br />So they must be keeping a variable that the range is <em>less than</em>, and shifting if that value is &lt; $80 instead of &lt;= $80.  Strange.
<br />
<br />Anyway, that border case doesn't seem to come up anywhere else, and unless I consider the prob=2*$25, that clearly is the answer. Fixing that and I now get the 16th bit.
<br />
<br />EDIT:
<br />Yep works for 1st - 18th bit now.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>jolly_codger</b> [ Fri Jun 27, 2008 6:29 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="codetitle"><b>Code:</b></div><div class="codecontent">//Bit 18 &#40;#2&#41;<br />&nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x11;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x25;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x25;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x5A;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br /><br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 0 ||<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 0;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x25;<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x5A;<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 1 ||<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 0;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &#125;<br /></div><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">//bit 19<br />&nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;17&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x11;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // hmm..?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;14&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;13&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;12&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;11&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;10&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x25;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x25;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 ||<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x25;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x5A;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; != &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;17&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;17&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;16&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x25;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x25;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;17&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x5A;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x25;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PROB = 0x5A;<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; // 0-0 &#91;MPS&#93;<br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 0-0 &#91;MPS&#93;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 0;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 0;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 0;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; // 0-1 &#91;MPS&#93;<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;17&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 0;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;17&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 0;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; // 1-0 &#91;MPS&#93;<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;15&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;7&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 0 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;17&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; &#40;&#40;PREDICT&gt;&gt;17&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;9&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;8&#41;&amp;1&#41; == 1 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;1&#41;&amp;1&#41; == 0 &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#40;&#40;PREDICT&gt;&gt;0&#41;&amp;1&#41; == 1 &#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MPS = 1;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &#125;<br /></div>
<br />
<br />Personally not happy about the way MPS is written for 18-19. <img src="./images/smilies/icon_sad.gif" alt=":(" title="Sad" />
<br />And there's some quirky things beginning to happen. o_o
<br />
<br />
<br />EDIT:
<br />CODE &lt; VALUE --&gt; MPS
<br />CODE &gt;= VALUE --&gt; LPS
<br />(Current core = like you sifted out!)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>neviksti</b> [ Fri Jun 27, 2008 1:38 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Bleh. I didn't get much done on the plane, but I have a few quick comments.
<br />
<br /><div class="quotetitle">jolly_codger wrote:</div><div class="quotecontent">Personally not happy about the way MPS is written for 18-19. <img src="./images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br />And there's some quirky things beginning to happen. o_o</div>
<br />Thank you for all your hard work!
<br />I am amazed you are able to find such complicated logic to fit the data.  I don't think it is useful continuing further in this direction though.  The idea was just to build up some raw facts of what everything depends on, so we could condense this into a hopefully fairly simple evolution of the probabilities and mps.  As shown by the 19th bit logic, we should really devote time to figuring out what "state information" the chip does use.
<br />
<br />For instance, how much can those logic trees be simplified if we allow use of the previous mps and prob as part of the logic?
<br />
<br />
<br />
<br />I was going to try to stay away from this during my trip, but it is really stuck in the back of my mind.  Since it appears to be a futile fight, I might be working on it a little bit tonight.
<br />
<br />Good luck everyone.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Andreas Naive</b> [ Fri Jun 27, 2008 3:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">For instance, how much can those logic trees be simplified if we allow use of the previous mps and prob as part of the logic? </div>
<br />
<br />Yesterday i was able to reproduce the first 16 bits in a reasonably clean and coherent way by supposing the three previous bits are used to determine the context and the "lastBits" state variable is reset every 4 bits. All works fine till reaching the 17th bit, where i'm having problems with the MPS evolution. Not sure if i'm going to be able to work on this this weekend, but i will continue on this line when i can.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>neviksti</b> [ Fri Jun 27, 2008 3:33 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Andreas Naive wrote:</div><div class="quotecontent">All works fine till reaching the 17th bit, where i'm having problems with the MPS evolution.</div><br />I was just about to post about this.  I was working on some evolution tables and the 17th bit is seriously messed up.<br /><br />Check this out:<br />ALL previous outputs are 1, AND the previous mps is 1<br />what would you guess the mps to be?<br /><br />Well it is 0.<br />So I seriously think we hit the next set of bitplane "contexts".<br />This actually makes sense considering the SNES format.<br /><br /><div class="quotetitle">Andreas Naive wrote:</div><div class="quotecontent">Yesterday i was able to reproduce the first 16 bits in a reasonably clean and coherent way by supposing the three previous bits are used to determine the context and the "lastBits" state variable is reset every 4 bits.</div>
<br />After 16bits, try resetting all contexts to "startup state" and let me know if you get 32bits now.
<br />
<br />Can you share your code for us to fiddle with?
<br />
<br />EDIT: Nevermind.  The probability and mps states do carry over somehow, as bit17 can have prob=$25, and the mps of bit17 <span style="text-decoration: underline"><em>can</em></span> be 1.
<br />
<br />This makes absolutely no sense.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>jolly_codger</b> [ Fri Jun 27, 2008 3:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />'Trying' to get bit 20 to print out using brute force (barmy crazy hard).
<br />If it works, history implies bits 21-23 should be cakewalk (ideally).
<br />
<br />Not surprisingly, the logic is getting _more_ convoluted. So this probably isn't going to hold out much longer - which probably messes up my current theory (hehe).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Andreas Naive</b> [ Fri Jun 27, 2008 4:27 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">After 16bits, try resetting all contexts to "startup state" and let me know if you get 32bits now.<br /></div><br /><br />He, he. That was the first thing i tried, you should have guessed that. <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" /><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">EDIT: Nevermind. The probability and mps states do carry over somehow, as bit17 can have prob=$25, and the mps of bit17 can be 1. </div><br /><br /><img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Can you share your code for us to fiddle with? </div>
<br />
<br />Of course:
<br />
<br /><a href="http://andreasnaive.en.eresmas.com/SPC7110/test7.cpp.zip" class="postlink">http://andreasnaive.en.eresmas.com/SPC7110/test7.cpp.zip</a>
<br />
<br />But this is just a development snapshot. You have been warned. <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Andreas Naive</b> [ Sat Jun 28, 2008 3:22 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />OK. After allowing the MPS be changed even if PROB=0x25, i now match all the 17th bit "strange cases" with the cases when after the 9th bit we haven't renormalized (there is a 1 to 1 correspondence). So maybe the answer is there. I now have to go to a relative's wedding, so i will be gone till tomorrow. Good luck.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>11</strong> of <strong>21</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>