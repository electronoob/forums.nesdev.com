<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=10439" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2013-09-02T23:53:04-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=10439</id>
<entry>
<author><name><![CDATA[infiniteneslives]]></name></author>
<updated>2013-09-02T23:53:04-07:00</updated>
<published>2013-09-02T23:53:04-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117500#p117500</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117500#p117500"/>
<title type="html"><![CDATA[Re: RAMBO-1 IRQ timing]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117500#p117500"><![CDATA[
I verified the MMC1's double write cycle protection was based on what appears to be latching of PRG R/W with M2 as a clock. I verified that by leaving M2 low while writing to the mapper and every write was accepted or blocked based on the status of PRG R/W for the most recent latch.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4832">infiniteneslives</a> — Mon Sep 02, 2013 11:53 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ulfalizer]]></name></author>
<updated>2013-09-02T19:50:52-07:00</updated>
<published>2013-09-02T19:50:52-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117470#p117470</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117470#p117470"/>
<title type="html"><![CDATA[Re: RAMBO-1 IRQ timing]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117470#p117470"><![CDATA[
<div class="quotetitle">3gengames wrote:</div><div class="quotecontent"><br />Isn't it consecutive writes the first one is the only one that takes effect? At least that's what I thought was determined from all tests, ever.<br /></div><br /><br />Yeah, that was what I meant - &quot;...all writes <em>but the first</em> always being ignored...&quot;<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5911">ulfalizer</a> — Mon Sep 02, 2013 7:50 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[3gengames]]></name></author>
<updated>2013-09-02T19:46:28-07:00</updated>
<published>2013-09-02T19:46:28-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117469#p117469</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117469#p117469"/>
<title type="html"><![CDATA[Re: RAMBO-1 IRQ timing]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117469#p117469"><![CDATA[
Isn't it consecutive writes the first one is the only one that takes effect? At least that's what I thought was determined from all tests, ever.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4311">3gengames</a> — Mon Sep 02, 2013 7:46 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ulfalizer]]></name></author>
<updated>2013-09-02T19:31:20-07:00</updated>
<published>2013-09-02T19:31:20-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117468#p117468</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117468#p117468"/>
<title type="html"><![CDATA[Re: RAMBO-1 IRQ timing]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117468#p117468"><![CDATA[
Thanks for the investigation.<br /><br />Another thing I'm curious about is the precise circumstances where MMC1 ignores writes. thefox implied it's not as simple as all writes but the first always being ignored for consecutive writes (can't remember where he said that though). Emulating it like that fixes Bill and Ted's Excellent Adventure but breaks the polynes3 demo.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5911">ulfalizer</a> — Mon Sep 02, 2013 7:31 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[James]]></name></author>
<updated>2013-09-02T17:00:07-07:00</updated>
<published>2013-09-02T17:00:07-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117464#p117464</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117464#p117464"/>
<title type="html"><![CDATA[Re: RAMBO-1 IRQ timing]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117464#p117464"><![CDATA[
That's correct. Similar to RAMBO-1's scanline counter mode.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=88">James</a> — Mon Sep 02, 2013 5:00 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[infiniteneslives]]></name></author>
<updated>2013-09-02T16:17:51-07:00</updated>
<published>2013-09-02T16:17:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117462#p117462</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117462#p117462"/>
<title type="html"><![CDATA[Re: RAMBO-1 IRQ timing]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117462#p117462"><![CDATA[
<div class="quotetitle">James wrote:</div><div class="quotecontent"><br />The IRQ counter reaches 0 at F (as predicted, 259.25us after E) then, like MMC3-style IRQs, IRQ is asserted on the next falling edge of M2 (G):<br /></div><br />Good stuff,<br /><br />So just to clarify, when you say 'like MMC3 style IRQs', you mean 'like RAMBO-1's CHR-A12 scanline counter' (which is similar to the MMC3 but different in delay amongst possible other things).  Not 'like Nintendo's MMC3'.  Correct?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4832">infiniteneslives</a> — Mon Sep 02, 2013 4:17 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[James]]></name></author>
<updated>2013-09-02T15:49:39-07:00</updated>
<published>2013-09-02T15:49:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117461#p117461</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117461#p117461"/>
<title type="html"><![CDATA[Re: RAMBO-1 IRQ timing]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117461#p117461"><![CDATA[
I took a closer look at CPU cycle-based IRQs today:<br /><br />The IRQ counter reload is set to 0x74 (116) so, once IRQs are enabled, the next IRQ should occur 464 (116*4) CPU cycles later (or about 259.25us later):<br /><img src="http://nemulator.com/images/rambo_cpu_set_reload.png" alt="Image" /><br /><br />IRQs are enabled by writing to 0xE001 at D.  The IRQ counter starts counting down on the next falling edge of M2 (E):<br /><img src="http://nemulator.com/images/rambo_cpu_enable_irq.png" alt="Image" /><br /><br />The IRQ counter reaches 0 at F (as predicted, 259.25us after E) then, like MMC3-style IRQs, IRQ is asserted on the next falling edge of M2 (G):<br /><img src="http://nemulator.com/images/rambo_cpu_assert_irq.png" alt="Image" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=88">James</a> — Mon Sep 02, 2013 3:49 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[infiniteneslives]]></name></author>
<updated>2013-09-01T10:49:01-07:00</updated>
<published>2013-09-01T10:49:01-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117403#p117403</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117403#p117403"/>
<title type="html"><![CDATA[Re: RAMBO-1 IRQ timing]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117403#p117403"><![CDATA[
Awesome work James!  That's an interesting approach they took and now makes complete sense on the wide range of delays seen by the RAMBO-1.  Thanks for taking the time to get that chip to spill it's guts.<br /><br />We need to make sure this gets updated in the wiki and Disch docs.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4832">infiniteneslives</a> — Sun Sep 01, 2013 10:49 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[James]]></name></author>
<updated>2013-09-02T15:41:06-07:00</updated>
<published>2013-08-31T10:25:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117323#p117323</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117323#p117323"/>
<title type="html"><![CDATA[RAMBO-1 IRQ timing]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10439&amp;p=117323#p117323"><![CDATA[
Here's the results of my analysis of RAMBO-1 IRQ timing.<br /><br />For MMC3-style IRQs, RAMBO-1 checks A12 on falling edges of M2.  When it's time to do so, IRQ is asserted on the next falling edge of M2 (plus about 20ns).  Since there are <a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=6186&amp;start=0" class="postlink">4 possible CPU/PPU alignments</a>, there are 4 variations of IRQ timing.  Furthermore, since odd frames are 1 PPU cycle short, there are two different delays for each variation.  Here's the IRQ assertion time, relative to the rising edge of A12, for each alignment:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Short      Long<br />ns (cycles)<br />761 (4.1)   947 (5.1)<br />621 (3.3)   812 (4.3)<br />900 (4.8)   1088 (5.8)<br />582 (3.1)   950 (5.1)<br /></div><br /><br />Alignment 1:<br /><img src="http://nemulator.com/images/rambo_a12_1_1.png" alt="Image" /><br /><img src="http://nemulator.com/images/rambo_a12_1_2.png" alt="Image" /><br /><br />Alignment 2:<br /><img src="http://nemulator.com/images/rambo_a12_2_1.png" alt="Image" /><br /><img src="http://nemulator.com/images/rambo_a12_2_2.png" alt="Image" /><br /><br />Alignment 3:<br /><img src="http://nemulator.com/images/rambo_a12_3_1.png" alt="Image" /><br /><img src="http://nemulator.com/images/rambo_a12_3_2.png" alt="Image" /><br /><br />Alignment 4:<br /><img src="http://nemulator.com/images/rambo_a12_4_1.png" alt="Image" /><br /><img src="http://nemulator.com/images/rambo_a12_4_2.png" alt="Image" /><br /><br />Edit: Revised CPU cycle-based IRQ info below.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=88">James</a> — Sat Aug 31, 2013 10:25 am</p><hr />
]]></content>
</entry>
</feed>