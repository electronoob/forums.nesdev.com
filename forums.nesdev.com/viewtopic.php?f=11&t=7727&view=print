<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - mapper19 と Namcot 129, 163, 175, 340</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">mapper19 と Namcot 129, 163, 175, 340</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=11&amp;t=7727">http://forums.nesdev.com/viewtopic.php?f=11&amp;t=7727</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>naruko</b> [ Sat May 07, 2011 8:07 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>mapper19 と Namcot 129, 163, 175, 340</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />163 に flash memory をつないだり、実機で動かしてみました。いままでの資料に記載されていないレジスタの情報などをまとめてテキストファイルにしておきました。
<br />
<br /><!-- m --><a class="postlink" href="http://unagi.sourceforge.jp/cgi-bin/hiki/hiki.cgi?c=plugin;plugin=attach_download;p=163_namco;file_name=namcot_163.txt">http://unagi.sourceforge.jp/cgi-bin/hik ... ot_163.txt</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://unagi.sourceforge.jp/cgi-bin/hiki/hiki.cgi?c=plugin;plugin=attach_download;p=163_namco;file_name=namcot_175_340.txt">http://unagi.sourceforge.jp/cgi-bin/hik ... 75_340.txt</a><!-- m -->
<br />
<br />本当は英語で記載したかったのですが、気力が足りなかったので日本語のところに書いてみました。また、NesCartDb さんの情報には大変お世話になりました。ありがとうございます。

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Sat May 07, 2011 9:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />新しいの情報をありがとうございました。時間あれば翻訳したいけど、私の日本語がまだ良くないです。
<br />
<br />新しいの情報が分けたがどうか知りたいです。　
<br />
<br />よろしくお願い致します。

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>naruko</b> [ Wed May 18, 2011 8:06 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />文書を更新しました�RAM CS# 端子の接続と $e000 の挙動から、スプラッターハウスやワギャンランドを 340 としました。 ただしこれは採番の観点から考えると矛盾しています。
<br />
<br />スターウォーズの 129 の基板の写真を掲載しておきます。(thanks Yoshida)
<br />音源機能はありますが、 163 とはすこし違いました。
<br /><img src="http://cdn-ak.f.st-hatena.com/images/fotolife/n/na6ko/20110519/20110519115523.jpg" alt="Image" />
<br /><img src="http://cdn-ak.f.st-hatena.com/images/fotolife/n/na6ko/20110519/20110519115522.jpg" alt="Image" />
<br />
<br />Banshakuさん
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">新しいの情報が分けたがどうか知りたいです。　 </div>
<br />日本語が伝わらないので英語で書いてもらえますか。(ただし返答は日本語にします)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>etabeta</b> [ Wed Apr 17, 2013 12:18 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: mapper19 と Namcot 129, 163, 175, 340</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />sorry to bump this old thread, but I'd like to update MESS to properly emulate these Namco boards too and I'd like to have a few confirmations<br /><br />Namcot 175:<br />- can map only CHR-ROM to PPU RAM by writing at $8000-$bfff<br />- no mirroring control<br />- WRAM protect bit at $c000-$c7ff<br />- no additional sound<br /><br />Namcot 340:<br />- can map only CHR-ROM to PPU RAM by writing at $8000-$bfff<br />- mirroring control to map CIRAM to PPU nametable at $e000-$e7ff<br />- no WRAM in any known cart (so unclear if there is any enable bit)<br />- no additional sound<br /><br />Namcot 129/163<br />- can map either CHR-ROM or CIRAM to PPU RAM by writing at $8000-$bfff<br />- mirroring control to map either CIRAM or CHR-ROM to PPU nametable at $c000-$dfff<br />- WRAM protect bits at $f800-$ffff<br />- additional sound<br /><br />is the above correct?<br /><br />If so, I'd have a couple of questions about Namcot-163.<br /><br />1. is there any game which actually uses CIRAM as PPU RAM? <br />I'd like to have a test case to see if I'm emulating it correctly<br /><br />2. docs are not 100% clear about $f800 reg. it seems to work both as External RAM protect *and* for sound address... but when is it used for one and when for the other? does the effect depend on bit4 or on something else? or is it always used for both?<br /><br />at the moment, I won't emulate the sound capabilities (I'm not really a sound guy, so I'll ask help to some other MAMEdev for that), but I'd like to have CIRAM and WRAM correct before that <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />thanks<br /><br />EDIT: replaced spurious occurrence of CHR-RAM with CHR-ROM...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Wed Apr 17, 2013 2:17 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: mapper19 と Namcot 129, 163, 175, 340</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I helped BootGod modify his CopyNES so that he could verify everything I'd transcribed from naruko's notes; he said he agrees with the behavior I've transcribed on the wiki.<br /><br />With one bonus: Masamune is weird. The four epoxy blob version of Masamune is bizarre in a completely inscrutable way that we couldn't figure out. If the smallest epoxy blob is destroyed or disabled, the cartridge seems to act like a perfectly normal N163 cartridge. If the smallest epoxy blob is functional, writes to internal RAM must first be written to $6000, and then the write to $4800 uses the value that had been written to $6000. Reads act as normal regardless. However: the game seems to work perfectly fine regardless of whether the behavior is proper N163 or this bizarro-land variant.<br /><br /><div class="quotetitle">etabeta wrote:</div><div class="quotecontent">is the above correct?</div> I'd say that your summary is, with the specificity that &quot;CHR-ROM to PPU RAM&quot; means specifically &quot;as pattern tables&quot;<br /><br /><div class="quotetitle">etabeta wrote:</div><div class="quotecontent">1. is there any game which actually uses CIRAM as PPU RAM?<br />I'd like to have a test case to see if I'm emulating it correctly</div> Naruko and BootGod both verified the behavior, but couldn't find a specific game that relied on it. Disch claims that specific games exist that rely on this behavior, but doesn't provide a name.<br /><br /><div class="quotetitle">etabeta wrote:</div><div class="quotecontent">2. docs are not 100% clear about $f800 reg. it seems to work both as External RAM protect *and* for sound address... but when is it used for one and when for the other? does the effect depend on bit4 or on something else? or is it always used for both?</div> It is always both. So there's some hilarious dances in (i think?) e.g. King of Kings to update music registers at the same time as it keeps PRG-RAM writeable.<br /><br />I don't know whether there's actually two separate registers inside, but it looks like that should be academic: if the register <strong>is</strong> shared, when the auto-increment bit is set, PRG-RAM is write-protected.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">at the moment, I won't emulate the sound capabilities (I'm not really a sound guy, so I'll ask help to some other MAMEdev for that), but I'd like to have CIRAM and WRAM correct before that <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>The N163 natively generates samples at 119kHz always, and rotates between all the channels. A good resampler should be the only hard part about it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>etabeta</b> [ Wed Apr 17, 2013 2:55 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: mapper19 と Namcot 129, 163, 175, 340</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />thanks a lot for the replies, it all makes sense now (for what an epoxy block can make sense <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" /> ). <br /><br />a small question, to be sure I'm not starting from wrong assumptions about 163 CHR banks usage (it happens often to me, but usually I find test cases which prove me wrong, while here there seems to be no usage of this feature, so I prefer to ask): the documented behavior is that when these accesses occur the NES CIRAM is used as VRAM (i.e. PPU $0-$1fff) instead of being used as NT (i.e. PPU $2000-$2fff), right? because some (old) docs talk about CHR-RAM but no on-cart VRAM chips is present (based on bootgod descriptions)...<br /><br /><div class="quotetitle">lidnariq wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">at the moment, I won't emulate the sound capabilities (I'm not really a sound guy, so I'll ask help to some other MAMEdev for that), but I'd like to have CIRAM and WRAM correct before that <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>The N163 natively generates samples at 119kHz always, and rotates between all the channels. A good resampler should be the only hard part about it.</div><br /><br />yup, but I'm not familiar with the internals of sound emulation in MAME/MESS. it took me a few minutes to add sound to Sunsoft5B and VRC6, because the base chips were already emulated and I only needed to take care of their registers. but in this case, I need to understand e.g. how to hook up the resampler to the rest of the code <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />given that I still have many more simpler things to implement, I think this will be postponed to a later stage...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>naruko</b> [ Wed Apr 17, 2013 9:07 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: mapper19 と Namcot 129, 163, 175, 340</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />質問の回答ではないのですが、紹介したいことがあります。<br /><br />Namco の IC の調査はハードウェアの解析は私が行いましたが、外部 WorkRAM の write protect の調査は牧村さんが行いました。 彼は 163 のレジスタ全てを総当たりで書き込んで、 write protect がどこか調べるプログラムを自作しました。<br /><br />現在はテストプログラムは削除されていますが、彼の調査が非常に大きな事でした。<br /><br />解析していた当時の彼の twitter の発言の URL を貼っておきます。<br /><!-- m --><a class="postlink" href="http://twilog.org/makimura_mfg/month-1104">http://twilog.org/makimura_mfg/month-1104</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Wed Apr 17, 2013 12:43 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: mapper19 と Namcot 129, 163, 175, 340</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">etabeta wrote:</div><div class="quotecontent">a small question, to be sure I'm not starting from wrong assumptions about 163 CHR banks usage (it happens often to me, but usually I find test cases which prove me wrong, while here there seems to be no usage of this feature, so I prefer to ask): the documented behavior is that when these accesses occur the NES CIRAM is used as VRAM (i.e. PPU $0-$1fff) instead of being used as NT (i.e. PPU $2000-$2fff), right? because some (old) docs talk about CHR-RAM but no on-cart VRAM chips is present (based on bootgod descriptions)...</div> Yes, there's no separate CHR-RAM.<br /><br />The VRAM can be mapped to both nametables and pattern tables at the same time—it just has the ability to map any of the bottom 256KiB of CHRROM or the 2KiB RAM on the mainboard into any of the twelve bottommost 1KiB slices of the PPU's address space. (Modulo the bit about ROM nametables can only only come from the bottom 224KiB of CHRROM) But I agree that it seems likely the games either use 1 screen mirroring and use the other KiB like TQROM, or maybe use ROM nametables. <br /><br />For what it's worth, I think I found some ROM nametables in Battle Fleet (about half of the last 32KiB of the 128KiB CHRROM), and the last 6KiB of Megami Tensei 2's 256KiB CHR looks like non-tile data—so maybe this is a game to investigate for using RAM-as-pattern table?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Apr 17, 2013 1:36 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: mapper19 と Namcot 129, 163, 175, 340</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I see one good reason to use the TQROM configuration in a video game made only for Japan.<br /><br />(Google)<br />私はビデオゲームでTQROM構成を使用するには、一つの良い理由は、日本のためにのみ作られたを参照してください。<br /><br /><span style="font-size: 150%; line-height: normal">漢字</span>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>naruko</b> [ Fri Apr 19, 2013 5:50 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: mapper19 と Namcot 129, 163, 175, 340</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />TQROM はカートリッジに Chracter RAM と Charcter ROM が併存していて PPU address 0x0000-0x1fff に配置できるみたいですね。<br />163 の場合は Charcter RAM として使う場合は本体の VRAM を 0x0000-0x1fff に配置できる配線ではあることは確認してます。カートリッジの中にキャラクタRAMはありませんし、PPU /WR の線が未使用です。<br /><br />女神転生II (DDS2) の Program ROM の中に Charcter data が入っていると牧村さんが言及していたので、Charcter RAM 機能は実在する可能性はあるんですよね....

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>