<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - Audio psuedo-code</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - NESemdev" href="http://forums.nesdev.com/feed.php?f=3" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Audio psuedo-code" href="http://forums.nesdev.com/feed.php?f=3&amp;t=13767" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '1');
	var per_page = '15';
	var base_url = './viewtopic.php?f=3&amp;t=13767';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



	/**
	* Play quicktime file by determining it's width/height
	* from the displayed rectangle area
	*
	* Only defined if there is a file block present.
	*/
	function play_qt_file(obj)
	{
		var rectangle = obj.GetRectangle();

		if (rectangle)
		{
			rectangle = rectangle.split(',')
			var x1 = parseInt(rectangle[0]);
			var x2 = parseInt(rectangle[2]);
			var y1 = parseInt(rectangle[1]);
			var y2 = parseInt(rectangle[3]);

			var width = (x1 < 0) ? (x1 * -1) + x2 : x2 - x1;
			var height = (y1 < 0) ? (y1 * -1) + y2 : y2 - y1;
		}
		else
		{
			var width = 200;
			var height = 0;
		}

		obj.width = width;
		obj.height = height + 16;

		obj.SetControllerVisible(true);

		obj.Play();
	}


// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<!--<div style="float: right;">
					<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick">
					<input type="hidden" name="hosted_button_id" value="X2HM4WNR5YT8S">
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
					<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
					</form>
				</div>-->
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=minion"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Fri Aug 17, 2018 1:41 am<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=3">NESemdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />
	

					<center>
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- NesDev Forums -->
					<ins class="adsbygoogle"
						 style="display:block"
						 data-ad-client="ca-pub-7801010229099644"
						 data-ad-slot="7979066809"
						 data-ad-format="auto"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>
					</center>
	<br />


<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=3&amp;t=13767">Audio psuedo-code</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=3"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=3&amp;t=13767"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>3</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 44 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=3&amp;t=13767&amp;start=15">2</a><span class="page-sep">, </span><a href="./viewtopic.php?f=3&amp;t=13767&amp;start=30">3</a> &nbsp;<a href="./viewtopic.php?f=3&amp;t=13767&amp;start=15">Next</a></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=3&amp;t=13767&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=3&amp;t=13767&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=3&amp;t=13767&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p163071"></a>
				<b class="postauthor">oRBIT2002</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163071">Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163071#p163071"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Jan 22, 2016 4:54 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=353.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Mar 19, 2006 3:06 am<br /><b>Posts:</b> 584<br /><b>Location:</b> Gothenburg/Sweden
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">A few people might have seen my other thread about struggling with generating some NES-audio. I'm trying to cleanup this mess and thought about trying to generate some psuedo-code to hopefully make things more clear. I'm not sure this is a good idea or not, we'll see. I don't understand all of the documentation that's available but I'm hoping some talented people (I know there are many around here) perhaps wants to help out? <br />Feel free to make comments about adjustements and I'll update this post. Or if you have a better idea, feel free to let me know. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />Currently I'm focusing on understanding the squarewave channel 0 (below) but it's obviously not complete at the moment.<br /><br />EDIT: Ignore this psuedo-code below, check the posts from Disch instead. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">$4000:<br />&nbsp; &nbsp;Set DutyType to (bit 6-7)<br /><br />&nbsp; &nbsp;if bit 5 = 1 (?????)<br />&nbsp; &nbsp;&nbsp; &nbsp;if VolumeMode=Decay<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if bit 4 = 1<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;DecayLooping=true, restart at 0x0F;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;DecayLooping=false, stay at 0<br />&nbsp; &nbsp;&nbsp; &nbsp;LenghtCounterClock = Disabled<br /><br />&nbsp; &nbsp;if bit 4 = 0<br />&nbsp; &nbsp;&nbsp; &nbsp;VolumeMode=Decay<br />&nbsp; &nbsp;&nbsp; &nbsp;Set Volume to 0x0F<br />&nbsp; &nbsp;&nbsp; &nbsp;Set EnvelopeReloadValue to (bit 3-0)<br />&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;VolumeMode=Fixed<br />&nbsp; &nbsp;&nbsp; &nbsp;Set volume to (bit 3-0)<br /><br /><br />$4001: SWEEP<br />&nbsp; &nbsp;<br /><br />$4002<br />&nbsp; &nbsp;WaveLength (lowest 8 bits) = value<br /><br />$4003<br />&nbsp; &nbsp;WaveLength (upper 3 bits) = bit 2-0<br />&nbsp; &nbsp;CurrentWaveLength=WaveLength<br /><br />&nbsp; &nbsp;LengtCounter=Bit 7-3 (5 bits)<br />&nbsp; &nbsp;LenghtCounter=DurationTable&#91;LengthCounter&#93;<br />&nbsp; &nbsp;LenghtCounterClock = enabled (if LengthCounter&gt;0)<br /><br /><br />$Vertical blank:<br />if LengthCounterClock is enabled<br />&nbsp; &nbsp;LengthCounter--<br />&nbsp; &nbsp;if LenghtCounter==0<br />&nbsp; &nbsp;&nbsp; &nbsp;SilenceChannel()<br /><br /><br /></div></div>

					
						<div class="postbody"><br />_________________<br /><!-- m --><a class="postlink" href="http://nes.goondocks.se/">http://nes.goondocks.se/</a><!-- m --></div>
					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=353">oRBIT2002</a> on Fri Jan 22, 2016 1:19 pm, edited 1 time in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=353"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p163098"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163098">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163098#p163098"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Jan 22, 2016 9:56 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">1)  Nothing happens during VBlank.  VBlank is tied to the PPU and is in no way related to the APU.  The APU is driven entirely by CPU/APU clocks.<br /><br />2) Things like the sweep/decay/length units are clocked by the <em>frame counter</em>, but don't let the &quot;frame&quot; in the name fool you, it has nothing to do with an actual frame.  it's just another clock divider.<br /><br />3) The length counter will never* be 0 after a write to $4003 because every entry in the duration table is &gt; 0.  Whether or not the length counter is enabled depends on $4000.5    (* unless the channel is disabled via $4015, in which case the length counter is always 0 until the channel is re-enabled)<br /><br /><br />I'll whip up some pseudo-code for you and post it.  Give me a few mins</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p163102"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163102">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163102#p163102"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Jan 22, 2016 10:50 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">In doing this pseudo-code writeup... I realized just how much of a mess the wiki is for APU details.  Some pages have only brief descriptions and link to other places for further details, some places leave out entire registers, etc.  I had to flip through like 5 different pages just to get all the information here.  This could really stand to be cleaned up.<br /><br /><br />I'm throwing in EVERYTHING you need to make a 100% functional pulse wave.  Note that sweep/length/decay can probably be omitted if you just want to generate basic tones, and it should be fine to play music in most games (though sound effects will likely screw up).<br /><br />There might be screwey edge-case conditions not accounted for here that you might need to pass hypertechnical test ROMs, but I'll assume you don't care about that.<br /><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">========================================================<br /><br />$4000 write:<br />&nbsp; &nbsp; duty_table =&nbsp; &nbsp; &nbsp; &nbsp; dutytables&#91; v.76 &#93;<br />&nbsp; &nbsp; decay_loop =&nbsp; &nbsp; &nbsp; &nbsp; v.5<br />&nbsp; &nbsp; length_enabled =&nbsp; &nbsp; !v.5<br />&nbsp; &nbsp; decay_enabled =&nbsp; &nbsp; &nbsp;!v.4<br />&nbsp; &nbsp; decay_V =&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v.3210<br />&nbsp; &nbsp; <br />========================================================<br />&nbsp; &nbsp; <br />$4001 write:<br />&nbsp; &nbsp; sweep_timer =&nbsp; &nbsp; &nbsp; &nbsp;v.654<br />&nbsp; &nbsp; sweep_negate =&nbsp; &nbsp; &nbsp; v.3<br />&nbsp; &nbsp; sweep_shift =&nbsp; &nbsp; &nbsp; &nbsp;v.210<br />&nbsp; &nbsp; sweep_reload =&nbsp; &nbsp; &nbsp; true<br />&nbsp; &nbsp; sweep_enabled =&nbsp; &nbsp; &nbsp;v.7&nbsp; &amp;&amp;&nbsp; sweep_shift != 0<br />&nbsp; &nbsp; <br />========================================================<br />&nbsp; &nbsp; <br />$4002 write:<br />&nbsp; &nbsp; freq_timer =&nbsp; &nbsp; &nbsp; &nbsp; v&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(low 8 bits)<br />&nbsp; &nbsp; <br />========================================================<br />&nbsp; &nbsp; <br />$4003 write:<br />&nbsp; &nbsp; freq_timer =&nbsp; &nbsp; &nbsp; &nbsp; v.210&nbsp; &nbsp; &nbsp; &nbsp;(high 3 bits)<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( channel_enabled )<br />&nbsp; &nbsp; &nbsp; &nbsp; length_counter =&nbsp; &nbsp; lengthtable&#91; v.76543 &#93;<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; ; phase is also reset here&nbsp; (important for games like SMB)<br />&nbsp; &nbsp; freq_counter =&nbsp; &nbsp; &nbsp; freq_timer<br />&nbsp; &nbsp; duty_counter =&nbsp; &nbsp; &nbsp; 0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ; decay is also flagged for reset here<br />&nbsp; &nbsp; decay_reset_flag =&nbsp; true<br />&nbsp; &nbsp; <br />========================================================<br />&nbsp; &nbsp; <br />$4015 write:<br />&nbsp; &nbsp; channel_enabled =&nbsp; &nbsp;v.0<br />&nbsp; &nbsp; if( !channel_enabled )<br />&nbsp; &nbsp; &nbsp; &nbsp; length_counter = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; ; ... other channels and DMC here ...<br />&nbsp; &nbsp; <br />========================================================<br />&nbsp; &nbsp; <br />$4017 write:<br />&nbsp; &nbsp; sequencer_mode =&nbsp; &nbsp; v.7&nbsp; &nbsp; &nbsp;; switch between 5-step (1) and 4-step (0) mode<br />&nbsp; &nbsp; irq_enabled =&nbsp; &nbsp; &nbsp; &nbsp;!v.6<br />&nbsp; &nbsp; next_seq_phase =&nbsp; &nbsp; 0<br />&nbsp; &nbsp; sequencer_counter = ClocksToNextSequence()&nbsp; ; see: http://wiki.nesdev.com/w/index.php/APU_Frame_Counter<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; for example, this will be 3728.5 APU cycles, or 7457 CPU cycles.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; It might be easier to work in CPU cycles so you don't have to deal with<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;&nbsp; half cycles.<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if(sequencer_mode)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; Clock_QuarterFrame()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; see below<br />&nbsp; &nbsp; &nbsp; &nbsp; Clock_HalfFrame()<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; if(!irq_enabled)<br />&nbsp; &nbsp; &nbsp; &nbsp; irq_pending = false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; acknowledge Frame IRQ<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />========================================================<br /><br />$4015 read:<br />&nbsp; &nbsp; output = 0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( length_counter != 0 )&nbsp; &nbsp; &nbsp; &nbsp;output |= 0x01<br />&nbsp; &nbsp; ; ... other channels length counters here<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( irq_pending )<br />&nbsp; &nbsp; &nbsp; &nbsp; output |= 0x40<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ; ... DMC IRQ state read back here<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; irq_pending = false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; IRQ acknowledged on $4015 read<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; return output<br />&nbsp; &nbsp; <br /><br />========================================================<br /><br />Every APU Cycle:<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ; clock pulse wave<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( freq_counter &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; --freq_counter<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; freq_counter = freq_timer<br />&nbsp; &nbsp; &nbsp; &nbsp; duty_counter = (duty_counter + 1) &amp; 7<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ; ... clock other channels here<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ; clock frame sequencer<br />&nbsp; &nbsp; if( sequencer_counter &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; --sequencer_counter<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; ; see http://wiki.nesdev.com/w/index.php/APU_Frame_Counter for more details on here<br />&nbsp; &nbsp; &nbsp; &nbsp; ;&nbsp; I'm just giving the basic idea here to conceptualize it<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; if( next_seq_phase causes a Quarter Frame Clock )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Clock_QuarterFrame();<br />&nbsp; &nbsp; &nbsp; &nbsp; if( next_seq_phase causes a Half Frame Clock )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Clock_HalfFrame();<br />&nbsp; &nbsp; &nbsp; &nbsp; if( irq_enabled &amp;&amp; next_seq_phase causes an IRQ )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; irq_pending = true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; raise IRQ<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; ++next_seq_phase<br />&nbsp; &nbsp; &nbsp; &nbsp; if( next_seq_phase &gt; max phases for this mode )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next_seq_phase = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; sequencer_counter = ClocksToNextSequence()<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ; determine audio output<br />&nbsp; &nbsp; if(&nbsp; &nbsp; duty_table&#91; duty_counter &#93;&nbsp; &nbsp;; current duty phase is high<br />&nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; length_counter != 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; length counter is nonzero (channel active)<br />&nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; !IsSweepForcingSilence()&nbsp; &nbsp; &nbsp;; sweep unit is not forcing channel to be silent<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; ; output current volume<br />&nbsp; &nbsp; &nbsp; &nbsp; if(decay_enabled)&nbsp; &nbsp; &nbsp; &nbsp;output = decay_hidden_vol<br />&nbsp; &nbsp; &nbsp; &nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output = decay_V<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; low duty, or channel is silent<br />&nbsp; &nbsp; &nbsp; &nbsp; output = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; ; ... mix other channels with output here<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />========================================================<br /><br />Clock_QuarterFrame:<br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ; quarter frame clocks Decay<br />&nbsp; &nbsp; if( decay_reset_flag )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; decay_reset_flag =&nbsp; false<br />&nbsp; &nbsp; &nbsp; &nbsp; decay_hidden_vol =&nbsp; 0xF<br />&nbsp; &nbsp; &nbsp; &nbsp; decay_counter =&nbsp; &nbsp; &nbsp;decay_V<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; if( decay_counter &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --decay_counter<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; decay_counter = decay_V<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( decay_hidden_vol &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --decay_hidden_vol<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if( decay_loop )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; decay_hidden_vol = 0xF<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />========================================================<br /><br />Clock_HalfFrame:<br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ; half frame clocks Sweep<br />&nbsp; &nbsp; if( sweep_reload )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; sweep_counter = sweep_timer<br />&nbsp; &nbsp; &nbsp; &nbsp; ; note there's an edge case here -- see http://wiki.nesdev.com/w/index.php/APU_Sweep<br />&nbsp; &nbsp; &nbsp; &nbsp; ;&nbsp; &nbsp;for details.&nbsp; You can probably ignore it for now<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; sweep_reload = false<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else if( sweep_counter &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; --sweep_counter<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; sweep_counter = sweep_timer<br />&nbsp; &nbsp; &nbsp; &nbsp; if( sweep_enabled &amp;&amp; !IsSweepForcingSilence() )<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(sweep_negate)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; freq_timer -= (freq_timer &gt;&gt; sweep_shift) + 1&nbsp; &nbsp;; note: +1 for Pulse1 only.&nbsp; Pulse2 has no +1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; freq_timer += (freq_timer &gt;&gt; sweep_shift)<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ; half frame also clocks length<br />&nbsp; &nbsp; if( length_enabled &amp;&amp; length_counter &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; --length_counter<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; <br />========================================================&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />IsSweepForcingSilence:<br /><br />&nbsp; &nbsp; if( freq_timer &lt; 8 )<br />&nbsp; &nbsp; &nbsp; &nbsp; return true<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; else if(&nbsp; &nbsp; !sweep_negate<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; freq_timer + (freq_timer &gt;&gt; sweep_shift) &gt;= 0x800&nbsp; &nbsp; )<br />&nbsp; &nbsp; &nbsp; &nbsp; return true<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; return false<br />&nbsp; &nbsp; &nbsp; &nbsp; <br /></div></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p163108"></a>
				<b class="postauthor">oRBIT2002</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163108">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163108#p163108"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Jan 22, 2016 1:17 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=353.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Mar 19, 2006 3:06 am<br /><b>Posts:</b> 584<br /><b>Location:</b> Gothenburg/Sweden
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Huge thanks once again Disch for your help! Great work!<br />And I'm glad I am not the only one that gets confused by the wiki. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Here's a sample-wave where I've implemented the &quot;psuedo-code&quot; in my little work-in-progress emulator (square wave 0 only, for &quot;Mario Bros.&quot;).  I'm doing this &quot;get every 40:th byte-way&quot; you described in our other thread..<br />I think it sounds a bit &quot;high pitched&quot; or something.. FCEUX' sounds a bit &quot;softer&quot; (but perhaps that has something to do with resampling), but of course, I might have bugs aswell. <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" /></div>

					
						<br clear="all" /><br />

						<table class="tablebg" width="100%" cellspacing="1">
						<tr>
							<td class="row3"><b class="genmed">Attachments: </b></td>
						</tr>
						
							<tr>
								<td class="row2">
			<span class="gensmall"><b>File comment:</b> Squarewave 0 from titlescreen, Mario Bros</span><br />
		
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=4966">MarioBros_sq1.zip</a> [9.03 KiB]
			</span><br />
			<span class="gensmall">Downloaded 90 times</span>
		

		<br />
	</td>
							</tr>
						
						</table>
					
						<div class="postbody"><br />_________________<br /><!-- m --><a class="postlink" href="http://nes.goondocks.se/">http://nes.goondocks.se/</a><!-- m --></div>
					

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=353"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p163109"></a>
				<b class="postauthor">Zepper</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163109">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163109#p163109"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Jan 22, 2016 1:20 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Formerly Fx3</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=39_1487294131.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Nov 12, 2004 4:59 pm<br /><b>Posts:</b> 3139<br /><b>Location:</b> Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">@Disch<br />Where did you take such notation &quot;v.3210&quot; instead of &quot;v &amp; 0x0F&quot; (or v &amp; 15)??? Never seen such notation. <img src="./images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" />  <img src="./images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=39"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p163114"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163114">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163114#p163114"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Jan 22, 2016 1:47 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">@ oRBIT2002:<br /><br />Yeah it sounds like you're playing an octave too high, which means you are clocking twice as fast as you should be.  It's weird because there are 2 CPU cycles to every 1 APU cycle.... so the channels* clock at half the CPU rate.<br /><br />So you can either divide the CPU cycles by 2 before clocking your APU... or you can effectively double the width of the wave by having a 16-step duty instead of an 8-step.  Note that doing the latter will result in slight inaccuracies and might cause you to fail some test ROMs, but it would mostly work.<br /><br /><br />* Also note that not ALL the APU channels clock at 0.5 the CPU rate (the triangle clocks at the CPU rate... and the frame sequencer seems to operate on half cycles, implying that it's really using the CPU clock and not the APU clock), so I really question whether or not using APU cycles is the best way to go about this.  This is kind of a mess and I don't really have a good answer for the best way to approach this problem yet.<br /><br /><br />Side note:  That 'tinny' or 'buzzing' effect that you hear is due to the nearest-neighbor approach to downsampling.  When you employ a better downsampling method, that will go away.  But for now don't worry about it  <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" /><br /><br /><br />@ Zepper:<br /><br />It's pseudocode.  I made it up  <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" /></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p163116"></a>
				<b class="postauthor">oRBIT2002</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163116">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163116#p163116"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Jan 22, 2016 1:59 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=353.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Mar 19, 2006 3:06 am<br /><b>Posts:</b> 584<br /><b>Location:</b> Gothenburg/Sweden
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Ah, I did the APU-clocking once for every CPU-clock. I fixed that (runs once every 2:th CPU-clock now) but now the audio plays twice as fast (at 44.1Khz) so I'm probably doing something else wrong aswell.</div>

					
						<div class="postbody"><br />_________________<br /><!-- m --><a class="postlink" href="http://nes.goondocks.se/">http://nes.goondocks.se/</a><!-- m --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=353"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p163118"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163118">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163118#p163118"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Jan 22, 2016 2:05 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">If you halved the APU clock rate but are still outputting one sample every ~40 APU cycles, you have effectively cut the sample rate in half.<br /><br />You'll want to output 1 sample every ~20 APU cycles now (which is ~40 CPU cycles)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p163119"></a>
				<b class="postauthor">oRBIT2002</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163119">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163119#p163119"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Jan 22, 2016 2:18 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=353.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Mar 19, 2006 3:06 am<br /><b>Posts:</b> 584<br /><b>Location:</b> Gothenburg/Sweden
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Of course. Genius.. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /> Thanks!</div>

					
						<div class="postbody"><br />_________________<br /><!-- m --><a class="postlink" href="http://nes.goondocks.se/">http://nes.goondocks.se/</a><!-- m --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=353"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p163152"></a>
				<b class="postauthor">oRBIT2002</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163152">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163152#p163152"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Jan 23, 2016 6:39 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=353.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Mar 19, 2006 3:06 am<br /><b>Posts:</b> 584<br /><b>Location:</b> Gothenburg/Sweden
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I think your psuedocode would fit into the wiki! <br />Are you interested in doing this for the other channels aswell? Let me know if you need a bribe. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />Would be a great addition for everyone that finds the documentation confusing (well, parts of it anyway).</div>

					
						<div class="postbody"><br />_________________<br /><!-- m --><a class="postlink" href="http://nes.goondocks.se/">http://nes.goondocks.se/</a><!-- m --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=353"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p163155"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163155">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163155#p163155"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Jan 23, 2016 11:28 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Pulse 2:  Identical to Pulse 1 with the following changes:<br /><br />- use $4004-4007 instead of $4000-4003<br />- $4015 reads/writes use bit 1 instead of bit 0<br />- no '+ 1' when doing sweep negate<br /><br /><br /><br /><br />Triangle:<br />A few things to note about the triangle:<br /><br />- It's clocked at twice the rate of other channels (use CPU clock instead of APU clock)<br />- To silence it, you stop clocking the tri-step unit, but do not change its output.  This is in contrast to other channels where you silence them by forcing output to zero.<br />- There is no volume control, but Tri might appear quieter sometimes due to interference from the DMC.  See <!-- m --><a class="postlink" href="http://wiki.nesdev.com/w/index.php/APU_Mixer">http://wiki.nesdev.com/w/index.php/APU_Mixer</a><!-- m --> for details<br />- When the freq timer is &lt; 2, it goes &quot;ultrasonic&quot; and is effectively silenced by forcing output to &quot;7.5&quot; (this causes a pop).<br /><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">$4015 read / write:&nbsp; Same as Pulse1, only use bit 2 instead of bit 0<br />&nbsp; &nbsp; &nbsp; &nbsp; Note 4015 touches length counter only, it does not do anything with linear counter<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />========================================================<br /><br />$4008 write:<br />&nbsp; &nbsp; linear_control = v.7<br />&nbsp; &nbsp; length_enabled = !v.7<br />&nbsp; &nbsp; linear_load = v.6543210<br />&nbsp; &nbsp; <br />========================================================<br /><br />$400A write:<br />&nbsp; &nbsp; freq_timer = v&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (low 8 bits)<br />&nbsp; &nbsp; <br />========================================================<br /><br />$400B write:<br />&nbsp; &nbsp; freq_timer = v.210&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (high 3 bits)<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( channel_enabled )<br />&nbsp; &nbsp; &nbsp; &nbsp; length_counter = lengthtable&#91; v.76543 &#93;<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; linear_reload = true<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />========================================================<br /><br />Every **CPU** Cycle:<br />&nbsp; &nbsp; ; Note the Triangle is clocked at twice the rate of other channels!<br />&nbsp; &nbsp; ; It is clocked by CPU cycle and not by APU cycle!<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ;; clock tri wave<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ultrasonic = false<br />&nbsp; &nbsp; if( freq_timer &lt; 2 &amp;&amp; freq_counter == 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; ultrasonic = true<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; clock_triunit = true<br />&nbsp; &nbsp; if( length_counter == 0 )&nbsp; &nbsp; &nbsp; &nbsp;clock_triunit = false<br />&nbsp; &nbsp; if( linear_counter == 0 )&nbsp; &nbsp; &nbsp; &nbsp;clock_triunit = false<br />&nbsp; &nbsp; if( ultrasonic )&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; clock_triunit = false<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( clock_triunit )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; if( freq_counter &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --freq_counter<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; freq_counter = freq_timer<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tri_step = (tri_step + 1) &amp; 0x1F&nbsp; &nbsp; ; tri-step bound to 00..1F range<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ;; determine audio output<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ; the xor here creates the 'triangle' shape<br />&nbsp; &nbsp; if( ultrasonic )&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output = 7.5<br />&nbsp; &nbsp; else if( tri_step &amp; 0x10 )&nbsp; &nbsp; &nbsp; output = tri_step ^ 0x1F<br />&nbsp; &nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output = tri_step<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />========================================================<br /><br />Clock_QuarterFrame:<br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ; quarter frame clocks Linear<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( linear_reload )<br />&nbsp; &nbsp; &nbsp; &nbsp; linear_counter = linear_load<br />&nbsp; &nbsp; else if( linear_counter &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; --linear_counter<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; if( !linear_control )<br />&nbsp; &nbsp; &nbsp; &nbsp; linear_reload = false<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />========================================================<br /><br />Clock_HalfFrame:<br /><br />&nbsp; &nbsp; ; clock Length counter, same as Pulse<br /></div></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p163157"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163157">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163157#p163157"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Jan 23, 2016 11:43 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Noise:<br /><br />Notes:<br />- noise_shift must never be zero or the noise channel will never produce any output.  Initialize it with 1 at bootup / hard reset.<br />- with below implementation, noise_shift must not be signed-16 bit (unsigned is OK, or something larget than 16 bit is OK).  If signed, the right-shift will feed in unwanted 1s.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">$4015 read / write:&nbsp; Same as Pulse1, only use bit 3 instead of bit 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />========================================================<br /><br />$400C write:<br />&nbsp; &nbsp; ; same as $4000, only ignore bits 6 and 7 because noise has no duty<br />&nbsp; &nbsp; <br />========================================================<br /><br />$400E write:<br />&nbsp; &nbsp; freq_timer = noise_freq_table&#91; v.3210 &#93;&nbsp; ; see http://wiki.nesdev.com/w/index.php/APU_Noise for freq table<br />&nbsp; &nbsp; shift_mode = v.7<br />&nbsp; &nbsp; <br />========================================================<br /><br />$400F write:<br />&nbsp; &nbsp; if( channel_enabled )<br />&nbsp; &nbsp; &nbsp; &nbsp; length_counter = lengthtable&#91; v.76543 &#93;<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; decay_reset_flag = true<br />&nbsp; &nbsp; <br />========================================================<br /><br />Every APU Cycle:<br /><br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ; clock noise shift<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( freq_counter &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; --freq_counter<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; freq_counter = freq_timer<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; note, set bit fifteen here, not bits 1 and 5<br />&nbsp; &nbsp; &nbsp; &nbsp; if( shift_mode )&nbsp; &nbsp; noise_shift.15 = noise_shift.6 ^ noise_shift.0<br />&nbsp; &nbsp; &nbsp; &nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; noise_shift.15 = noise_shift.1 ^ noise_shift.0<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; noise_shift &gt;&gt;= 1<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ; determine audio output<br />&nbsp; &nbsp; if(&nbsp; &nbsp; noise_shift.0 == 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; current noise output is low (output vol when low -- opposite of pulse)<br />&nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; length_counter != 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; length counter is nonzero (channel active)<br />&nbsp; &nbsp; &nbsp; &nbsp; )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; ; output current volume<br />&nbsp; &nbsp; &nbsp; &nbsp; if(decay_enabled)&nbsp; &nbsp; &nbsp; &nbsp;output = decay_hidden_vol<br />&nbsp; &nbsp; &nbsp; &nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output = decay_V<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; high shift output, or channel is silent<br />&nbsp; &nbsp; &nbsp; &nbsp; output = 0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />========================================================<br /><br />Clock_QuarterFrame:<br />&nbsp; &nbsp; ; clock Decay, same as Pulse<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />========================================================<br /><br />Clock_HalfFrame:<br />&nbsp; &nbsp; ; clock Length counter, same as Pulse<br />&nbsp; &nbsp; <br /></div><br /><br /><br /><br />I might do the DMC later</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p163160"></a>
				<b class="postauthor">oRBIT2002</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163160">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163160#p163160"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Jan 23, 2016 2:02 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=353.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Mar 19, 2006 3:06 am<br /><b>Posts:</b> 584<br /><b>Location:</b> Gothenburg/Sweden
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Awesome, thanks again! <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Is volume of the Noise-channel working the same way as the square/trianglewaves? In case I haven't missed any obvious bugs, my output seems very loud compared to FCEUX..<br />Or if it's always starting at volume 0x0F for some reason...</div>

					
						<div class="postbody"><br />_________________<br /><!-- m --><a class="postlink" href="http://nes.goondocks.se/">http://nes.goondocks.se/</a><!-- m --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=353"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p163162"></a>
				<b class="postauthor" style="color: #FF3300">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163162">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163162#p163162"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Jan 23, 2016 2:10 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 20409<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Noise period values 0-2 will sound louder with point sampling than with proper low-pass filtering. And noise itself might be mixed quieter.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p163187"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p163187">Re: Audio psuedo-code</a></div><div style="float: right;"><a href="./viewtopic.php?p=163187#p163187"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jan 24, 2016 4:14 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">DMC boy-eeeeee<br /><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">$4010 write:<br />&nbsp; &nbsp; dmcirq_enabled =&nbsp; &nbsp; v.7<br />&nbsp; &nbsp; dmc_loop =&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v.6<br />&nbsp; &nbsp; freq_timer =&nbsp; &nbsp; &nbsp; &nbsp; dmc_freq_table&#91; v.3210 &#93;&nbsp; &nbsp;; see http://wiki.nesdev.com/w/index.php/APU_DMC for freq table<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( !dmcirq_enabled )<br />&nbsp; &nbsp; &nbsp; &nbsp; dmcirq_pending = false&nbsp; ; acknowledge IRQ if disabled<br />&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; <br />========================================================<br /><br />$4011 write:<br />&nbsp; &nbsp; output = v.6543210&nbsp; &nbsp; ; note there is some edge case weirdness here, see wiki for details<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />========================================================<br />&nbsp; &nbsp; <br />$4012 write:<br />&nbsp; &nbsp; addrload = $C000 | v&lt;&lt;6<br /><br />========================================================<br />&nbsp; &nbsp; <br />$4013 write:<br />&nbsp; &nbsp; lengthload = v&lt;&lt;4 + 1<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />========================================================<br /><br />$4015 write:<br />&nbsp; &nbsp; if( v.4 )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; if( length == 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; length = lengthload<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; addr = addrload<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; length = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; dmcirq_pending = false&nbsp; &nbsp; &nbsp; ; acknowledge DMC IRQ on write<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />========================================================<br /><br />$4015 read:<br />&nbsp; &nbsp; v.4 = (length &gt; 0)<br />&nbsp; &nbsp; v.7 = dmcirq_pending<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ; ... other channels and frame IRQ set other bits<br /><br />&nbsp; &nbsp; <br />========================================================<br /><br />Every ?CPU? cycle????<br />( not sure if DMC runs on APU cycles or CPU cycles.&nbsp; It doesn't really matter because all the frequencies<br />are even.&nbsp; The wiki lists freqs in CPU cycles, so.... *shrug* )<br /><br /><br /><br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ;&nbsp; Clock DMC unit<br /><br />&nbsp; &nbsp; if( freq_counter &gt; 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; --freq_counter<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; freq_counter = freq_timer<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; if( !output_unit_silent )<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( (output_shift &amp; 1) &amp;&amp; output &lt; $7E )&nbsp; &nbsp; output += 2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!(output_shift &amp; 1) &amp;&amp; output &gt; $01 )&nbsp; &nbsp; output -= 2<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; --bits_in_output_unit<br />&nbsp; &nbsp; &nbsp; &nbsp; output_shift &gt;&gt;= 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; if( bits_in_output_unit == 0 )<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bits_in_output_unit = 8<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output_shift = sample_buffer<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output_unit_silent = is_sample_buffer_empty<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; is_sample_buffer_empty = true<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ;&nbsp; Perform DMA if necessary<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; if( length &gt; 0 &amp;&amp; is_sample_buffer_empty )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; sample_buffer = DMAReadFromCPU( addr )&nbsp; &nbsp;; note:&nbsp; this DMA halts the CPU for up to 4 cycles.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; See wiki for timing details.&nbsp; Note that all commercial games will work<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; fine if you ignore these stolen cycles, but some tech<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; demos and test ROMs will glitch/fail.&nbsp; So getting these stolen cycles<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; correct is not super important unless you're putting a lot of emphasis<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; on accuracy.<br />&nbsp; &nbsp; &nbsp; &nbsp; is_sample_buffer_empty = false<br />&nbsp; &nbsp; &nbsp; &nbsp; addr = (addr + 1) | $8000&nbsp; &nbsp; &nbsp;; &lt;- wrap $FFFF to $8000<br />&nbsp; &nbsp; &nbsp; &nbsp; --length<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; if(length == 0)<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( dmc_loop )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; length = lengthload<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; addr = addrload<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if( dmcirq_enabled )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dmcirq_pending = true&nbsp; &nbsp; &nbsp; &nbsp;; raise IRQ<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />&nbsp; &nbsp; ;; Determine channel output<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ; output is always 'output' ... the 7 bit value written to $4011 and modified by the DMC unit<br /></div></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=3&amp;t=13767"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=3"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=3&amp;t=13767"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>3</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 44 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=3&amp;t=13767&amp;start=15">2</a><span class="page-sep">, </span><a href="./viewtopic.php?f=3&amp;t=13767&amp;start=30">3</a> &nbsp;<a href="./viewtopic.php?f=3&amp;t=13767&amp;start=15">Next</a></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=3">NESemdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 5 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="13767" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3" selected="selected">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="34">&nbsp; &nbsp;&nbsp; &nbsp;2018 NESdev Competition</option>
		
			<option value="33">&nbsp; &nbsp;&nbsp; &nbsp;2017 NESdev Competition</option>
		
			<option value="32">&nbsp; &nbsp;&nbsp; &nbsp;2016 NESdev Competition</option>
		
			<option value="31">&nbsp; &nbsp;&nbsp; &nbsp;2014 NESdev Competition</option>
		
			<option value="30">&nbsp; &nbsp;&nbsp; &nbsp;2011 NESdev Competition</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;&nbsp; &nbsp;Reproduction</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="11">&nbsp; &nbsp;&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="12">&nbsp; &nbsp;&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;&nbsp; &nbsp;GBDev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>


<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>