<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=6&amp;t=4112" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2008-12-07T13:47:47-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=6&amp;t=4112</id>
<entry>
<author><name><![CDATA[kalzone]]></name></author>
<updated>2008-12-07T13:47:47-07:00</updated>
<published>2008-12-07T13:47:47-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=40560#p40560</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=40560#p40560"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=40560#p40560"><![CDATA[
This is going to sound like a weird request, but could anyone that downloaded that code archive I posted rehost it somewhere?<br /><br />In cleaning out my computer a few months ago, I accidentally erased it, and I want to make some minor modifications.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3530">kalzone</a> — Sun Dec 07, 2008 1:47 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[steve0]]></name></author>
<updated>2008-06-26T09:02:26-07:00</updated>
<published>2008-06-26T09:02:26-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=34466#p34466</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=34466#p34466"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=34466#p34466"><![CDATA[
Oh guys  ,awesome !I'll go download a rom patcher and try it out.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3560">steve0</a> — Thu Jun 26, 2008 9:02 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kalzone]]></name></author>
<updated>2008-05-25T15:30:36-07:00</updated>
<published>2008-05-25T15:30:36-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33658#p33658</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33658#p33658"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33658#p33658"><![CDATA[
<div class="quotetitle">Fx3 wrote:</div><div class="quotecontent"><br />- Interesting, and it's an old idea becoming reality thanks to an easy effort. <img src="http://forums.nesdev.com/images/smilies/icon_wink.gif" alt=";)" title="Wink" /> However, I have a few advices:<br /><br />1. You didn't include stages music tracks in the package. ^_^;;<br />2. As I said, you should apply the FE (or FF) to stop the music. Some game transitions become weird if you don't do this... but fine.<br />3. Think about creating an INI file to save custom tracks. The user could change the default music track by another file, it would be cool.<br />4. The next "natural" step would be gfx enhancement...<br /></div><br /><br />1. Well, under the circumstances, I really <em>couldn't</em>.  The intention from the beginning was to release this directly to The Megas and their fans...and I'm sure they wouldn't be too happy with me distributing pirated copies of the album.  Given that that was the target audience, though, there really wasn't a problem, because everyone would have their own legal copy.<br />2. I still can't think of any particular examples in game at all...if you were to try to apply these techniques to another game, that might be an issue, but in MM2, one ends when another starts.<br />3. Probably a good idea, as far as generalizing the code goes.<br />4. Gfx is a whole other ballpark, really, I'll let someone more experienced try to tackle something like that.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3530">kalzone</a> — Sun May 25, 2008 3:30 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2008-05-25T15:21:52-07:00</updated>
<published>2008-05-25T15:21:52-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33657#p33657</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33657#p33657"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33657#p33657"><![CDATA[
- Interesting, and it's an old idea becoming reality thanks to an easy effort. <img src="http://forums.nesdev.com/images/smilies/icon_wink.gif" alt=";)" title="Wink" /> However, I have a few advices:<br /><br />1. You didn't include stages music tracks in the package. ^_^;;<br />2. As I said, you should apply the FE (or FF) to stop the music. Some game transitions become weird if you don't do this... but fine.<br />3. Think about creating an INI file to save custom tracks. The user could change the default music track by another file, it would be cool.<br />4. The next "natural" step would be gfx enhancement...<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sun May 25, 2008 3:21 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kalzone]]></name></author>
<updated>2008-05-24T23:11:26-07:00</updated>
<published>2008-05-24T23:11:26-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33649#p33649</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33649#p33649"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33649#p33649"><![CDATA[
Oh, I was referring more to the "know if music is playing" part.  The major difficulty I had with this project was just figuring out when exactly to play to the music...if you've got that down, then most of your work is already finished.<br /><br />Anyway, because I hardly commented at all on the portions I edited, here's a few pointers:<br />-MP3play.h/MP3play.cpp is where all of the MP3 playback capabilities are<br />-The PlayFile function takes 4 arguments:<br />     File path/name (and make sure to start that with a '/')<br />     Whether the file loops or not (1 if it does, 0 if it doesn't)<br />     Sample to begin the loop (int)<br />     Sample to end the loop (int)<br />-The code that actually calls MP3play::PlayFile() is in Cpu.cpp<br />-This was briefly mentioned in a previous post, but the basic design is as follows:<br /><br />There are two distinct blocks of instructions that mark the playing of a new sound effect or song in MM2:<br /><br />LDA $XX ($XX = song/sfx identifier)<br />JSR $C051<br /><br />...and...<br /><br />LDA $XXXX, $XX ($XX = song/sfx identifier)<br />JSR $C051<br /><br />The implentations of all of these instructions are located in the CPU.cpp source file.  So, in MR_AX() and MR_IM(), which are called as part of the LDA opcodes (which one is called is dependent on whether the instruction is LDA $XXXX, $XX or LDA $XX), a BYTE variable named songCounter is set to whatever the current value of DT (the BYTE data being used with the instruction) is.<br /><br />Then, whenever JSR is called, EA (the WORD used in the instruction) is checked against $C051.  If EA==0xC051, then a switch statement just calls PlayFile according to the current value of songCounter.  With this implementation, theoretically all sound effects could be replaced as well.<br /><br />There is one exception, however.  Through testing, it became apparent that Heat Man's weapon sfx had the same "sound effect number" as the "stage selected" music, so firing his weapon just causes that music to play over and over.  The boolean value stageSelected was introduced to prevent this particular case.  By default, stageSelected is false.  When a call is made to play the "stage selection" music, it is assumed that the "stage selected" music will follow before Heat Man's weapon would be fired.  Therefore, stageSelected is set to true whenever the "stage selection" music plays, and reset to false afterward.<br /><br />So there you have it, a more thorough description of my modifications.  Hopefully that'll help a bit, as much of what I described is specific to MM2, and now you have a better idea of what needs tweaking and what can be outright removed when working with another game.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3530">kalzone</a> — Sat May 24, 2008 11:11 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Hamtaro126]]></name></author>
<updated>2008-05-24T22:42:32-07:00</updated>
<published>2008-05-24T22:42:32-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33647#p33647</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33647#p33647"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33647#p33647"><![CDATA[
<div class="quotetitle">kalzone wrote:</div><div class="quotecontent"><br />If you already know all that, I'm not sure my code will really be any help, but good luck either way.<br /></div><br /><br />I do not know how to make music, Just know how to delete music in SMB1.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=287">Hamtaro126</a> — Sat May 24, 2008 10:42 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kalzone]]></name></author>
<updated>2008-05-24T22:07:06-07:00</updated>
<published>2008-05-24T22:07:06-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33646#p33646</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33646#p33646"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33646#p33646"><![CDATA[
If you already know all that, I'm not sure my code will really be any help, but good luck either way.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3530">kalzone</a> — Sat May 24, 2008 10:07 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Hamtaro126]]></name></author>
<updated>2008-05-24T22:04:57-07:00</updated>
<published>2008-05-24T22:04:57-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33645#p33645</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33645#p33645"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33645#p33645"><![CDATA[
<div class="quotetitle">Fx3 wrote:</div><div class="quotecontent"><br />Heh, under the condition YOU know how to handle Mario's music playback, okay? <img src="http://forums.nesdev.com/images/smilies/icon_wink.gif" alt=";)" title="Wink" /><br /></div><br /><br />Yea, I know how to delete mario's music data. But also know to see if the music is playing<br /><br />Kalzone: Thank you for distributing the code, I will give you credit for using it.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=287">Hamtaro126</a> — Sat May 24, 2008 10:04 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kalzone]]></name></author>
<updated>2008-05-24T21:04:20-07:00</updated>
<published>2008-05-24T21:04:20-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33642#p33642</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33642#p33642"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33642#p33642"><![CDATA[
Here it is: <!-- m --><a class="postlink" href="http://rapidshare.com/files/117415759/virtualnes.rar.html">http://rapidshare.com/files/117415759/v ... s.rar.html</a><!-- m --><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3530">kalzone</a> — Sat May 24, 2008 9:04 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kalzone]]></name></author>
<updated>2008-05-24T20:46:52-07:00</updated>
<published>2008-05-24T20:46:52-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33641#p33641</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33641#p33641"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33641#p33641"><![CDATA[
<em>My</em> code?   Whoa...let's take a step back here...the original emulator is under the GNU public license; you and everyone else here has full rights to the source...I just figured it was too sloppy for it to be particularly useful to anyone.  If there's actually a demand I'll go ahead and post the source.  I need to switch to my other computer but give me a few minutes and I'll have it up.  Fair warning: the sections I added are not commented at all.<br /><br />In the same vein though...if you use this code for your Mario hack, you're basically obligated to release the source.<br /><br />The thing is...my code is really designed to be generalized, for the most part.  The MP3 playing code is fully self-contained (and mostly ripped from Metal MAME, actually)...but the code that triggers it is based on a specific sequence of instructions in the MM2 code.  I'm not really sure how similar this sequence may be to that of other games, but I'm sure someone here could help.[/i]<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3530">kalzone</a> — Sat May 24, 2008 8:46 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2008-05-24T20:04:34-07:00</updated>
<published>2008-05-24T20:04:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33636#p33636</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33636#p33636"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33636#p33636"><![CDATA[
Heh, under the condition YOU know how to handle Mario's music playback, okay? <img src="http://forums.nesdev.com/images/smilies/icon_wink.gif" alt=";)" title="Wink" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sat May 24, 2008 8:04 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Hamtaro126]]></name></author>
<updated>2008-05-24T15:06:05-07:00</updated>
<published>2008-05-24T15:06:05-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33626#p33626</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33626#p33626"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33626#p33626"><![CDATA[
<div class="quotetitle">kalzone wrote:</div><div class="quotecontent"><br />There's no need to stop the music (except possibly when the emulator is paused, but I didn't bother to add that in)...every time the music is "stopped" it's only because something else is about to be played, so that handles itself.<br /><br />Anyway, for anyone who <em>does</em> want to give a try, you can download it <a href="http://rapidshare.com/files/115903911/VirtualNES_-_MM2Custom.rar" class="postlink">here</a>.  It's still on Rapidshare though, so be careful with that CAPTCHA, it's a doozy, apparently.  The rom and some of the MP3's aren't included for legal issues, though, so I'm not sure how much use you'll get out of it unless you find all that.<br /></div><br /><br />Can I please have permission to use a Windows (32bit EXE) Disassembler to privately use your code to make it handle the Mario Series, And only release it in EXEcutable form? Mario Hackers really need it too, I give credit for the permissive use of disassembled code<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=287">Hamtaro126</a> — Sat May 24, 2008 3:06 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[kalzone]]></name></author>
<updated>2008-05-23T20:52:10-07:00</updated>
<published>2008-05-23T20:52:10-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33612#p33612</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33612#p33612"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33612#p33612"><![CDATA[
There's no need to stop the music (except possibly when the emulator is paused, but I didn't bother to add that in)...every time the music is "stopped" it's only because something else is about to be played, so that handles itself.<br /><br />Anyway, for anyone who <em>does</em> want to give a try, you can download it <a href="http://rapidshare.com/files/115903911/VirtualNES_-_MM2Custom.rar" class="postlink">here</a>.  It's still on Rapidshare though, so be careful with that CAPTCHA, it's a doozy, apparently.  The rom and some of the MP3's aren't included for legal issues, though, so I'm not sure how much use you'll get out of it unless you find all that.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3530">kalzone</a> — Fri May 23, 2008 8:52 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2008-05-23T20:16:48-07:00</updated>
<published>2008-05-23T20:16:48-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33611#p33611</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33611#p33611"/>
<title type="html"><![CDATA[Modding an Emu to Play Custom Soundtrack for MM2, need help]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33611#p33611"><![CDATA[
- Did you take care about *stopping the music*? If mind is good, the code is FEh or FFh. ^_^;; Just wondering since you mentioned "things ready".<br /><br />- I can't wait to give a try. <img src="http://forums.nesdev.com/images/smilies/icon_wink.gif" alt=";)" title="Wink" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Fri May 23, 2008 8:16 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2008-05-18T18:39:57-07:00</updated>
<published>2008-05-18T18:39:57-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33489#p33489</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33489#p33489"/>
<title type="html"><![CDATA[Anything but Rapidshare!]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4112&amp;p=33489#p33489"><![CDATA[
<a href="http://www.tetrisconcept.com/forum/viewtopic.php?p=20663#20663" class="postlink">Lately, Rapidshare has been next to impossible to download from</a>. Either you have to solve what might be the hardest <a href="http://en.wikipedia.org/wiki/CAPTCHA" class="postlink">CAPTCHA</a> on the Internet, or you have to pay. The members of tetrisconcept.com appear to recommend Mediafire or Sendspace or Zshare.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Sun May 18, 2008 6:39 pm</p><hr />
]]></content>
</entry>
</feed>