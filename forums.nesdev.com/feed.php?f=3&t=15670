<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=15670" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2017-03-16T10:01:06-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=15670</id>
<entry>
<author><name><![CDATA[Alyosha_TAS]]></name></author>
<updated>2017-03-16T10:01:06-07:00</updated>
<published>2017-03-16T10:01:06-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=15670&amp;p=191289#p191289</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=15670&amp;p=191289#p191289"/>
<title type="html"><![CDATA[NES Power On Variance]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=15670&amp;p=191289#p191289"><![CDATA[
Some recent work with the read2004.nes test rom was done by True on TASVideos.org to see what real console results were like.<br /><br />While it generally worked as expected, in terms of the actual test of the $2004 reads, the initial number of 'FF' at the beginning was pretty variable (and in ways that I'm not understanding.)<br /><br />For those not familiar, this test by Quietust basically just waits for 4 VBlanks, does an NMI, and then runs the test. The initial 'FF's just indicate where the tests start, one per ppu tick per FF. So this test is an excellent way to characterize power on timing.<br /><br />The results varied from 0-12 FF. But, what I'm not understanding is that there were more then 8 values possible. Initially I thought that there should be 8 (4 clock alignments x Vblank)<br /><br />So I started looking at what exactly 6502 does when the rest line is low.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">cycle   ab   db   rw   Fetch   pc   a   x   y   s   p   Execute   State   res<br />0   0000   a2   1   LDX #   0000   aa   00   00   fd   nv‑BdIZc   BRK   T1   1<br />0   0000   a2   1   LDX #   0000   aa   00   00   fd   nv‑BdIZc   BRK   T1   1<br />1   0001   55   1      0001   aa   00   00   fd   nv‑BdIZc   LDX #   T0+T2   1<br />1   0001   55   1      0001   aa   00   00   fd   nv‑BdIZc   LDX #   T0+T2   1<br />2   0002   9a   1   TXS   0002   aa   55   00   fd   nv‑BdIzc   LDX #   T1   1<br />2   0002   9a   1   TXS   0002   aa   55   00   fd   nv‑BdIzc   LDX #   T1   1<br />3   0003   e8   1      0003   aa   55   00   fd   nv‑BdIzc   TXS   T0+T2   1<br />3   0003   e8   1      0003   aa   55   00   fd   nv‑BdIzc   TXS   T0+T2   1<br />4   0003   e8   1   INX   0003   aa   55   00   55   nv‑BdIzc   TXS   T1   1<br />4   0003   e8   1   INX   0003   aa   55   00   55   nv‑BdIzc   TXS   T1   1<br />5   0004   e8   1      0004   aa   55   00   55   nv‑BdIzc   INX   T0+T2   0<br />5   0004   e8   1      0004   aa   55   00   55   nv‑BdIzc   INX   T0+T2   0<br />6   0004   e8   1   INX   0004   aa   55   00   55   nv‑BdIzc   INX   T1   0<br />6   0004   e8   1   INX   0004   aa   55   00   55   nv‑bdIzc   INX   T1   0<br />7   0005   e8   1      0005   aa   56   00   55   nv‑bdIzc   BRK   T0   0<br />7   0005   e8   1      0005   aa   56   00   55   nv‑bdIzc   BRK   T0   0<br />8   e8ac   00   1      e8ac   aa   56   00   55   nv‑bdIzc   BRK   T0+T1   0<br />8   e8ac   00   1      e8ac   aa   56   00   55   nv‑bdIzc   BRK   T0+T1   0<br />9   00e7   00   1      00e7   aa   56   00   55   nv‑bdIzc   BRK   T0+T1   0<br />9   00e7   00   1      00e7   aa   56   00   55   nv‑bdIzc   BRK   T0+T1   0<br />10   00ff   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T0+T1   1<br />10   00ff   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T0+T1   1<br />11   00ff   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T0+T1   1<br />11   00ff   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T0+T1   1<br />12   00ff   00   1   BRK   00ff   aa   56   00   55   nv‑bdIzc   BRK   T1   1<br />12   00ff   00   1   BRK   00ff   aa   56   00   55   nv‑bdIzc   BRK   T1   1<br />13   00ff   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T2   1<br />13   00ff   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T2   1<br />14   0155   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T3   1<br />14   0155   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T3   1<br />15   0154   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T4   1<br />15   0154   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T4   1<br />16   0153   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T5   1<br />16   0153   00   1      00ff   aa   56   00   55   nv‑bdIzc   BRK   T5   1<br />17   fffc   00   1      00ff   aa   56   00   52   nv‑bdIzc   BRK      1<br />17   fffc   00   1      00ff   aa   56   00   52   nv‑bdIzc   BRK      1<br />18   fffd   00   1      00ff   aa   56   00   52   nv‑BdIzc   BRK   T0   1<br />18   fffd   00   1      00ff   aa   56   00   52   nv‑BdIzc   BRK   T0   1<br />19   0000   a2   1   LDX #   0000   aa   56   00   52   nv‑BdIzc   BRK   T1   1<br />19   0000   a2   1   LDX #   0000   aa   56   00   52   nv‑BdIzc   BRK   T1   1</div><br /><br />Basically it holds the current operation and waits to see a high RES line during phi2 (similar to other interrupt behaviour.)<br /><br />So, if reset happens to be released during phi1, there could be up to an entire CPU cycle of mismatch between when the CPU reacts and when the ppu reacts.<br /><br />I haven't found a way to investigate reset like this on Visual 2C02, is this possible? If it turns out that the ppu resets faster, it could add another variable to start up state. This is important in TAS since games don't tend to self sync to a single ppu tick like Blargg's test roms do!<br /><br />Does anyone have any thoughts or added information about this?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=7612">Alyosha_TAS</a> — Thu Mar 16, 2017 10:01 am</p><hr />
]]></content>
</entry>
</feed>