<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Question about bankswitched memory from a layman</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Question about bankswitched memory from a layman</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=10&amp;t=11035">http://forums.nesdev.com/viewtopic.php?f=10&amp;t=11035</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>SuperDerek</b> [ Fri Feb 21, 2014 10:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hey guys,<br /><br />I have to apologize because I have no idea if this question is really a newbie-level question. Rather, I'm posting here because I myself am very new to NES tech and dev.<br /><br />My name is SuperDerek, and I review videogames. I've been working on a video in defense of a somewhat notorious NES game. I've been trying to do my research well, but I seem to have run into a brick wall, and I think that if anybody can answer my questions, it's probably you guys.<br /><br />The game I'm going to be reviewing doesn't use bankswitched memory. Since it was one of only two games released on the NES that did <em>not </em>use that technique, you might already know to which game I am referring.<br /><br />Initially, I though that this meant that the game had to be much smaller than a normal NES title, to verify this I downloaded a ROM file of the game and compared it to Super Mario Bros for a little perspective. To my surprise the file sizes were actually the same. Am I missing something , or just wrong about what bankswitching actually does?<br /><br />The second question that I have is if there is a physical difference in the NES cartridges that used and didn't use bankswitching? I know that NES cartridges came in all kinds of different configurations, so I guess this question boils down to, looking at the circuit board, can you tell if a game uses bankswitching, and how? Or is this a purely software-based technique?<br /><br />The final question I have about bankswitching is if there is a reason that a NES game released well into the NES life cycle would choose not to use this technique? Is bankswitching costly? Or is this more likely related to the fact that this game is a port of an older PC-6001/8801 title, and that programming the game to utilize bankswitching would require substantial rewriting of the entire game's code?<br /><br />Thank you for your time, and any light you might be able to help shed on these questions for me.<br /><br />-Derek<br /><br /><em>Edit:<br />Looks like that bit about it being one of only 2 games that used bankswitching was completely wrong -- I misread an article which stated it was one of only 2 RPGs that used bankswitching. Big difference there, and I thank you guys for helping to clear that up! <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /></em>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>natt</b> [ Fri Feb 21, 2014 11:00 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />A lot of NES games, including Super Mario Bros. did not use any bankswitching in the cartridge.  Here is a partial list:  <!-- m --><a class="postlink" href="http://bootgod.dyndns.org:7777/search.php?ines=0">http://bootgod.dyndns.org:7777/search.php?ines=0</a><!-- m --><br /><br />Assuming the game is in iNES format, and was not dumped incorrectly, the byte size of the file will be less than or equal to 40,976 bytes if no bankswitching is used.  The converse is partially true; if an iNES file is less than or equal to 40,976 bytes in size, it probably did not use bankswitching, but there are exceptions.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Fri Feb 21, 2014 11:03 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">SuperDerek wrote:</div><div class="quotecontent">The game I'm going to be reviewing doesn't use bankswitched memory. Since it was one of only two games released on the NES that did <em>not </em>use that technique, you might already know to which game I am referring.</div><br />What do you mean &quot;only 2 games don't use banswitching&quot;? Tons of games don't use memory bankswitching (according to <a href="http://bootgod.dyndns.org:7777/search.php?ines_op=%3D%60%40%60&amp;ines=0&amp;field=2&amp;order=asc&amp;rfa=1+2+11+3+9+20+41+53" class="postlink">Bootgod's database</a>, 247 games). EDIT: Ninja'd!<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Initially, I though that this meant that the game had to be much smaller than a normal NES title, to verify this I downloaded a ROM file of the game and compared it to Super Mario Bros for a little perspective. To my surprise the file sizes were actually the same. Am I missing something , or just wrong about what bankswitching actually does?</div><br />SMB is one of the 247 games that doesn't use bankswitching, so it's no surprise that the size is the same. Games that don't have a mapper (chip that bankswitches memory) use a board named NROM. This board supports up to 32KB of Program ROM and 8KB of Character ROM, so 40KB is the largest you'll see that doesn't use a mapper.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The second question that I have is if there is a physical difference in the NES cartridges that used and didn't use bankswitching? I know that NES cartridges came in all kinds of different configurations, so I guess this question boils down to, looking at the circuit board, can you tell if a game uses bankswitching, and how? Or is this a purely software-based technique?</div><br />Yes, boards are very different. The bare minimum number of chips in an NES PCB is 3: Program ROM, Character ROM/RAM and the lockout chip. If that's all you see, there's no bankswitching. Any more than that, there's most likely a mapper present (extra chips could also be extra RAM though).<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The final question I have about bankswitching is if there is a reason that a NES game released well into the NES life cycle would choose not to use this technique? Is bankswitching costly?</div><br />There shouldn't be such a big difference during the later NES years. In the early days though, both the mapper and the larger ROM would've made a significant difference.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Or is this more likely related to the fact that this game is a port of an older PC-6001/8801 title, and that programming the game to utilize bankswitching would require substantial rewriting of the entire game's code?</div><br />They probably didn't need the extra space. Do you know how large the original game is? There'd no point in expanding the game just for the heck of it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>SuperDerek</b> [ Fri Feb 21, 2014 11:12 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><strong>D'oh! </strong><br /><br />Looks like I failed at reading comprehension. Apparently it's one of only 2 <em><strong>RPGs</strong></em> that didn't use bankswitching! Well that cleared up my misconception right quick, so thank you both for your quick replies! You've both given me a lot to chew on, and have been a huge help. And thanks for being so welcoming. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">They probably didn't need the extra space. Do you know how large the original game is? There'd no point in expanding the game just for the heck of it.</div><br /><br />@tokumaru,<br />The original game had several music tracks for different environments. However, when ported to the NES (in 1988) they dropped all but 3 15-second loops of music, one of which is all that you hear for the vast majority of the game, which is one of the major gripes.<br /><br />Apparently the only other NES RPG not to use bankswitching just resolved the problem by omitting music altogether. I'm guessing that the only reason they didn't expand the game was because at the time, it must have still been expensive to get the extra chips.<br /><br />I'm not sure how large the original PC88 version of the game would be, but I think I'll take a crack at finding out. Thanks again!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Fri Feb 21, 2014 11:15 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It isn't <a href="http://www.hardcoregaming101.net/stargazer/stargazer.htm" class="postlink">legendary crapgame Stargazer</a>, is it?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>SuperDerek</b> [ Fri Feb 21, 2014 11:26 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Nope... Honestly I'm not sure why I'm beating around the bush so much. If someone finds out early it's no big deal.<br /><br />I'm going to be putting together a defense for Hydlide, which was ripped apart by the AVGN as well as ProJared.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Fri Feb 21, 2014 11:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have never played Hydlide, but from looking at it I see something very peculiar: it doesn't use the hardware registers for scrolling, instead it redraws the entire gameplay area to simulate scrolling. This is most likely replicated from the original version, which probably ran on a video chip that didn't have hardware scrolling.<br /><br />Software scrolling isn't common on the NES, because programs only have a small portion of a frame's time for screen updates, and that time is not enough to update an entire screen, so the effect looks very choppy, while hardware scrolling can be perfectly smooth (but can't be done with those bricks around the gameplay area).<br /><br />EDIT: Looks like I was wrong. I looked at the PC-88 version and it doesn't have scrolling at all. There's actually a pretty long black screen between screens. Maybe the NES version is based on the MSX one?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>natt</b> [ Fri Feb 21, 2014 12:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Ahh, Hydlide.  Packing an RPG game into an NROM is certainly a feat, but I agree with tokumaru.  From a technical perspective, I think that the nametable and scrolling setup is what makes this game peculiar.<br /><br />Scrolling is done fully in software, and is quite slow and choppy as a result.  In order to use hardware scrolling though, the status bar on the right would have to have been eliminated, or an MMC5 would be needed ($$$$$).<br /><br /><img src="http://i.imgur.com/5QjHhcR.png" alt="Image" /><br /><br />Even given all that, it seems like they should have been able to improve the performance by a sort of &quot;double buffer&quot; strategy, where one nametable is on screen and one is being drawn to.  It doesn't speed things up because you can still only edit the &quot;backbuffer&quot; during vblank, but it would have eliminated the tearing that is so obvious in the game when you scroll.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Fri Feb 21, 2014 1:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">Software scrolling isn't common on the NES, because programs only have a small portion of a frame's time for screen updates, and that time is not enough to update an entire screen, so the effect looks very choppy</div><br />There's a difference between choppy and very choppy. One of my older games would scroll two 10x20 tile windows at 30 fps using a bit of early blanking. The Bad Apple demo updates the nametable at 15 fps using double buffering. But games during the NROM era had the double disadvantage of A. programmers not yet having discovered efficient display update methods for the NES PPU and B. the NES possibly not having built-in RAM to buffer a big nametable update transaction.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>SuperDerek</b> [ Fri Feb 21, 2014 1:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yeah, I can verify that Hydlide had scrolling added to it when it was ported to the MSX, so you're most likely right that this was the version the port was based off of. Additionally, it sounds like the music for the NES game came straight from Hydlide 2. Probably because, while Hidlyde had some different tracks, they were composed of nothing but short chirps and beeps.<br /><br />The points you bring up about scrolling are also very interesting. I noticed that scrolling within Hydlide was pretty awkward, but assumed that sort of scrolling was improved as devs got a better hold of the NES hardware. It's interesting that the NES had hardware based scrolling available. I wonder how much better Hydlide could have been if they had redesigned the game from the ground up for the NES?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Fri Feb 21, 2014 1:12 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">It isn't legendary crapgame Stargazer, is it?</div><br />Looks like this game uses UNROM. It also has the interesting properties to use the only non-prototype Nintendo made board with SRAM in a surface mounted package instead of the more traditional DIP-28 package (either narrow or wide).<br /><br />I can't think of another RPG that don't use a mapper. There is Portopia who has no mapper and no music, but it's clearly not an RPG. But because it was made by Chunsoft/Enix some people might confuse it for an RPG ?<br /><br />Dragon Quest doesn't use PRG bankswitching, but it uses CHR bankswitching.<br /><br />Then there is all the FDS games that don't use bankswitching, but they use disk access instead.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>SuperDerek</b> [ Fri Feb 21, 2014 1:34 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yeah, Portopia was the other alleged RPG not to use bankswitching.  So I would guess that would make Hydlide one of a kind, huh? <br /><br />I've been looking up the MMC5 chip that Matt mentioned to get a good idea of what kind of bang developers could get for their buck, which coincidentally took me to another thread on this forum, <a href="http://forums.nesdev.com/viewtopic.php?t=513" class="postlink">here</a>. I have to say, I'm certainly learning a lot as I go, thanks to you guys! It really gives me a new found appreciation for the considerations that went, (and still does,) into programming games for the NES. I only hope I can get even half of this to translate into an entertaining and informative review of Hydlide. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Pokun</b> [ Mon Feb 24, 2014 5:44 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Question about bankswitched memory from a layman</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yeah Portopia is definitely an adventure game. But it has this 3D maze that was inspired by Wizardry and I heard the game was like an experiment before they dared to make their first RPG, Dragon Quest. Ironically the 3D maze is the worst part of the game IMHO. lol<br /><br />MMC5 is like the most advanced Nintendo made mapper there is and not too many games used it as you can see.<br /><br /><div class="quotetitle">SuperDerek wrote:</div><div class="quotecontent">game is a port of an older PC-6001/8801 title, and that programming the game to utilize bankswitching would require substantial rewriting of the entire game's code<br /></div><br />You would have to rewrite the code anyway. PC-6001, PC-88 and MSX are all using a CPU called Z80 while NES/FAMICOM is using one based on 6502.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>