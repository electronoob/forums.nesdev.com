<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - PowerMappers (a new set of PowerPak mappers)</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">PowerMappers (a new set of PowerPak mappers)</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=9&amp;t=11945">http://forums.nesdev.com/viewtopic.php?f=9&amp;t=11945</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>6</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Wed Oct 22, 2014 7:43 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />PowerMappers is a new set of mappers for the PowerPak NES flash cartridge. It is a complete rewrite of my previous Save State Mappers. I have been sitting on this for a while, but since there hasn't been significant progress in the last month or so, this seems like a good time to release it.<br /><br />Download at <!-- m --><a class="postlink" href="https://kkfos.aspekt.fi/">https://kkfos.aspekt.fi/</a><!-- m --><br /><br />If you encounter any problems, let me know. This is still in a beta state.<br /><br />(Cross-posted to NintendoAGE forums.)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ccovell</b> [ Wed Oct 22, 2014 6:01 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks for the hard work! I'll try them out.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Wed Oct 22, 2014 6:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Do these contain whatever fixes were in loopy's mapper set for MMC3?  (It's been a while...)  I can pull my PowerPak out and test stuff if you need it!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Thu Oct 23, 2014 4:06 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">koitsu wrote:</div><div class="quotecontent">Do these contain whatever fixes were in loopy's mapper set for MMC3?  (It's been a while...)  I can pull my PowerPak out and test stuff if you need it!</div><br />MMC3 IRQ should be the same as in loopy's mappers. However, it can still be problematic for a couple of different reasons. It works well enough on my setup.<br /><br />I don't have anything specific for you to test, but general testing would be welcome, since this was only tested by myself before release, and also very briefly by Pasky.<br /><br />There was issue on one of Pasky's AV Famicoms (I believe) where loading would corrupt the nametable (in all mappers). Haven't been able to figure the cause of that one out yet, since I can't reproduce it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>JRoatch</b> [ Fri Oct 24, 2014 8:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />So I go around to trying these out and to my surprise an particular NROM image that used to not work suddenly did. I guess I had *really* outdated mappers. Thank you. Also, nice touch on clearing the ram. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Great Hierophant</b> [ Sun Oct 26, 2014 3:03 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Great work fox!  Some comments on your compatibility list :<br /><br />All the games that rely on bus capacitance for input work fine for me, but I didn't test save states.<br /><br />Bubble Bath Babes, Hot Slots and Peek-A-Boo Poker all run with your new mappers.  <br /><br />Pin Bot, High Speed, Gauntlet and Rad Racer II and Conflict now run with the new mappers.<br /><br />In your prior mapper 4, Bucky O'Hare's scanlines seemed to be solid.<br /><br />For Startropics, Mike's sprite doesn't flicker for me, but the last scanline before the border does.  I didn't notice any flickering sprites or scanlines in Startropics II.<br /><br />Try as I might, I can't see anything wrong with Perfect Fit's graphics, but I can see issues with the other games you listed as corrupting CHR-ROM.<br /><br />Mickey in Numberland has severe glitches and is not playable, but Letterland is playable.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Sun Oct 26, 2014 3:54 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Great Hierophant wrote:</div><div class="quotecontent">All the games that rely on bus capacitance for input work fine for me, but I didn't test save states.</div><br />Yeah, this is expected. I don't know what is wrong with this NES of mine that it has one of the controller bits high that's not supposed to be high.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">In your prior mapper 4, Bucky O'Hare's scanlines seemed to be solid.</div><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Mickey in Numberland has severe glitches and is not playable, but Letterland is playable.</div><br />MMC3 is really annoying to implement, because of the unclean PPU A12 that PowerPak provides. It's literally up to luck whether a certain revision of the mappers will work well or not, depending on how the logic is laid out. I'd suggest doing what the original MMC3 boards did, and add a 220 pf capacitor from ground to PPU A12 on the PowerPak. I'd be interested in hearing if this fixes any problems for anybody willing to try it.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Try as I might, I can't see anything wrong with Perfect Fit's graphics, but I can see issues with the other games you listed as corrupting CHR-ROM.</div><br />IIRC you have to press SELECT to exit the game for the corruption to occur, or something like that. The CHR corruption problem is another flaw in the PowerPak hardware design and I don't know of a workaround for it (besides patching the ROM).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Great Hierophant</b> [ Sun Oct 26, 2014 4:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />More MMC3 fun :<br /><br />Crystalis - The screen shakes when a dialog window is present.<br /><br />Star Trek 25th Anniversary - Corrupt graphics flicker when the dialog window appears on the ship.  I see this with Little Ninja Bros. as well.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Great Hierophant</b> [ Sun Oct 26, 2014 4:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">MMC3 is really annoying to implement, because of the unclean PPU A12 that PowerPak provides. It's literally up to luck whether a certain revision of the mappers will work well or not, depending on how the logic is laid out. I'd suggest doing what the original MMC3 boards did, and add a 220 pf capacitor from ground to PPU A12 on the PowerPak. I'd be interested in hearing if this fixes any problems for anybody willing to try it.</div><br /><br />Is this as simple as putting one leg of a capacitor on PPU/CHR A12 (say at pin 64 of the cartridge connector) and another leg on GND?  Would this have any negative effect on games that do not use MMC3?  Sounds easy enough to try.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Sun Oct 26, 2014 7:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Great Hierophant wrote:</div><div class="quotecontent">Is this as simple as putting one leg of a capacitor on PPU/CHR A12 (say at pin 64 of the cartridge connector) and another leg on GND?  Would this have any negative effect on games that do not use MMC3?  Sounds easy enough to try.</div><br />As far as I understand, the cap should preferably be placed as close to the FPGA input as possible, but I'm no electrical engineer. Placing it close might be hard, though, so you can try placing it at the cart connector I guess. It shouldn't have any negative effects on other mappers/games.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>2600</b> [ Mon Oct 27, 2014 11:28 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />A digital delay filter within your mapper might work as well.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Mon Oct 27, 2014 11:46 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">2600 wrote:</div><div class="quotecontent">A digital delay filter within your mapper might work as well.</div><br />Such implementation couldn't match the real MMC3 behavior very closely though, because on a real MMC3 the IRQ is asserted directly on the rising edge of A12.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>2600</b> [ Mon Oct 27, 2014 12:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">thefox wrote:</div><div class="quotecontent"><div class="quotetitle">2600 wrote:</div><div class="quotecontent">A digital delay filter within your mapper might work as well.</div><br />Such implementation couldn't match the real MMC3 behavior very closely though, because on a real MMC3 the IRQ is asserted directly on the rising edge of A12.</div><br /><br />I think it could match it closely, but you may think differently.  I'm just talking about a delay of a few ns.  Enough to filter out the random spike.  The capacitor delays the rising edge of A12 as seen by the MMC3 as well.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Mon Oct 27, 2014 12:18 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">2600 wrote:</div><div class="quotecontent">I think it could match it closely, but you may think differently.  I'm just talking about a delay of a few ns.  Enough to filter out the random spike.  The capacitor delays the rising edge of A12 as seen by the MMC3 as well.</div><br />How do you implement a few ns delay digitally? The PowerPak's on-board clock is 20 MHz.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>2600</b> [ Mon Oct 27, 2014 12:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: PowerMappers (a new set of PowerPak mappers)</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You have A12 go through a buffer or two and let's call this A12_delay.  Then you AND A12_delay with A12.  You'll need to make sure that ISE doesn't optimize out the buffer so you may want to use 2 NOT gates, AND gates, or whatever instead of a buffer.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>6</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>