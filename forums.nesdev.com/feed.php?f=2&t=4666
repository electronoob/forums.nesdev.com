<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=2&amp;t=4666" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2008-12-24T21:20:08-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=2&amp;t=4666</id>
<entry>
<author><name><![CDATA[Celius]]></name></author>
<updated>2008-12-24T21:20:08-07:00</updated>
<published>2008-12-24T21:20:08-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41029#p41029</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41029#p41029"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41029#p41029"><![CDATA[
I have header-esque files. They're mainly macro definitions though. I actually have kept my global variable definitions in separate files. They're a mess right now and could stand some cleaning up.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=138">Celius</a> — Wed Dec 24, 2008 9:20 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Banshaku]]></name></author>
<updated>2008-12-24T20:29:28-07:00</updated>
<published>2008-12-24T20:29:28-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41028#p41028</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41028#p41028"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41028#p41028"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />You might use .include if you use header files and a linker. Exports + constants go in header, routine definitions and data in source file.<br /></div><br /><br />Totally agree with this. This is the way I'm doing it with CC65 for my nes projects.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3559">Banshaku</a> — Wed Dec 24, 2008 8:29 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-12-24T20:57:45-07:00</updated>
<published>2008-12-24T16:55:36-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41024#p41024</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41024#p41024"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41024#p41024"><![CDATA[
You might use .include if you use header files and a linker. Exports + routine descriptions + constants go in header, routine definitions and data in source file.<br /><br />EDIT: routine descriptions also go in header<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Wed Dec 24, 2008 4:55 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Dwedit]]></name></author>
<updated>2008-12-24T15:52:03-07:00</updated>
<published>2008-12-24T15:52:03-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41023#p41023</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41023#p41023"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41023#p41023"><![CDATA[
You only #include code in ASM if you don't use a linker.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=53">Dwedit</a> — Wed Dec 24, 2008 3:52 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Celius]]></name></author>
<updated>2008-12-24T13:06:38-07:00</updated>
<published>2008-12-24T13:06:38-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41020#p41020</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41020#p41020"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41020#p41020"><![CDATA[
Thank you for doing that. I still have to study the answers a little more, as I just skimmed through them. But this mainly applies to C/C++, and not 6502, right?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=138">Celius</a> — Wed Dec 24, 2008 1:06 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2008-12-24T06:46:45-07:00</updated>
<published>2008-12-24T06:46:45-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41012#p41012</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41012#p41012"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=41012#p41012"><![CDATA[
<div class="quotetitle">Celius wrote:</div><div class="quotecontent"><br />Is there any specific reason that you really don't want to use .include statements in a big C program in particular?<br /></div><br />When you asked this, I posted this question at forum.gbadev.org. By now, <a href="http://forum.gbadev.org/viewtopic.php?p=165463#165463" class="postlink">they have come back with their replies</a>.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Wed Dec 24, 2008 6:46 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2008-12-23T05:40:25-07:00</updated>
<published>2008-12-23T05:40:25-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40984#p40984</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40984#p40984"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40984#p40984"><![CDATA[
<div class="quotetitle">Bregalad wrote:</div><div class="quotecontent"><br />If I would place it into many small section, the sound code would be shaterred in pieces in the large ROM, and it would be harder to make a .nsf file (I would basically have to take the ROM as a whole for the .nsf file, which would be a waste).<br /></div><br />Or you could set up your project such that it'd just be a matter of recompiling the project with only the sound code.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Tue Dec 23, 2008 5:40 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[dXtr]]></name></author>
<updated>2008-12-23T05:18:52-07:00</updated>
<published>2008-12-23T05:18:52-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40981#p40981</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40981#p40981"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40981#p40981"><![CDATA[
one thing I've never liked about wla-dx is the .incdir command. I'd rather have it like in gcc where I can specify include directories as an argument to the compiler.<br /><br />/rant off<br /><br />I usually have my structure with a project dir as a root and sub-folders for code, assets, tools, etc. then I usually have all this connected to a svn so I keep a history of changes. So I can easily revert changes.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=15">dXtr</a> — Tue Dec 23, 2008 5:18 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Bregalad]]></name></author>
<updated>2008-12-23T03:27:17-07:00</updated>
<published>2008-12-23T03:27:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40979#p40979</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40979#p40979"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40979#p40979"><![CDATA[
<div class="quotetitle">Celius wrote:</div><div class="quotecontent"><br />For project organization, it's possible to have one file that organizes everything without doing anything special with the command line. It could look like this:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.bank 8 SLOT 1<br />.orga $C000<br />.section &quot;FixedBank&quot; FORCE<br />.incdir &quot;IncludeFiles&quot;<br />.include &quot;FixedInclude.asm&quot;<br />.ends<br /><br />.bank 7 SLOT 0<br />.orga $8000<br />.section &quot;MapData&quot; FORCE<br />.incdir &quot;IncludeFiles&quot;<br />.include &quot;MapInclude.asm&quot;<br />.ends<br />...<br /><br />.bank 1 SLOT 0<br />.orga $8000<br />.section &quot;CHRRAM1&quot; FORCE<br />.incdir &quot;IncludeFiles&quot;<br />.include &quot;CHR1Include.asm&quot;<br />.ends<br /></div><br /></div><br />You'd want to have each subroutine or group of subroutine to have their own section. There is no point in having large piece of code taking up a large section, unless you really want it to be in the same order in your code and in the final binary file and there is no reason you'd want that. Exept for the sound code I place in a large section so that it's easy to crease a .nsf file.<br />If I would place it into many small section, the sound code would be shaterred in pieces in the large ROM, and it would be harder to make a .nsf file (I would basically have to take the ROM as a whole for the .nsf file, which would be a waste).<br /><br />I use RAM code only once for a routine that maze sprites, so that it mazes them in either increasing or decreasing order, and only a few instruction has to be modified. I could do it all in ROM by placing a switch for two different routines, but it would waste more ROM I guess.<br />Altough WLA has almost no provisions for relocatable codes, which is lacking, I just made a RAM section with a label, and copy code into that label. When calling the routine, I use either the RAM label to enable sprite cycling, or the ROM label to disable it (if sprite priorities are needed). When modyfiyng the code, I just use RAMLabel,X, so I don't need any other labels, but that's not the clean way to do it, because if I change the code itself I have to change the routine that modifies it as well, and re-count the bytes it takes and so on...<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> — Tue Dec 23, 2008 3:27 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Celius]]></name></author>
<updated>2008-12-22T21:12:33-07:00</updated>
<published>2008-12-22T21:12:33-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40973#p40973</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40973#p40973"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40973#p40973"><![CDATA[
For copying code to RAM, you could just assemble code telling the compiler that the starting address of the bank is $6000 (for SRAM) or $500 depending on wherever you want the labels to be. So you assemble that peice by itself so it turns it into a binary file, then you have that incbined into a particular location in ROM to copy to RAM. Oh, and that way you can really reuse names for variables because it's completely different asm file. But it's not so good if you jump to a location in ROM afterwards. But the ways to resolve this issue don't match up to the simplicity of your method.<br /><br />I think someday I might look into CA65. I just used WLA-DX because it had more common features that NESASM was lacking (this statement is not meant to cause a branch in discussion to "how bad" people think NESASM is).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=138">Celius</a> — Mon Dec 22, 2008 9:12 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Memblers]]></name></author>
<updated>2008-12-22T20:14:50-07:00</updated>
<published>2008-12-22T20:14:50-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40971#p40971</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40971#p40971"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40971#p40971"><![CDATA[
I use .org in CA65, often I have some code that I want to copy into RAM and run from there.  So any labels in that are based on the .org address.  At the end, you use .reloc and it goes back to the usual relocatable address mode.<br /><br />This is different because it just links it normally, and you copy it to the ORG location yourself in your program.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=10">Memblers</a> — Mon Dec 22, 2008 8:14 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[loopy]]></name></author>
<updated>2008-12-22T19:36:19-07:00</updated>
<published>2008-12-22T19:36:19-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40968#p40968</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40968#p40968"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40968#p40968"><![CDATA[
<div class="quotetitle">Celius wrote:</div><div class="quotecontent"><br />Also, I notice you do .Align $2000. What's $2000 for? What exactly does that do?<br /></div><br />It makes each bank take up 8kB. Just a different way of doing things, without creating sections.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4">loopy</a> — Mon Dec 22, 2008 7:36 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Celius]]></name></author>
<updated>2008-12-22T19:22:23-07:00</updated>
<published>2008-12-22T19:22:23-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40966#p40966</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40966#p40966"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40966#p40966"><![CDATA[
Yeah, I think this kind of system will work for me. I don't get really into dealing with the command line anyways <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" />. I might reorganize my code to have a folder for each bank, with one include file. Though this could get ugly as I have 32 banks to deal will (512k PRG), but I suppose if I am viewing in icon mode instead of tile mode (I use Windows XP), it shouldn't look so cluttered and uninviting.<br /><br />Also, I notice you do .Align $2000. What's $2000 for? What exactly does that do?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=138">Celius</a> — Mon Dec 22, 2008 7:22 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[loopy]]></name></author>
<updated>2008-12-22T18:59:04-07:00</updated>
<published>2008-12-22T18:59:04-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40962#p40962</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40962#p40962"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40962#p40962"><![CDATA[
<div class="quotetitle">Celius wrote:</div><div class="quotecontent"><br />Say I have some tables that are each $80 bytes or less that I want to start at $8680, but I want them to each start on multiples of $80, so I never cross a page boundary. So it would be really nice to be able to do something like this:<br /><br />.org $8680<br />;define table 1<br />.org $8700<br />;define table 2<br />.org $8780<br />;define table 3<br />etc.<br /><br />Like I said, some of them may be less than $80 bytes, but they do not exceed $80 bytes. It would be really handy if you could just specify where the following code/data begins without dealing with sections.<br /></div><br />As tepples said, there's <strong>.align</strong>.   Some assemblers have a <strong>.pad</strong> directive, which pads the rom up to a specified address.<br /><br />FWIW, I write my 6502 code just like you describe, one organizing file with a bunch of .includes, and smaller sections in their own .asm files.  Banks are handled sorta like this... <br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.base $8000<br />.include bank0.asm<br />.align $2000<br /><br />.base $8000<br />.include bank1.asm<br />.align $2000<br /><br />.base $a000<br />.include bank2.asm<br />.align $2000<br /><br />...etc<br /></div><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4">loopy</a> — Mon Dec 22, 2008 6:59 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Celius]]></name></author>
<updated>2008-12-22T18:37:00-07:00</updated>
<published>2008-12-22T18:37:00-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40961#p40961</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40961#p40961"/>
<title type="html"><![CDATA[Project Organization]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=4666&amp;p=40961#p40961"><![CDATA[
My one compiled file is structured where everything is assigned a location. So with .DEFINE and .UNDEFINE statements where I can reuse variable names for certain parts of code, and that, I'm still not quite seeing why I wouldn't want to assemble it as one big chunk not dealing with the command line. It seems to simplify things.<br /><br />Another way of organizing code would be to have one file like I said, but code and data wouldn't be separated, instead, it would be one bank to one folder. So the main "bundle" file would look like:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.incdir &quot;bank0&quot;<br />.include &quot;bank0include.asm&quot;<br />.incdir &quot;bank1&quot;<br />.include &quot;bank1include.asm&quot;<br />...<br /></div><br /><br />and bank0include.asm would look like:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.bank 0 SLOT 0<br />.orga $8000<br />.section &quot;bank0&quot; FORCE<br />.include &quot;stuff.asm&quot;<br />.incbin &quot;whatever.bin&quot;<br />...<br /></div><br /><br />and so on for whatever. This might be a better setup than separating code and data because you wouldn't get "lost" when trying to find something. As long as you know what bank it's in, you're good to go.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=138">Celius</a> — Mon Dec 22, 2008 6:37 pm</p><hr />
]]></content>
</entry>
</feed>