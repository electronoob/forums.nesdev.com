<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - ld65 madness</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - NESdev" href="http://forums.nesdev.com/feed.php?f=2" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - ld65 madness" href="http://forums.nesdev.com/feed.php?f=2&amp;t=9896" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '1');
	var per_page = '';
	var base_url = '';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=register"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Sat Sep 20, 2014 6:25 pm<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=2">NESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />

<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=2&amp;t=9896">ld65 madness</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=2"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=2&amp;t=9896"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 13 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=2&amp;t=9896&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=2&amp;t=9896&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=2&amp;t=9896&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p108971"></a>
				<b class="postauthor" style="color: #AA0000">koitsu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p108971">ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=108971#p108971"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Mar 07, 2013 5:47 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Site Admin</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3.png" width="100" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 9:28 pm<br /><b>Posts:</b> 1864<br /><b>Location:</b> Mountain View, CA, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">So it's as I expected -- I have spent more time fucking around with ld65 and trying to &quot;make it happy&quot; than I have actually written code.  I have no real issue with the assembler (ca65), just that this bloody &quot;linker configuration&quot; nonsense is a complete and total nightmare.  I've ranted about this before in some other post some time ago -- it provides very little benefit given the nature of the platform being developed on.<br /><br />To make this simple: does anyone have a ld65 configuration template for MMC3 with multiple PRG banks in use?<br /><br />I'd also like someone to explain to me what the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">size</tt> directive in the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">MEMORY</tt> section of the config <strong>actually <span style="text-decoration: underline">does</span></strong>.  <a href="http://www.cc65.org/doc/ld65-5.html" class="postlink">The documentation</a> does not actually say; instead its &quot;implied&quot; or &quot;eluded to&quot; somehow, yet when it comes to making an actual .NES file with multiple PRG banks, it matters immensely.  It seems to control the &quot;size&quot; of the related <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">.scope</tt>, i.e. how much room on-disk (in <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">file</tt>) something takes up.<br /><br />Why such is called <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">MEMORY</tt> I don't know -- oh, wait, yes I do, because <strong>the entire linker semantics and design is intended for <span style="text-decoration: underline">C, not assembly</span></strong>.<br /><br />I'm tempted to make <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">MEMORY</tt> into something that correlates 1:1 a segment and a file, then use <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">FILES</tt> to set all the output types to <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">bin</tt>, then just use <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">copy /b header.bin+prg0.bin+prg1.bin+... &gt; test.nes</tt> to make the damn ROM image.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p108974"></a>
				<b class="postauthor" style="color: #AA0000">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p108974">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=108974#p108974"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Mar 07, 2013 6:50 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 12424<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">You might want to start with an MMC1 project using <a href="http://forums.nesdev.com/viewtopic.php?f=22&amp;t=7991" class="postlink">my SGROM/SNROM template</a>, which can be modified for UNROM with only a slight change to the code (replacing the serial load with a simple load).<br /><br />I'm willing to walk you through making a working ld65 configuration file. Are you using fixed $C000/$E000 or fixed $8000/$E000? If the former, how many $8000 banks and how many $A000 banks? If the latter, how many $A000 banks and how many $C000 banks?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p108975"></a>
				<b class="postauthor">Quietust</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p108975">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=108975#p108975"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Mar 07, 2013 7:23 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 10:59 pm<br /><b>Posts:</b> 1188
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">The &quot;size&quot; value in MEMORY lets you control exactly how much ROM space can be used by that section - for example, if you have an 8KB bank that gets mapped at $8000-$9FFF, then you'd have &quot;start = $8000, size = $2000&quot; (and probably also &quot;fill = yes&quot; to make sure it gets padded), while a 16KB bank at $C000-$FFFF would have &quot;start = $C000, size = $4000&quot; (or perhaps &quot;size = $3FFA&quot; if it's your fixed bank and you want a separate 6-byte memory block for your interrupt vectors so you don't have to explicitly insert the padding in your code); the SEGMENTS section lets you control the order in which each block gets assembled into your resulting 'object' file (which will be your entire PRG ROM).</div>

					
						<div class="postbody"><br />_________________<br />Quietust, QMT Productions
<br />P.S. If you don't get this note, let me know and I'll write you another.</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p108976"></a>
				<b class="postauthor" style="color: #AA0000">koitsu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p108976">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=108976#p108976"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Mar 07, 2013 7:25 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Site Admin</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3.png" width="100" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 9:28 pm<br /><b>Posts:</b> 1864<br /><b>Location:</b> Mountain View, CA, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I did have a &quot;working&quot; ld configuration file for MMC3 (well, meaning it didn't emit any errors during link-time), but the problem was that the PRG banks/pages were 4x larger than they should have been (because I had to change <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">size=$2000</tt> to <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">size=$8000</tt> in the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">MEMORY</tt> section), but it's become a pain in the ass for me simply because I don't understand what on earth is really going on under the hood.  I say all this with familiarity with linkers and segment models on x86/x64 platforms and OSes, but the NES is not such a platform.<br /><br />I started with <a href="http://rainwarrior.ca/music/moon8romsrc.zip" class="postlink">rainwarrior's MOON8 stuff</a>, then modified it to work with UxROM.  That worked great -- no issues.  But the PRG bank size on UxROM is 16KBytes, so the ld65 configuration template was much more obvious (everything having <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">size=$4000</tt> and <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">start=$8000</tt>).<br /><br />With MMC3, the PRG bank sizes are 8KBytes, which is inducing lots of confusion.<br /><br />I'll take a look at your SGROM/SNROM template and see what I can make from that.<br /><br />As for the hardwiring, I planned on having $C000/$E000 hardwired.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p108978"></a>
				<b class="postauthor" style="color: #AA0000">koitsu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p108978">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=108978#p108978"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Mar 07, 2013 7:56 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Site Admin</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3.png" width="100" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 9:28 pm<br /><b>Posts:</b> 1864<br /><b>Location:</b> Mountain View, CA, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Quietust wrote:</div><div class="quotecontent">The &quot;size&quot; value in MEMORY lets you control exactly how much ROM space can be used by that section - for example, if you have an 8KB bank that gets mapped at $8000-$9FFF, then you'd have &quot;start = $8000, size = $2000&quot; (and probably also &quot;fill = yes&quot; to make sure it gets padded), while a 16KB bank at $C000-$FFFF would have &quot;start = $C000, size = $4000&quot; (or perhaps &quot;size = $3FFA&quot; if it's your fixed bank and you want a separate 6-byte memory block for your interrupt vectors so you don't have to explicitly insert the padding in your code); the SEGMENTS section lets you control the order in which each block gets assembled into your resulting 'object' file (which will be your entire PRG ROM).</div><br />Thank you thank you thank you thank you!  This is <strong>exactly</strong> what I needed to know -- I got everything working.  :-)<br /><br />Edit: removed example code.  CHR-ROM stuff is not working how I expected, but that's my own fault/issue/misunderstanding.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p108981"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p108981">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=108981#p108981"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Mar 07, 2013 8:30 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1384529626.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 1615<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I find the cc65 documentation is not good at all as a tutorial, but the information I need is usually there if I look for it. If you want a good understanding of the linker config files, I suggest just giving this entire page a quick read:<br /><br /><a href="http://www.cc65.org/doc/ld65-5.html" class="postlink">http://www.cc65.org/doc/ld65-5.html</a><br /><br />Edit: Oh, you already linked to it. Well, never mind.</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=5165">rainwarrior</a> on Thu Mar 07, 2013 8:57 pm, edited 1 time in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p108982"></a>
				<b class="postauthor">blargg</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p108982">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=108982#p108982"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Mar 07, 2013 8:49 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=17.gif" width="60" height="69" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Sep 27, 2004 8:33 am<br /><b>Posts:</b> 3711<br /><b>Location:</b> Central Texas, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I've found cc65's documentation very lacking. I keep yelling at it, &quot;what does this DO?&quot; and it answers back &quot;this is used for this kind of thing&quot;. I resorted to the scientific method to figure out the meanings of things. It's very frustrating to deal with things that aren't documented. We can't read the mind of the programmer, who of course knows what everything does. This is a common problem with software, where creators keep too much in their head and leave everyone else (including themselves at a later date) in the dark. I speak from my own past self who has left me in this position for lots of my stuff...</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=17"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p108990"></a>
				<b class="postauthor" style="color: #AA0000">koitsu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p108990">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=108990#p108990"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Mar 07, 2013 11:39 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Site Admin</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3.png" width="100" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 9:28 pm<br /><b>Posts:</b> 1864<br /><b>Location:</b> Mountain View, CA, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Thanks guys.  :-)  rainwarrior, your MOON8 stuff is really what helped me the most (when making a UxROM image), hands down.  Like I read it and struggled a bit but then it made sense.<br /><br />The stuff I'm stuck on now is vectors (REALLY!?!?!?  THIS IS A WALK IN THE DAMN PARK), but I see this same topic has come up before -- <!-- l --><a class="postlink-local" href="http://forums.nesdev.com/viewtopic.php?t=8586">viewtopic.php?t=8586</a><!-- l --> -- it looks like I'm going to have to do things the &quot;hard&quot; way and make a separate segment for them.  I really hoped to just keep them in the source code of my last (hard-wired) PRG bank, but oh well.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p109000"></a>
				<b class="postauthor" style="color: #AA0000">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p109000">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=109000#p109000"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Mar 08, 2013 5:56 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 12424<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">For vectors, make a new segment starting at $FFFA in the last bank.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p109016"></a>
				<b class="postauthor">thefox</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p109016">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=109016#p109016"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Mar 08, 2013 11:25 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=80.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Jan 03, 2005 10:36 am<br /><b>Posts:</b> 1869<br /><b>Location:</b> Tampere, Finland
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">FYI, there's also the <a href="http://www.cc65.org/snapshot-doc/" class="postlink">snapshot doc</a> which contains some stuff the release doc doesn't yet (and maybe some fixed links, etc). Naturally it would make sense to use that with the snapshot version of cc65, as it might (and does) mention some features that the release version doesn't include.<br /><br /><div class="quotetitle">Quietust wrote:</div><div class="quotecontent">(or perhaps &quot;size = $3FFA&quot; if it's your fixed bank and you want a separate 6-byte memory block for your interrupt vectors so you don't have to explicitly insert the padding in your code);</div><br />It's also possible to do this by using the <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">start</tt> attribute of the VECTORS segment, which is placed in the last bank (i.e. last ROM based MEMORY block, basically what tepples said).<br /><br />It's important to note that the order of segments in the file is relevant, so if a segment has a start address of $FFFA, it must come after every other segment that goes in the same bank (otherwise the bank will get padded up to $FFFA, and rest of the segments will not fit).</div>

					
						<div class="postbody"><br />_________________<br /><span style="font-size: 85%; line-height: normal">Download STREEMERZ for NES from <a href="http://www.fauxgame.com" class="postlink">www.fauxgame.com</a>!</span></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=80"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p109046"></a>
				<b class="postauthor" style="color: #AA0000">koitsu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p109046">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=109046#p109046"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Mar 08, 2013 8:12 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Site Admin</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3.png" width="100" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 9:28 pm<br /><b>Posts:</b> 1864<br /><b>Location:</b> Mountain View, CA, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">For other readers, this is what I ended up doing:<br /><br />ld65 memory config (called main.cfg) --<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">MEMORY {<br />&nbsp; &nbsp; ZP:&nbsp; &nbsp; &nbsp; &nbsp; start = $00,&nbsp; &nbsp;size = $100,&nbsp; type = rw;<br />&nbsp; &nbsp; RAM:&nbsp; &nbsp; &nbsp; &nbsp;start = $0200, size = $600,&nbsp; type = rw;<br />&nbsp; &nbsp; HDR:&nbsp; &nbsp; &nbsp; &nbsp;start = $0000, size = $10,&nbsp; &nbsp;type = ro, file = %O, fill = yes;<br />&nbsp; &nbsp; PRG0:&nbsp; &nbsp; &nbsp; start = $8000, size = $4000, type = ro, file = %O, fill = yes, fillval = $FF;<br />&nbsp; &nbsp; PRG1:&nbsp; &nbsp; &nbsp; start = $8000, size = $4000, type = ro, file = %O, fill = yes, fillval = $FF;<br />&nbsp; &nbsp; PRG2:&nbsp; &nbsp; &nbsp; start = $8000, size = $4000, type = ro, file = %O, fill = yes, fillval = $FF;<br />&nbsp; &nbsp; PRG3_C000: start = $C000, size = $2000, type = ro, file = %O, fill = yes, fillval = $FF;<br />&nbsp; &nbsp; PRG3_E000: start = $E000, size = $2000, type = ro, file = %O, fill = yes, fillval = $FF;<br />&nbsp; &nbsp; CHR0:&nbsp; &nbsp; &nbsp; start = $0000, size = $1000, type = ro, file = %O, fill = yes, fillval = $00;<br />&nbsp; &nbsp; CHR1:&nbsp; &nbsp; &nbsp; start = $0000, size = $1000, type = ro, file = %O, fill = yes, fillval = $00;<br />}<br /><br />SEGMENTS {<br />&nbsp; &nbsp;ZP:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;load = ZP,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type = zp;<br />&nbsp; &nbsp;BSS:&nbsp; &nbsp; &nbsp; &nbsp; load = RAM,&nbsp; &nbsp; &nbsp; &nbsp; type = bss, align = $100, define = yes;<br />&nbsp; &nbsp;HEADER:&nbsp; &nbsp; &nbsp;load = HDR,&nbsp; &nbsp; &nbsp; &nbsp; type = ro,&nbsp; align = $10;<br /><br />&nbsp; &nbsp;PRG0_8000:&nbsp; load = PRG0,&nbsp; &nbsp; &nbsp; &nbsp;type = ro,&nbsp; start = $8000;<br />&nbsp; &nbsp;PRG0_A000:&nbsp; load = PRG0,&nbsp; &nbsp; &nbsp; &nbsp;type = ro,&nbsp; start = $A000;<br />&nbsp; &nbsp;PRG1_8000:&nbsp; load = PRG1,&nbsp; &nbsp; &nbsp; &nbsp;type = ro,&nbsp; start = $8000;<br />&nbsp; &nbsp;PRG1_A000:&nbsp; load = PRG1,&nbsp; &nbsp; &nbsp; &nbsp;type = ro,&nbsp; start = $A000;<br />&nbsp; &nbsp;PRG2_8000:&nbsp; load = PRG2,&nbsp; &nbsp; &nbsp; &nbsp;type = ro,&nbsp; start = $8000;<br />&nbsp; &nbsp;PRG2_A000:&nbsp; load = PRG2,&nbsp; &nbsp; &nbsp; &nbsp;type = ro,&nbsp; start = $A000;<br />&nbsp; &nbsp;PRG3_C000:&nbsp; load = PRG3_C000,&nbsp; type = ro,&nbsp; start = $C000;<br />&nbsp; &nbsp;PRG3_E000:&nbsp; load = PRG3_E000,&nbsp; type = ro,&nbsp; start = $E000;<br />&nbsp; &nbsp;VECTORS:&nbsp; &nbsp; load = PRG3_E000,&nbsp; type = ro,&nbsp; start = $FFFA;<br />&nbsp; &nbsp;CHR0:&nbsp; &nbsp; &nbsp; &nbsp;load = CHR0,&nbsp; &nbsp; &nbsp; &nbsp;type = ro,&nbsp; define = no;<br />&nbsp; &nbsp;CHR1:&nbsp; &nbsp; &nbsp; &nbsp;load = CHR1,&nbsp; &nbsp; &nbsp; &nbsp;type = ro,&nbsp; define = no;<br />}<br /><br />FILES {<br />&nbsp; &nbsp;%O:&nbsp; &nbsp;format = bin;<br />}</div><br /><br />main.s, which is what's assembled when calling ca65:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp; &nbsp; &nbsp; .setcpu &quot;6502&quot;<br /><br />;<br />; NES (1.0) header<br />; http://wiki.nesdev.com/w/index.php/INES<br />;<br />.segment &quot;HEADER&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte &quot;NES&quot;, $1a<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $04&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 16KB PRG-ROM banks = 4<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;&nbsp; 8KB CHR-ROM banks = 1<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $40, $00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Mapper 4 (MMC3)<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $00<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $00<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $00<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $00<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $00<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $00<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $00<br />&nbsp; &nbsp; &nbsp; &nbsp; .byte $00<br /><br /><br />;<br />; Zero page variables<br />;<br />.segment &quot;ZP&quot;<br />scroll1:&nbsp; &nbsp; &nbsp; &nbsp; .res 1<br />scroll2:&nbsp; &nbsp; &nbsp; &nbsp; .res 1<br /><br /><br />;<br />; PRG banks (8KBytes each, per MMC3)<br />;<br />.scope PRG0<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;PRG0_8000&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;PRG0_A000&quot;<br />.endscope<br /><br />.scope PRG1<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;PRG1_8000&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;PRG1_A000&quot;<br />.endscope<br /><br />.scope PRG2<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;PRG2_8000&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;PRG2_A000&quot;<br />.endscope<br /><br />.scope PRG3_C000<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;PRG3_C000&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; .include &quot;prg3_c000.s&quot;<br />.endscope<br /><br />.scope PRG3_E000<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;PRG3_E000&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; .include &quot;prg3_e000.s&quot;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; ; Labels nmi/reset/irq are part of prg3_e000.s<br />&nbsp; &nbsp; &nbsp; &nbsp; ;<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;VECTORS&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; .addr nmi<br />&nbsp; &nbsp; &nbsp; &nbsp; .addr reset<br />&nbsp; &nbsp; &nbsp; &nbsp; .addr irq<br />.endscope<br /><br />;<br />; CHR banks (1 or 2KBytes each, per MMC3)<br />;<br />.scope CHR0<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;CHR0&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; .incbin &quot;font.chr&quot;<br />.endscope<br />.scope CHR1<br />&nbsp; &nbsp; &nbsp; &nbsp; .segment &quot;CHR1&quot;<br />.endscope<br /></div><br /><br />You can see a couple things here:<br /><br />1. Code for PRG0, PRG1, and PRG2 has not been written -- instead, the linker takes care of this by filling the relevant 16KByte regions in the resulting .nes file with value $FF.  When I need these PRG pages (which per MMC3 will be 8KBytes), I'll edit the ld65 memory map and change the size to $2000 and split them up much like I did with PRG3_C000 and PRG3_E000.<br /><br />2. The NMI, RESET, and IRQ/BRK vectors are declared in main.s, but the labels that are referenced are in prg3_e000.s.<br /><br />3. CHR0 references a 4096-byte file (font.chr) and CHR1 isn't used yet (like #1 above, te linker will fill this 4096-byte region in the resulting .nes file with $00 -- I haven't gotten around to drawing graphics for that CHR page yet).<br /><br />prg3_c000.s contains literally jack squat right now --<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp; &nbsp; &nbsp; .org $c000<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; nop<br />&nbsp; &nbsp; &nbsp; &nbsp; nop<br />&nbsp; &nbsp; &nbsp; &nbsp; nop<br />&nbsp; &nbsp; &nbsp; &nbsp; nop<br />&nbsp; &nbsp; &nbsp; &nbsp; nop<br /></div><br /><br />prg3_e000.s -- you can see the vector labels defined here:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp; &nbsp; &nbsp; .org $e000<br /><br />reset:<br />&nbsp; &nbsp; &nbsp; &nbsp; sei<br />&nbsp; &nbsp; &nbsp; &nbsp; cld<br />&nbsp; &nbsp; &nbsp; &nbsp; ldx #$ff<br />&nbsp; &nbsp; &nbsp; &nbsp; txs<br /><br />;<br />; Infinite loop for the time being<br />;<br />:&nbsp; &nbsp; &nbsp; &nbsp;jmp :-<br /><br />nmi:<br />&nbsp; &nbsp; &nbsp; &nbsp; rti<br /><br />irq:<br />&nbsp; &nbsp; &nbsp; &nbsp; rti<br /></div><br /><br />And finally how to build it (I just call this make.bat) --<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">@echo off<br />SET CC65=D:\Console\cc65<br /><br />del *.o test.nes<br /><br />@echo on<br />%CC65%\bin\ca65 main.s<br />%CC65%\bin\ld65 -C main.cfg -m ld65_map.txt -o test.nes main.o<br />@pause<br /></div><br /><br />What ld65_map.txt contains after a successful build:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Modules list:<br />-------------<br />main.o:<br />&nbsp; &nbsp; HEADER&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Offs = 000000&nbsp; &nbsp;Size = 000010<br />&nbsp; &nbsp; ZP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Offs = 000000&nbsp; &nbsp;Size = 000002<br />&nbsp; &nbsp; PRG3_C000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Offs = 000000&nbsp; &nbsp;Size = 000005<br />&nbsp; &nbsp; PRG3_E000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Offs = 000000&nbsp; &nbsp;Size = 00009F<br />&nbsp; &nbsp; VECTORS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Offs = 000000&nbsp; &nbsp;Size = 000006<br />&nbsp; &nbsp; CHR0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Offs = 000000&nbsp; &nbsp;Size = 001000<br /><br /><br />Segment list:<br />-------------<br />Name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Start&nbsp; &nbsp;End&nbsp; &nbsp; &nbsp;Size<br />--------------------------------------------<br />CHR0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 000000&nbsp; 000FFF&nbsp; 001000<br />HEADER&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 000000&nbsp; 00000F&nbsp; 000010<br />ZP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 000000&nbsp; 000001&nbsp; 000002<br />PRG3_C000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00C000&nbsp; 00C004&nbsp; 000005<br />PRG3_E000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00E000&nbsp; 00E09E&nbsp; 00009F<br />VECTORS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00FFFA&nbsp; 00FFFF&nbsp; 000006<br /><br /><br />Exports list:<br />-------------<br /><br /><br /><br />Imports list:<br />-------------</div><br /><br />Note that the reason PRG3_E000 is $9F in size is because I do have some PPU/etc. code in there which I've chose to emit from this post -- it's irrelevant to what I'm showing here.  :-)  I just wanted to provide folks with a working example for ca65/ld65.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p109060"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p109060">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=109060#p109060"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Mar 09, 2013 12:10 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1384529626.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 1615<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">One thing you might want to do is make the A000 segments &quot;optional&quot;. This would let you put more than 8k in the 8000 segment if the A000 segment is left undefined. (I use this for my &quot;standard&quot; NSF linker config, so I can use the DPCM segment if needed, otherwise I just let data overflow into it.)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p109068"></a>
				<b class="postauthor" style="color: #AA0000">koitsu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p109068">Re: ld65 madness</a></div><div style="float: right;"><a href="./viewtopic.php?p=109068#p109068"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Mar 09, 2013 3:09 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Site Admin</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3.png" width="100" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 9:28 pm<br /><b>Posts:</b> 1864<br /><b>Location:</b> Mountain View, CA, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">One thing you might want to do is make the A000 segments &quot;optional&quot;. This would let you put more than 8k in the 8000 segment if the A000 segment is left undefined. (I use this for my &quot;standard&quot; NSF linker config, so I can use the DPCM segment if needed, otherwise I just let data overflow into it.)</div><br />Yep, I may end doing that, depending on what my needs are with what I'm writing.  I'll worry about that once I get there.  :-)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=2&amp;t=9896"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=2"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=2&amp;t=9896"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 13 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=2">NESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 2 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="9896" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2" selected="selected">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="11">&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="12">&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;GBDev</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>

<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>

</body>
</html>