<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Alternate application of SuperFX</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Alternate application of SuperFX</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=12&amp;t=7013">http://forums.nesdev.com/viewtopic.php?f=12&amp;t=7013</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>smkd</b> [ Wed Oct 06, 2010 10:06 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Alternate application of SuperFX</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I think it was TmEE who brought up that <a href="http://www.youtube.com/watch?v=EaLRLo2yB04" class="postlink">Galaxy Force</a> was ported to the Genesis at some point.  That's really surprising considering you'd need a coprocessor on the cart to get something that actually resembles the original arcade release.  After checking it out, it looks about as lame as I expected.
<br />
<br />I'm curious what other people here think about that scaled-sprite graphical style in the video.  If starfox ran at 20FPS using the graphical style seen in that vid, with a few less colors, would you find it nicer looking? The style might seem very dated to most, but I really like how the cave sections and fire stage turned out to name a few.  From a 1992/1993 marketting perspecitve the true 3D would likely be alot more appealing, but consider this in the present day.  What style do you find more appealing?
<br />
<br />The 21Mhz SFX should be able to do a decent amount of drawing since cache/ram/rom all have buses that can run in parallel, right? The 4bpp mode may make things kind of ugly and no where near as colorful as galaxy force.  8bpp may eat into the frame rate or borders, but I guess it's all about how you use your colors.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tomaitheous</b> [ Thu Oct 07, 2010 12:21 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Are you sure StarFox ran at 20fps??? IIRC, it was more like ~15fps with nothing onscreen, and at times felt like 10fps or less. 
<br />
<br /> I'm not sure if the sega scaler board for that game runs at 60fps or 45fps/30fps (which space harrier does IIRC). Either way, Galaxy Force looks waaaaaaaayyy smoother in motion and beautiful to boot. Ever play that game in the arcade? It's amazing. Some models of GF had a rotating chair version.  
<br />
<br /> I'm sure you can find the specs for the scaler board used for that, but IIRC from a discussion with charles macdonald a few years back, it's just a glorified sprite blitter onto a frame buffer. There's tilt and later boards added rotation to the frame buffer (but not the sprites). I always thought they looked awesome (way better than flat shaded polygons). Power Drift is another. Steel Gunner 1 and 2 are also similar 3D games (although machine gun games with fixed path/scrolling).
<br />
<br /> Oh, OutRunners (not OutRun) is also pretty awesome for a sprite scaler game.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mic_</b> [ Thu Oct 07, 2010 1:08 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I'm sure you can find the specs for the scaler board used for that</div>
<br />Perhaps the MAME source code contains some info since it emulates the SEGA Y Board. Finding what you're looking for in their online source repo isn't always that easy though.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>smkd</b> [ Thu Oct 07, 2010 2:20 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tomaitheous wrote:</div><div class="quotecontent">Are you sure StarFox ran at 20fps??? IIRC, it was more like ~15fps with nothing onscreen, and at times felt like 10fps or less. </div><br /><br />Oh no, it ran terribly like you say. I am just considering a more ideal situation.  If this hypothetical GalaxyForce-like game ran at 20FPS with the borders and such.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I'm not sure if the sega scaler board for that game runs at 60fps or 45fps/30fps (which space harrier does IIRC). Either way, Galaxy Force looks waaaaaaaayyy smoother in motion and beautiful to boot. Ever play that game in the arcade? It's amazing. Some models of GF had a rotating chair version.</div><br /><br />It's very smooth in an emulator atleast.  It <em>looked</em> like 60FPS when I played it.  Not happening with an SFX setup ofcourse =(.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I'm sure you can find the specs for the scaler board used for that, but IIRC from a discussion with charles macdonald a few years back, it's just a glorified sprite blitter onto a frame buffer. There's tilt and later boards added rotation to the frame buffer (but not the sprites). I always thought they looked awesome (way better than flat shaded polygons). Power Drift is another. Steel Gunner 1 and 2 are also similar 3D games (although machine gun games with fixed path/scrolling).</div>
<br />
<br />Yes I've read something similar.  A cached SFX routine with spaced out read/writes should be able to mimic this decently, but I haven't messed around that much with the chip recently.  When I wanted to try, bsnes didn't support it and emulators apparently used whole instructions as opposed to clock cycles and it was way, way off.  I don't think the cache was even emulated either.
<br />
<br />Beyond the neat video setup, I know Sega added custom chips that did the same math the 68k would do in software, but with instantly readable results.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Thu Oct 07, 2010 7:11 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I don't think the Neo Geo or GBA could run a game like Galaxy Force 2, even though they have hardware sprite scaling.  GBA would hit the scaled sprite limit very quickly.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Oct 07, 2010 7:43 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The Neo Geo doesn't support real-time sprite rotation at all, so let's analyze the GBA. The GBA PPU has 1210 cycles per line to process sprite pixels. Each unscaled pixel costs one cycle, each scaled sprite costs 10, and each scaled pixel costs 2 cycles. So if you're using 32x32 pixel sprites, each sprite costs 10+32*2 = 74 cycles, and 16 will fit on a line. That's still 16*32/240=213% overdraw, twice as much as the <em>unscaled</em> overdraw close to 100% on Genesis and Super NES. The only time it'd overflow is when drawing those carrier-looking ships that use multiple layers for depth. (I can think of a few workarounds for that.) But the GBA OAM only holds 32 rotation matrices at once, and at some points on the screen, you'll need to upload replacement matrices. For these, you'll want to enable HDMA to OAM, which reduces the sprite rendering time to 954 cycles or 12 sprites on any line when it is active.
<br />
<br />The DS's 3D core can be used as 1,500 sprites, each with its own matrix.
<br />
<br />Back to the Super NES: The poster child for rotating and scaling quads on SNES is Yoshi's Island. Has anyone tried ripping out its sprite texturing code and benchmarking it?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>byuu</b> [ Thu Oct 07, 2010 11:12 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The video really, really doesn't do the game justice.
<br />
<br />Placed properly in the context of its time, that was probably the most amazing arcade machine I've ever played. You sit inside of this box where everything else is pitch black, have this gigantic freaking monitor, and the entire booth rotates as you move your ship. It was extremely immersive.
<br />
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">emulators apparently used whole instructions as opposed to clock cycles and it was way, way off. I don't think the cache was even emulated either.</div>
<br />
<br />If you want to do something cool, I'd suggest trying to utilize the SFX2+SA-1 at the same time. Maybe even use MSU1 and treat the SPC700 as a math coprocessor :D
<br />
<br />Other emulators have not improved at all since then, and no, they don't emulate any of the caches.
<br />
<br />SuperFX has:
<br />- 256-byte instruction cache with VERY complicated 16-byte row fetching
<br />- instruction pipeline
<br />- ROM buffer cache
<br />- RAM buffer cache
<br />- primary pixel cache
<br />- secondary pixel cache
<br />- high-speed multiplication mode for SFX1 only
<br />- different memory AND cache speeds between SFX1/2
<br />- ROM/RAM access control that can stall SFX at any point
<br />
<br />And all of that stuff is parallel. When you plot pixels, it fills the primary pixel cache. Once that pixel cache is filled or once you swap to another tile, it flushes it all over to the secondary cache and starts over.
<br />
<br />The part that even I don't emulate is something I've never understood. The secondary cache is supposed to run in parallel with the RAM buffer cache. Basically, when RAM is not being used, the secondary pixel cache can write to it. But when it is, the secondary cache stalls. And if that stalls out, it can eventually stall the primary cache as well.
<br />
<br />But when I emulate it, it causes timing issues in all kinds of games. And what happens if you are executing a tight loop directly out of RAM? Does the secondary cache stall forever, or does it interleave operations with the RAM buffer cache? Eg read one RAM buffer, write one secondary pixel, repeat. I have no idea.
<br />
<br />There's also the matter of incomplete tiles flushing the secondary cache. Games definitely do this all the time, and you don't get black garble, so it seems necessary that the secondary cache also has to READ from RAM, making the whole thing even more complicated.
<br />
<br />I'd say other SFX emulators have completely useless timing, and I've got it about 90% right. But both are really pitiful. If you write SFX2 timing-sensitive code and want to ensure it works, you have no choice but to find a way to run it on real hardware.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>smkd</b> [ Fri Oct 08, 2010 5:13 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />About neogeo, while it can't rotate sprites, it does have direct access to 128Mbyte of sprite tiles.  The cons are being able to only shrink sprites and the 96 sprite/scanline limit will likely get in the way.  Pre-rotated frames at full zoom (possibly multiple sizes) will be extremely large all things considered.  Possibly prohibitively large.
<br />
<br />Interesting info about the GBA there.  Seems that a SuperFX would be better suited for this in the end, even with the limitations considered.
<br />
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I'd say other SFX emulators have completely useless timing, and I've got it about 90% right. But both are really pitiful. If you write SFX2 timing-sensitive code and want to ensure it works, you have no choice but to find a way to run it on real hardware.</div>
<br />
<br />That's too bad.  Still haven't imported an SFC and I've been meaning to do that for a while now.  But it's something to try out whenever I get the means to do it.
<br />
<br />And I never had the chance to play in an actual machine &gt;8(.  Sega's old arcade machines looked real nice with the physical immersion.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>byuu</b> [ Fri Oct 08, 2010 7:25 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />An SFC alone isn't really enough to test SFC code, nor is a copier.
<br />
<br />The SFX chip sits <em>between</em> the cartridge bus and the ROM/RAM chips.
<br />
<br />To test SFX code, you will have to use a serial cable and stop-n-swap with an SFX game, and even then you will be limited to only using RAM to execute your code. Since RAM execution and the pixel caches fight each other, you'll get worse performance.
<br />
<br />In order to execute your own code through the SFX ROM path, you would have to solder your own EPROMs onto an SFX game board.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>smkd</b> [ Fri Oct 08, 2010 9:03 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yeah I guess that post was a bit miselading.
<br />
<br />I know about that, it's just that I have no working system at all and I'd prefer an SFC above anything else (urrrghh, PAL).  I've done the EPROM socketing/soldering on neo geo carts so it should be familiar territory.  When I get my SFC and some SFX cart, I'll probably get into it.  I believe there's alot of messy rewiring involved though.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sik</b> [ Fri Oct 15, 2010 5:22 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Not wanting to be mean, but Galaxy Force 2 is crap... The port of G-Loc looks much better and has a higher framerate as well.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>psycopathicteen</b> [ Sat Oct 16, 2010 10:06 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I've attempted software rotation using the 65816, but the conversion of sprites from a large packed-pixel bitmap to planar 8x8 tiles takes a lot of complicated and confusing code.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mic_</b> [ Sat Oct 16, 2010 11:07 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I guess it depends on how you define "a lot". This is what I use as a post-processing stage when decompressing graphics data: <a href="http://pastebin.com/keiKUd5r" class="postlink">http://pastebin.com/keiKUd5r</a>
<br />
<br />
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The port of G-Loc looks much better</div>
<br />You mean the MD port of G-Loc VS the MD port of Galaxy Force II, right? Because the MD port of G-Loc obviously can't hold a candle against the arcade version of Galaxy Force II.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>psycopathicteen</b> [ Sat Oct 16, 2010 3:38 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">mic_ wrote:</div><div class="quotecontent">I guess it depends on how you define "a lot". This is what I use as a post-processing stage when decompressing graphics data: <a href="http://pastebin.com/keiKUd5r" class="postlink">http://pastebin.com/keiKUd5r</a><br /><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The port of G-Loc looks much better</div><br />You mean the MD port of G-Loc VS the MD port of Galaxy Force II, right? Because the MD port of G-Loc obviously can't hold a candle against the arcade version of Galaxy Force II.</div>
<br />
<br />I have an idea.  Set <a href="http://wiki.superfamicom.org/snes/show/Registers#vmain__video_port_control_30" class="postlink">$2115</a> to #$88.  Load it to v-ram while rotating the sprite pixel by pixel.  Switch $2115 to #$80.  DMA it back to CPU side.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sik</b> [ Sat Oct 16, 2010 7:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">mic_ wrote:</div><div class="quotecontent">You mean the MD port of G-Loc VS the MD port of Galaxy Force II, right? Because the MD port of G-Loc obviously can't hold a candle against the arcade version of Galaxy Force II.</div>
<br />Yeah, MD vs. MD. The arcade version of G-Loc probably beats the arcade version of Galaxy Force anyways because of the 360 degree rotating seat (that's from where the game takes its name).

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>