<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Voice Outtakes</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Voice Outtakes</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=6&amp;t=4391">http://forums.nesdev.com/viewtopic.php?f=6&amp;t=4391</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Roth</b> [ Wed Sep 17, 2008 11:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Voice Outtakes</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hey all, I've been putting together a small game for the Garage Cart 2 release, and I had my son do some voices for the DMC channel. Sorry Bregalad, I know how much you hate that channel! ; ) hehe
<br />
<br />I like to try and include him in as many things as possible, so I figured why not put his voice on the NES? Anyway, the point of this post is just for giggles. I made about a minute long mp3 of some outtakes. You can even hear me say "no" at one point where he started to get carried away haha
<br />
<br /><!-- m --><a class="postlink" href="http://robertlbryant.com/gaming/mp3/Pegs%20Outtakes.mp3">http://robertlbryant.com/gaming/mp3/Pegs%20Outtakes.mp3</a><!-- m -->
<br />
<br />I just thought some of you might find this a bit funny : )

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Wed Sep 17, 2008 12:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I don't see what this does for the NES but you should be using $4011 if you want to do voices so that the quality is high enough (I don't hate the DMC channel if used with $4011 or if used as a slient IRQ source, what annoys me is the terrible hissing noise of DPCM), but you're free to do whathever you want with your games, just as I'm free to do whathever I want with my games.
<br />
<br />Also non native people who lernt english have very low chances to make sense of it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Sep 17, 2008 12:46 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">I don't see what this does for the NES but you should be using $4011 if you want to do voices so that the quality is high enough</div>
<br />I agree, <em>if</em> your game doesn't need speech and action at once. Wisdom Tree's <em>Joshua</em> is like this; so is Hi-Tech's <em>Big Bird's Hide and Speak</em>. But it wouldn't work for something like Irem's <em>Kung Fu</em> or Sony's <em>Parappa the Rapper</em>.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Wed Sep 17, 2008 1:03 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">Also non native people who lernt english have very low chances to make sense of it.</div>
<br />Let's try... "Go!", "Choose an empty slot!" and "Good job!"? I'm not sure about "slot", but I think I got the rest right, no? I must admit it is sometimes hard for non-native speakers to understand recordings that were mostly spontaneous (not like in series or movies where everything is fake).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Roth</b> [ Wed Sep 17, 2008 1:11 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You got it Tokumaru : )
<br />
<br />I actually had to have it change to "Choose a slot," because the file size was annoyingly big otherwise hehe Still though, that one ended up being the hardest to understand. To atone for that though, I've made sure that the words he's saying are printed on screen when it happens.
<br />
<br />Now let's hope a language barrier doesn't make a Japanese person think that the countdown in the game isn't supposed to be counting from 3-2-1... 5!!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Wed Sep 17, 2008 1:22 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />So Roth, are you gonna write the samples directly or will you use the 1 bit deltas? I think his voice sounded good for a video game, so I hope the encoding won't destroy it! =)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Wed Sep 17, 2008 1:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Honnesly, I can't undersand one word of it.
<br />All I hear is "Haa ya !" and something like that. I didn't even notice it was supposed to mean something. Sorry, but you probably shouldn't exept any player to understand the voices if they aren't doubled by text. But feel free to do wathever you want.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Wed Sep 17, 2008 1:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hahaha Guess you were right, Roth! He hates it! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />
<br />
<br />Seriously though, yeah, I agree that text is a must. I was never able to understand anything that came out of the NES if there wasn't any text. Then again, I didn't know much english back then.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Roth</b> [ Wed Sep 17, 2008 1:45 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">So Roth, are you gonna write the samples directly or will you use the 1 bit deltas? I think his voice sounded good for a video game, so I hope the encoding won't destroy it! =)</div>
<br />
<br />I've made them into .dmc files. I'm not quite sure what writing samples directly means, though : P
<br />
<br />Yeah, the text is all present for each one. The really only bad one that came out was Choose a slot. Go and Good job came out very, very nice : ) 
<br />
<br />Wait a second... Bregalad, you can't understand one word of the mp3?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Wed Sep 17, 2008 2:04 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Roth wrote:</div><div class="quotecontent">I'm not quite sure what writing samples directly means, though : P</div>
<br />I've NEVER done any sound programming on the NES (sadly), but as far as I know, there are 2 forms of playing samples:
<br />
<br />1. The NES automatically reads 1-bit deltas from the ROM and adjusts the waveform according to the value of each bit;
<br />
<br />2. You write the samples (I think they are 7-bit values) directly;
<br />
<br />Obviously, the 2nd method will produce better results, because you can handle all sorts of transitions, while the 1-bit deltas will fail to represent sudden transitions, causing sound distortions. However, the disadvantage of writing samples directly, besides the larger space they occupy (although you could come up with a compression algorithm, like tepples did), is the fact that your program has to continuously write the samples, leaving no time to do anything else. This is what tepples meant when he talked about "speech and action at the same time".

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Wed Sep 17, 2008 2:22 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Wait a second... Bregalad, you can't understand one word of the mp3?</div>
<br />No I can't, but I'm really not used to listen to people talking english, especially little kids.
<br />
<br />And you should go for way 2 for making samples (no need to make .dmc, I've made a NES programm that uses SRAM to converts PCM to tepples' great ADPCM-like compression format I could send it to you if you want).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Roth</b> [ Wed Sep 17, 2008 2:29 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That's alright, I totally understand : )
<br />
<br />As for this program, it's already finished. I just have to do some commenting in the source before I officially release it and such. So, I won't be able to put that converter that you're talking about to use right now, but I would still be interested in checking it out! My email address should be under my post here. Thanks!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Wed Sep 17, 2008 2:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, the encoder is only used to make a .sav file that contains data to be used by the player. The only reason I made it a NES programm is that I didn't have enough skill in java back then, now I'd make a java programm instead since I've taken course for it last year and it's great.
<br />
<br />The player that you'll need in your code is like that.
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp;ldy #$00<br />--&nbsp; &nbsp;ldx #$27&nbsp; &nbsp;;This values changes playback rate<br />-&nbsp; &nbsp;dex<br />&nbsp; &nbsp;bne -<br />&nbsp; &nbsp;lda &#91;DMCPointerL&#93;,Y<br />&nbsp; &nbsp;lsr A<br />&nbsp; &nbsp;lsr A<br />&nbsp; &nbsp;lsr A<br />&nbsp; &nbsp;lsr A&nbsp; &nbsp; &nbsp; ;High nybble<br />&nbsp; &nbsp;tax<br />&nbsp; &nbsp;lda DPCMTable.w,X<br />&nbsp; &nbsp;clc<br />&nbsp; &nbsp;adc Last_DMCByte<br />&nbsp; &nbsp;sta Last_DMCByte<br />&nbsp; &nbsp;sta $4011<br />&nbsp; &nbsp;ldx #$28<br />-&nbsp; &nbsp;dex<br />&nbsp; &nbsp;bne -<br />&nbsp; &nbsp;lda &#91;DMCPointerL&#93;,Y<br />&nbsp; &nbsp;and #$0f&nbsp; &nbsp; &nbsp; &nbsp; ;Low nybble<br />&nbsp; &nbsp;tax<br />&nbsp; &nbsp;lda DPCMTable.w,X<br />&nbsp; &nbsp;clc<br />&nbsp; &nbsp;adc Last_DMCByte<br />&nbsp; &nbsp;sta Last_DMCByte<br />&nbsp; &nbsp;sta $4011<br />&nbsp; &nbsp;iny<br />&nbsp; &nbsp;bne --<br />&nbsp; &nbsp;inc DMCPointerH<br />&nbsp; &nbsp;lda DMCPointerH<br />&nbsp; &nbsp;cmp #$c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;Stupid way to check the end of the sample<br />&nbsp; &nbsp;bcc --<br />-&nbsp; &nbsp;jmp -<br /><br />DPCMTable&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;Square table<br />&nbsp; &nbsp;.db 0, 1, 4, 9, 16, 25, 36, 49, -64, -49, -36, -25, -16, -9, -4, -1</div><br /><br />The encoder should look liks that (sorry I'm just pasting it):<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp;ldy #$00<br />-&nbsp; &nbsp;lda &#91;DMCPointerL&#93;,Y<br />&nbsp; &nbsp;jsr PCMtoDPCM<br />&nbsp; &nbsp;asl A<br />&nbsp; &nbsp;asl A<br />&nbsp; &nbsp;asl A<br />&nbsp; &nbsp;asl A<br />&nbsp; &nbsp;sta Temp<br />&nbsp; &nbsp;inc DMCPointerL<br /><br />&nbsp; &nbsp;lda &#91;DMCPointerL&#93;,Y<br />&nbsp; &nbsp;jsr PCMtoDPCM<br />&nbsp; &nbsp;ora Temp<br />&nbsp; &nbsp;sta &#91;DMCPointer2L&#93;,Y<br /><br />&nbsp; &nbsp;inc DMCPointer2L<br />&nbsp; &nbsp;bne +<br />&nbsp; &nbsp;inc DMCPointer2H<br />+&nbsp; &nbsp;inc DMCPointerL<br />&nbsp; &nbsp;bne -<br />&nbsp; &nbsp;inc DMCPointerH<br />&nbsp; &nbsp;lda DMCPointerH<br />&nbsp; &nbsp;bpl -<br />&nbsp; &nbsp;lda #$5a<br />&nbsp; &nbsp;sta &#91;DMCPointer2L&#93;,Y<br />&nbsp; &nbsp;iny<br />&nbsp; &nbsp;lda Last_DMCByte<br />&nbsp; &nbsp;sta &#91;DMCPointer2L&#93;,Y<br />&nbsp; &nbsp;iny<br />&nbsp; &nbsp;lda #$ff<br />&nbsp; &nbsp;sta &#91;DMCPointer2L&#93;,Y<br />-&nbsp; &nbsp;jmp -<br /><br />PCMtoDPCM&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;;Actual conversion routine<br />&nbsp; &nbsp;lsr A&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;;7-bit unsigned format<br />&nbsp; &nbsp;ldx #$00<br />&nbsp; &nbsp;sec<br />&nbsp; &nbsp;sbc Last_DMCByte&nbsp; &nbsp;;Differentiate with last sample<br />-&nbsp; &nbsp;cmp DPCMTable2.w,X<br />&nbsp; &nbsp;bcc ++<br />&nbsp; &nbsp;inx<br />&nbsp; &nbsp;cpx #$0f<br />&nbsp; &nbsp;bne -<br /><br />++&nbsp; &nbsp;lda Last_DMCByte<br />&nbsp; &nbsp;clc<br />&nbsp; &nbsp;adc DPCMTable.w,X<br />&nbsp; &nbsp;sta Last_DMCByte<br />&nbsp; &nbsp;txa<br />&nbsp; &nbsp;rts<br /><br />DPCMTable<br />&nbsp; &nbsp;.db 0, 1, 4, 9, 16, 25, 36, 49, -64, -49, -36, -25, -16, -9, -4, -1<br /><br />DPCMTable2<br />&nbsp; &nbsp;.db 1, 2, 6, 12, 20, 30, 42, 72, -57, -43, -31, -21, -13, -7, -3, -1<br /></div>
<br />
<br />Basically it computes the delta between each sample, and the square root of the (un-signed) delta is being encoded (with the original sign). For example if the delta is -5, you'll encode -2 because the square root of 5 is slightly above 2, and it's rounded down to 2, and the original sign is preserved. Each sample is coded on 4-bit.
<br />
<br />When playing, you just use a signed square table to play back the samples. For some reason that square/root technique sound a whole lot better than the linear version of the same 4-bit dela encoding (I've tried it), and tepples found that.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>