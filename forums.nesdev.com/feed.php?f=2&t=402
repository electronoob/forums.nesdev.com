<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=2&amp;t=402" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2005-07-13T04:44:04-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=2&amp;t=402</id>
<entry>
<author><name><![CDATA[beneficii]]></name></author>
<updated>2005-07-13T04:44:04-07:00</updated>
<published>2005-07-13T04:44:04-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2792#p2792</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2792#p2792"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2792#p2792"><![CDATA[
Well, it still doesn't work on FCEU and FCEUXD.  It shows a really messed up screen instead of showing the proper one.  SMB3 and Kirby's Adventure, which use the same IRQ's in the same mapper, run fine in the two programs.  Because of this, I am still perplexed.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=156">beneficii</a> — Wed Jul 13, 2005 4:44 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[beneficii]]></name></author>
<updated>2005-07-12T16:40:55-07:00</updated>
<published>2005-07-12T16:40:55-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2779#p2779</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2779#p2779"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2779#p2779"><![CDATA[
<div class="quotetitle">Quietust wrote:</div><div class="quotecontent"><br />Hint: if you register an account on the forums, you'll be able to edit your posts.<br /></div><br /><br />Well, I did like two years ago.<br /><br />Anyway, the fact that this doesn't work on FCEU and FCEUXD makes me think there is still something wrong with the program.  Now, I wish to learn more about timing the PPU, which seems to be a thing that many here have difficulty with.<br /><br />I'm gonna leave in a few minutes and will be back in a few hours.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=156">beneficii</a> — Tue Jul 12, 2005 4:40 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Quietust]]></name></author>
<updated>2005-07-12T16:28:38-07:00</updated>
<published>2005-07-12T16:28:38-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2778#p2778</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2778#p2778"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2778#p2778"><![CDATA[
Hint: if you register an account on the forums, you'll be able to edit your posts.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=7">Quietust</a> — Tue Jul 12, 2005 4:28 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-07-12T16:07:24-07:00</updated>
<published>2005-07-12T16:07:24-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2777#p2777</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2777#p2777"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2777#p2777"><![CDATA[
<div class="quotetitle">Quietust wrote:</div><div class="quotecontent"><br /><div class="quotetitle">Anonymous wrote:</div><div class="quotecontent">Seriously, though, make the correction on the thing yourself, and you'll see some interesting effects on the display, which got all messed up.  Some tiles are drawn diagonally.  <img src="http://forums.nesdev.com/images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> <br /><br />If we could master that, we could have some cool effects.  <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /></div><br /><br />I just did, and it looked fine. The only problem was that on the FIRST scanline of the bottom region, the tiles were slightly offset. This is perfectly normal, since you did not time the $2006 writes to be within HBLANK.<br /><br /><div class="quotetitle">Anonymous wrote:</div><div class="quotecontent"><br />I'm still having a problem with the IRQs just raring to go though.  As soon as I clear that interrupt disable flag the IRQs just keep on coming and coming and coming and coming, despite my writes to $e000.<br /></div><br /><br />Like I said, that is an EMULATOR problem - if you want proper results, use a reliable accurate emulator.</div><br /><br />BTW, I have no idea how to time the $2006 writes to be within HBLANK.  Being a perfectionist, I would like to.<p>Statistics: Posted by Guest — Tue Jul 12, 2005 4:07 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-07-12T16:05:13-07:00</updated>
<published>2005-07-12T16:05:13-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2776#p2776</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2776#p2776"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2776#p2776"><![CDATA[
<div class="quotetitle">Quietust wrote:</div><div class="quotecontent"><br /><div class="quotetitle">Anonymous wrote:</div><div class="quotecontent">Seriously, though, make the correction on the thing yourself, and you'll see some interesting effects on the display, which got all messed up.  Some tiles are drawn diagonally.  <img src="http://forums.nesdev.com/images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> <br /><br />If we could master that, we could have some cool effects.  <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /></div><br /><br />I just did, and it looked fine. The only problem was that on the FIRST scanline of the bottom region, the tiles were slightly offset. This is perfectly normal, since you did not time the $2006 writes to be within HBLANK.<br /><br /><div class="quotetitle">Anonymous wrote:</div><div class="quotecontent"><br />I'm still having a problem with the IRQs just raring to go though.  As soon as I clear that interrupt disable flag the IRQs just keep on coming and coming and coming and coming, despite my writes to $e000.<br /></div><br /><br />Like I said, that is an EMULATOR problem - if you want proper results, use a reliable accurate emulator.</div><br /><br />I considered that as well, but I was using FCEUXD, which runs SMB3 and Kirby's Adventure fine, but which does not seem to run this.  FCEU doesn't either.  Then again, your emulator loads it fine, as does Nesticle, LoopyNES, JNES, NNNesterJ, and I'm going to stop here.  Still, why is it not supported by FCEU and FCEUXD?  FCEUXD is based on FCEU and FCEU is well-renowned.<br /><br />The other comment, Disch mentioned that.  He recommended to have the interrupt start a little early.  Still, timing does seem complicated and I will eventually need to implement horizontal scrolling where I would want one part of the screen to stay put.  Any pointers on that?<p>Statistics: Posted by Guest — Tue Jul 12, 2005 4:05 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Quietust]]></name></author>
<updated>2005-07-12T15:51:39-07:00</updated>
<published>2005-07-12T15:51:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2775#p2775</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2775#p2775"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2775#p2775"><![CDATA[
<div class="quotetitle">Anonymous wrote:</div><div class="quotecontent"><br />Seriously, though, make the correction on the thing yourself, and you'll see some interesting effects on the display, which got all messed up.  Some tiles are drawn diagonally.  <img src="http://forums.nesdev.com/images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> <br /><br />If we could master that, we could have some cool effects.  <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /></div><br /><br />I just did, and it looked fine. The only problem was that on the FIRST scanline of the bottom region, the tiles were slightly offset. This is perfectly normal, since you did not time the $2006 writes to be within HBLANK.<br /><br /><div class="quotetitle">Anonymous wrote:</div><div class="quotecontent"><br />I'm still having a problem with the IRQs just raring to go though.  As soon as I clear that interrupt disable flag the IRQs just keep on coming and coming and coming and coming, despite my writes to $e000.<br /></div><br /><br />Like I said, that is an EMULATOR problem - if you want proper results, use a reliable accurate emulator.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=7">Quietust</a> — Tue Jul 12, 2005 3:51 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-07-12T15:44:13-07:00</updated>
<published>2005-07-12T15:44:13-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2773#p2773</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2773#p2773"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2773#p2773"><![CDATA[
<div class="quotetitle">Anonymous wrote:</div><div class="quotecontent"><br /><div class="quotetitle">Quietust wrote:</div><div class="quotecontent">Your IRQ code is pointing the screen at the FIRST nametable and is trying to set vertical scroll via $2005, which <strong>cannot be done mid-frame</strong>. If you want a setup similar to what SMB3 does, you should be writing $0B,$00 to $2006 and $00 <strong>once</strong> to $2005.<br /></div><br /><br />I'm still having a problem with the IRQs just raring to go though.  As soon as I clear that interrupt disable flag the IRQs just keep on coming and coming and coming and coming, despite my writes to $e000.  I think if this issue can be resolved, then I can get this dang thing to work.  I hope I'm not being too bothersome; I do appreciate the help you've given me thus far. ^_^</div><br /><br />Seriously, though, make the correction on the thing yourself, and you'll see some interesting effects on the display, which got all messed up.  Some tiles are drawn diagonally.  <img src="http://forums.nesdev.com/images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> <br /><br />If we could master that, we could have some cool effects.  <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><p>Statistics: Posted by Guest — Tue Jul 12, 2005 3:44 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-07-12T15:36:47-07:00</updated>
<published>2005-07-12T15:36:47-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2771#p2771</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2771#p2771"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2771#p2771"><![CDATA[
<div class="quotetitle">Quietust wrote:</div><div class="quotecontent"><br />Your IRQ code is pointing the screen at the FIRST nametable and is trying to set vertical scroll via $2005, which <strong>cannot be done mid-frame</strong>. If you want a setup similar to what SMB3 does, you should be writing $0B,$00 to $2006 and $00 <strong>once</strong> to $2005.<br /></div><br /><br />I'm still having a problem with the IRQs just raring to go though.  As soon as I clear that interrupt disable flag the IRQs just keep on coming and coming and coming and coming, despite my writes to $e000.  I think if this issue can be resolved, then I can get this dang thing to work.  I hope I'm not being too bothersome; I do appreciate the help you've given me thus far. ^_^<p>Statistics: Posted by Guest — Tue Jul 12, 2005 3:36 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Quietust]]></name></author>
<updated>2005-07-12T15:18:21-07:00</updated>
<published>2005-07-12T15:18:21-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2769#p2769</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2769#p2769"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2769#p2769"><![CDATA[
Your IRQ code is pointing the screen at the FIRST nametable and is trying to set vertical scroll via $2005, which <strong>cannot be done mid-frame</strong>. If you want a setup similar to what SMB3 does, you should be writing $0B,$00 to $2006 and $00 <strong>once</strong> to $2005.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=7">Quietust</a> — Tue Jul 12, 2005 3:18 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-07-12T15:13:46-07:00</updated>
<published>2005-07-12T15:13:46-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2768#p2768</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2768#p2768"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2768#p2768"><![CDATA[
<div class="quotetitle">Quietust wrote:</div><div class="quotecontent"><br />The problem is that you are never clearing the I flag <strong>outside of NMI</strong> - when you do CLI at the end of your NMI routine, the RTI shortly afterwards <strong>sets the I flag again</strong>. As such, IRQs will ONLY be serviced at the end of your NMI routine (when the I flag is briefly cleared).<br /><br />If your NMI routine is short, you shouldn't even be doing CLI inside in the first place - you should be doing it at the end of your initialization code, right after you enable NMIs (and be sure to write to $E000 before doing CLI, otherwise an unacknowledged MMC3 IRQ might go off).<br /><br />The fact that your IRQ handler is being called 6 times in a row means there is probably a flaw in your MMC3 IRQ implementation, since writing to $E000 should acknowledge any pending MMC3 IRQs.<br /></div><br /><br />Dur,  <img src="http://forums.nesdev.com/images/smilies/icon_idea.gif" alt=":idea:" title="Idea" /> I knew that.  Thanks for that info.  I can't believe I missed that.  LOL.<br /><br />Still, I'm missing something.  I do have one good piece of news, since fixing that interrupt flag thing, the whole screen is now black.  Now that may not sound so good to you, but if you look at the name tables in the ROM, you'll see that there is no way the whole screen can be black without split-screen scrolling.  So I have implemented it; now I need to figure out how to set the right value.<br /><br />Uh, in some experimenation, I ran into some problems.  The display got weird.  Because of that, I'll go ahead and include the source files with the ROM so perhaps you can look at it and tell me how I'm implementing the IRQs wrongly:<br /><br /><!-- m --><a class="postlink" href="http://www.freewebs.com/beneficii/scroll.zip">http://www.freewebs.com/beneficii/scroll.zip</a><!-- m --><p>Statistics: Posted by Guest — Tue Jul 12, 2005 3:13 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Quietust]]></name></author>
<updated>2005-07-12T14:48:58-07:00</updated>
<published>2005-07-12T14:48:58-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2767#p2767</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2767#p2767"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2767#p2767"><![CDATA[
The problem is that you are never clearing the I flag <strong>outside of NMI</strong> - when you do CLI at the end of your NMI routine, the RTI shortly afterwards <strong>sets the I flag again</strong>. As such, IRQs will ONLY be serviced at the end of your NMI routine (when the I flag is briefly cleared).<br /><br />If your NMI routine is short, you shouldn't even be doing CLI inside in the first place - you should be doing it at the end of your initialization code, right after you enable NMIs (and be sure to write to $E000 before doing CLI, otherwise an unacknowledged MMC3 IRQ might go off).<br /><br />The fact that your IRQ handler is being called 6 times in a row means there is probably a flaw in your MMC3 IRQ implementation, since writing to $E000 should acknowledge any pending MMC3 IRQs.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=7">Quietust</a> — Tue Jul 12, 2005 2:48 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-07-12T14:44:40-07:00</updated>
<published>2005-07-12T14:44:40-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2766#p2766</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2766#p2766"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2766#p2766"><![CDATA[
^ Note that I did not show all the instances of the IRQs, which all did the same thing.<p>Statistics: Posted by Guest — Tue Jul 12, 2005 2:44 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-07-12T14:43:39-07:00</updated>
<published>2005-07-12T14:43:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2765#p2765</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2765#p2765"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2765#p2765"><![CDATA[
I ran a trace of the code. Almost immediately after CLI'ing (after one instruction after), the IRQ was executed 6 times in rapid succession, with only one instruction being executed at a time between IRQs.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">$E117:48        PHA                        A:0A X:00 Y:C0 P:nvubdIzc   ;;;start of NMI<br />$E118:8A        TXA                        A:0A X:00 Y:C0 P:nvubdIzc<br />$E119:48        PHA                        A:00 X:00 Y:C0 P:nvubdIZc<br />$E11A:98        TYA                        A:00 X:00 Y:C0 P:nvubdIZc<br />$E11B:48        PHA                        A:C0 X:00 Y:C0 P:NvubdIzc<br />$E11C:AD 02 20  LDA $2002 = #$AA           A:C0 X:00 Y:C0 P:NvubdIzc<br />$E11F:A9 00     LDA #$00                   A:AA X:00 Y:C0 P:NvubdIzc<br />$E121:8D 06 20  STA $2006 = #$00           A:00 X:00 Y:C0 P:nvubdIZc<br />$E124:8D 06 20  STA $2006 = #$00           A:00 X:00 Y:C0 P:nvubdIZc<br />$E127:E6 30     INC $30 = #$00             A:00 X:00 Y:C0 P:nvubdIZc<br />$E129:A5 30     LDA $30 = #$01             A:00 X:00 Y:C0 P:nvubdIzc<br />$E12B:C9 C0     CMP #$C0                   A:01 X:00 Y:C0 P:nvubdIzc<br />$E12D:B0 1F     BCS $E14E                  A:01 X:00 Y:C0 P:nvubdIzc<br />$E12F:AD 02 20  LDA $2002 = #$20           A:01 X:00 Y:C0 P:nvubdIzc<br />$E132:A9 00     LDA #$00                   A:20 X:00 Y:C0 P:nvubdIzc<br />$E134:8D 05 20  STA $2005 = #$00           A:00 X:00 Y:C0 P:nvubdIZc<br />$E137:A5 30     LDA $30 = #$01             A:00 X:00 Y:C0 P:nvubdIZc<br />$E139:8D 05 20  STA $2005 = #$00           A:01 X:00 Y:C0 P:nvubdIzc<br />$E13C:A9 C0     LDA #$C0                   A:01 X:00 Y:C0 P:nvubdIzc<br />$E13E:8D 00 C0  STA $C000 = #$FF           A:C0 X:00 Y:C0 P:NvubdIzc<br />$E141:8D 01 C0  STA $C001 = #$FF           A:C0 X:00 Y:C0 P:NvubdIzc<br />$E144:8D 01 E0  STA $E001 = #$02           A:C0 X:00 Y:C0 P:NvubdIzc<br />$E147:58        CLI                        A:C0 X:00 Y:C0 P:NvubdIzc<br />$E148:68        PLA                        A:C0 X:00 Y:C0 P:Nvubdizc   ;;; not the end of the NMI!<br />$E155:78        SEI                        A:C0 X:00 Y:C0 P:NvubdIzc    ;;; start of IRQ<br />$E156:8D 00 E0  STA $E000 = #$0F           A:C0 X:00 Y:C0 P:NvubdIzc<br />$E159:48        PHA                        A:C0 X:00 Y:C0 P:NvubdIzc<br />$E15A:AD 02 20  LDA $2002 = #$21           A:C0 X:00 Y:C0 P:NvubdIzc<br />$E15D:A9 00     LDA #$00                   A:21 X:00 Y:C0 P:nvubdIzc<br />$E15F:8D 05 20  STA $2005 = #$00           A:00 X:00 Y:C0 P:nvubdIZc<br />$E162:8D 05 20  STA $2005 = #$00           A:00 X:00 Y:C0 P:nvubdIZc<br />$E165:AD 02 20  LDA $2002 = #$20           A:00 X:00 Y:C0 P:nvubdIZc<br />$E168:A9 08     LDA #$08                   A:20 X:00 Y:C0 P:nvubdIzc<br />$E16A:8D 06 20  STA $2006 = #$00           A:08 X:00 Y:C0 P:nvubdIzc<br />$E16D:A9 00     LDA #$00                   A:08 X:00 Y:C0 P:nvubdIzc<br />$E16F:8D 06 20  STA $2006 = #$00           A:00 X:00 Y:C0 P:nvubdIZc<br />$E172:68        PLA                        A:00 X:00 Y:C0 P:nvubdIZc<br />$E173:40        RTI                        A:C0 X:00 Y:C0 P:NvubdIzc<br />$E149:A8        TAY                        A:C0 X:00 Y:C0 P:NvUbdizc<br />$E155:78        SEI                        A:C0 X:00 Y:C0 P:NvUbdIzc   ;;;start of IRQ &#40;again&#41;<br />$E156:8D 00 E0  STA $E000 = #$0F           A:C0 X:00 Y:C0 P:NvUbdIzc<br />$E159:48        PHA                        A:C0 X:00 Y:C0 P:NvUbdIzc<br />$E15A:AD 02 20  LDA $2002 = #$20           A:C0 X:00 Y:C0 P:NvUbdIzc<br />$E15D:A9 00     LDA #$00                   A:20 X:00 Y:C0 P:nvUbdIzc<br />$E15F:8D 05 20  STA $2005 = #$00           A:00 X:00 Y:C0 P:nvUbdIZc<br />$E162:8D 05 20  STA $2005 = #$00           A:00 X:00 Y:C0 P:nvUbdIZc<br />$E165:AD 02 20  LDA $2002 = #$20           A:00 X:00 Y:C0 P:nvUbdIZc<br />$E168:A9 08     LDA #$08                   A:20 X:00 Y:C0 P:nvUbdIzc<br />$E16A:8D 06 20  STA $2006 = #$00           A:08 X:00 Y:C0 P:nvUbdIzc<br />$E16D:A9 00     LDA #$00                   A:08 X:00 Y:C0 P:nvUbdIzc<br />$E16F:8D 06 20  STA $2006 = #$00           A:00 X:00 Y:C0 P:nvUbdIZc<br />$E172:68        PLA                        A:00 X:00 Y:C0 P:nvUbdIZc<br />$E173:40        RTI                        A:C0 X:00 Y:C0 P:NvUbdIzc<br />$E14A:68        PLA                        A:C0 X:00 Y:C0 P:NvUbdizc</div><br /><br />I think I'm doing something wrong.  Perhaps people can finally look at it.<p>Statistics: Posted by Guest — Tue Jul 12, 2005 2:43 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-07-12T14:25:17-07:00</updated>
<published>2005-07-12T14:25:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2763#p2763</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2763#p2763"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2763#p2763"><![CDATA[
Okay, I wrote a simpler piece of code (in a new program).  Here it is:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">nmi:<br />   pha<br />   txa<br />   pha<br />   tya<br />   pha<br />   lda $2002<br />   lda #$00<br />   sta $2006<br />   sta $2006<br />   inc &lt;$30<br />   lda &lt;$30<br />   cmp #$C0<br />   bcs reset<br /><br />finishnmi:<br />   lda $2002<br />   lda #$00<br />   sta $2005<br />   lda &lt;$30<br />   sta $2005<br />   lda #$c0<br />   sta $c000<br />   sta $c001<br />   sta $e001<br />   cli<br />   pla<br />   tay<br />   pla<br />   tax<br />   pla<br />   rti<br /><br />reset:<br />   lda #$00<br />   sta &lt;$30<br />   jmp finishnmi<br /><br />irq:<br />   sei<br />   sta $e000<br />   pha<br />   lda $2002<br />   lda #$00<br />   sta $2005<br />   sta $2005<br />   lda $2002<br />   lda #$08<br />   sta $2006<br />   lda #$00<br />   sta $2006<br />   pla<br />   rti</div><br /><br />The problem is that it sets the whole display to what is specified in the IRQ.  It's like the IRQ takes precedence over the NMI for the whole screen.  Here's a download of the NES file so that you guys can take a look at it:<br /><br /><!-- m --><a class="postlink" href="http://www.freewebs.com/beneficii/scroll.nes">http://www.freewebs.com/beneficii/scroll.nes</a><!-- m --><br /><br />The image that gets loaded into the $2000 name table is the one I want to scroll, and the one I load into the $2800 name table is the one I don't want to.<p>Statistics: Posted by Guest — Tue Jul 12, 2005 2:25 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Memblers]]></name></author>
<updated>2005-07-12T14:28:49-07:00</updated>
<published>2005-07-12T14:24:23-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2762#p2762</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2762#p2762"/>
<title type="html"><![CDATA[Split-Screen Scrolling on the MMC3]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=402&amp;p=2762#p2762"><![CDATA[
You may need to write in the order of $2006, $2005, $2005, $2006 to get the vertical scrolling set correctly after the screen splits.  Keep in mind that'd make the first $2005 write vertical.<br /><br />And also, the CPU disables IRQs automatically while the IRQ/NMI is being run.  So the SEI instruction can be dropped there.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=10">Memblers</a> — Tue Jul 12, 2005 2:24 pm</p><hr />
]]></content>
</entry>
</feed>