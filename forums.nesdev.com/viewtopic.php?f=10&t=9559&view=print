<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Patching bin to NES rom</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Patching bin to NES rom</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=10&amp;t=9559">http://forums.nesdev.com/viewtopic.php?f=10&amp;t=9559</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>pikachumanson</b> [ Sun Dec 02, 2012 2:53 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Ok I have my code all up and ready except... I don't know how to patch the bin file to the rom. How do you do that?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>3gengames</b> [ Sun Dec 02, 2012 3:10 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Don't use the word patch, that means you take a file and change it with another file. Now, what specifically do you have? Do you have BIN files? ROMS files? Source code? What do you need to turn into a ROM?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>pikachumanson</b> [ Sun Dec 02, 2012 4:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have a dual tile encoding routine that I have assembled into a bin file using ASM6. What I want to do is insert that code into a nes rom file but I have no idea how to do it. I thought of disassembling the rom and putting the routine in but I hear it's a long and painstaking to reassemble a full rom back into working order, especially for a small asm hack. I have the asm file and the bin. I tried FCEUXD but it only takes absolute operations and not branching operations.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>3gengames</b> [ Sun Dec 02, 2012 4:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Dunno what you're talking about trying it in FCEUX without it being a ROM since you can't, but with the ASM6 file, you should have built the header for the file with assembly. I dunno how to do it as I don't and never will use ASM6, but somebody here will know. There should be some examples somewhere.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Denine</b> [ Sun Dec 02, 2012 4:17 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I guess he's making a hack of a game. He probably wants to insert his own routine in existing game.<br />Right?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>snarfblam</b> [ Sun Dec 02, 2012 4:23 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />3gengames, he is trying to assemble some code and patch it into an existing game. By doing it with FCEUX, he would open the existing game and modify it with the mini assembler included in the debugger.<br /><br />As far as disassembling/reassembling the ROM, that would be overkill.<br /><br />Either manually insert the assembled code with a hex editor, write a simple utility to patch the bin into the rom, or use software with this feature built in.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>pikachumanson</b> [ Sun Dec 02, 2012 4:33 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />@denine right. I am gonna try out snarfblam's program and hopefully it will suit me just so I can get to the fun part and translate the game.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Sun Dec 02, 2012 4:35 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />There are two ways to go about this...<br />Use a Hex editor and manually copy-paste the bytes into the NES file.  HXD is a nice hex editor.<br />or<br />Make a new ASM6 project that uses a bunch of incbins to include the original code, then put your modified code in there too, then incbin the rest of the rom.   First use a hex editor or something to find the empty space for your code.<br /><br />Example:  (hack for SMB1 that makes more koopas appear for some reason)<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.db &quot;NES&quot;,$1A,2,1,1,0,0,0,0,0,0,0,0,0<br /><br />;PRG ROM<br /><br />.org $8000<br />$ = $8000<br />incbin &quot;Super mario bros.nes&quot;, $ - $8000 + $10, $C71D - $<br />nop ;replaces sec instruction<br />incbin &quot;Super mario bros.nes&quot;, $ - $8000 + $10, $10000 - $<br /><br />;CHR ROM<br />incbin &quot;Super mario bros.nes&quot;, $8010, $2000<br /><br /></div><br /><br />Another example for Contra:  (get the spread gun when you die)<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">;NES header<br />.db &quot;NES&quot;,$1A,8,0,$21,0,0,0,0,0,0,0,0,0<br /><br />;PRG ROM<br /><br />;bank 0<br />.org $8000<br />$ = $8000<br />;copy 8000 until C000 of that bank<br />incbin &quot;contra.nes&quot;, $ - $8000 + (0*$4000) + $10, $C000 - $<br />.org $C000<br /><br />;bank 1<br />$ = $8000<br />;copy 8000 until C000 of that bank<br />incbin &quot;contra.nes&quot;, $ - $8000 + (1*$4000) + $10, $C000 - $<br />.org $C000<br /><br />;bank 2<br />$ = $8000<br />;copy 8000 until C000 of that bank<br />incbin &quot;contra.nes&quot;, $ - $8000 + (2*$4000) + $10, $C000 - $<br />.org $C000<br /><br />;bank 3<br />$ = $8000<br />;copy 8000 until C000 of that bank<br />incbin &quot;contra.nes&quot;, $ - $8000 + (3*$4000) + $10, $C000 - $<br />.org $C000<br /><br />;bank 4<br />$ = $8000<br />;copy 8000 until C000 of that bank<br />incbin &quot;contra.nes&quot;, $ - $8000 + (4*$4000) + $10, $C000 - $<br />.org $C000<br /><br />;bank 5<br />$ = $8000<br />;copy 8000 until C000 of that bank<br />incbin &quot;contra.nes&quot;, $ - $8000 + (5*$4000) + $10, $C000 - $<br />.org $C000<br /><br />;bank 6<br />$ = $8000<br />;copy 8000 until C000 of that bank<br />incbin &quot;contra.nes&quot;, $ - $8000 + (6*$4000) + $10, $C000 - $<br />.org $C000<br /><br />;bank 7 (fixed bank C000-FFFF)<br />$ = $C000<br />;we are changing code at DAD1, so copy code until $DAD1<br />incbin &quot;contra.nes&quot;, $ - $C000 + (7*$4000) + $10, $DAD1 - $<br />lda #3&nbsp; ;get spread gun when you die<br />;rest of the bank until $10000<br />incbin &quot;contra.nes&quot;, $ - $C000 + (7*$4000) + $10, $10000 - $<br /><br />;finished<br /></div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Denine</b> [ Sun Dec 02, 2012 4:49 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />For my <a href="http://www.romhacking.net/hacks/930/" class="postlink">DreamWorld Pogie Revival</a> hack, I changed some code to &quot;jsr&quot; instructions, and made them jump to my own code which I assembled beforehand and inserted with hex editor.<br />You just need to remember to be careful and not forget to do replaced actions in your new code.<br />For example:<br />Old code<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Lda #$09<br /> sta Lives<br />;;some code;;</div><br />Changed into<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">jsr $FF00 ;jump to my own code(inserted earlier with hex editor)<br /> nop<br /></div><br />And this code at $FF00<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">lda #$09<br />sta Lives    ;Redo replaced code<br /><br />;;do my own code;;<br />rts<br /></div><br />That's how I'm doing it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Sun Dec 02, 2012 4:54 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I just noticed that DreamWorld Pogie fails on the newest version of FCEUX, but works on other emulators.  Time to send in a bug report I guess.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Denine</b> [ Sun Dec 02, 2012 5:02 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That's odd. Both unpatched and patched games works perfectly for me...<br />I'm using FCEUX 2.2.0.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>pikachumanson</b> [ Sun Dec 02, 2012 11:40 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Patching bin to NES rom</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thank you everyone for the knowledge, that hex editor deal worked like a charm! And thanks for the assembler Snarfblam!

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>