<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Mesen - NES Emulator</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Mesen - NES Emulator</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=13844">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=13844</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>33</strong> of <strong>34</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>unregistered</b> [ Fri Aug 03, 2018 3:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><img src="./images/smilies/icon_redface.gif" alt=":oops:" title="Embarassed" /> Just loaded our game in .139 and the &quot;lines&quot; aren't present and all of the lua text on the screen is crystal clear.  So, obviously, you had nothing to do with the changes that I've experienced.  Changes I made before trying .164: I just changed a few outdated comments in the code and added the new mesen into the folder (and renamed the newest mesen I have &quot;mesen.exe&quot; and renamed the .139 mesen back to &quot;MesenDevWin-0.9.5.139.exe&quot;).  God blessed our game again!!  <img src="./images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" />   Sorry for my bogus report to you Sour.  Glad you are going to create 0.9.6. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sour</b> [ Fri Aug 03, 2018 3:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />No worries.  FYI, the issue with the Lua text being unclear is usually caused by using blargg's NTSC filter.  Due to the way things are internally, I have no simple way of making the text appear properly when using that one particular filter at the moment.  I'm guessing that's probably what was causing issues on your end.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Fri Aug 03, 2018 5:03 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I finished to install Sierra/High sierra on a different partition and here's the result of my test<br /><br />[Sierra]<br />- Windows version <br />   - works but screen scaling issue<br />   - debugger is sluggish<br />- SDL version (from link in thread)<br />   - work with screen normal size, refresh seems sluggish<br />   - debugger is slugish<br /><br />[High sierra]<br />- Windows version<br />   - works but screen scaling issue<br />   - debugger seems more sluggish than sierra<br />- SDL version (from link in thread)<br />   - work with screen normal size, refresh seems sluggish<br />   - debugger seems more sluggish than sierra<br /><br />The good news is that is it working on high sierra with wine 3.0.2, dotnet45 but it is slow.  The bad news for me is that I cannot make it work on my main partition and I don't know why <img src="./images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />I will keep both partition for now and can test some builds to see if it becomes faster. For now, in it current state, compared to when I'm using it on a latest machine with linux or a 10 years old pc on Windows, it's too slow to be usable. Only testing different build will allows us to figure out performance issues.<br /><br />This ends my report.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sour</b> [ Fri Aug 03, 2018 7:48 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks for taking the time to check all of this. Good to know it actually runs on your new installation, hopefully you can figure out what's causing it to crash on your regular setup.<br /><br />I can reproduce essentially the same performance issues on Linux when I run the Windows SDL build using Wine, so that at least gives me a relatively decent way to figure out what's causing the slowdowns through trial and error.  Is it mostly just the debugger tools that are slow on your end?  I seem to recall the regular configuration dialogs working relatively well under Wine.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Fri Aug 03, 2018 8:03 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The normal version, since the scaling is broken, it is hard to judge if the speed is normal but on the SDL version, even though it shows 60 fps, the refresh is not smooth compared to other platform.  If I can get the win version to work properly then I could confirm if the same problem occur.  <br /><br />I remember that you mentioned a parameter to start the emulator but I do not think it was for fixing that issue, isn't it? I cannot find it back in this thread (or was it in another thread).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sour</b> [ Sat Aug 04, 2018 8:53 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Looking back at the code for the windows SDL version, I had set it to use software rendering because hardware rendering refused to work, but that might have been specific to my macOS VM.  I'll have to try setting it to hardware rendering again to see.  Although arguably it might be easier to try to fix the aspect ratio under Wine with the DX11 build (since it would be much easier for me in terms of code/maintenance)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Sat Aug 04, 2018 8:11 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I just don't know why it does that either on wine. I think on my linux pc I used mono with with the windows version and everything was fine. I was not able to run mono properly on the mac so I may try again since the performance was better on linux so hopefully I may see the same thing on the mac performance wise.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sour</b> [ Sun Aug 05, 2018 8:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I just released <a href="https://github.com/SourMesen/Mesen/releases/tag/0.9.6" class="postlink">0.9.6</a> earlier today.  There are over 300 commits in this release, which probably makes it the largest release since 0.1.0 in terms of commits (so it's a bit hard to give a full list of everything that's been done).  Debugger-wise, there's been a lot of small additions/improvements/bugfixes in a lot of the debugging tools. Linux-wise, this build should run the emulation ~20-30% faster than the official 0.9.5 release thanks to PGO, and a lot of debugger UI issues have been fixed, too.<br /><br />Also, I've recently discovered that Mono has a tool to produce a native Linux binary from a .NET executable and it actually seems to work properly as far as Mesen goes.  This means it would be possible to release a Linux-only 64-bit build that's only about 10-15mb in size and does not require Mono to be installed at all (its only dependency would be SDL2), which would make using Mesen easier for first time users (and would avoid forcing people to download the entire mono package)<br /><br /><div class="quotetitle">Banshaku wrote:</div><div class="quotecontent">I think on my linux pc I used mono with with the windows version and everything was fine</div>The official build actually contains both windows &amp; linux binaries - so running it on Mono on Linux will run the native Linux SDL build, rather than the DX11 build.  The scaling issue is most likely a DX11 issue w/ Wine, but maybe I can find a workaround for it.<br />Mono Winforms on macOS is horribly broken as far as I can tell, so it's probably not worth the effort trying to get it to work on mono on macOS at the moment (until winforms support is fixed on macOS, if ever)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Sun Aug 05, 2018 8:20 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I see. I will try the new build on linux and see how fast it is.<br /><br />As for Mono on mac, yep, they say it when you start an app about carbon version, 32 bits etc so I tried on both sierra version and it fails in both cases.  I'm only using mac os because of bash and to backup the phone so I'm starting to get less and less interested in the os now that I'm not using it for work.  I tried to remove homebrew, zap the wine folder, reinstall everything related and still doesn't work. I'm not in the mood to reinstall the os for now so I think I will just keep an extra partition to give feedback on how the latest version works on mac.<br /><br />I could install linux on another partition but the keyboard layout is a pain, some part doesn't work (the camera wasn't years ago, maybe it works now) so unless I always use with an external keyboard, I don't know how comfortable it would be. But this is my personal problem, not really mesen related <img src="./images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />It's butter smooth on and old core 2 duo so I may start to use windows with the linux subsystem for now.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Mon Aug 06, 2018 4:49 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Crash report:<br /><br />Open N163TEST.NES from this post: <!-- l --><a class="postlink-local" href="https://forums.nesdev.com/viewtopic.php?p=222711#p222711">viewtopic.php?p=222711#p222711</a><!-- l --><br /><br />After it starts running, go to Debug menu and open Debugger. Will crash immediately.<br /><br />A screenshot of the crash window is attached. After clicking OK Mesen is unresponsive and has to be force closed.

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<a href="./download/file.php?id=13247&amp;mode=view"><img src="./download/file.php?id=13247&amp;t=1" alt="N163TEST_debugger_crash.png" /></a><br />
			<span class="gensmall">N163TEST_debugger_crash.png [ 41.92 KiB | Viewed 207 times ]</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sour</b> [ Mon Aug 06, 2018 5:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks - this is because the NES 2.0 header gives it 128bytes of work ram, and Mesen only has 256-byte granularity on these sort of things. This ends up mapping null pointers to a section of ram and causes a crash in the debugger.<br /><br />After changing the header to say no work ram (I thought a discussion a long time ago had concluded that the internal RAM for this mapper shouldn't be counted in the header? Unsure.), it boots, but then the ROM assumes that code will be available at $8000 without initializing the PRG banking register for it, so Mesen leaves that portion as open bus and doesn't boot properly.  I guess I could change this to select random banks instead of open bus, but unless that test contains the same 8kb bank copied 4 times over, it won't work reliably still.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Aug 06, 2018 5:28 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Sour wrote:</div><div class="quotecontent">it boots, but then the ROM assumes that code will be available at $8000 without initializing the PRG banking register for it, so Mesen leaves that portion as open bus and doesn't boot properly.  I guess I could change this to select random banks instead of open bus</div><br />How do you boot games using mapper 66 (GNROM), 11 (Color Dreams), 34 (BNROM), or 7 (AOROM)?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sour</b> [ Mon Aug 06, 2018 5:37 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Those will select a random bank and boot from there - but then that makes sense for those mappers.  I guess you could argue that someone using the Namco 163 could set the reset vector to $8000 and copy the reset code to all banks (e.g like this rom most likely does), but in practice this potentially wastes a lot of PRG space, so I imagine nobody ever did this back then.<br /><br />I usually kept these kinds of scenarios as open bus where possible to avoid homebrew devs forgetting to initialize the banking registers (or relying on a power on state that doesn't exist on hardware), but I guess I could just make them random instead.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Mon Aug 06, 2018 5:45 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Sour wrote:</div><div class="quotecontent">I usually kept these kinds of scenarios as open bus where possible to avoid homebrew devs forgetting to initialize the banking registers (or relying on a power on state that doesn't exist on hardware), but I guess I could just make them random instead.</div><br />I thought it was already randomized if you used the Emulation &gt; Advanced &gt; &quot;Randomize power-on state for mappers&quot; option?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Sour</b> [ Mon Aug 06, 2018 7:24 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Mesen - NES Emulator</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">I thought it was already randomized if you used the Emulation &gt; Advanced &gt; &quot;Randomize power-on state for mappers&quot; option?</div>The current implementation only does it for some (~20) mappers - but now that I think about it, I could easily randomize all the banks that are currently left as open bus (whether that option is enabled or not).  That would likely cover the vast majority of mappers (at least those likely to be used in homebrew dev or rom hacks), would technically be more accurate than leaving it as open bus, and would allow cases like this test rom to work properly.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>33</strong> of <strong>34</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>