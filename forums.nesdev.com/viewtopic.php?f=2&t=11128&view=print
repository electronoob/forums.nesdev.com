<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - NES color palette - why?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">NES color palette - why?</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=11128">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=11128</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>seven</b> [ Fri Mar 28, 2014 10:28 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The NES has a 64 color palette, but 9 of those colors are black. Does anyone know why? Was it due to hardware limitations or poor design? It's a simple question but Google couldn't tell me.<br /><br />Also, why does the NES have more blues than greens or reds? It seems like a strange choice.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Fri Mar 28, 2014 10:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The NES palette wasn't designed in the sense that someone picked a nice set of colors that artists would like to use in their games, it was designed to be easily generated by simple hardware. If you have to put it this way, yes, it's a hardware limitation.<br /><br />I can't explain the specifics (I'm sure someone else who understands PAL and NTSC signals in great detail will), but NES colors are generated by square waves of different frequencies, and I'm sure Nintendo was as cheap as possible when deciding how to calculate these waves.<br /><br /><a href="http://wiki.nesdev.com/w/index.php/NTSC_video" class="postlink">This page</a> explains a bit about how the video signal is generated (I can't understand most of it!).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Fri Mar 28, 2014 11:02 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The color video signal is generated by 12 different possible square waves, each is delayed 0 to 11 master clock cycles.  They can be at 4 different brightness levels.  So that's 48 colors there.<br />Then the first column has no color and is only gray, it has three different brightness levels, then a second copy of white.<br />Then there's that column that has weird black (blacker than black), black, and two gray levels.<br />Then the rest of the colors are all black for some reason.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Fri Mar 28, 2014 11:13 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The NES palette is natively generated in the <a href="https://en.wikipedia.org/wiki/YIQ" class="postlink">YIQ color space</a>: one choice of hue or saturation, and one choice of brightness. A lot of the nitty-gritty is described <a href="http://wiki.nesdev.com/w/index.php/NTSC_video" class="postlink">on our wiki</a>.<br /><br />Why only twelve angles, in contrast to the 2600's fifteen? The 2600 generates its colors using a series of inverters and RC delays to produce a series of angles around the color wheel. This process is analog, and so comparatively sensitive to noise, voltage rail fluctuations, and process variation. The NES, on the other hand, uses a series of clock dividers for an all-digital color signal until the final output DAC; in this manner a master clock of 6× the color subcarrier for the region (NTSC: 3.58MHz; PAL: 4.43MHz) can produce 12 different hues.<br /><br />So why not a 7× crystal? Dividing by odd numbers is more complicated (while maintaining a 50% duty cycle) than dividing by even numbers. It would also have made the pixel clock different, and so implied a different number of pixels horizontally on screen (240 or 300 instead of 256). Nintendo may have started with the width (inherited from many of its predecessors, including the ColecoVision) and worked from there; at this point they would have to pick some multiple of 10.7MHz to both generate the (5.4MHz) pixel clock and the color subcarrier (3.6MHz).<br /><br />How did they choose the specific brightnesses they did, and why did they not provide more? That I can't say. There's a lot of room within the same fundamental structure (selecting one of 12 different clock phases, driving different taps on a DAC) for a much wider range of brightnesses and saturations then they provided. Without any other changes at all, they could have added a single wire to provide four extra shades of grey (the average of the $x0 and $xD greys, even though those would be fairly close to the five greys already provided).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>OneCrudeDude</b> [ Sat Mar 29, 2014 8:49 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />So would that be the reason why the NES doesn't have a proper yellow?  Unless this was considered a normal way to generate colors, it seems quite awkward using square waves.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Sat Mar 29, 2014 9:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">OneCrudeDude wrote:</div><div class="quotecontent">Unless this was considered a normal way to generate colors, it seems quite awkward using square waves.<br /></div>The square waves is actually just a red herring. (The difference between a square wave and the sine wave that it's supposed to be, as far as NTSC is concerned, will only be visible with neighboring pixels of differing colors. By the Fourier transform, a square wave is made of a set of sine waves of odd multiples of the fundamental, but the first overtone at 3×3.6MHz is well above the 5-7MHz bandwidth of NTSC).<br /><div class="quotetitle">OneCrudeDude wrote:</div><div class="quotecontent">So would that be the reason why the NES doesn't have a proper yellow?<br /></div>The lackluster color set is because the NES's phases are evenly spaced around the YIQ colorspace (every 30°). The only colors (per the <a href="https://en.wikipedia.org/wiki/Vectorscope" class="postlink">vectorscopes</a> that were used to diagnose NTSC color woes) that happened to align to the 2C02's output were <a href="https://en.wikipedia.org/wiki/File:Vectorscope_graticule.png" class="postlink">purple (+120°) and green(-60°)</a>.<br /><br />The PAL NES's colorspace is rotated by 15° relative to the NTSC NES, and so provides a comparatively nice red (+75°), yellow (+15°), blue (-165°) and cyan (-105°), at the cost of less satisfying purple and green. The lack of control over saturation is still unfortunate.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>seven</b> [ Sun Mar 30, 2014 12:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks for picking up my question so quickly! You guys are great <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />OK, so my understanding so far is that the NES can generate 12 hues (actually delayed square waves?) at 4 different brightness levels, 12 * 4 = 48 colors. These hues (and colors) are not hand-picked but are evenly spaced along the YIQ color wheel. The hardware could have supported another 2 hues (thus 8 more colors) but this would require dividing 7 by 2 and would have made programming more complicated, so they didn't do it. Uh, why not an 8x crystal then? 16 * 4 = 64, which seems perfect... Anyway this is the reason those colors are unused, just copies of black.<br /><br />If I'm not getting it could you explain it to me like I'm five? I think I need a more intuitive understanding before I can get into things like vectorscopes.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Mar 30, 2014 1:38 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />An 8x crystal would have meant no grays.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Sun Mar 30, 2014 2:12 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">seven wrote:</div><div class="quotecontent">Uh, why not an 8x crystal then? 16 * 4 = 64, which seems perfect...<br /></div>Well, two possible things:<br />1- That doesn't leave any space for any greys. Retaining the greys would have required omitting some phase, which .. while doable, I'm not certain what they'd pick. (If you had to omit a column of color from the <a href="https://en.wikipedia.org/wiki/List_of_videogame_consoles_palettes#Atari_2600" class="postlink">2600's palette</a>, how would you choose?)<br />2- That still implies a different number of pixels horizontally on a line. The two closest possible on-screen widths would be 272 (×8÷5) or ≈224 (×8÷6)  (instead of 256 (×6÷4))<br /><br />I'm also under the impression, based on what people have said when they've talked about drawing for the NES, that the set of hues the NES provides, while restrictive, isn't really the problem; they usually wish they had access to more varied choices of brightness (and occasionally saturation).<br /><br />As a (hopefully not misleading?) example, the Wikipedia articles on <a href="https://en.wikipedia.org/wiki/List_of_palettes" class="postlink">color palettes</a> use a picture of a <a href="https://en.wikipedia.org/wiki/File:RGB_24bits_palette_sample_image.jpg" class="postlink">parrot</a> and a <a href="https://en.wikipedia.org/wiki/File:RGB_24bits_palette_color_test_chart.png" class="postlink">color test chart</a>. If I quantize each of hue/saturation/brightness to the 12 hues/boolean saturation/4 brightnesses the NES can provide, while letting the other properties vary continuously, I get the following pictures:<div class="attachtitle">Attachment:</div><div class="attachcontent">
			<img src="./download/file.php?id=1392" alt="color-test-chart-quantized.png" /><br />
			<span class="gensmall">color-test-chart-quantized.png [ 7.83 KiB | Viewed 672 times ]</span>
		

		<br />
	</div>(The color test chart doesn't have a &quot;yes/no saturation&quot; demonstration because the image is fully saturated)<div class="attachtitle">Attachment:</div><div class="attachcontent">
			<a href="./download/file.php?id=1393&amp;mode=view"><img src="./download/file.php?id=1393&amp;t=1" alt="parrot-quantized.jpg" /></a><br />
			<span class="gensmall">parrot-quantized.jpg [ 65.35 KiB | Viewed 672 times ]</span>
		

		<br />
	</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Mar 30, 2014 3:00 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">lidnariq wrote:</div><div class="quotecontent">2- That still implies a different number of pixels horizontally on a line. The two closest possible on-screen widths would be 272 (×8÷5) or ≈224 (×8÷6)  (instead of 256 (×6÷4))</div><br />At least CB×8÷5 would have been closer to square pixels. (Exact square pixels are CB×12÷7.)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Drag</b> [ Wed Apr 02, 2014 11:52 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I think, all things considered, the NES's palette is extremely capable; it's mostly the limited number of simultaneous colors that tends to be the wrench, at least for me.<br /><br />At least, when you work with limited RGB based palettes (like R, G, and B all being 2 bits), it's hard to get the color you want because red, green, and blue all have different luminosities, and to get the brightness you want, you often have to skew the hue or deal with desaturating it, and although RGB is a simpler concept to grasp, the NES's luma/chroma system offers a better selection of colors that are more balanced overall, so I tend to prefer that. Yeah, not having finer control over saturation is a pain sometimes, but with a little practice, any pixel artist should be able to overcome it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>psycopathicteen</b> [ Thu Apr 03, 2014 6:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I always wondered how an extended version of the NES color palette would've looked like.<br /><br />Maybe have it in the format:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">ppppllllhhhh<br />p: phase<br />l: lower bound (0 is -.333, 15 is 1.333)<br />w: higher bound (0 is -.333, 15 is 1.333)<br /></div><br /><br />and have a ROM table lookup of the best 256 colors, with the first 64 colors from the original palette.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Thu Apr 03, 2014 7:24 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />For NTSC, it turns out that if you have a N-bit DAC clocked at exactly 3×CB, you can map each of the three samples in sequence to an R, G, and B component. You don't even need a real modulator; just the right choice of RGB to produce hue -U for colorburst.<br /><br />In any case, the problem with the NES is mostly figuring out how to represent a useful palette and pack it into 8 bits. Above 8 bits, I figure you may as well provide a TrueColor representation, even with the caveats that Drag mentioned.<br /><br />The 2600's 3 bits of luma, 4 bits of hue is pretty good. If I were going to extend the NES's master palette, I'd probably use that, and maybe add a bit for high/low saturation.<br /><br />Using a 7× crystal has the nifty property that 7/4 is very very close to 12/7: the pixel aspect ratio is 48/49. It'd be ~300 pixels wide at that dotclock.<br /><br />I might also try something a little more like what the NES provides, but not coupling high and low lumas together.<br />- three bits of phase information (none, 6 from a half of the NES palette, one for averages of luma for extra greys)<br />- three bits of luma_1 (maybe 0,2,4,6,8,10,12,14)<br />- two bits of luma_2 (maybe 1,5,9,13)<br />You only need half the phase information here because part of it's encoded in whether luma_1 &gt; luma_2 or vice versa.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>psycopathicteen</b> [ Sat Apr 05, 2014 1:38 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Wouldn't you need luma values over 100% for a fully saturated yellow?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Sat Apr 05, 2014 4:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES color palette - why?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yeah. We're kinda hamstrung by the standards inadvertently specifying the intersection of the RGB colorspace with the YIQ colorspace. And if we generate the video natively in HSL (phase/amplitude/DC), that's a third colorspace constraint, leading to either a lot of desaturated colors or a lot of out of gamut ones.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>