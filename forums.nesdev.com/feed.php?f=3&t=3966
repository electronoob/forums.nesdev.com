<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="https://forums.nesdev.com/feed.php?f=3&amp;t=3966" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="https://forums.nesdev.com/index.php" />
<updated>2013-08-07T11:47:07-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>https://forums.nesdev.com/feed.php?f=3&amp;t=3966</id>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2013-08-07T11:47:07-07:00</updated>
<published>2013-08-07T11:47:07-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=116155#p116155</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=116155#p116155"/>
<title type="html"><![CDATA[Re: ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=116155#p116155"><![CDATA[
Cpow's archived most of the known test roms here (including this one)-<br /><!-- m --><a class="postlink" href="https://github.com/christopherpow/nes-test-roms">https://github.com/christopherpow/nes-test-roms</a><!-- m --><p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Wed Aug 07, 2013 11:47 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2013-08-07T11:45:16-07:00</updated>
<published>2013-08-07T11:45:16-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=116154#p116154</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=116154#p116154"/>
<title type="html"><![CDATA[Re: ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=116154#p116154"><![CDATA[
I would, but applying the mapping from <a href="http://forums.nesdev.com/viewtopic.php?p=107763#p107763" class="postlink">blargg's previous post</a> gives a 404.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Wed Aug 07, 2013 11:45 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2013-08-07T10:57:15-07:00</updated>
<published>2013-08-07T10:57:15-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=116149#p116149</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=116149#p116149"/>
<title type="html"><![CDATA[Re: ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=116149#p116149"><![CDATA[
*bump* Could someone update the link for the test ROM, please? ^_^;;<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Wed Aug 07, 2013 10:57 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2008-07-05T09:03:41-07:00</updated>
<published>2008-07-05T09:03:41-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34646#p34646</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34646#p34646"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34646#p34646"><![CDATA[
OK, I got it. Thanks a lot. ^_^;;<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sat Jul 05, 2008 9:03 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-07-05T09:01:54-07:00</updated>
<published>2008-07-05T09:01:54-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34645#p34645</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34645#p34645"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34645#p34645"><![CDATA[
Correct for both. If (abs&amp;0xFF)+X &gt; 0xFF, then LDA abs,X makes a dummy read from (abs&amp;0xFF00) | (abs+X)&amp;0xFF, or more simply in an emulator, abs+X-0x100 (since you know it's going to generate a carry in this case, you can just subtract it).<br /><br />The accumulator (and flags) does not change. Internally the CPU does a memory access every cycle. In this case, it sees that there was a carry when adding X to the low byte of the address, so it throws away the value read from memory, then increments the high byte of the address and then accesses the correct byte of memory.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sat Jul 05, 2008 9:01 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2008-07-05T04:24:21-07:00</updated>
<published>2008-07-05T04:24:21-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34642#p34642</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34642#p34642"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34642#p34642"><![CDATA[
So, the accumulator does not change?<br /><br />Additionally, there's another problem: in the test rom, there's a lda 3FE0+22 (X indexed), making a dummy read from 3F02. Yes, it is a page cross, but my cpu core takes the <em>effective sum</em>, reading from 3FE0+22 = <strong>4002</strong>, instead of 3FE0. So, should it read from <em>offset&amp;0xFF00 + (offset+X)&amp;0xFF</em> for every page crossing?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sat Jul 05, 2008 4:24 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-07-04T19:01:47-07:00</updated>
<published>2008-07-04T19:01:47-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34640#p34640</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34640#p34640"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34640#p34640"><![CDATA[
A dummy read is simply one whose result is ignored by the CPU; in all other aspects it is a normal read. So a dummy read of $2002 should clear the VBL flag, etc. just as a normal read would.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Fri Jul 04, 2008 7:01 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2008-07-04T18:32:44-07:00</updated>
<published>2008-07-04T18:32:44-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34639#p34639</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34639#p34639"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=34639#p34639"><![CDATA[
- I didn't get it yet. Like, lda $20E0+22 does a dummy read from $2002, but what data is actually fetched? Garbage?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Fri Jul 04, 2008 6:32 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Bregalad]]></name></author>
<updated>2008-03-15T01:46:07-07:00</updated>
<published>2008-03-15T01:46:07-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31662#p31662</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31662#p31662"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31662#p31662"><![CDATA[
Yeah. If (# of cycles the instruction takes - # of bytes the instruction is - #of reads/writes the instruction is supposed to do) is greater than zero, then you get dummy read and writes.<br /><br />For example lda [$00],Y takes 2 bytes, is supposed to read $00 and $01, and to read the adress pointed in [$00],Y. So it's supposed to do 5 memory acesses, and the instruction takes 5 cycles, so you know there is no extra read or write. That's easy enough.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> — Sat Mar 15, 2008 1:46 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[dvdmth]]></name></author>
<updated>2008-03-14T17:55:18-07:00</updated>
<published>2008-03-14T17:55:18-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31661#p31661</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31661#p31661"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31661#p31661"><![CDATA[
RMW instructions (e.g. ASL $0246, X) will also perform a dummy read regardless of whether or not a page boundary is crossed.  RMW instructions also include the famous "dummy write" where the memory address gets written twice, once with the old value and once with the new value.<br /><br />Branch instructions may contain up to two dummy PC reads, depending on where the branch goes and whether a page boundary is crossed.<br /><br />JSR has a dummy stack read before anything gets pushed to the stack (no idea why).  All stack pull instructions (PLA, PLP, RTI, and RTS) have a dummy stack read before S is incremented.  Further, RTS has a dummy PC read before the return address is incremented.<br /><br />All single-byte instructions have a dummy PC read during the second cycle, at the address of the next instruction.<br /><br />The modes Zp,X, Zp,Y, and (Zp,X) all have a dummy read in zero page, at the base address (before X or Y is added).<br /><br />BRK's second instruction byte is read in the second cycle of the instruction.<br /><br />Remember that a memory access occurs on every clock cycle, so if an instruction takes five cycles, there are five accesses (no more, no less).  Of course, a lot of these dummy reads don't really have any consequence - the only real important ones are the indexed addressing modes and the extra write during RMW instructions.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=360">dvdmth</a> — Fri Mar 14, 2008 5:55 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Disch]]></name></author>
<updated>2008-03-14T10:40:12-07:00</updated>
<published>2008-03-14T10:40:12-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31643#p31643</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31643#p31643"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31643#p31643"><![CDATA[
LDA $4016,X is fine because it only reads $4016 once (assuming X is zero)<br /><br />For read-only ops... the dummy read is only performed when an extra cycle is used (when X crosses a page boundary).<br /><br />For write ops like STA... the dummy read is performed every time (which is why STA always takes an extra cycle even if it doesn't cross a page boundary)<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=33">Disch</a> — Fri Mar 14, 2008 10:40 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-03-14T10:36:35-07:00</updated>
<published>2008-03-14T10:36:35-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31642#p31642</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31642#p31642"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31642#p31642"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Does this means that lda $4016,X won't work<br /></div><br />It'll work fine since there is no carry generated when the index is added to the low byte of the address. The source code for the test ROM covers it pretty well. I always suggest people read it since it's the final word on what is really being tested.<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">ldx #$22<br />lda $2000,x     ; no dummy read<br /><br />ldx #$22<br />lda $20E0,x     ; dummy read from $2002<br />   <br />ldx #$22<br />lda $20E2,x     ; dummy read from $2004<br />   <br />ldx #$22<br />lda $3FE0,x     ; dummy read from $3F02</div><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Some other things come to mind, like the timing of these accesses, and RMW instructions write testing (maybe use $2007 for that).<br /></div><br />Yes, I want to make a full instruction timing test some time that verifies the timing of every non-opcode access.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Fri Mar 14, 2008 10:36 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Bregalad]]></name></author>
<updated>2008-03-14T10:00:49-07:00</updated>
<published>2008-03-14T10:00:49-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31641#p31641</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31641#p31641"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31641#p31641"><![CDATA[
Does this means that lda $4016,X won't work (assuming X is #0 for joypad #1 and X is #1 for joypad #2), because it wil do a dummy read and then you'll get only one bits out of two from the serial joypad port ?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> — Fri Mar 14, 2008 10:00 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[hap]]></name></author>
<updated>2008-03-14T06:34:55-07:00</updated>
<published>2008-03-14T06:34:55-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31637#p31637</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31637#p31637"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31637#p31637"><![CDATA[
Some other things come to mind, like the timing of these accesses, and RMW instructions write testing (maybe use $2007 for that).<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=115">hap</a> — Fri Mar 14, 2008 6:34 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2010-03-17T11:34:49-07:00</updated>
<published>2008-03-13T13:58:24-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31629#p31629</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31629#p31629"/>
<title type="html"><![CDATA[ABS,X and (ZP),Y dummy read test ROM]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=3966&amp;p=31629#p31629"><![CDATA[
I put together a test ROM to verify the addressing modes which have dummy reads. It tests STA and LDA with modes (ZP,X), (ZP),Y and ABS,X. Dummy reads are made for the following cases:<br /><br />STA ABS,X or (ZP),Y<br />LDA ABS,X or (ZP),Y when carry is generated from low byte<br /><br />The dummy read is at (ABS &amp; 0xFF00) | ((ABS + index) &amp; 0xFF). Presumably the same applies to the many other read instructions like ADC, ORA, CMP, etc. <br /><br />Test ROM and full ca65 source code: <a href="http://blargg.parodius.com/temp/cpu_dummy_reads.zip" class="postlink">cpu_dummy_reads.zip</a><p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Thu Mar 13, 2008 1:58 pm</p><hr />
]]></content>
</entry>
</feed>