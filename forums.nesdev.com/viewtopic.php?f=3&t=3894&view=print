<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Schpune for Mac OSX / *nix systems.</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Schpune for Mac OSX / *nix systems.</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=3894">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=3894</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>B00daW</b> [ Mon Feb 11, 2008 7:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Schpune for Mac OSX / *nix systems.</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />If I wasn't stuck on Windows for all of my music development, I'd be using <a href="http://www.romhacking.net/forum/index.php/topic,5648.0.html" class="postlink">this Schpune</a>.
<br />
<br />Latest development:
<br /><div class="quotetitle">Parasyte wrote:</div><div class="quotecontent"><a href="http://parasyte.kodewerx.net/projects/schpune/schpune-0.1.2.tar.gz" class="postlink">Version 0.1.2 (2/7/2008)</a>:<br />        * Fixed Unicode issues.  Unicode builds should now work. (Disch)<br />        * Added patch to fix Unicode build with g++. (Parasyte)<br />        * Added support for --enable-unicode and --enable-debug in configure<br />          script. (Parasyte)</div>
<br />If <strong>Disch <em>or</em> Parasyte</strong> were ever so kind to mirror the developments into this thread, it would be neato, fresh, keen, l33t. K? <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mattmatteh</b> [ Thu Feb 14, 2008 11:58 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />fails to compile using wxGTK 2.6 with ansi:
<br />configfile.cpp:35: error: 'class wxStandardPathsBase' has no member named 'GetExecutablePath'
<br />
<br />
<br />fails to compile using wxGTK 2.6 with unicode:
<br />mapperdlg.cpp:84: error: conversion from 'const ch_t*' to 'const wxString' is ambiguous
<br />
<br />
<br />fails to compile using wxGTK 2.8:
<br />mapperdlg.cpp:84: error: conversion from 'const ch_t*' to 'const wxString' is ambiguous
<br />
<br />
<br />matt

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Disch</b> [ Thu Feb 14, 2008 12:34 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Schpune for Mac OSX / *nix systems.</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">B00daW wrote:</div><div class="quotecontent">If <strong>Disch <em>or</em> Parasyte</strong> were ever so kind to mirror the developments into this thread, it would be neato, fresh, keen, l33t. K? :D</div><br /><br />I don't really want to post on dozens of different messageboards every time I update something.  The fact of the matter is it's still a very early WIP, so I didn't even really want to make a thread about it at all (I just kind of piggybacked Parasyte's thread on that board).<br /><br />It seems like other people are more interested in advertising the emu than I am.  =P  personally I think I'd rather wait until it's something more substantive before hyping it up.<br /><br />But anyway I don't mind other people posting things about it.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">configfile.cpp:35: error: 'class wxStandardPathsBase' has no member named 'GetExecutablePath'</div><br /><br />It should.  Perhaps you need v2.8 for that.<br /><br />I'm currently using 2.8.7<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">mapperdlg.cpp:84: error: conversion from 'const ch_t*' to 'const wxString' is ambiguous</div>
<br />
<br />Parasyte was having these same problems with unicode builds.  The problem was that I was typedefing as 'unsigned short', but he needed 'wchar_t'.  See line ~60 of nes_types.h.  Perhaps wchar_t isn't working for you... or perhaps UNICODE is not being defined (there is no #define in the code anywhere, it should be a compiler option)
<br />
<br />I didn't want to include any hint of wx in the emulator core (which is where ch_t is used).  But apparently there are typedefing nightmares when converting to wxString.  I'm open to suggestions on how to avoid these problems.  The only thing I can think of would be to conditionally typedef ch_t to whatever the compiler needs with a barrage of #ifdefs -- but that's insanely ugly.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Feb 14, 2008 1:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Schpune for Mac OSX / *nix systems.</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Disch wrote:</div><div class="quotecontent">I didn't want to include any hint of wx in the emulator core (which is where ch_t is used).  But apparently there are typedefing nightmares when converting to wxString.  I'm open to suggestions on how to avoid these problems.  The only thing I can think of would be to conditionally typedef ch_t to whatever the compiler needs with a barrage of #ifdefs -- but that's insanely ugly.</div>
<br />That's what a project's config.h is for.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mattmatteh</b> [ Thu Feb 14, 2008 1:51 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />i dont understand why there is a conversion needed.  could you just use wchar_t or char as decribed here <!-- m --><a class="postlink" href="http://www.wxwidgets.org/manuals/2.8/wx_unicode.html">http://www.wxwidgets.org/manuals/2.8/wx_unicode.html</a><!-- m --> ?
<br />
<br />seems like you are using char when you should be using wchar_t ?
<br />
<br />matt

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Disch</b> [ Thu Feb 14, 2008 2:06 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">mattmatteh wrote:</div><div class="quotecontent">i dont understand why there is a conversion needed.</div><br /><br />The emu core uses C-style strings (char or wide char pointers).  The GUI uses the wxString class.  A conversion is required to build a wxString object from the core's C-style strings.<br /><br />This is not a conversion from ANSI to Unicode or vice versa.  Such a conversion should never take place.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">could you just use wchar_t or char</div><br /><br />I am.  See line ~60 of nes_types.h<br /><br />wchar_t if UNICODE is defined<br />char otherwise (ANSI)<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">seems like you are using char when you should be using wchar_t ?</div>
<br />
<br />If it's using char in a unicode build, then UNICODE isn't being defined by your compiler.  I'm still a MSVS boy so I'm not sure how to go about defining this in other compilers -- I thought Parasyte had already taken care of it in his support files.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mattmatteh</b> [ Thu Feb 14, 2008 2:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />i see
<br />
<br />#ifdef UNICODE
<br />typedef unsigned short                  ch_t;
<br />
<br />that looks wrong, i was thinking it should be wchar_t ?
<br />------------------------------------
<br />i looked on wxwidgets site and that function chagned from 2.6 to 2.8.
<br />
<br />but in either version i think you should be using wxstring instead of 
<br />const ch_t*             szToggleTitle;
<br />
<br />the compiler is doing conversions and failing.  perhaps you could just use string ? or if you want to keep the core separate, write a class or function to handle transitions ?
<br />
<br />matt

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Disch</b> [ Thu Feb 14, 2008 2:38 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">mattmatteh wrote:</div><div class="quotecontent">i see<br /><br />#ifdef UNICODE<br />typedef unsigned short                  ch_t;<br /><br />that looks wrong, i was thinking it should be wchar_t ?<br /></div><br /><br />That must be an older version.  I thought Parasyte uploaded the newer one with a fix:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">/*<br />&nbsp;*&nbsp; &nbsp;For strings<br />&nbsp;*/<br />#ifdef UNICODE<br /><br />#ifdef _MSC_VER<br />typedef unsigned short&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ch_t;<br />#else // _MSC_VER<br />typedef wchar_t&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ch_t;<br />#endif // _MSC_VER<br /><br />#define shT&#40;t&#41;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;L##t<br /><br />#else // UNICODE&nbsp; &#40;not unicode&#41;<br /><br />typedef char&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;ch_t;<br />#define&nbsp; &nbsp;&nbsp; shT&#40;t&#41;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;t<br /><br />#endif // UNICODE<br /></div><br /><br />The _MSC_VER check may not be needed.  I had problems compiling with wchar_t... but that might have been due to how I built wx.  I'll rebuild my wx again later and see if I can get Schpune working with wchar_t all the time.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">but in either version i think you should be using wxstring instead of <br />const ch_t*             szToggleTitle;<br /></div><br /><br />That is not an option.  I want the emu core to be free of any and all external libraries.  There may come a time in the future where I want to build this for a platform wx or whatever aren't handling... or maybe I'll want to drag and drop the emu core into another program.  Having unnecessary bindings to wx would require me to gut and redo large portions of the code in order to accomplish that.<br /><br /><br />Not to mention it would <em>kill</em> compile times if I'm including wx in everything.  Compile times are already long enough.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">the compiler is doing conversions and failing.  perhaps you could just use string ? or if you want to keep the core separate, write a class or function to handle transitions ?</div>
<br />
<br />Well wxString should be doing the conversions.  It has ctors to convert from the appropriate source.  It's just a matter of getting the types right.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Feb 14, 2008 2:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Is there an advantage of using wchar_t (in UTF-16 encoding) over using char (in UTF-8 encoding)?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mattmatteh</b> [ Thu Feb 14, 2008 2:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />well, ill let you work on that.  let me know if you want me to test again.
<br />
<br />i agree with what tepples said, all those ifdef's belong in src/config.h
<br />
<br />and i keep them to a minimum.
<br />
<br />matt

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Disch</b> [ Thu Feb 14, 2008 3:24 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Is there an advantage of using wchar_t (in UTF-16 encoding) over using char (in UTF-8 encoding)?</div><br /><br />Some APIs don't take UTF-8 encoded strings.  Apart from that, I don't think so.  I think using Unicode ultimately boils down to using the format your API uses.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">well, ill let you work on that. let me know if you want me to test again. </div><br /><br />After rebuilding wx with fixed settings, wchar_t works fine under VS as well.  I was just silly before.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">i agree with what tepples said, all those ifdef's belong in src/config.h <br /><br />and i keep them to a minimum. </div>
<br />
<br />Will do.  That part in nes_types.h was the only #ifdef I had in the entire source before Para made his adjustments (I think, anyway).
<br />
<br />Anyway yeah I'll move that all around.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mattmatteh</b> [ Thu Feb 14, 2008 3:43 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />is there a new link for the source so i can try the lastest ?
<br />
<br />src/config.h i think should only have #define,  no ifdef or what ever.  the configure script determins all that.
<br />
<br />matt

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Parasyte</b> [ Thu Feb 14, 2008 4:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Using config.h would probably hurt compatibility with MSVC, which is what Disch is stuck with. Complain about it enough, and maybe he will come over to the light side.
<br />
<br />And the configure script already handles unicode with --enable-unicode

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mattmatteh</b> [ Thu Feb 14, 2008 4:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />you can still use config.h with windows, you just need something to configure it correctly like the configure script does.
<br />
<br />and if the configure script handles unicode correctly, then in config.h you would define HAVE_UNICODE 1 and in the code 
<br />
<br />#ifdef HAVE_UNICODE
<br />     wchar_t *mystring;
<br />#else
<br />     char * mystring;
<br />#endif
<br />
<br />matt

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Feb 14, 2008 8:35 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Disch wrote:</div><div class="quotecontent"><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Is there an advantage of using wchar_t (in UTF-16 encoding) over using char (in UTF-8 encoding)?</div><br />Some APIs don't take UTF-8 encoded strings.</div>
<br />Which APIs are you talking about? Windows NT supports both 8-bit code units ("ANSI build") and 16-bit code units ("Unicode build"). If you build your program using the ANSI APIs, you can tell Windows that your ANSI strings are in UTF-8 by giving it "code page 65001".
<br />
<br />Disch: Is it true that you are stuck with Microsoft Visual C++ and not, say, MinGW?

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>