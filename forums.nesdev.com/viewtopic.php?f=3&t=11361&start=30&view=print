<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Nestopia and Ninja Gaiden/Burai Fighter</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Nestopia and Ninja Gaiden/Burai Fighter</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=11361">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=11361</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>3</strong> of <strong>7</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>oxyandy</b> [ Sun Jul 13, 2014 4:18 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hi *Spitfire_NES*<br />I was wondering how you went implementing a fix in Nestopia.<br />So, did you manage to fix this ?<br /><br />Cheers

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Sun Jul 13, 2014 7:17 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />hi oxyandy, <br /><br />Presently at an impasse. The code posted on page 2 of this thread is where everything is at. Mickeys has apparently been fixed thanks to james help!.  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" />  The burai fighter issue has not been fixed. Do you have any ideas that may be of help?<br /><br />Someone who understands the structure better of nestopias code might be able to do better than me. These 2 issues seem to be related though.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Sun Jul 13, 2014 10:23 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">zxbdragon wrote:</div><div class="quotecontent">in nemu...<br />fixed is <br />if(address &amp; 0x1000)<br />    irq.address =4;===&gt;irq.address =8;<br />?</div><br /><br />zxbdragon is this code referring to mickeys or burai fighter?<br /><br />edit*** also referring back to some pms maybe we need to check if nestopia is putting palette writes on the bus.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>zxbdragon</b> [ Mon Jul 21, 2014 8:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">*Spitfire_NES* wrote:</div><div class="quotecontent"><div class="quotetitle">zxbdragon wrote:</div><div class="quotecontent">in nemu...<br />fixed is <br />if(address &amp; 0x1000)<br />    irq.address =4;===&gt;irq.address =8;<br />?</div><br /><br />zxbdragon is this code referring to mickeys or burai fighter?<br /><br />edit*** also referring back to some pms maybe we need to check if nestopia is putting palette writes on the bus.</div><br />???<br /> this code referring  to mickeys or burai fighter in other emu

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Tue Jul 22, 2014 2:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />thank you for replying zxbdragon. I was just asking if that block of code you were asking about was referring to mickey's or burai fighter.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Tue Jul 22, 2014 10:46 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Same result of the other guy. It fixes Mickey, but not Burai FIghter. I don't know about $2006, since it's a write-only register.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Wed Jul 23, 2014 7:02 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />so just to clarify zepper, you tried this fix with the same result on a different emulator?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Wed Jul 23, 2014 7:29 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />In my own emulator, of course. Fixes Mickey in Letterland, but not Burai FIghter. I understand on $2007 reads and writes, but what about $2006???

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Wed Jul 23, 2014 7:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zepper wrote:</div><div class="quotecontent">In my own emulator, of course. Fixes Mickey in Letterland, but not Burai FIghter. I understand on $2007 reads and writes, but what about $2006???</div><br /><br /><br />looks like your emulator and nestopia share the same problem then, so what will work for yours will prob work for nestopia too. Will be interesting to see for sure. Thanks for clarifying.  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" /> <br /><br />Im digging back through what i have on the issue to see if i can find anything of relevance.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>zxbdragon</b> [ Wed Jul 23, 2014 11:59 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zepper wrote:</div><div class="quotecontent">In my own emulator, of course. Fixes Mickey in Letterland, but not Burai FIghter. I understand on $2007 reads and writes, but what about $2006???</div><br /><br />$2007 Reads,PPU is death.<br /><br />I think

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Thu Jul 24, 2014 1:00 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, at $2007 read, the ppu address is given by loopy_v &amp; 0x3FFF, since it ignores the higher bit ($4000). But how's supposed to handle the ppu mirroring $3000-3EFF to $2000-2EFF???

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Jul 24, 2014 4:01 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The PPU doesn't do that mirroring. The CIRAM does that because it's not connected to A12 in the vast majority of boards.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>*Spitfire_NES*</b> [ Thu Jul 24, 2014 9:23 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">The PPU doesn't do that mirroring. The CIRAM does that because it's not connected to A12 in the vast majority of boards.</div><br /><br />hey tepples, just to clarify, is the CIRAM related to burai fighter?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Thu Jul 24, 2014 9:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><span style="font-size: 85%; line-height: normal">Warning! The following code/description respects my ppu gfx engine/rendering method and <a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=4634&amp;p=41198&amp;hilit=ppu+bus#p41198" class="postlink">an idea from Disch, be sure to read this post</a>. A few things might be &quot;different&quot; for a few of you. </span> <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />I have <strong>no clue</strong> about a proper fix for Burai Fighter. Works on Nintendulator, but not on Nestopia. It doesn't matter the MMC3 PPU bus value, the score is still clipped, much like what happened with Gradius II (J) ages ago, but that's mapper 25. My only finding was about Mickey in Letterland. It's 1 scanline early in puNES by seeing a screenshot posted here. A way for fixing it relies on $2006 second write. The MMC3 PPU bus should take <em>loopy_v &amp; 0x3FFF</em>, and the mirroring must occur. In short words, if( ppu_bus &gt;= 0x2000) ppu_bus = 0 (no rising).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Fri Jul 25, 2014 3:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Nestopia and Ninja Gaiden/Burai Fighter</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">*Spitfire_NES* wrote:</div><div class="quotecontent"><div class="quotetitle">tepples wrote:</div><div class="quotecontent">The PPU doesn't do that mirroring. The CIRAM does that because it's not connected to A12 in the vast majority of boards.</div><br />hey tepples, just to clarify, is the CIRAM related to burai fighter?</div><br />CIRAM is just a name I found somewhere for that 2K VRAM chip on the motherboard, commonly used for nametables. And according to <a href="http://bootgod.dyndns.org:7777/profile.php?id=415" class="postlink">its entry in NesCartDB</a>, <em>Burai Fighter</em> uses the TEROM board, which doesn't do anything funny with the nametables the way <a href="http://wiki.nesdev.com/w/index.php/INES_Mapper_068" class="postlink"><em>After Burner</em></a> and <a href="http://wiki.nesdev.com/w/index.php/Namco_163" class="postlink">Namco 129 and 163</a> do.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>3</strong> of <strong>7</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>