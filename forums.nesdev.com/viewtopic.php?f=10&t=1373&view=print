<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Attempting &quot;Programming that 8-bit beast of power, the</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Attempting &quot;Programming that 8-bit beast of power, the</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=10&amp;t=1373">http://forums.nesdev.com/viewtopic.php?f=10&amp;t=1373</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Captain Boh</b> [ Wed Apr 12, 2006 10:17 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Attempting &quot;Programming that 8-bit beast of power, the</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />(EDIT, the title should read: 'Attempting "Programming that 8-bit beast of power, the NES" but it cut off, even though the title box accepted that many characters...)
<br />
<br />I've just gotten into this sort of stuff.  I belive I have enough knowledge to understand more or less whats going on in this document, but not much beyond that.
<br />
<br />That said, I'm to the point where you start adding sprites, but I'm having a problem: the assembler isn't putting my chr data into my file, it is instead, cutting off at the end of the prg page.
<br />
<br />I have tried both with what I typed out and what was in the document (which may or may not be different,  I haven't compared them line for line) and the result is the same, a 16kb file with no chr data.
<br />
<br />I'm probably overlooking something stupidly simple, but I can't for the life of me work out what it is.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>never-obsolete</b> [ Wed Apr 12, 2006 1:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />post something with a little more detail because there could be many things.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Apr 12, 2006 3:27 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Are you getting any error messages? Which assembler are you using?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Captain Boh</b> [ Thu Apr 13, 2006 11:15 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />This is what I have so far:
<br /><!-- m --><a class="postlink" href="http://members.shaw.ca/aknowlan/test.asm">http://members.shaw.ca/aknowlan/test.asm</a><!-- m -->
<br />
<br />working from this here:
<br /><!-- m --><a class="postlink" href="http://nesdev.com/NESprgmn.txt">http://nesdev.com/NESprgmn.txt</a><!-- m -->
<br />
<br />I'm using nesasm, which I've already read here isn't too good an idea, but it was what the tutorial recomended, so I would think that would work in that.
<br />
<br />I didn't upload the other files (the palette and the chr) because the pal is working for me and the chr is taken from a commercial ROM.  The file sizes for both are correct (as far as the tutorial says they should be anyway)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Thu Apr 13, 2006 2:14 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I know the problem, I bet. Turn OFF the screen before writing to $2007. For some reason, it really will NOT work if you write to $2007 while the screen is on. So just change the beggining part to:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">cld<br />sei<br />ldx #$FF<br />txs<br /><br />inx<br />stx $2000<br />stx $2001<br /></div><br /><br />The first four lines are almost required for an actual game to run properly. Then since X is #$FF, do inx, and X will be #$00, and store that in those registers and turn off the screen. When you're done writing to $2007, be sure to also restore the scroll! When you write to the register, you always have to turn the screen off, write, restore scroll, turn on screen. So put this at the end before your endless loop:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent"><br />lda #$00<br />sta $2005<br />sta $2005<br />lda #$08<br />sta $2000<br />lda #$1E<br />sta $2001<br /><br /></div>
<br />
<br />Does this help?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Disch</b> [ Thu Apr 13, 2006 2:15 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />you probably meant to .incbin the CHR file and not .include?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Captain Boh</b> [ Thu Apr 13, 2006 3:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It was set to incbin when I had the problem, I had forgotten I had changed that when I was trying to work out what was wrong on my own.
<br />
<br />When it said incbin it still wasn't working.
<br />
<br />Even using the code included in the tutorial word for word (the part right before name tables) still gives the same problem.
<br />
<br />No matter what I seem to do, I end up outputting a 16k nes file with no chr bank.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Disch</b> [ Thu Apr 13, 2006 3:58 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well it seems strange to me that you would have the .chr in the .asm anyway.  But I guess that's how nesasm works =/
<br />
<br />
<br />Normally though.. the assembler would just assemble the code and make a binary file, which you would combine with other binary files (like your header, .chr, etc) to make the .nes file.
<br />
<br />Anyway I can't really help on this one since it appears to be related to nesasm, which I'm not familiar with.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Captain Boh</b> [ Thu Apr 13, 2006 5:35 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I could just add it manually myself.  I had been avoiding doing that because I assumed that the proper way was to get the assembler to do it, like the tutorial had said, but if it isn't the standard way of doing things, then there's no point in getting used to doing it the wrong way.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Thu Apr 13, 2006 6:12 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, I don't know what's wrong with it when you assemble it, but I assembled it just fine. Even without changing that code I was talking about. The scroll is all messed up, but just restore it and it will be fine. Make a .bat file that looks like this:
<br />
<br />@echo off
<br />nesasm (asmfile).asm
<br />pause
<br />
<br />If you don't know how to make one, just open up notepad, type that, and save it as "demo.bat" or something. But yeah, change "include" to "incbin", because you must do that. And also, maybe instead of "Test.pal", put this under the lable:
<br />
<br />
<br />	.db $3F,$00,$10,$30,$3F,$00,$10,$30,$3F,$00,$10,$30,$3F,$00,$10,$30
<br />	.db $3F,$00,$10,$30,$3F,$00,$10,$30,$3F,$00,$10,$30,$3F,$00,$10,$30
<br />
<br />
<br />It's a complete greyscale pallete. It will work with the code. And you say you have the CHR file with graphics in it, correct? 8K data, correct? Put this before the endless loop:
<br />
<br />lda #$00
<br />sta $2005
<br />sta $2005
<br />
<br />It will show "Hello" in the top left corner of the screen. Just so you know, that code would most likely not run on a real NES, but for now, it's okay. If you're just starting out not trying to make anything big, it's all good.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Apr 13, 2006 6:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Until linkers are made available that support UNIF, it's best to rely on tools outside the assembler to join the iNES header or UNIF other chunks, the PRG, and the CHR, into one file.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>