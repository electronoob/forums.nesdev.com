<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Get rid of vibrato clicking (pop) in ppmck / mml SM</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Get rid of vibrato clicking (pop) in ppmck / mml SM</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=6&amp;t=9427">http://forums.nesdev.com/viewtopic.php?f=6&amp;t=9427</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>8bitmatt</b> [ Tue Oct 23, 2012 4:02 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Get rid of vibrato clicking (pop) in ppmck / mml SM</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It's kind of driving me crazy. I haven't been able to find a way to eliminate the clicking / popping sound when using vibrato on certain notes like &quot;a&quot; in a square channel.<br /><br />I know the SM command exists in the newest versions of ppmck but that doesn't seem to do anything.<br />From the research I've done the problem is well known and called &quot;phase reset&quot;.<br /><br />I found this post at Famitracker.com: <!-- m --><a class="postlink" href="http://famitracker.com/forum/posts.php?id=3175&amp;sort=2">http://famitracker.com/forum/posts.php?id=3175&amp;sort=2</a><!-- m --><br />Which led to this post here: <!-- l --><a class="postlink-local" href="http://forums.nesdev.com/viewtopic.php?t=231">viewtopic.php?t=231</a><!-- l --> <br /><br />But honestly it's a little over my head. <br /><br />The last post on that thread at famitracker says they got it working and links to this mmlshare url <!-- m --><a class="postlink" href="http://mmlshare.com/tracks/view/236">http://mmlshare.com/tracks/view/236</a><!-- m --> but I think he's updated it since then because I don't see anything in there that looks related to this problem.<br /><br />Please show me an example of how to eliminate the clicking and educate me on why it works. Maybe the answer is already in those other posts but like I said it's beyond my understanding.<br /><br />And as always thanks!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>cak</b> [ Tue Oct 23, 2012 11:31 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Get rid of vibrato clicking (pop) in ppmck / mml SM</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />IIRC, my little experiment failed. I got the &quot;y&quot; command working on one note, then ran into problems.<br /><br />Someone made a <a href="http://www.mediafire.com/download.php?7aqqy9u215o7ay8" class="postlink">hack of PPMCK</a> which supposedly eliminates vibrato clicking, but I couldn't even get it to compile nsfs. As for &quot;SM&quot;, it does provide a legato effect for rapidly changing notes, but doesn't affect the notes which cause the clicking.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Shiru</b> [ Wed Oct 24, 2012 2:25 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Get rid of vibrato clicking (pop) in ppmck / mml SM</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />As the clicking is a hardware issue, not software one, it is better to just work around it the easy way. Like, just don't use vibrato on A-3. Yes, it could be worked around using the hardware sweep, but I don't think it was used in the past, in commercial games.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Wed Oct 24, 2012 10:11 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Get rid of vibrato clicking (pop) in ppmck / mml SM</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />In famitracker the rule of thumb is to not use vibrato stronger than 2 on A-3. Some people will alter the pitch of A-3 to make room, e.g. P81 allows vibrato of 3, etc...<br /><br />The reason it happens is that whenever the pitch control value crosses a multiple of 256, setting the higher bits causes the phase of the square generator to be reset (making a click).<br /><br />Here are the boundaries that have this problem:<br /><br />G#-3 / A-3<br />G#-2 / A-2<br />C#-2 / D-2<br />G#-1 / A-1<br />F-1 / F#-1<br />C#-1 / D-1<br />B-0 / C-1<br /><br />A-3 is normally the only one people notice. The numbers are bigger as the pitch goes lower, so there is more space between notes and you are less likely to cause clicking via vibrato. Since A-3 is the highest one, it has the worst problem.<br /><br />If you want to listen to an NSF without this problem, you can use NSFPlay and disable the phase reset in the APU1 options panel. This isn't authentic to the hardware, obviously, but you could finally listen to the Mega Man 2 ending without that dreadful click, for example.<br /><br />Yes, there are tricks using the hardware sweeps to get around it, but as shiru said, no games used them at the time. A few people have been using it recently.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>neilbaldwin</b> [ Tue Dec 04, 2012 5:01 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Get rid of vibrato clicking (pop) in ppmck / mml SM</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Surprised Famitracker hasn't got a fix for this yet?<br /><br />It's been pretty well documented (thanks to blargg who discovered the trick) on here and reasonably straightforward to implement.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Tue Dec 04, 2012 7:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Get rid of vibrato clicking (pop) in ppmck / mml SM</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />jsr implemented it, but he didn't put it in because so few NSF players emulate the frame sequencer behaviour correctly. NSFPlay was one of them (didn't have any $4017 response until the current beta).<br /><br />Even though Blargg's sweep trick was discovered years ago, I'm not aware of any NSF release that used the technique before the very recent Streemerz NSF.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>