<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - IRQ timing bug in SMB3 (J)?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">IRQ timing bug in SMB3 (J)?</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=15520">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=15520</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Thu Feb 09, 2017 4:18 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It occurs even in Nintendulator. Pic from RockNES.<div class="attachtitle">Attachment:</div><div class="attachcontent">
			<a href="./download/file.php?id=7969&amp;mode=view"><img src="./download/file.php?id=7969&amp;t=1" alt="Super Mario Bros. 3 (J) 000.png" /></a><br />
			<span class="gensmall">Super Mario Bros. 3 (J) 000.png [ 23.68 KiB | Viewed 2978 times ]</span>
		

		<br />
	</div><br />The only emulator that displays it perfectly is VirtuaNES (see below)<br /><div class="attachtitle">Attachment:</div><div class="attachcontent">
			<img src="./download/file.php?id=7970" alt="Super Mario Bros. 3 (J) 201702092119578.png" /><br />
			<span class="gensmall">Super Mario Bros. 3 (J) 201702092119578.png [ 8.93 KiB | Viewed 2975 times ]</span>
		

		<br />
	</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Feb 09, 2017 4:21 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Splits in <em>Super Mario Bros. 3</em>, <em>Mega Man 3</em>, and possibly other early MMC3 games are glitchy on hardware. Have you compared this to the behavior of an authentic <em>Super Mario Bros. 3</em> cassette in an authentic Family Computer?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Thu Feb 09, 2017 4:23 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Splits in <em>Super Mario Bros. 3</em>, <em>Mega Man 3</em>, and possibly other early MMC3 games are glitchy on hardware. Have you compared this to the behavior of an authentic <em>Super Mario Bros. 3</em> cassette in an authentic Family Computer?</div><br />I don't own a Famicom.<br /><br />EDIT: looks like it's not a bug after all.<br /><!-- m --><a class="postlink" href="https://www.youtube.com/watch?v=lXSJeKgbBeQ">https://www.youtube.com/watch?v=lXSJeKgbBeQ</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>zeroone</b> [ Thu Feb 09, 2017 5:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It is difficult to tell exactly what you are referring to based on your description and pics.  Are you referring to one of these:<br /><br /><!-- m --><a class="postlink" href="https://wiki.nesdev.com/w/index.php/Game_bugs">https://wiki.nesdev.com/w/index.php/Game_bugs</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Thu Feb 09, 2017 5:56 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">zeroone wrote:</div><div class="quotecontent">It is difficult to tell exactly what you are referring to based on your description and pics.  Are you referring to one of these:<br /><br /><!-- m --><a class="postlink" href="https://wiki.nesdev.com/w/index.php/Game_bugs">https://wiki.nesdev.com/w/index.php/Game_bugs</a><!-- m --></div><br />Difficult!?  <img src="./images/smilies/icon_eek.gif" alt=":shock:" title="Shocked" /> Look again.<br /><div class="attachtitle">Attachment:</div><div class="attachcontent">
			<img src="./download/file.php?id=7971" alt="glitch1.png" /><br />
			<span class="gensmall">glitch1.png [ 7.76 KiB | Viewed 2952 times ]</span>
		

		<br />
	</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Feb 09, 2017 6:46 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />In case anyone missed it, Zepper refers to a white line between the copyright notice and the checkerboard.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>zeroone</b> [ Thu Feb 09, 2017 6:51 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">In case anyone missed it, Zepper refers to a white line between the copyright notice and the checkerboard.</div><br /><br />That actually look me a minute to notice.<br /><br /><div class="quotetitle">Zepper wrote:</div><div class="quotecontent">EDIT: looks like it's not a bug after all.</div><br /><br />As Zepper pointed out, there are plenty of videos of SMB3 (U) on YouTube recorded from real hardware and they do indeed have that white horizontal scanline on the title screen.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>zxbdragon</b> [ Thu Feb 09, 2017 6:57 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />smb3 j<br />PRG0,is have this line<br />PRG1,is not have this line.<br /><br />smb3 u<br />PRG0,PRG1 have this line.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zepper</b> [ Sun Feb 12, 2017 4:50 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">zeroone wrote:</div><div class="quotecontent">As Zepper pointed out, there are plenty of videos of SMB3 (U) on YouTube recorded from real hardware and they do indeed have that white horizontal scanline on the title screen.</div><br />I mean the japanese version! In other words, &quot;there are a few videos of SMB3 (J) on YouTube recorded from real hardware and they have NO white horizontal scanline on the title screen&quot;.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>zxbdragon</b> [ Sun Feb 12, 2017 5:26 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zepper wrote:</div><div class="quotecontent"><div class="quotetitle">zeroone wrote:</div><div class="quotecontent">As Zepper pointed out, there are plenty of videos of SMB3 (U) on YouTube recorded from real hardware and they do indeed have that white horizontal scanline on the title screen.</div><br />I mean the japanese version! In other words, &quot;there are a few videos of SMB3 (J) on YouTube recorded from real hardware and they have NO white horizontal scanline on the title screen&quot;.</div><br /><br />SMB3 J <br />PRG0 version is have this white horizontal scanline.<br />I have PRG1 version cart.

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<a href="./download/file.php?id=7987&amp;mode=view"><img src="./download/file.php?id=7987&amp;t=1" alt="IMG_20170212_202218.jpg" /></a><br />
			<span class="gensmall">IMG_20170212_202218.jpg [ 433.78 KiB | Viewed 2833 times ]</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>zxbdragon</b> [ Sun Feb 12, 2017 5:33 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />this is USA version

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<a href="./download/file.php?id=7988&amp;mode=view"><img src="./download/file.php?id=7988&amp;t=1" alt="IMG_20170212_202218.jpg" /></a><br />
			<span class="gensmall">IMG_20170212_202218.jpg [ 602.2 KiB | Viewed 2830 times ]</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ap9</b> [ Wed Apr 12, 2017 1:39 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />What makes it clear that there is an IRQ bug in the earlier MMC3-A Japanese ROM(s) is the glitch line produced in the castle levels where the ceiling drops. It's revealed in the <a href="https://www.youtube.com/watch?v=lXSJeKgbBeQ" class="postlink">YouTube video</a> mentioned by Zepper in this thread, beginning at 6:08.<br /><br />It appears that only one of the official releases for Super Mario Bros. 3 drops most of the white line on the title screen — the more common Japanese PRG1, so it's safe to assume that the black area was unintentional. (And if it was intentional, it's still not in the modern form expressed in all future releases, U.S.-on.)<br /><br />There's more extensive research into the differences between the ROMs on The Cutting Room floor website, where the black area can be seen:<br /><br /><!-- m --><a class="postlink" href="https://tcrf.net/Super_Mario_Bros._3/Version_differences">https://tcrf.net/Super_Mario_Bros._3/Ve ... ifferences</a><!-- m -->

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="gensmall"><b>File comment:</b> With puNES, which emulates the MMC3-A board very closely to the real thing</span><br />
		
			<a href="./download/file.php?id=8596&amp;mode=view"><img src="./download/file.php?id=8596&amp;t=1" alt="SMB3 W1 Castle (J-A).jpg" /></a><br />
			<span class="gensmall">SMB3 W1 Castle (J-A).jpg [ 114.49 KiB | Viewed 2517 times ]</span>
		

		<br />
	</td>
				</tr>
			
				<tr>
					<td>
			<span class="gensmall"><b>File comment:</b> YouTube frame of actual Famicom</span><br />
		
			<a href="./download/file.php?id=8595&amp;mode=view"><img src="./download/file.php?id=8595&amp;t=1" alt="Super Mario Bros 3 (J) MMC3-A IRQ bug-Famicom YouTube.png" /></a><br />
			<span class="gensmall">Super Mario Bros 3 (J) MMC3-A IRQ bug-Famicom YouTube.png [ 109.91 KiB | Viewed 2517 times ]</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>kazblox</b> [ Fri Apr 14, 2017 9:57 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Comparison of IRQ line timings to the Japanese prototypes:

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="gensmall"><b>File comment:</b> Famimaga Sept. 1988</span><br />
		
			<a href="./download/file.php?id=8627&amp;mode=view"><img src="./download/file.php?id=8627&amp;t=1" alt="a3.png" /></a><br />
			<span class="gensmall">a3.png [ 494.58 KiB | Viewed 2439 times ]</span>
		

		<br />
	</td>
				</tr>
			
				<tr>
					<td>
			<span class="gensmall"><b>File comment:</b> GTV Jul. 1998</span><br />
		
			<a href="./download/file.php?id=8626&amp;mode=view"><img src="./download/file.php?id=8626&amp;t=1" alt="a2.png" /></a><br />
			<span class="gensmall">a2.png [ 564.8 KiB | Viewed 2439 times ]</span>
		

		<br />
	</td>
				</tr>
			
				<tr>
					<td>
			<span class="gensmall"><b>File comment:</b> GTV Jul. 1988</span><br />
		
			<a href="./download/file.php?id=8625&amp;mode=view"><img src="./download/file.php?id=8625&amp;t=1" alt="a1.png" /></a><br />
			<span class="gensmall">a1.png [ 229.31 KiB | Viewed 2439 times ]</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ap9</b> [ Sat Apr 15, 2017 1:15 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IRQ timing bug in SMB3 (J)?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">kazblox wrote:</div><div class="quotecontent">Comparison of IRQ line timings to the Japanese prototypes:</div><br /><br />The early prototypes make it obvious that Mario is slightly intersecting the checkerboard pattern. Technically, he's always intersecting the first split line, but aesthetically, it may have been better to have the characters meet a black line first (as the sprites have black outlines). The white line is very much present in the prototype snapshots.<br /><br />It was probably necessary to move the second part of the split a little lower due to DMC CPU read delays during DMC sound effects (the effects of the delays still show up in overscan-clipped areas). It would be interesting to know whether or not DMC sound effects were even used until later, considering the early test videos had no game play sound. The controller read / DMC DMA conflict bug only made things more complicated; however, we all know Super Mario Bros. 2 (U) used DMC in its 1988 release.<br /><br />There were a number of bugs to work out, and some still present including occasional glitches during &quot;water float&quot; sequences while several actions are slowing down the game, so two extra black scanlines added considerable IRQ split leeway in the end. The top of the scoreboard split is one pixel lower in a level than it is on a world map.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>