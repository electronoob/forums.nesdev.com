<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Beginner's questions about CC65</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Beginner's questions about CC65</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=10469">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=10469</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>2</strong> of <strong>3</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>cpow</b> [ Mon Sep 09, 2013 7:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">DRW wrote:</div><div class="quotecontent">Are you referring to a specific post of me or is this just a general suggestion?<br />I guess I will have a look, but in the moment, I'm still learning the basics of NES programming. I won't start developing an actual game until I understand every single line in my sample code. So, yes, I might actually use an IDE as soon as I start a real project. But in the moment, a text editor and the assembler is all that I need. I don't want anything to be abstracted away from me now. (Well, except for the actual conversion of assembly code to binary code of course.)</div><br /><br />I think he just meant that it comes with C/asm example projects [New Project-&gt;Templates] and config files that [should] compile [at least last I checked...].  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>slobu</b> [ Tue Sep 10, 2013 7:04 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">cpow wrote:</div><div class="quotecontent"><div class="quotetitle">DRW wrote:</div><div class="quotecontent">Are you referring to a specific post of me or is this just a general suggestion?<br />I guess I will have a look, but in the moment, I'm still learning the basics of NES programming. I won't start developing an actual game until I understand every single line in my sample code. So, yes, I might actually use an IDE as soon as I start a real project. But in the moment, a text editor and the assembler is all that I need. I don't want anything to be abstracted away from me now. (Well, except for the actual conversion of assembly code to binary code of course.)</div><br /><br />I think he just meant that it comes with C/asm example projects [New Project-&gt;Templates] and config files that [should] compile [at least last I checked...].  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" /></div><br /><br /><br />What cpow said I said!  NESICIDE is a great way to start programming for the NES.  A beginner should focus on coding -  save twiddling with the toolchain and utilities for later.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DRW</b> [ Tue Sep 10, 2013 2:27 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">cpow wrote:</div><div class="quotecontent">I think he just meant that it comes with C/asm example projects [New Project-&gt;Templates] and config files that [should] compile [at least last I checked...].  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" /></div><br />Well, in this case I guess I will have a look. To see what the example programs are like.<br /><br /><div class="quotetitle">slobu wrote:</div><div class="quotecontent">What cpow said I said!  NESICIDE is a great way to start programming for the NES.  A beginner should focus on coding -  save twiddling with the toolchain and utilities for later.</div><br />Generally, you're right. If someone is eager to start a project right now. But since the NES is so low-level, I'd rather understand everything before I start a real game. After all, I'm not in a hurry. I have a sample program that doesn't really do anything useful, but that already includes the basics (building backgrounds, letting a sprites move etc.). And as soon as I'm able to explain every single line in that code, I will move on.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DRW</b> [ Wed Sep 11, 2013 3:10 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />A little question about the CC65 assembler: What are the commands to declare variables?<br /><br />IN NESASM, you write this:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; .rsset $0000<br />xlocation .rs 1<br />ylocation .rs 1<br />score .rs 1</div><br />What's the CC65 equivalent? I didn't find it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Memblers</b> [ Wed Sep 11, 2013 5:42 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It's &quot;.res&quot;.  From the ca65 manual:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">11.84 .RES<br /><br />Reserve storage. The command is followed by one or two constant expressions. The first one is mandatory and defines, how many bytes of storage should be defined. The second, optional expression must by a constant byte value that will be used as value of the data. If there is no fill value given, the linker will use the value defined in the linker configuration file (default: zero).<br /><br />Example:<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Reserve 12 bytes of memory with value $AA<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .res&nbsp; &nbsp; 12, $AA<br /></div><br /><br />Obviously, the fill value would be ignored for RAM.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Thu Sep 12, 2013 12:06 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Memblers wrote:</div><div class="quotecontent">Obviously, the fill value would be ignored for RAM.</div><br />If I remember correctly, CC65 will give a warning if a fill value other than 0 (the default) is used for BSS segments.<br /><br />Anyway, for DRW, also remember to specify the correct segment:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.segment &quot;ZEROPAGE&quot; ; Or whatever other segment.<br />foo: .res 2<br />bar: .word 0 ; This also works. Note that you need to clear the memory in your initialization code to make sure the value is actually 0.<br />xyzzy: .dword 12345 ; This will give a warning if/when ZEROPAGE segment has been defined as type=bss.<br /></div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>DRW</b> [ Thu Sep 12, 2013 2:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks a lot. It works very well.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Lazycow</b> [ Fri Sep 20, 2013 7:44 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">thefox wrote:</div><div class="quotecontent"><div class="codetitle"><b>Code:</b></div><div class="codecontent">bar: .word 0 ; This also works. Note that you need to clear the memory in your initialization code to make sure the value is actually 0.<br /></div></div><br />Hm... why clear anything? &quot;.word 0&quot; places two zero-bytes at the label.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Movax12</b> [ Fri Sep 20, 2013 8:17 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />A quirk? The value is actually how many of the proceeding to reserve space for (or maybe not in this context.. it may place zeros there, but that matches what should be in RAM, so it's okay). If you prefer to use <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">.byte</tt>,<tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">.word</tt> or <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">.addr</tt>, etc, in a RAM segment, you need to specify a zero. It's a bit odd, since inside a .struct, you don't need to specify a zero size, and you can use numbers greater than zero.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.struct foo<br />&nbsp; &nbsp; bar&nbsp; &nbsp; .byte 10&nbsp; &nbsp; ; bar is 10 bytes<br />&nbsp; &nbsp; baz&nbsp; &nbsp; .byte&nbsp; &nbsp; &nbsp; &nbsp; ; baz is 1 byte<br />.endstruct<br /></div><br /><br />A struct in ca65 doesn't reserve anything though, it just creates a data structure.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Fri Sep 20, 2013 8:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Lazycow wrote:</div><div class="quotecontent"><div class="quotetitle">thefox wrote:</div><div class="quotecontent"><div class="codetitle"><b>Code:</b></div><div class="codecontent">bar: .word 0 ; This also works. Note that you need to clear the memory in your initialization code to make sure the value is actually 0.<br /></div></div><br />Hm... why clear anything? &quot;.word 0&quot; places two zero-bytes at the label.</div><br />It doesn't place anything if that label is in RAM, you have to initialize all variables manually.<br /><br />Some people might be used to initializing variables like that (.db, .dw, .byte, .word, etc.), but this will only work in computers/architectures that copy the programs from the storage media to RAM before running them (so the variables are copied over as well). On the NES, however, programs run directly from ROM, so RAM is completely untouched when the program starts running.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Movax12</b> [ Fri Sep 20, 2013 8:48 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That's a better explanation. ca65 will let you define .word/.bytes or whatever in a RAM segment, but it won't actually place anything there for you.<br /><br />I assume (untested) you could define your ZP segment load as:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">MEMORY<br />{<br />&nbsp; &nbsp;ZP:&nbsp; start =&nbsp; &nbsp; $0, size =&nbsp; &nbsp;$100,&nbsp; type = rw,&nbsp; define = yes, fillval = $AA;<br />}<br /></div> <br />And then:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.segment &quot;ZEROPAGE&quot;<br />&nbsp; &nbsp; bar: .word $AA&nbsp; &nbsp; &nbsp;; matches what the fillval for ZP is suppose to be.<br /></div><br /><br />If the value doesn't match, you'll get a linker error.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Lazycow</b> [ Fri Sep 20, 2013 8:52 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Ok, didn't realize that you are talking about structs. Without .struct, .byte 10 reserves 1 byte, filled with value 10

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Movax12</b> [ Fri Sep 20, 2013 9:08 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I brought structs into this. They are a different thing, that use the same keywords to define space. Not the same as reserving RAM.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Fri Sep 20, 2013 9:52 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Lazycow wrote:</div><div class="quotecontent"><div class="quotetitle">thefox wrote:</div><div class="quotecontent"><div class="codetitle"><b>Code:</b></div><div class="codecontent">bar: .word 0 ; This also works. Note that you need to clear the memory in your initialization code to make sure the value is actually 0.<br /></div></div><br />Hm... why clear anything? &quot;.word 0&quot; places two zero-bytes at the label.</div><br />It depends on what is the type of the segment that you're placing the data in. If the segment is in the NES CPU RAM, it's your responsibility to initialize it (either by clearing it, if it's a BSS segment, or by copying the correct values over from ROM, if it's a read-write segment). If the segment is in ROM, the value will of course be written to the ROM file, so no need to &quot;manually&quot; initialize anything.<br /><br /><div class="quotetitle">Movax12 wrote:</div><div class="quotecontent">That's a better explanation. ca65 will let you define .word/.bytes or whatever in a RAM segment, but it won't actually place anything there for you.<br /><br />I assume (untested) you could define your ZP segment load as:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">MEMORY<br />{<br />&nbsp; &nbsp;ZP:&nbsp; start =&nbsp; &nbsp; $0, size =&nbsp; &nbsp;$100,&nbsp; type = rw,&nbsp; define = yes, fillval = $AA;<br />}<br /></div> <br />And then:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">.segment &quot;ZEROPAGE&quot;<br />&nbsp; &nbsp; bar: .word $AA&nbsp; &nbsp; &nbsp;; matches what the fillval for ZP is suppose to be.<br /></div><br /><br />If the value doesn't match, you'll get a linker error.</div><br />Not really true, or I'm misunderstanding you.<br /><br />It depends on the type of the segment again. If it's &quot;bss&quot;, you have to use 0 (.word 0, or .byte 0, or whatever -- in this context, CA65 regards 0 as &quot;uninitialized&quot;), regardless of the fill value of the corresponding memory area definition. If it's &quot;rw&quot; or &quot;ro&quot;, it doesn't matter if the value matches the fillval, the data will be written to the output file.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Sat Sep 21, 2013 8:43 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Beginner's questions about CC65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The CC65 CRT initializes the BSS segment to 0 on startup, which is why it makes that assumption. If you make a custom CRT library you should probably initialize BSS to 0 to avoid breaking the assembler's assumption.<br /><br />It also copies the DATA segment from its ROM (load position) to RAM (run position), which is how your global C variables get initialized.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>2</strong> of <strong>3</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>