<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Flags?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Flags?</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=12193">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=12193</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Erockbrox</b> [ Fri Jan 02, 2015 10:44 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />My main question is why on earth do these processors have flags? Zero flag, carry flag, negative flag and so on. Why can't just the code be followed?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Fri Jan 02, 2015 10:46 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Flags represent the state of a comparison and are used to implement &quot;if-then&quot; logic with branches.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Erockbrox</b> [ Fri Jan 02, 2015 11:53 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />but cant you do if then logic without flags<br /><br />example:<br /><br />load 55 into x register<br />compare with value of 20<br />since they are not equal then do something<br />if they are equal then don't do something

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Kasumi</b> [ Fri Jan 02, 2015 11:55 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />If the processors didn't have flags, you couldn't branch conditionally. So the code would just go straight down. There could be no changes in behavior based on input. They're what allow you to choose whether to jump or fall down a pit, whether to move left, right or stand still. Any choice at all would be impossible without them.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">but cant you do if then logic without flags</div><br />Well... no? I mean, the flag is exactly what tells you if they're equal or not after the compare. If the flag wasn't there you could only do one thing. The branch based on the flag is what allows you to potentially not do that thing. Without flags, there could be no branches based on them.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mikaelmoizt</b> [ Fri Jan 02, 2015 12:01 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Erockbrox wrote:</div><div class="quotecontent">load 55 into x register<br />compare with value of 20<br />since they are not equal then do something<br />if they are equal then don't do something</div><br /><br />like this?<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">ldx #55<br />cpx #20 <br />bne &quot;do something&quot; <br />beq &quot;don't do something&quot;</div><br /><br />Edit: you can also test flags and the status register with this small routine in a simulator.. like easy6502<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">start:<br />; things to try out goes here, for example sec, sei, lda #$ff or whatever<br />&nbsp;<br />php<br />tsx<br />lda $101,x<br />sta $0<br /><br />; in $0 now you have a copy of status register, and will be able to analyze it<br /><br />loop:<br />jmp loop</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>loopy</b> [ Fri Jan 02, 2015 12:38 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Erockbrox wrote:</div><div class="quotecontent">but cant you do if then logic without flags<br /><br />example:<br /><br />1. load 55 into x register<br />2. compare with value of 20<br />3. since they are not equal then do something<br />4. if they are equal then don't do something</div><br />Between step 2 and 3, the processor needs to remember the comparison result, since these are separate instructions.  That's what the flags are for.<br /><br /><div class="quotetitle">Kasumi wrote:</div><div class="quotecontent">If the processors didn't have flags, you couldn't branch conditionally.</div><br />There are some CPU architectures that don't have flags, like MIPS for example.  A comparison and branch is one instruction.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">beq $r1, $r2, offset&nbsp; &nbsp;# branch if r1==r2<br />bne $r1, $r2, offset&nbsp; &nbsp;#&nbsp; &nbsp;r1!=r2<br />bgtz $r1, offset&nbsp; &nbsp; &nbsp; &nbsp;#&nbsp; &nbsp;r1&gt;0<br />bgez $r1, offset&nbsp; &nbsp; &nbsp; &nbsp;#&nbsp; &nbsp;r1&gt;=0<br />bltz $r1, offset&nbsp; &nbsp; &nbsp; &nbsp;#&nbsp; &nbsp;r1&lt;0<br />blez $r1, offset&nbsp; &nbsp; &nbsp; &nbsp;#&nbsp; &nbsp;r1&lt;=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# and other oddities, like:<br />slt $r1, $r2, $r3&nbsp; &nbsp; &nbsp; #&nbsp; &nbsp;r1 = r2&lt;r3? 1: 0<br /></div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Fri Jan 02, 2015 12:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Of course you can do branching logic without flags, see the MIPS family of processors for example. However, that's just not how the 6502 family was designed.<br /><br />Asking why there is flags is as weird as asking why there is an accumulator and two index registers. It was just an arbitrary choice made when the processor was designed.<br /><br />Also this should probably go in the newbie section rather than in NESdev (even though it's not up to me to judge).<br /><br />EDIT : I was out-speeded by Loopy, but our point was the exact same  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" />  <img src="./images/smilies/icon_wink.gif" alt=":wink:" title="Wink" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Kasumi</b> [ Fri Jan 02, 2015 1:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Cool! In the languages I've looked at, I've never seen no flags. Always good to learn a thing.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Fri Jan 02, 2015 1:58 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Another way of thinking about flags is that they save the result of the &quot;if&quot; instruction for use in the &quot;then&quot; part.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Fri Jan 02, 2015 3:33 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I like the design decision of using flags, because most operations set multiple flags, so you get more information about the result of each operation, which allows you to make successive decisions after a single operation.<br /><br />Back when I started learning assembly, the flags were the most mystical thing about it. It felt like magic that decisions were completely disconnected from comparisons, and it took a while for me to realize that the flags were responsible for that, and that you could take advantage of flag persistence to optimize the code.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tomaitheous</b> [ Fri Jan 02, 2015 4:19 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Erockbrox: Is this your first processor with assembler?<br /><br /> As far as flags, I thought the concept was fairly simple. The Z flag is the easiest flag to understand. The result of an action is either zero or non-zero. C flag is a <em>little </em>more complicated than the Z flag, but definitely nothing overly complex. I mean, on the <em>simplest </em>level it's just 'borrow/carry'. Don't get intimidated by Z or C flags. N and V, well.. that's something else entirely. With enough exposure and experience, you'll come to understand them.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ccovell</b> [ Fri Jan 02, 2015 5:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Most CPUs are just giant state machines, and don't have a &quot;short-term memory&quot; like you or I do.  They don't continue directly from the condition to the result in a single step,<br /><br />Thus, the CPU checks the flags on every instruction (that uses it) to remind itself what it had just done.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Erockbrox</b> [ Fri Jan 02, 2015 10:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks guys for explaining this!<br /><br />I've taken a few computer courses, but as far as I remember they never mentioned flags before so the idea was strange at first. While I'm new at learning these old processors I'm not entirely new to programming. Here is my background:<br /><br />Classes<br /><br />Computer logic and design - wrote pseudo code and simple programs<br />Visual Basic - online course, hardly learned anything<br />C Programming - Wrote some programs in C, for loops, do while loops, nested loops, stings, arrays<br />Software Applicatoins - learned Matlab and a little of Mathematicia <br /><br />So I'm familiar with some things. I've taken an interest in making NES and SNES games and so that's why I'm here trying to learn these old processors and hopefully make a game!<br /><br />And now thanks to you guys I think I kind of understand these flags LOL!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sat Jan 03, 2015 2:33 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Flags?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You should not confuse assembly and high level languages, as those are very different things.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Cool! In the languages I've looked at, I've never seen no flags. Always good to learn a thing.</div><br />I know it's weird, but I don't think it's correct to call different assembly language &quot;languages&quot;. Even if they are all completely different, they're still assembly language : The different processors are usually referred to as &quot;architectures&quot; or &quot;processor family&quot;.<br /><br />Most RISC does not have flags, exept ARM which does have them. I am not sure about PowerPC and MSP430 series, but I'm sure MIPS series lacks them.<br /><br /><br />Erockbrox wrote:<br />load 55 into x register<br />compare with value of 20<br />since they are not equal then do something<br />if they are equal then don't do something<br /><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">like this?<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">ldx #55<br />cpx #20 <br />bne &quot;do something&quot; <br />beq &quot;don't do something&quot;</div><br /><br /></div><br />The ARM family can do exactly that, not only branches are conditional but all other instructions too. This is a huge advantage in an if-then-else of a single instruction, as it avoids flushing the pipeline in one of both cases. When there is more than 2 instrucitons, typically it's better to take the risk to flush the pipeline, rather than loosing fetching many useless instructions, although it depends on applications.<br /><br />In non-pipelined processors such as the 6502 it does not matter, since we never loose time flushing the pipeline since there is none. So it makes more sense not wasting 4 bits per instructions just for the conditional flags, and have only the branches who are conditional.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>