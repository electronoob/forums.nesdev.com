<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - wrestling with SMB1 title screen</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - NESemdev" href="http://forums.nesdev.com/feed.php?f=3" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - wrestling with SMB1 title screen" href="http://forums.nesdev.com/feed.php?f=3&amp;t=8647" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '1');
	var per_page = '';
	var base_url = '';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=register"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Thu Aug 30, 2012 11:07 am<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=3">NESemdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />

<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=3&amp;t=8647">wrestling with SMB1 title screen</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=3"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=3&amp;t=8647"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 12 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=3&amp;t=8647&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=3&amp;t=8647&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=3&amp;t=8647&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p90338"></a>
				<b class="postauthor">miker00lz</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90338">wrestling with SMB1 title screen</a></div><div style="float: right;"><a href="./viewtopic.php?p=90338#p90338"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Feb 22, 2012 2:32 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4572.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Sep 23, 2010 7:28 pm<br /><b>Posts:</b> 145
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">alright, this one has been bugging me ever since i first started writing my emulator. this is what the SMB title screen looks like:
<br />
<br /><img src="http://rubbermallet.org/smbtitle.png" alt="Image" />
<br />
<br />i know it requires the PPU read delay buffer to be functional, and mine is. it passes blargg's test ROM for that. i can't find what the problem is here. it's not the ROM either, it looks right in other emulators.
<br />
<br />here is my current code:
<br />
<br /><!-- m --><a class="postlink" href="http://sourceforge.net/projects/moarnes/files/moarnes-0.12.2.18-alpha-source.zip/download">http://sourceforge.net/projects/moarnes ... p/download</a><!-- m -->
<br />
<br />
<br />does anybody want to take a stab at this one? it's been driving me nuts for about a year and a half now!  <img src="./images/smilies/icon_neutral.gif" alt=":|" title="Neutral" /></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4572"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p90340"></a>
				<b class="postauthor">Dwedit</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90340"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90340#p90340"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Feb 22, 2012 2:52 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=53.png" width="68" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Nov 19, 2004 7:35 pm<br /><b>Posts:</b> 2546
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="codetitle"><b>Code:</b></div><div class="codecontent">uint8_t readPPU&#40;uint16_t addr&#41; &#123;<br />&nbsp; &nbsp;uint8_t tempbyte;<br />&nbsp; &nbsp;addr &amp;= 0x3FFF;<br />&nbsp; &nbsp;if &#40;addr&gt;=0x3F00&#41; addr = 0x3F00 | &#40;addr &amp; 0x1F&#41;;<br />&nbsp; &nbsp;if &#40;addr&gt;0x2FFF &amp;&amp; addr&lt;0x3F00&#41; addr = 0x3000 | &#40;addr &amp; 0xEFF&#41;;<br />&nbsp; &nbsp;if &#40;addr&gt;=0x2000 &amp;&amp; addr&lt;0x2400&#41; addr = &#40;addr - 0x2000&#41; + PPU-&gt;ntmap&#91;0&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else if &#40;addr&gt;=0x2400 &amp;&amp; addr&lt;0x2800&#41; addr = &#40;addr - 0x2400&#41; + PPU-&gt;ntmap&#91;1&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else if &#40;addr&gt;=0x2800 &amp;&amp; addr&lt;0x2C00&#41; addr = &#40;addr - 0x2800&#41; + PPU-&gt;ntmap&#91;2&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else if &#40;addr&gt;=0x2C00 &amp;&amp; addr&lt;0x3000&#41; addr = &#40;addr - 0x2C00&#41; + PPU-&gt;ntmap&#91;3&#93;;<br />&nbsp; &nbsp;if &#40;addr&lt;0x2000&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;tempbyte = cartridge.CHRbank&#91;addr&gt;&gt;10&#93;&#91;addr&amp;1023&#93;;&nbsp; &nbsp;//&nbsp; &lt;-- Setting Tempbyte<br />&nbsp; &nbsp;&nbsp; &nbsp;if &#40;cartridge.mapper == 9&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;switch &#40;addr &amp; 0x3FF0&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x0FD0: map9-&gt;latch1 = 0xFD; CHRswap&#40;&amp;cartridge, 0, map9-&gt;latch0_fd, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x0FE0: map9-&gt;latch1 = 0xFE; CHRswap&#40;&amp;cartridge, 0, map9-&gt;latch0_fe, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x1FD0: map9-&gt;latch2 = 0xFD; CHRswap&#40;&amp;cartridge, 1, map9-&gt;latch1_fd, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x1FE0: map9-&gt;latch2 = 0xFE; CHRswap&#40;&amp;cartridge, 1, map9-&gt;latch1_fe, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;return&#40;tempbyte&#41;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;if &#40;addr &gt;= 0x3F00&#41; tempbyte = VRAM&#91;addr&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else tempbyte = PPU-&gt;bytebuffer;&nbsp; &nbsp; //&nbsp; &lt;-- Throwing it out<br />&nbsp; &nbsp;PPU-&gt;bytebuffer = VRAM&#91;addr&#93;;&nbsp; //&nbsp; &lt;-- Here's your bug<br />&nbsp; &nbsp;return&#40;tempbyte&#41;;<br />&#125;<br /></div>
<br />
<br />Why are you setting Tempbyte to something, only to later throw it out?
<br />Looks like you are fetching something incorrect for the actual data read out.</div>

					
						<div class="postbody"><br />_________________<br />Here come the fortune cookies!  Here come the fortune cookies!  They're wearing paper hats!</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=53"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p90341"></a>
				<b class="postauthor">miker00lz</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90341"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90341#p90341"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Feb 22, 2012 2:58 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4572.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Sep 23, 2010 7:28 pm<br /><b>Posts:</b> 145
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Dwedit wrote:</div><div class="quotecontent"><div class="codetitle"><b>Code:</b></div><div class="codecontent">uint8_t readPPU&#40;uint16_t addr&#41; &#123;<br />&nbsp; &nbsp;uint8_t tempbyte;<br />&nbsp; &nbsp;addr &amp;= 0x3FFF;<br />&nbsp; &nbsp;if &#40;addr&gt;=0x3F00&#41; addr = 0x3F00 | &#40;addr &amp; 0x1F&#41;;<br />&nbsp; &nbsp;if &#40;addr&gt;0x2FFF &amp;&amp; addr&lt;0x3F00&#41; addr = 0x3000 | &#40;addr &amp; 0xEFF&#41;;<br />&nbsp; &nbsp;if &#40;addr&gt;=0x2000 &amp;&amp; addr&lt;0x2400&#41; addr = &#40;addr - 0x2000&#41; + PPU-&gt;ntmap&#91;0&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else if &#40;addr&gt;=0x2400 &amp;&amp; addr&lt;0x2800&#41; addr = &#40;addr - 0x2400&#41; + PPU-&gt;ntmap&#91;1&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else if &#40;addr&gt;=0x2800 &amp;&amp; addr&lt;0x2C00&#41; addr = &#40;addr - 0x2800&#41; + PPU-&gt;ntmap&#91;2&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else if &#40;addr&gt;=0x2C00 &amp;&amp; addr&lt;0x3000&#41; addr = &#40;addr - 0x2C00&#41; + PPU-&gt;ntmap&#91;3&#93;;<br />&nbsp; &nbsp;if &#40;addr&lt;0x2000&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;tempbyte = cartridge.CHRbank&#91;addr&gt;&gt;10&#93;&#91;addr&amp;1023&#93;;&nbsp; &nbsp;//&nbsp; &lt;-- Setting Tempbyte<br />&nbsp; &nbsp;&nbsp; &nbsp;if &#40;cartridge.mapper == 9&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;switch &#40;addr &amp; 0x3FF0&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x0FD0: map9-&gt;latch1 = 0xFD; CHRswap&#40;&amp;cartridge, 0, map9-&gt;latch0_fd, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x0FE0: map9-&gt;latch1 = 0xFE; CHRswap&#40;&amp;cartridge, 0, map9-&gt;latch0_fe, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x1FD0: map9-&gt;latch2 = 0xFD; CHRswap&#40;&amp;cartridge, 1, map9-&gt;latch1_fd, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x1FE0: map9-&gt;latch2 = 0xFE; CHRswap&#40;&amp;cartridge, 1, map9-&gt;latch1_fe, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;return&#40;tempbyte&#41;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;if &#40;addr &gt;= 0x3F00&#41; tempbyte = VRAM&#91;addr&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else tempbyte = PPU-&gt;bytebuffer;&nbsp; &nbsp; //&nbsp; &lt;-- Throwing it out<br />&nbsp; &nbsp;PPU-&gt;bytebuffer = VRAM&#91;addr&#93;;<br />&nbsp; &nbsp;return&#40;tempbyte&#41;;<br />&#125;<br /></div><br /><br />Why are you setting Tempbyte to something, only to later throw it out?<br />Looks like you are fetching something incorrect for the actual data read out.</div>
<br />
<br />that's because (if i understand correctly) when reading from the area of the PPU memory map with the palette data, that is returned without having a 1-byte buffer delay, but the value is still stored in the buffer.
<br />
<br />the return(tempbyte) is there instead of return(PPU-&gt;bytebuffer) in case it's a palette read. the palette data can be returned immediately and still get buffered.
<br />
<br />is this wrong?
<br />
<br />EDIT: oh i see your first comment there. there is a return(tempbyte) in that if block, it returns that value if the PPU address is under $2000. it's not thrown out.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4572"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p90342"></a>
				<b class="postauthor">Dwedit</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90342"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90342#p90342"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Feb 22, 2012 3:04 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=53.png" width="68" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Nov 19, 2004 7:35 pm<br /><b>Posts:</b> 2546
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">You're reading from mapped video memory in one place, then using the VRAM array in another place.
<br />
<br />What goes into the "byte buffer" should be what's in mapped video memory, not simply the contents of "VRAM".
<br />
<br />Edit: Re-read your second post.  The delay happens with reading character data as well, why are you immediately returning the value?  I didn't see that part where there was a return in the middle of the IF block.
<br />
<br />
<br />Edit: I think this should do it:
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">uint8_t readPPU&#40;uint16_t addr&#41; &#123;<br />&nbsp; &nbsp;uint8_t tempbyte;<br />&nbsp; &nbsp;addr &amp;= 0x3FFF;<br />&nbsp; &nbsp;if &#40;addr&gt;=0x3F00&#41; addr = 0x3F00 | &#40;addr &amp; 0x1F&#41;;<br />&nbsp; &nbsp;if &#40;addr&gt;0x2FFF &amp;&amp; addr&lt;0x3F00&#41; addr = 0x3000 | &#40;addr &amp; 0xEFF&#41;;<br />&nbsp; &nbsp;if &#40;addr&gt;=0x2000 &amp;&amp; addr&lt;0x2400&#41; addr = &#40;addr - 0x2000&#41; + PPU-&gt;ntmap&#91;0&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else if &#40;addr&gt;=0x2400 &amp;&amp; addr&lt;0x2800&#41; addr = &#40;addr - 0x2400&#41; + PPU-&gt;ntmap&#91;1&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else if &#40;addr&gt;=0x2800 &amp;&amp; addr&lt;0x2C00&#41; addr = &#40;addr - 0x2800&#41; + PPU-&gt;ntmap&#91;2&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else if &#40;addr&gt;=0x2C00 &amp;&amp; addr&lt;0x3000&#41; addr = &#40;addr - 0x2C00&#41; + PPU-&gt;ntmap&#91;3&#93;;<br />&nbsp; &nbsp;if &#40;addr&lt;0x2000&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;tempbyte = cartridge.CHRbank&#91;addr&gt;&gt;10&#93;&#91;addr&amp;1023&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;if &#40;cartridge.mapper == 9&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;switch &#40;addr &amp; 0x3FF0&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x0FD0: map9-&gt;latch1 = 0xFD; CHRswap&#40;&amp;cartridge, 0, map9-&gt;latch0_fd, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x0FE0: map9-&gt;latch1 = 0xFE; CHRswap&#40;&amp;cartridge, 0, map9-&gt;latch0_fe, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x1FD0: map9-&gt;latch2 = 0xFD; CHRswap&#40;&amp;cartridge, 1, map9-&gt;latch1_fd, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0x1FE0: map9-&gt;latch2 = 0xFE; CHRswap&#40;&amp;cartridge, 1, map9-&gt;latch1_fe, 4096&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />//new code:<br />uint8_t oldbyte = PPU-&gt;bytebuffer;<br />PPU-&gt;bytebuffer = tempbyte;<br />return oldbyte;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;if &#40;addr &gt;= 0x3F00&#41; tempbyte = VRAM&#91;addr&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else tempbyte = PPU-&gt;bytebuffer;<br />&nbsp; &nbsp;PPU-&gt;bytebuffer = VRAM&#91;addr&#93;;<br />&nbsp; &nbsp;return&#40;tempbyte&#41;;<br />&#125;<br /></div></div>

					
						<div class="postbody"><br />_________________<br />Here come the fortune cookies!  Here come the fortune cookies!  They're wearing paper hats!</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=53"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p90344"></a>
				<b class="postauthor">miker00lz</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90344"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90344#p90344"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Feb 22, 2012 3:16 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4572.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Sep 23, 2010 7:28 pm<br /><b>Posts:</b> 145
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">wow, i miss some pretty obvious things sometimes. *smacks self*
<br />
<br /><img src="http://rubbermallet.org/smbtitle2.png" alt="Image" />
<br />
<br />you, sir, are my hero.  <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /> 
<br />
<br />i'm starting to wonder what else that may have fixed in other games.
<br />
<br />now to figure out the APU sweeps, and that should cover all of the obvious glaring issues with my emu. i've never understood exactly how the square period stuff is modified by the sweeps.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4572"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p90376"></a>
				<b class="postauthor">Bisqwit</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90376">Re: square sweeps</a></div><div style="float: right;"><a href="./viewtopic.php?p=90376#p90376"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Feb 23, 2012 2:30 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="http://bisqwit.iki.fi/kala/hloop.gif" width="60" height="60" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Oct 14, 2011 1:09 am<br /><b>Posts:</b> 186
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">miker00lz wrote:</div><div class="quotecontent">i've never understood exactly how the square period stuff is modified by the sweeps.</div>
<br />
<br />From my emulator:
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Sweep tick &#40;square waves only&#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40;HalfTick &amp;&amp; c &lt; 2 &amp;&amp; count&#40;ch.sweep_delay, ch.reg.SweepRate&#41;&#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40;wl &gt;= 8 &amp;&amp; ch.reg.SweepEnable &amp;&amp; ch.reg.SweepShift&#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int s = wl &gt;&gt; ch.reg.SweepShift, d&#91;4&#93; = &#123;s, s, ~s, -s&#125;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wl += d&#91;ch.reg.SweepDecrease*2 + c&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40;wl &lt; 0x800&#41; ch.reg.WaveLength = wl;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125;</div>
<br />
<br />I.e. on half-ticks (120 Hz or 96 Hz), for both square-channels, their internal sweep delay counter is decremented by one. If it reaches zero, it is reinitialized to SweepRate (which is bits 6―4 from register 1) and the following is performed, on the condition that current_period ≥ 8, and SweepEnable is set (bit 7 from register 1), and SweepShift is not zero (bits 2―0 from register 1):
<br />
<br />A delta is calculated from: current_period, right-shifted by SweepShift (which is bits 2―0 from register 1).
<br />
<br />That delta is then added to the current_period in one of the following four ways, depending on SweepDecrease (bit 3 from register 1) and the channel number:
<br />
<br />SweepDecrease=0, channel=0:   current_period += delta;
<br />SweepDecrease=0, channel=1:   current_period += delta;
<br />SweepDecrease=1, channel=0:   current_period += ~delta; // This is equivalent to −(delta−1).
<br />SweepDecrease=1, channel=1:   current_period += −delta;
<br />
<br />Finally, if the result is ≥ 0x800, the old current_period is preserved and the above calculations are ignored.
<br />
<br />EDIT: on the condition that current_period ≥ 8, not ≤.</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=5043">Bisqwit</a> on Sat Feb 25, 2012 5:46 am, edited 1 time in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5043"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p90419"></a>
				<b class="postauthor">miker00lz</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90419"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90419#p90419"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Feb 23, 2012 1:02 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4572.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Sep 23, 2010 7:28 pm<br /><b>Posts:</b> 145
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">great explanation, thanks! nice and simple. i'll work on adding the sweeps now. what i was confused about before was what to do with the calculated sweep result.
<br />
<br /><img src="http://rubbermallet.org/banana.gif" alt="Image" /></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4572"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p90588"></a>
				<b class="postauthor">miker00lz</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90588"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90588#p90588"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Feb 26, 2012 4:38 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4572.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Sep 23, 2010 7:28 pm<br /><b>Posts:</b> 145
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">bisqwit, i still seem to be having a problem with the sweep. it is kind of working now, but the sweep doesn't seem to stay on as long as it should. it goes back to the original period prematurely.
<br />
<br />here's a short 7 MB AVI of playing through the first level of SMB1. you can notice it mostly when i enter a pipe.
<br />
<br /><!-- m --><a class="postlink" href="http://rubbermallet.org/mario.avi">http://rubbermallet.org/mario.avi</a><!-- m -->
<br />
<br />
<br />
<br />here's what i'm doing on every frame sequencer tick:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">void frameseqAPU&#40;&#41; &#123;<br />&nbsp; &nbsp; if &#40;clockticks6502 &lt; seqticknext&#41; return;<br />&nbsp; &nbsp;&nbsp; &nbsp;else seqticknext += seqtickgap;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if&nbsp; &#40;seqmode == 4&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;switch &#40;seqstep&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;envclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;linearclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 1:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lengthclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;sweepclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;envclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;linearclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 2:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;envclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;linearclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 3:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;setinterruptAPU&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lengthclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;sweepclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;envclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;linearclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;seqstep = &#40;seqstep + 1&#41; % seqmode;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125; else if &#40;seqmode == 5&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;switch &#40;seqstep&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 0:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lengthclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;sweepclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;envclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;linearclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 1:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;envclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;linearclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 2:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;lengthclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;sweepclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;envclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;linearclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 3:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;envclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;linearclock&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 4:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;seqstep = &#40;seqstep + 1&#41; % seqmode;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&#125;</div><br /><br /><br /><br />here is the sweepclock() function:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">void sweepclock&#40;&#41; &#123;<br />&nbsp; &nbsp;int32_t s, wl, d&#91;4&#93;;<br />&nbsp; &nbsp;uint8_t chan;<br /><br />&nbsp; &nbsp;for &#40;chan=0; chan&lt;2; chan++&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if &#40;&#40;--square&#91;chan&#93;.sweep == 0&#41; || square&#91;chan&#93;.sweepreload&#41; square&#91;chan&#93;.sweep = square&#91;chan&#93;.sweepperiod;<br />&nbsp; &nbsp;&nbsp; &nbsp;if &#40;&#40;square&#91;chan&#93;.period &gt;= 8&#41; &amp;&amp; square&#91;chan&#93;.sweepenable &amp;&amp; square&#91;chan&#93;.sweep&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;wl = square&#91;chan&#93;.period;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;s = wl &gt;&gt; square&#91;chan&#93;.sweep;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;d&#91;0&#93; = s; d&#91;1&#93; = s; d&#91;2&#93; = ~s; d&#91;3&#93; = -s;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;wl += d&#91;square&#91;chan&#93;.negate*2 + chan&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if &#40;wl &lt; 0x800&#41; square&#91;chan&#93;.sweepresult = wl;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else square&#91;chan&#93;.sweepresult = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125; else square&#91;chan&#93;.sweepresult = 0;<br />&nbsp; &nbsp;&#125;<br />&#125;</div><br /><br /><br /><br />and this code runs after every CPU cycle to see if it's time to update the square channels' output waveform:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp;if &#40;square&#91;0&#93;.sweepenable &amp;&amp; square&#91;0&#93;.sweepresult&#41; squaretarget = square&#91;0&#93;.sweepresult;<br />&nbsp; &nbsp;&nbsp; &nbsp;else squaretarget = square&#91;0&#93;.period;<br />&nbsp; &nbsp;if &#40;&#40;clockticks6502 - square&#91;0&#93;.lasttick&#41; &gt;= &#40;squaretarget &lt;&lt; 1&#41;&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if &#40;square&#91;0&#93;.enabled &amp;&amp; &#40;squaretarget &gt; 7&#41; &amp;&amp; &#40;square&#91;0&#93;.lengthcounter &gt; 0&#41;&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;channels&#91;0&#93; = square&#91;0&#93;.envelope * square_duty&#91;square&#91;0&#93;.duty&#93;&#91;square&#91;0&#93;.dutypos&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;square&#91;0&#93;.dutypos = &#40;square&#91;0&#93;.dutypos + 1&#41; &amp; 7;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125; else channels&#91;0&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;if &#40;square&#91;0&#93;.sweepenable &amp;&amp; !square&#91;0&#93;.sweepresult&#41; channels&#91;0&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;square&#91;0&#93;.lasttick = clockticks6502 - &#40;&#40;clockticks6502 - square&#91;0&#93;.lasttick&#41; - &#40;squaretarget &lt;&lt; 1&#41;&#41;;<br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;if &#40;square&#91;1&#93;.sweepenable &amp;&amp; square&#91;1&#93;.sweepresult&#41; squaretarget = square&#91;1&#93;.sweepresult;<br />&nbsp; &nbsp;&nbsp; &nbsp;else squaretarget = square&#91;1&#93;.period;<br />&nbsp; &nbsp;if &#40;&#40;clockticks6502 - square&#91;1&#93;.lasttick&#41; &gt;= &#40;squaretarget &lt;&lt; 1&#41;&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if &#40;square&#91;1&#93;.enabled &amp;&amp; &#40;squaretarget &gt; 7&#41; &amp;&amp; &#40;square&#91;1&#93;.lengthcounter &gt; 0&#41;&#41; &#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;channels&#91;1&#93; = square&#91;1&#93;.envelope * square_duty&#91;square&#91;1&#93;.duty&#93;&#91;square&#91;1&#93;.dutypos&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;square&#91;1&#93;.dutypos = &#40;square&#91;1&#93;.dutypos + 1&#41; &amp; 7;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125; else channels&#91;1&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;if &#40;square&#91;1&#93;.sweepenable &amp;&amp; !square&#91;1&#93;.sweepresult&#41; channels&#91;1&#93; = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;square&#91;1&#93;.lasttick = clockticks6502 - &#40;&#40;clockticks6502 - square&#91;1&#93;.lasttick&#41; - &#40;squaretarget &lt;&lt; 1&#41;&#41;;<br />&nbsp; &nbsp;&#125;</div>
<br />
<br />
<br />
<br />does anything seem obviously wrong? thanks!</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4572"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p90592"></a>
				<b class="postauthor">Zepper</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90592"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90592#p90592"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Feb 26, 2012 4:48 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Formerly Fx3</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=39.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Nov 12, 2004 4:59 pm<br /><b>Posts:</b> 1965<br /><b>Location:</b> Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Offtopic, but what palette are you using?</div>

					
						<div class="postbody"><br />_________________<br /><strong>Zepper</strong><br /><a href="http://rocknes.web.fc2.com/" class="postlink"><em>RockNES developer</em></a></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=39"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p90596"></a>
				<b class="postauthor">miker00lz</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90596"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90596#p90596"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Feb 26, 2012 5:17 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4572.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Sep 23, 2010 7:28 pm<br /><b>Posts:</b> 145
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">i can't remember where i got it, this is the one i've been using since i first attempted a NES emu back in 2010 but this is my color array:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">const uint32_t paletteNES&#91;64&#93; = &#123;<br />&nbsp; &nbsp;0x808080, 0x0000BB, 0x3700BF, 0x8400A6,<br />&nbsp; &nbsp;0xBB006A, 0xB7001E, 0xB30000, 0x912600,<br />&nbsp; &nbsp;0x7B2B00, 0x003E00, 0x00480D, 0x003C22,<br />&nbsp; &nbsp;0x002F66, 0x000000, 0x050505, 0x050505,<br /><br />&nbsp; &nbsp;0xC8C8C8, 0x0059FF, 0x443CFF, 0xB733CC,<br />&nbsp; &nbsp;0xFF33AA, 0xFF375E, 0xFF371A, 0xD54B00,<br />&nbsp; &nbsp;0xC46200, 0x3C7B00, 0x1E8415, 0x009566,<br />&nbsp; &nbsp;0x0084C4, 0x111111, 0x090909, 0x090909,<br /><br />&nbsp; &nbsp;0xFFFFFF, 0x0095FF, 0x6F84FF, 0xD56FFF,<br />&nbsp; &nbsp;0xFF77CC, 0xFF6F99, 0xFF7B59, 0xFF915F,<br />&nbsp; &nbsp;0xFFA233, 0xA6BF00, 0x51D96A, 0x4DD5AE,<br />&nbsp; &nbsp;0x00D9FF, 0x666666, 0x0D0D0D, 0x0D0D0D,<br /><br />&nbsp; &nbsp;0xFFFFFF, 0x84BFFF, 0xBBBBFF, 0xD0BBFF,<br />&nbsp; &nbsp;0xFFBFEA, 0xFFBFCC, 0xFFC4B7, 0xFFCCAE,<br />&nbsp; &nbsp;0xFFD9A2, 0xCCE199, 0xAEEEB7, 0xAAF7EE,<br />&nbsp; &nbsp;0xB3EEFF, 0xDDDDDD, 0x111111, 0x111111<br />&#125;;</div>
<br />
<br />it doesn't look as good in the AVI i think because it's XViD encoded.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4572"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p90600"></a>
				<b class="postauthor">Dwedit</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90600"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90600#p90600"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Feb 26, 2012 6:31 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=53.png" width="68" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Nov 19, 2004 7:35 pm<br /><b>Posts:</b> 2546
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Have you fixed the basic sound pitch problem yet?  All sounds are at the wrong pitch, they're about a half step lower than they should be.</div>

					
						<div class="postbody"><br />_________________<br />Here come the fortune cookies!  Here come the fortune cookies!  They're wearing paper hats!</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=53"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p90613"></a>
				<b class="postauthor">miker00lz</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p90613"></a></div><div style="float: right;"><a href="./viewtopic.php?p=90613#p90613"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Feb 26, 2012 10:00 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4572.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Sep 23, 2010 7:28 pm<br /><b>Posts:</b> 145
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Dwedit wrote:</div><div class="quotecontent">Have you fixed the basic sound pitch problem yet?  All sounds are at the wrong pitch, they're about a half step lower than they should be.</div>
<br />
<br />they are still? i thought i had it taken care of, still a little off? i must be waiting for a few too many clock cycles while generating each byte of the waveforms.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4572"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=3&amp;t=8647"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=3"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=3&amp;t=8647"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 12 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=3">NESemdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 1 guest</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="8647" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3" selected="selected">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="11">&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;NESdev China</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="12">&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;GBDev</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>

<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>

</body>
</html>