<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=10584" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2013-12-19T14:51:11-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=10584</id>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2013-12-19T14:51:11-07:00</updated>
<published>2013-12-19T14:51:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122682#p122682</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122682#p122682"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122682#p122682"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />Naming is one of the biggest challenges when creating programs. You want it descriptive of what the thing does or is used for, distinguishing from what other things do, unchanging as the program evolves, true to the usual meaning of the word, preferably a common word most programmers understand, not overly long to type. You've got to solve these for dozens of names a day, and they don't have any impact on generated code so it's difficult to find the motivation to think of the long-term.<br /></div><br /><br />I couldn't agree more, but in this case Mask[] is only used twice for obvious reasons so its not important. I was gonna change it's name later on anyway.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Thu Dec 19, 2013 2:51 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2013-12-19T14:44:06-07:00</updated>
<published>2013-12-19T14:44:06-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122681#p122681</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122681#p122681"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122681#p122681"><![CDATA[
Naming is one of the biggest challenges when creating programs. You want it descriptive of what the thing does or is used for, distinguishing from what other things do, unchanging as the program evolves, true to the usual meaning of the word, preferably a common word most programmers understand, not overly long to type. You've got to solve these for dozens of names a day, and they don't have any impact on generated code so it's difficult to find the motivation to think of the long-term.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Thu Dec 19, 2013 2:44 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2013-12-19T03:31:38-07:00</updated>
<published>2013-12-19T03:31:38-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122676#p122676</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122676#p122676"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122676#p122676"><![CDATA[
Hehe, it was the first verb that came to find when I wrote it years ago.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Thu Dec 19, 2013 3:31 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2013-12-18T19:14:23-07:00</updated>
<published>2013-12-18T19:14:23-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122665#p122665</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122665#p122665"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122665#p122665"><![CDATA[
Yeah, a mask is like a literal mask, blocking things out and only letting some things show through. For example:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">const uint8_t oam_mask &#91;4&#93; = { 0xff, 0xff, 0xe3, 0xff };<br />...<br />result = oam &#91;addr&#93; &amp; oam_mask &#91;addr % 4&#93;;</div><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Wed Dec 18, 2013 7:14 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[thefox]]></name></author>
<updated>2013-12-18T02:52:34-07:00</updated>
<published>2013-12-18T02:52:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122652#p122652</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122652#p122652"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122652#p122652"><![CDATA[
<div class="quotetitle">WedNESday wrote:</div><div class="quotecontent"><br /><div class="quotetitle">blargg wrote:</div><div class="quotecontent"><div class="quotetitle">WedNESday wrote:</div><div class="quotecontent">Here is some code from WedNESday on how to handle the palette thing you just mentioned. This is the best way to go.<br /><br /><tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">int Mask[16] = {0, 1, 2, 3, 0, 5, 6, 7, 0, 9, 10, 11, 0, 13, 14, 15};</tt><br /></div><br />What do you mask (AND) with these entries?</div><br /><br />Mask[Tile1Bits + Tile2Bits + AttributeBits];<br /><br />Why? How do you do yours?</div><br />I think the point was the naming. &quot;Mask&quot; implies your ANDing something with them, but it looks like the table just contains an index in to the palette.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=80">thefox</a> — Wed Dec 18, 2013 2:52 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2013-12-18T02:47:15-07:00</updated>
<published>2013-12-18T02:47:15-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122650#p122650</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122650#p122650"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122650#p122650"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br /><div class="quotetitle">WedNESday wrote:</div><div class="quotecontent">Here is some code from WedNESday on how to handle the palette thing you just mentioned. This is the best way to go.<br /><br /><tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">int Mask[16] = {0, 1, 2, 3, 0, 5, 6, 7, 0, 9, 10, 11, 0, 13, 14, 15};</tt><br /></div><br />What do you mask (AND) with these entries?</div><br /><br />Mask[Tile1Bits + Tile2Bits + AttributeBits];<br /><br />Why? How do you do yours?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Wed Dec 18, 2013 2:47 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2013-12-17T20:39:07-07:00</updated>
<published>2013-12-17T20:39:07-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122645#p122645</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122645#p122645"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122645#p122645"><![CDATA[
<div class="quotetitle">WedNESday wrote:</div><div class="quotecontent"><br />Here is some code from WedNESday on how to handle the palette thing you just mentioned. This is the best way to go.<br /><br /><tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">int Mask[16] = {0, 1, 2, 3, 0, 5, 6, 7, 0, 9, 10, 11, 0, 13, 14, 15};</tt><br /></div><br />What do you mask (AND) with these entries?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Tue Dec 17, 2013 8:39 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2013-12-17T18:59:10-07:00</updated>
<published>2013-12-17T18:59:10-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122640#p122640</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122640#p122640"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122640#p122640"><![CDATA[
Doesn't even need to be XML; it can be JSON or tab-separated or a variant on INI. All you need is a way to start the emulator playing a movie from the command line (which you need anyway for the TAS crowd) at warp speed (which the TAS crowd will appreciate once you add AVI export) and <a href="http://wiki.nesdev.com/w/index.php/Emulator_tests#Automated_testing" class="postlink">hash the current screenshot</a>. Of course you need a beefy multicore PC and an efficient emulator if you want to run 200 test ROMs in a reasonable time.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Tue Dec 17, 2013 6:59 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[cpow]]></name></author>
<updated>2013-12-17T18:44:54-07:00</updated>
<published>2013-12-17T18:44:54-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122639#p122639</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122639#p122639"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122639#p122639"><![CDATA[
<div class="quotetitle">ArsonIzer wrote:</div><div class="quotecontent"><br />I guess I can get pretty careless at times where I'm trying to work towards a goal too fast <img src="http://forums.nesdev.com/images/smilies/icon_razz.gif" alt=":P" title="Razz" /> I'm happy that there are so many tests though, I'd be lost without them.<br /></div><br />If you're using a UI toolkit or environment that supports parsing XML files, your emulator has the capability to feed in captured controller inputs, your emulator has the ability to stop after a specific number of PPU cycles, and your UI toolkit or environment has SHA-1 capability, you could do what I did and automate the process of running multiple [almost two hundred in my case] test ROMs.  Some test cases repeat test ROMs with different inputs to produce different result screens.  It is very handy.  For example I just realized I'm failing one of the sprite overflow tests now   <img src="http://forums.nesdev.com/images/smilies/icon_question.gif" alt=":?:" title="Question" />.  Coupled with git bisect, a test automation can shave *minutes* off of bug chasing.   <img src="http://forums.nesdev.com/images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3705">cpow</a> — Tue Dec 17, 2013 6:44 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2013-12-17T18:30:33-07:00</updated>
<published>2013-12-17T18:30:33-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122637#p122637</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122637#p122637"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122637#p122637"><![CDATA[
<div class="quotetitle">miker00lz wrote:</div><div class="quotecontent"><br />Yeah as a general rule, avoid if-else statements whenever you can in heavily-used functions. They hurt performance quite a bit, at least on x86. Taken branches hurt. When you DO have to use if-else, you should put what's most likely to be the true case under &quot;else&quot;. It takes a fair amount more clock cycles when a branch is taken because it then has to also calculate the effective address of the branch destination. When not taken, the code just falls through.<br /><br />Modern x86 chips may not be so awful, I'm not sure, but at least in the old days on the 8088/286 era chips it was a substantial penalty.<br /></div>Branch penalty on the 8086 up through the 80386 weren't good, but they were comparable to many other operation times, so branching was still usually the right choice. With later machines, the cost of a cache miss started being huge enough, even with speculative fetch, such that using tables are better for things that never used to be true (at least as long as CS:IP/EIP/RIP is still in-order).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Tue Dec 17, 2013 6:30 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2013-12-17T17:10:06-07:00</updated>
<published>2013-12-17T17:10:06-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122635#p122635</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122635#p122635"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122635#p122635"><![CDATA[
<div class="quotetitle">miker00lz wrote:</div><div class="quotecontent"><br />Modern x86 chips may not be so awful, I'm not sure, but at least in the old days on the 8088/286 era chips it was a substantial penalty.<br /></div><br /><br />switches hurt too. Even my Pentium III felt the pain.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Tue Dec 17, 2013 5:10 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[miker00lz]]></name></author>
<updated>2013-12-17T16:31:46-07:00</updated>
<published>2013-12-17T16:31:46-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122633#p122633</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122633#p122633"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122633#p122633"><![CDATA[
Yeah as a general rule, avoid if-else statements whenever you can in heavily-used functions. They hurt performance quite a bit, at least on x86. Taken branches hurt. When you DO have to use if-else, you should put what's most likely to be the true case under &quot;else&quot;. It takes a fair amount more clock cycles when a branch is taken because it then has to also calculate the effective address of the branch destination. When not taken, the code just falls through.<br /><br />Modern x86 chips may not be so awful, I'm not sure, but at least in the old days on the 8088/286 era chips it was a substantial penalty.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4572">miker00lz</a> — Tue Dec 17, 2013 4:31 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ArsonIzer]]></name></author>
<updated>2013-12-17T13:30:49-07:00</updated>
<published>2013-12-17T13:30:49-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122623#p122623</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122623#p122623"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122623#p122623"><![CDATA[
<div class="quotetitle">WedNESday wrote:</div><div class="quotecontent"><br />@ArsonIzer<br /><br />Contra uses 8x16 sprites to draw the clothes of the men in the title screen.<br /><br />Here is some code from WedNESday on how to handle the palette thing you just mentioned. This is the best way to go.<br /><br /><tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">int Mask[16] = {0, 1, 2, 3, 0, 5, 6, 7, 0, 9, 10, 11, 0, 13, 14, 15};</tt><br /></div><br /><br />Of course! That's why my previous version with only 8x8 sprite implementation draws the shirts partially, while my cycle-accurate BG only PPU draws jack diddly-squat. I really need to implement more than this measly 20% of the PPU before I start complaining -_-<br /><br />Thanks mate. Also, that mask thing looks good; I'll use it instead of the if-else statement.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6075">ArsonIzer</a> — Tue Dec 17, 2013 1:30 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2013-12-17T12:36:32-07:00</updated>
<published>2013-12-17T12:36:32-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122620#p122620</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122620#p122620"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122620#p122620"><![CDATA[
@ArsonIzer<br /><br />Contra uses 8x16 sprites to draw the clothes of the men in the title screen.<br /><br />Here is some code from WedNESday on how to handle the palette thing you just mentioned. This is the best way to go.<br /><br /><tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">int Mask[16] = {0, 1, 2, 3, 0, 5, 6, 7, 0, 9, 10, 11, 0, 13, 14, 15};</tt><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Tue Dec 17, 2013 12:36 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ArsonIzer]]></name></author>
<updated>2013-12-17T10:47:18-07:00</updated>
<published>2013-12-17T10:47:18-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122612#p122612</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122612#p122612"/>
<title type="html"><![CDATA[Re: Original Mario Bros bug on my emulator?]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10584&amp;p=122612#p122612"><![CDATA[
<div class="quotetitle">Quietust wrote:</div><div class="quotecontent"><br />My guess is that you're using the background color from the palette specified for the tile rather than always using the background from palette 0.<br /></div><br /><br />Actually, this is my code for it:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">            <br />if (paletteIndex % 4 != 0)<br />    c = Palette.COLORS&#91;memory.read(0x3F00 + paletteIndex)&#93;;<br />} else {<br />    c = Palette.COLORS&#91;memory.read(0x3F00)&#93;;<br />}<br /></div><br /><br />c being a Color object in Java (just R, G, B and A values with some methods), and paletteIndex being a number from 0x0 to 0xF, denoting which of the palettes and which of the colors to use. I think this is right, since if paletteIndex % 4 == 0, meaning that it's one of the memory values 0x04, 0x08 and 0x0C, it will automatically fetch the background color at 0x3F00.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6075">ArsonIzer</a> — Tue Dec 17, 2013 10:47 am</p><hr />
]]></content>
</entry>
</feed>