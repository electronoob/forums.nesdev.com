<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - .fds format: Can checksums be heuristically detected?</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - NESdev" href="http://forums.nesdev.com/feed.php?f=2" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - .fds format: Can checksums be heuristically detected?" href="http://forums.nesdev.com/feed.php?f=2&amp;t=15895" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '1');
	var per_page = '15';
	var base_url = './viewtopic.php?f=2&amp;t=15895';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<!--<div style="float: right;">
					<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick">
					<input type="hidden" name="hosted_button_id" value="X2HM4WNR5YT8S">
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
					<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
					</form>
				</div>-->
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=minion"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Fri Aug 17, 2018 12:26 am<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=2">NESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />
	

					<center>
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- NesDev Forums -->
					<ins class="adsbygoogle"
						 style="display:block"
						 data-ad-client="ca-pub-7801010229099644"
						 data-ad-slot="7979066809"
						 data-ad-format="auto"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>
					</center>
	<br />


<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=2&amp;t=15895">.fds format: Can checksums be heuristically detected?</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=2"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=2&amp;t=15895"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>2</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 21 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=2&amp;t=15895&amp;start=15">2</a> &nbsp;<a href="./viewtopic.php?f=2&amp;t=15895&amp;start=15">Next</a></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=2&amp;t=15895&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=2&amp;t=15895&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=2&amp;t=15895&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p194867"></a>
				<b class="postauthor">hex_usr</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194867">.fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194867#p194867"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 11:55 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat May 09, 2015 7:21 pm<br /><b>Posts:</b> 78
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">The .fds format, <a href="http://wiki.nesdev.com/w/index.php/Family_Computer_Disk_System#Data_not_stored_in_the_FDS_image" class="postlink">as we all know</a>, omits checksums that are physically present on the disks. This oversight makes it impossible to emulate a feature that was believed to not be important.<br /><br />I would argue that that feature really is important, but this is based on speculation, not hard facts.<br /><br /><a href="http://wiki.nesdev.com/w/index.php/Family_Computer_Disk_System#File_amount_block_.28block_2.29" class="postlink">Games can lie to the BIOS about how many files are on the disk as an anti-piracy measure.</a> The ones that do this have their own copies of the loading routine that hard-codes the actual number of files, making the file amount block unreliable for its intended purpose. I don't know this for certain, but I suspect that those very same loading routines can also ignore checksum errors reported by the RAM adapter, meaning that any number of files can deliberately include invalid checksums to trick pirates. It may even be possible that a disk loading routine will err out if the checksum really is correct.<br /><br />And the .fds format took those checksums out, so that emulators would never know.<br /><br />Nintendo's .qd format is <em>better</em> because it includes checksums, but not only does it omit the 00 padding between blocks, it also has one flaw not in the .fds format: it can take 65,536 bytes per side instead of the 65,500 that actual disks could hold!<br /><br />So I'm wondering if it is possible to expand the .fds format to make checksums optional instead of forbidden. I'd rather not have the header modified to indicate the presence of checksums; most emulators support leaving out the header entirely because it's practically useless right now, just like Super Famicom and PC Engine copier headers. So I'll argue for heuristic detection.<br /><br />Block types 1, 2, and 3, which are the disk info block, file amount block, and the file header block respectively, always have fixed sizes of 56, 2, and 16 when counting the block ID and omitting the checksum. This means that, no matter what, $0000 will always hold the byte 0x01, $0038 will always hold the byte 0x02, $003A will always hold the byte 0x03, and $004A will always hold the byte 0x04.<br /><br />If checksums are included, the block sizes above change to 58, 4, and 18 respectively, changing the locations of bytes 0x01, 0x02, 0x03, and 0x04 to $0000, $003A, $003E, and $0050 respectively.<br /><br />Thus, in order to detect whether a .fds file includes checksums, the emulator needs to verify the following:<br /><br />No checksums (all current .fds files)<br /><ul><li>The addresses $0038, $003A, and $004A hold the byte values 0x02, 0x03, and 0x04.</li></ul><br />Checksums present (new .fds files created to have them)<br /><ul><li>The addresses $003A, $003E, and $0050 hold the byte values 0x02, 0x03, and 0x04.</li><li>The address $0038 holds the 16-bit checksum of the disk info block ($0000-$0037), and said checksum is correct.</li><li>The address $003C holds the 16-bit checksum of the file amount block ($003A-$003B), and said checksum is correct.</li><li>The address $004E holds the 16-bit checksum of the first file's header block ($003E-$004D), and said checksum is correct.</li></ul><br />So, is it at all practical to make such a drastic change, considering the age of the .fds format and most older emulators that supported it? Keep in mind, these heuristics make checksums <em>optional</em>, not <em>required</em>, so all the existing .fds dumps in existence would not become invalid as a result of incorporating these heuristics.<br /><br />================================================<br />By the way, the NesDev wiki does not include the formula for calculating checksums. The <a href="http://nesdev.com/FDS%20technical%20reference.txt" class="postlink">Famicom Disk System technical reference</a> by Brad Taylor includes a formula, but it's in x86 assembly. By comparing the checksums I am getting with those from Nintendo's .qd images, I have found that this C-like pseudocode converted from that x86 formula produces the correct checksum:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">uint16_t fds_crc(uint8_t* data, unsigned size) {<br />&nbsp; //Do not include any existing checksum, not even the blank checksums 00 00 or FF FF.<br />&nbsp; //The formula will automatically count 2 0x00 bytes without the programmer adding them manually.<br />&nbsp; //Also, do not include the gap terminator (0x80) in the data.<br />&nbsp; //If you wish to do so, change sum to 0x0000.<br />&nbsp; uint16_t sum = 0x8000;<br /><br />&nbsp; for(unsigned byte_index = 0; byte_index &lt; size + 2; byte_index++) {<br />&nbsp; &nbsp; uint8_t byte = byte_index &lt; size ? data&#91;byte_index&#93; : 0x00;<br />&nbsp; &nbsp; for(unsigned bit_index = 0; bit_index &lt; 8; bit_index++) {<br />&nbsp; &nbsp; &nbsp; bool bit = (byte &gt;&gt; bit_index) &amp; 1;<br />&nbsp; &nbsp; &nbsp; bool carry = sum &amp; 1;<br />&nbsp; &nbsp; &nbsp; sum = (sum &gt;&gt; 1) | (bit &lt;&lt; 15);<br />&nbsp; &nbsp; &nbsp; if(carry) sum ^= 0x8408;<br />&nbsp; &nbsp; }<br />&nbsp; }<br />&nbsp; return sum;<br />}</div><br />The byte sequence (80) 02 07 (00 00) should have the checksum 0x4BE3. Checksums are stored in little-endian order on the disk, so the data will become (80) 02 07 E3 4B.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7009"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p194872"></a>
				<b class="postauthor" style="color: #FF3300">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194872">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194872#p194872"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 12:34 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 20409<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">hex_usr wrote:</div><div class="quotecontent">Nintendo's .qd format is <em>better</em> because it includes checksums, but not only does it omit the 00 padding between blocks, it also has one flaw not in the .fds format: it can take 65,536 bytes per side instead of the 65,500 that actual disks could hold!</div><br />Is 65,500 just an assumption, or is that from Mitsumi's actual spec? Otherwise I'm of half a mind to just adopt .qd.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p194873"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194873">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194873#p194873"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 12:43 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 6592<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Thanks for the C checksum implementation! That is good reference.<br /><br />As for the format change, I don't really see why .QD isn't already doing exactly what you need. Why try to change .FDS?<br /><br />Whether it might &quot;allow&quot; 36 more bytes seems completely unimportant to me? You can enforce this limit yourself when you make the file, or in the emulator, if you want.<br /><br /><br />If you really want to change the .FDS format, though, I wouldn't really suggest messing with the disk data to store the &quot;use checksums&quot; metadata. That's real information that shouldn't be tampered with, and your whole point was accuracy.<br /><br />Just alter the 5 byte header. Instead of &quot;FDS&quot;,$1A use &quot;FDS&quot;,$1B maybe? It would also prevent emulators that don't support checksums from trying to run these files (which it will fail on, because this is not a backwards-compatible option).</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p194874"></a>
				<b class="postauthor">hex_usr</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194874">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194874#p194874"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 12:51 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat May 09, 2015 7:21 pm<br /><b>Posts:</b> 78
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">rainwarrior, I didn't mean to imply that we should change the existing dumps - just to use the format for new dumps in the future.<br /><br />I... actually don't know if 65,500 is accurate. The 65,500 statistic comes from the <a href="http://wiki.nesdev.com/w/index.php/Family_Computer_Disk_System" class="postlink">NesDev wiki article about the Famicom Disk System</a>, which cites <a href="http://nesdev.com/fds-nori.txt" class="postlink">this Japanese-language souce</a> (where it's broken into &quot;6550&quot; and &quot;0&quot; on adjacent lines).<br /><br />In theory, .qd could be used, but it stands for &quot;QuickDisk&quot; and does not indicate what system the disk image is intended for, so I'm not sure it's a good idea to use the extension directly.<br /><br />On my computer, I name my PlayStation 2 ISOs with a compound extension &quot;.ps2.iso&quot; to indicate which console they are for. At least Dolphin standardized &quot;.gcm&quot; for GameCube disk images.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7009"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p194876"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194876">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194876#p194876"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 12:54 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 6592<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">hex_usr wrote:</div><div class="quotecontent">rainwarrior, I didn't mean to imply that we should change the existing dumps - just to use the format for new dumps in the future.</div><br />That's not what I meant either. What I was saying is that &quot;CRCs or not&quot; is metadata information, so it has to go <em>outside</em> of the disk image information. Put it in the header, not in the disk info block. (Using a different FOURCC in the header for this purpose also prevents compatibility issues.)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p194877"></a>
				<b class="postauthor">hex_usr</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194877">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194877#p194877"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 12:59 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat May 09, 2015 7:21 pm<br /><b>Posts:</b> 78
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">But the CRCs are physically present on the disk. They are just as much a part of the disk data as the Super Famicom ROM's internal header at $7FB0-$7FDF/$FFB0-$FFDF is part of that format.<br /><br />A few years ago, I heard that a ROM site ruined its entire Nintendo 64 ROM collection by removing the first 64 (?) bytes because they confused internal ROM headers with copier headers. I want to make it very clear that I am making that distinction.<br /><br />Er, don't games that have save data need to write the CRC as well when saving data? Or does the RAM adapter handle that for them?<br /><br />EDIT: In case it's not clear, the CRCs are for each individual data block, not for the entire disk image as a whole.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7009"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p194880"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194880">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194880#p194880"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 1:18 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 6592<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">hex_usr wrote:</div><div class="quotecontent">But the CRCs are physically present on the disk.</div><br />Sorry, there is a miscommunication here.<br /><br />Yes, I understand you want to include the CRCs in the .FDS file, as 2 extra bytes on the relevant blocks. That part is not what I'm talking about.<br /><br />What you are proposing is to change the emulator behaviour to either include CRCs or exclude CRCs. What I think is a bad idea is having the emulator make this decision based on data in the disk image. This metadata decision should be made in the file header, <em>outside</em> the data on the disk image. It should not try to read any of the disk image before this decision has been made.<br /><br />My offhand suggestion was to do this by simply changing the FOURCC to &quot;FDS&quot;,$1B (CRCs) instead of &quot;FDS&quot;,$1A (no CRCs).</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p194883"></a>
				<b class="postauthor">hex_usr</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194883">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194883#p194883"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 1:30 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat May 09, 2015 7:21 pm<br /><b>Posts:</b> 78
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I won't deny that there is a chance that the heuristic could fail. That the checksum for the first data block could have a 0x02 for its least significant byte among other things.<br /><br />But many emulators support .fds images with no header at all, and without a header, how can they tell which is which? The only usable information in the header right now is a byte at $04 that tells how many disk sides are present, which is already possible to determine by checking the file size.<br /><br />Should SNES emulators mandate that .sfc ROMs include headers in order to tell them that they are LoROM or HiROM? No, they already figure that out by reading the headers at each of the possible locations for the header and comparing them with the mode byte (Mode 20 at $7FB0-$7FDF, Mode 21 at $FFB0-$FFDF, Mode 25 at $40FFB0-$40FFDF).<br /><br />Some Mega Drive emulators, including Kega Fusion, don't rely on the extension of the ROM to tell whether they are interleaved. They look for &quot;SEGA&quot; or &quot; SEGA&quot; at a certain address or addresses (it gets split when interleaved), so it is entirely possible to have a Mega Drive ROM with the extension &quot;.smd&quot; that is NOT interleaved and still load it in those emulators.<br /><br />I don't even know how some PC Engine emulators figure out ROM dumps where the bits in each byte are reversed (erroneously called &quot;encryption&quot; even though it comes from naÃ¯ve misdumpings with a dumper intended for the wrong region). I have a Bonk's Adventure ROM where, for each byte, bit 0 is bit 7, bit 1 is bit 6, and so on, and some PC Engine emulators can figure it out already. Notably, Mednafen is NOT among them.<br /><br />That's what I'm referring to with this proposal.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7009"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p194886"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194886">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194886#p194886"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 1:42 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 6592<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">hex_usr wrote:</div><div class="quotecontent">But many emulators support .fds images with no header at all, and without a header, how can they tell which is which? The only usable information in the header right now is a byte at $04 that tells how many disk sides are present, which is already possible to determine by checking the file size.</div><br />Yes, there are two versions of the format, one with a header, one without, both very widely supported.<br /><br />If you use one with a header, there is a place for metadata like changes to the format. If you use one without, there is not. I suppose a different FOURCC will make emulators think it is a &quot;headerless&quot; file though, unless they go by file size... kind of a catch 22.<br /><br />But... very simply only one of these two versions of the format can be extended with metadata: the headered version. The headerless version will forever be the &quot;no CRC&quot; version of the file.<br /><br />If you want accurate emulation the decision needs to be made before it starts interpreting the disk data. Like, you should be able to feed it random data, bad disk info blocks, etc. and it should behave &quot;accurately&quot;, and you can't do this if your metadata about behaviour is stored in the disk image itself.<br /><br /><br />It doesn't really matter what SNES/MD formats do. This is about what you <em>should</em> do, not whether it does something that some older formats did. If accuracy is really your goal, the behaviour decision needs to be outside the raw image. This is true of SFC files too-- auto detection based on the image data means you can't emulate &quot;bad&quot; image info without being able to force the alternate behaviour externally.<br /><br />At least, I thought the whole point here is that you want to emulate how &quot;improper&quot; image data works (i.e. bad CRCs), but unless you put that behaviour switch outside the disk image you're preventing the technique from working accurately with a bad disk info block as well. That's why I think you should do it in the header (if you're going to do this at all).</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p194893"></a>
				<b class="postauthor">hex_usr</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194893">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194893#p194893"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 2:23 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat May 09, 2015 7:21 pm<br /><b>Posts:</b> 78
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><span style="color: #ee4444">Well, I guess we should invalidate every single Super Famicom and Mega Drive emulator ever made.<br /><br />Let the word be known: external headers are absolutely mandatory to emulate the Super Famicom! If your ROM is headerless, add a header to it, or lose the ability to play it forever! This header is the only way to distinguish LoROMs from HiROMs! Also, all those patches on ROMhacking.net that are intended for headerless ROMs? No good, throw them all out!</span><br /><br />&lt;/sarcasm&gt;<br /><br />Maybe you think this would make it impossible to play disk images with CRCs in old, deprecated emulators that are not being updated anymore. And you would be right. Those emulators would simply use the same CRC-less images that already exist, just like they treat NES 2.0 headers as if they were the older iNES headers. But newer emulators exist, and they improve on what came before.<br /><br />Truthfully, I don't think this proposal is fully ideal, either. I am a fan of higan's cartridge folders, which use manifests to describe memory maps, and for the Famicom, split ROMs into separate PRG-ROM and CHR-ROM images. The problem is that higan does not yet emulate any add-on devices such as the Mega-CD which uses disk images, so it does not yet have a way to store disk images and/or their contents yet.<br /><br />If I really got to have my way, I would scrap the CRC-less version entirely, just as higan scrapped copier headers from Super Famicom ROMs (an included companion app is needed to strip them out instead). And maybe include the gaps between data blocks as well, but I don't know how well that would work considering Mitsumi's own .qd format does not include them, and I'm not sure if multiple production runs of a single game keep consistency on how many 0 bits are in each gap, which is necessary in order for patches to work.<br /><br />But the world is not so simple. The current format as it is now is defective. Just as so many Super Famicom ROMs have copier headers, so too does every .fds image lack CRCs, and so far, higan is the only emulator ever to even bother taking a stand against the former. That's why I bothered with this heuristics proposal in the first place. The devs behind ZSNES, Snes9x, and SD2SNES wouldn't do so, so why should I expect any Famicom emulator devs to do the same with CRC-less .fds images? This proposal is a compromise.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7009"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p194894"></a>
				<b class="postauthor">loopy</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194894">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194894#p194894"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 2:30 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 10:52 pm<br /><b>Posts:</b> 376<br /><b>Location:</b> UT
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">No.<br />No No No.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I would argue that that feature really is important, but this is based on speculation</div><br />I need more than your speculation for this to be really important.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I don't know this for certain, but I suspect that those very same loading routines can also ignore checksum errors reported by the RAM adapter, meaning that any number of files can deliberately include invalid checksums to trick pirates. It may even be possible that a disk loading routine will err out if the checksum really is correct.</div><br />Show me one game that does this (Hint: there aren't any). I've seen plenty of arguments like this. Foggy memories, claims that some game might/could have done this. Never seen one instance where it was actually an issue.<br /><br />For emulators: CRC is not useful. The BIOS doesn't look at it, emulators just need to set the &quot;CRC GOOD&quot; status flag. Maybe insert dummy bytes for padding. Emulators will always need to do a little &quot;magic&quot; anyway to deal with GAP data etc.<br />For games: CRC could -theoretically- be used for copy protection or something. But it isn't. And won't be, ever.<br />For homebrew: Actually an annoyance, requiring an extra step in the compilation process. <br />For &quot;preservation&quot; (the <a href="http://www.no-intro.org/" class="postlink">No-Intro</a> crowd): CRC is redundant. Games would fail to load without a correct CRC so nothing is being lost by not including it.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Nintendo's .qd format is better because it includes checksums, but not only does it omit the 00 padding between blocks, it also has one flaw not in the .fds format: it can take 65,536 bytes per side instead of the 65,500 that actual disks could hold!</div><br />Both numbers are arbitrary. &quot;Game Doctor&quot; disks are about 65 kB.  There is no absolute maximum size because it depends on physical properties of the drive (switch positions, head alignment, etc.)  00 padding affects the true game size, a disk with lots of files will need more space because of padding.  The point is, that number is meaningless. A good disk format should have no fixed length, IMO.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">So I'm wondering if it is possible to expand the .fds format to make checksums optional Blah Blah Blah</div><br />Your whole proposal for this Really Important change is because there might, theoretically, be a game out there that needs CRC data. I'm not arguing that it's a bad idea to have it. Just that it's not a big deal, never has been, never will be, and not worth wringing our hands over.<br /><br />If you want a new file format, Make. A. New. File. Format. Morphing the .fds standard (that needs heuristics to parse, wtf) in a way that current emulators won't be able to read is a shit idea. No offence. Not trying to insult you, I'm just strongly opinionated about this <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />----<br /><br />My proposal for a new format (that will never get implemented, but one can dream...):<br /><br />A header contains the number of disks, and sizes of each.  No fixed disk size, each disk is as long as it needs to be. Each disk is a raw byte-for-byte copy of what goes on the disk including the CRC and GAP data. I've seen proposals going down to low level MFM encoding but that's a PITA and unnecessary IMO. Pre-gap (before block 1) is left out.  I would also standardize the GAP size so it's a canonical rom format that game collectors can maintain a sensible database of (<a href="http://forums.nesdev.com/viewtopic.php?p=151013#p151013" class="postlink">more on that here</a>)</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=4">loopy</a> on Tue May 02, 2017 2:44 pm, edited 2 times in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p194896"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194896">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194896#p194896"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 2:35 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 6592<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">hex_usr wrote:</div><div class="quotecontent">Well, I guess we should invalidate every single Super Famicom and Mega Drive emulator ever made.<br /><br />&lt;/sarcasm&gt;</div><br /><br />There's no need for the sarcasm. Maybe my words sound aggressive, but I'm merely making a counter proposal, because it seemed like you wanted to be able to emulate &quot;bad disk image&quot; behaviour that's outside of the current .FDS format.<br /><br />My whole point was, why not be able to emulate <em>all possible bad disk image data</em>, rather than <em>just</em> the CRCs? If you're adding only CRCs it feels like a half measure. Why don't you want the rest?<br /><br /><br />I wasn't calling SFC a bad format. I was just saying that it's incapable of emulating a bad image header (e.g. putting a LoROM ROM on a HiROM board) without some sort of external metadata. It doesn't matter because there's <em>no use cases</em>. Similarly, the lack of CRC currently in .FDS also doesn't really matter because there's no known use cases.<br /><br /><br /><em>Edit: didn't see Loopy's post before my reply.</em></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p194898"></a>
				<b class="postauthor">loopy</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194898">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194898#p194898"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 2:45 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 10:52 pm<br /><b>Posts:</b> 376<br /><b>Location:</b> UT
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">loopy wrote:</div><div class="quotecontent">My proposal for a new format (that will never get implemented, but one can dream...):<br /><br />A header contains the number of disks, and sizes of each.  No fixed disk size, each disk is as long as it needs to be. Each disk is a raw byte-for-byte copy of what goes on the disk including the CRC and GAP data. I've seen proposals going down to low level MFM encoding but that's a PITA and unnecessary IMO. Pre-gap (before block 1) is left out.  I would also standardize the GAP size so it's a canonical rom format that game collectors can maintain a sensible database of (<a href="http://forums.nesdev.com/viewtopic.php?p=151013#p151013" class="postlink">more on that here</a>)</div><br />Thinking about it a bit, this has downsides as well. Particularly for games that save. Enforcing a standard GAP size gets annoying and whole file contents get shifted around with variable length disks. Maybe just stick to .FDS.  And bump the size up a bit. And put the CRC in too, what the hell. But call it something else, I don't want to see weird mutant .fds files floating around with marginal support.</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=4">loopy</a> on Tue May 02, 2017 2:47 pm, edited 1 time in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p194899"></a>
				<b class="postauthor">hex_usr</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194899">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194899#p194899"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 2:47 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat May 09, 2015 7:21 pm<br /><b>Posts:</b> 78
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">loopy wrote:</div><div class="quotecontent">Show me one game that does this (Hint: there aren't any).</div><br />Do you actually know this for certain? Have you actually, carefully examined every single official FDS disk, licensed and otherwise, and verified without a doubt that no games ever do so?<br /><br />Absence of evidence is not evidence of absence.<br /><br />You are right about there being no observed use cases, though. But that means that one of us should attempt to create a test ROM (used loosely because these are not ROMs) that engineers this situation to create a use case. And if it proves to be impossible, then I'll accept your point.<br /><br /><div class="quotetitle">loopy wrote:</div><div class="quotecontent">For emulators: CRC is not useful. The BIOS doesn't look at it, emulators just need to set the &quot;CRC GOOD&quot; status flag. ... Games would fail to load without a correct CRC so nothing is being lost by not including it.</div><br />Some disk images already lie to the BIOS about how many files (pairs of 0x03 and 0x04 blocks) are in the disk, and they include their own custom loading routines that differ from what the BIOS uses by hardcoding the true number of files. If the BIOS was the end-all be-all of disk access, then this crude form of copy protection would never have been known about. That's why I think it's possible for disk images with deliberately wrong CRCs to exist.<br /><br />In order to fully lock out the possibility of including a fake CRC, the Famicom DIsk System would need to disable all access to its registers while executing game code and ensure that a program must jump back into the BIOS in order to enable them. But that didn't happen, did it?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7009"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p194901"></a>
				<b class="postauthor">loopy</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p194901">Re: .fds format: Can checksums be heuristically detected?</a></div><div style="float: right;"><a href="./viewtopic.php?p=194901#p194901"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue May 02, 2017 2:57 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 10:52 pm<br /><b>Posts:</b> 376<br /><b>Location:</b> UT
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">hex_usr wrote:</div><div class="quotecontent">Do you actually know this for certain? Have you actually, carefully examined every single official FDS disk, licensed and otherwise, and verified without a doubt that no games ever do so?</div><br />Of course not. Can't prove a negative and all that. But you're asking for a fix to a problem that (as of yet) doesn't exist and throwing emulators into turmoil, creating a lot of extra work. For a game that doesn't exist. Yet. Let me know when you find one.<br /><br />Sure, you could make a test rom to prove your point. That we need to update the file format .. for your test roms.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=2&amp;t=15895"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=2"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=2&amp;t=15895"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>2</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 21 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=2&amp;t=15895&amp;start=15">2</a> &nbsp;<a href="./viewtopic.php?f=2&amp;t=15895&amp;start=15">Next</a></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=2">NESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: <a href="./memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> and 3 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="15895" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2" selected="selected">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="34">&nbsp; &nbsp;&nbsp; &nbsp;2018 NESdev Competition</option>
		
			<option value="33">&nbsp; &nbsp;&nbsp; &nbsp;2017 NESdev Competition</option>
		
			<option value="32">&nbsp; &nbsp;&nbsp; &nbsp;2016 NESdev Competition</option>
		
			<option value="31">&nbsp; &nbsp;&nbsp; &nbsp;2014 NESdev Competition</option>
		
			<option value="30">&nbsp; &nbsp;&nbsp; &nbsp;2011 NESdev Competition</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;&nbsp; &nbsp;Reproduction</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="11">&nbsp; &nbsp;&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="12">&nbsp; &nbsp;&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;&nbsp; &nbsp;GBDev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>


<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>