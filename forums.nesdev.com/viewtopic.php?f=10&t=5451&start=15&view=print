<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Jumpy screen - out of CPU time?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Jumpy screen - out of CPU time?</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=10&amp;t=5451">http://forums.nesdev.com/viewtopic.php?f=10&amp;t=5451</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>2</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Fri Jul 31, 2009 5:19 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">UncleSporky wrote:</div><div class="quotecontent">This way you do not have to touch $2000, and the second write to $2006 copies T to V, implementing that new scroll.</div>
<br />Please don't think of setting the scroll with $2005/$2006 as a "shortcut". You may "not have to touch $2000", but it's still slower and more complex than using $2000 and $2005, which is the correct, safe way of setting the scroll.
<br />
<br />The correct way to set the scroll is selecting the desired name table by writing to $2000 and then specifying how far into that name table rendering should start with 2 consecutive writes to $2005, all of this still during VBlank. This is the correct and safe way to do it if you are a nice boy and like to play by the rules.
<br />
<br />But if you like adventures, and for whatever reason you absolutely <strong>need</strong> to set the scroll outside of VBlank, you have to use those tricks.
<br />
<br />The PPU has this internal register it uses to read and write information in it's address space. We control this register by writing to $2006. Curiously enough, the PPU appears to use this same register to keep track of what's displayed during rendering. The conclusion is that, as long as we obey the format in which the PPU handles that information, we can alter what is fetched for display as the screen renders.
<br />
<br />That's it. Obey the format the PPU uses, and use whatever combination of writes to put the information where you want it. Do this at the correct time during rendering and you'll successfully manipulate the scroll mid-frame.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Fri Jul 31, 2009 5:26 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">UncleSporky wrote:</div><div class="quotecontent">Under normal (simple) circumstances with no screen splitting tricks, you would simply wait for vblank, use $2006 and $2007 to write your nametables, then reset with $2000 and set your scroll with $2005.</div><br />Yes, you got that right.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">But if you want to do something like a non-scrolling status bar or parallax, you wait for sprite 0 hit and use $2006 and $2005 as described above to write a new scroll.</div>
<br />Yes, but it doesn't have to be a sprite 0 hit. It can be an IRQ, timed code, it doesn't matter, as long as you have a way to perform the writes at the correct time.
<br />
<br />Also, note that depending on the type of split you want, you don't have to go through all the trouble of writing to $2006. If you are only changing the horizontal scroll (X), you can still use $2000 and $2005 just fine. The whole trick with $2006 is only necessary if you have to change the vertical scroll as well.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>2</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>