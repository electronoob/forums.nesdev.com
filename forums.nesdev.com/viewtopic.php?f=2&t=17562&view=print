<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Is NES/Famicom detection possible?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Is NES/Famicom detection possible?</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=17562">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=17562</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>7</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>orlaisadog</b> [ Thu Jul 19, 2018 11:40 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Is it possible to programmatically tell the difference between a NES and a Famicom?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Thu Jul 19, 2018 11:43 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yes. <!-- l --><a class="postlink-local" href="https://forums.nesdev.com/viewtopic.php?p=189960#p189960">viewtopic.php?p=189960#p189960</a><!-- l -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>orlaisadog</b> [ Thu Jul 19, 2018 11:46 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have no idea what any of that means.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Thu Jul 19, 2018 11:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yes. Ask player 2 to press all buttons on the controller, if start and select are missing, it's a Famicom. <img src="./images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /><br /><br />Seriously though, there are a few characteristics that can only be found in Famicoms, such as the inability to read from OAM, but that's just because the Famicom is older and the earlier units used older revisions of the PPU and CPU, but after the NES was introduced, they probably shared the exact same chips.<br /><br />Another difference between the NES and the Famicom is that the Famicom doesn't reset the PPU when the console resets... Not sure how that could be used, but asking players to reset the console isn't much better than asking player 2 to press all the buttons...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>orlaisadog</b> [ Thu Jul 19, 2018 12:11 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />What about what lidnariq said?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Thu Jul 19, 2018 12:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That link described polling the controller devices and other things to detect the connected buttons/hardware etc. in a similar way, just without user input.<br /><br />There is a caveat to this in that there are a <em>lot</em> of clone devices out there. If your software is trying to do something differently based on &quot;NES&quot; or &quot;Famicom&quot; you can probably with some effort identify those two machines specifically, but it gets a whole lot harder to cover all the bases. (Also... didn't Everdrive or PowerPak end up messing with the results of these tests in some way too?)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>orlaisadog</b> [ Thu Jul 19, 2018 12:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, considering<br />A) We can't include every clone<br />and<br />B) Most people wouldn't have clones<br />I think this is fine to use for default language settings and controller pictures.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>orlaisadog</b> [ Thu Jul 19, 2018 12:51 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Also, can someone explain that post simply please?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rainwarrior</b> [ Thu Jul 19, 2018 1:09 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">orlaisadog wrote:</div><div class="quotecontent">Also, can someone explain that post simply please?</div><br />This isn't like translating a sentence from one language to another. It's a complex technical topic, and there's a whole lot of required knowledge. I made an attempt to simplify it for you in my last post, but apparently you were unsatisfied because I removed too much in that simplification. Sorry that's not good enough, but explaining it in the way you need is probably far too much work for you to reasonably request all at once.<br /><br />Like, the simple answer to your question is more or less &quot;yes&quot;, though a better answer might be &quot;it's probably a good idea to have the user choose directly, instead&quot;. If you want to learn the prerequisites for the &quot;how&quot; part, maybe start by learning something small first. Small questions are easier to answer.<br /><br /><div class="quotetitle">orlaisadog wrote:</div><div class="quotecontent">Most people wouldn't have clones</div><br />I think there's <em>far</em> more clones than original systems out there at this point. This forum, though, does tend to be slightly biased toward the official Nintendo hardware, though there is a notable Dendy faction here too.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Thu Jul 19, 2018 1:15 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'll make it simple: the answer is <span style="text-decoration: underline">yes, it can be done with accuracy for detecting a true NES vs. a true Famicom, with user involvement (asking the player to press buttons on controllers)</span>.<br /><br />However: this may not work correctly (read: the detection may not be accurate) on some clone consoles (i.e. not true Nintendo-made NES or Famicoms).<br /><br />Simple enough?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>pubby</b> [ Thu Jul 19, 2018 2:06 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It isn't a very useful thing to do because Famicom and NES cartridges don't fit into each other's slots...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tokumaru</b> [ Thu Jul 19, 2018 3:02 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">orlaisadog wrote:</div><div class="quotecontent">Most people wouldn't have clones</div><br />Even though clones didn't use to be particularly prevalent in most developed countries, they were in several parts of the world. Brazil, Russia and many other countries had Famiclones almost exclusively. But nowadays, even in the US, the old hardware is constantly failing, and since the patents for the console already expired, several companies are coming up with their own take on the system and cashing in on nostalgia.<br /><br /><div class="quotetitle">pubby wrote:</div><div class="quotecontent">It isn't a very useful thing to do because Famicom and NES cartridges don't fit into each other's slots...</div><br />Unless designs like <a href="https://www.youtube.com/watch?v=7p1VXPHN7_8" class="postlink">this</a> become more common. Double-ended carts were normally used to put two games on the same cartridge, but it'd be really cool if someone decided to make dual NES-Famicom carts.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Jul 19, 2018 3:23 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The pressing Start on controller 2 method won't distinguish an NES from an AV Famicom. The technique used by allpads will.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">There is a caveat to this in that there are a <em>lot</em> of clone devices out there. If your software is trying to do something differently based on &quot;NES&quot; or &quot;Famicom&quot; you can probably with some effort identify those two machines specifically, but it gets a whole lot harder to cover all the bases.</div><br />If it's just setting the default value for language selection so that the user doesn't have to go to Options as often, the stakes aren't quite that high.<br /><br /><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">(Also... didn't Everdrive or PowerPak end up messing with the results of these tests in some way too?)</div><br />PowerPak has pullups on data lines, while the NES grounds the lines in question. This can be detected and worked around. EverDrive behaves more like an authentic cartridge with respect to open bus behavior.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Fisher</b> [ Thu Jul 19, 2018 3:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">it'd be really cool if someone decided to make dual NES-Famicom carts.</div><br />Do you mean something similar to the &quot;almighthy&quot; <a href="http://braziliannesclones.blogspot.com/2016/04/cartuchos-da-marca-hydron-o-famoso.html" class="postlink">Hydron</a>?<br /><div class="attachtitle">Attachment:</div><div class="attachcontent">
			<span class="gensmall"><b>File comment:</b> Hydron</span><br />
		
			<a href="./download/file.php?id=13125&amp;mode=view"><img src="./download/file.php?id=13125&amp;t=1" alt="2.jpg" /></a><br />
			<span class="gensmall">2.jpg [ 50.82 KiB | Viewed 523 times ]</span>
		

		<br />
	</div><br />It's a little bizarre and kind of messy...<br />But works fine! <img src="./images/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="Mr. Green" /> <br /><div class="attachtitle">Attachment:</div><div class="attachcontent">
			<a href="./download/file.php?id=13126&amp;mode=view"><img src="./download/file.php?id=13126&amp;t=1" alt="cartucho-duplo-slot-72-e-60-pinos-roger-rabbit-original-nes-D_NQ_NP_667582-MLB26596058497_012018-F.jpg" /></a><br />
			<span class="gensmall">cartucho-duplo-slot-72-e-60-pinos-roger-rabbit-original-nes-D_NQ_NP_667582-MLB26596058497_012018-F.jpg [ 243.9 KiB | Viewed 523 times ]</span>
		

		<br />
	</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Jul 19, 2018 3:48 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Is NES/Famicom detection possible?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Untested code, condensing the results of <a href="https://forums.nesdev.com/viewtopic.php?p=143759#p143759" class="postlink">Riding the open bus</a>:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; ; The PPU is mapped at $2000-$3FFF.&nbsp; (Addresses $2000-$2007 are<br />&nbsp; ; unique; $2008-$3FFF are mirrors.)&nbsp; The PPU contains a dynamic<br />&nbsp; ; latch called &quot;io_db&quot; in Visual 2C02 and &quot;PPUGenLatch&quot; in FCEUX,<br />&nbsp; ; which holds the last value written to any PPU port.&nbsp; Reading a<br />&nbsp; ; write-only PPU port, such as the VRAM address ($2006), returns<br />&nbsp; ; the value of io_db.<br />&nbsp; lda #$FF<br />&nbsp; sta $3F16&nbsp; ; Fill $3F16 (i.e. $2006) and io_db<br />&nbsp; sta $3F16&nbsp; ; write twice because that's conventional for $2006<br />&nbsp; cmp $3F16&nbsp; ; read io_db<br />&nbsp; bne io_db_not_supported&nbsp; ; NOAC clones may implement io_db wrong<br /><br />&nbsp; ; The next read is tricky.&nbsp; When doing an indexed read that crosses<br />&nbsp; ; a 256-byte boundary, 6502 adds the index to the low byte mod 256<br />&nbsp; ; and then fixes it up next cycle if there was a carry.<br />&nbsp; ; Thus $3FF6 + $20 reads $3F16 then $4016.&nbsp; The $3F16 read<br />&nbsp; ; precharges the data bus with io_db.&nbsp; Then the $4016 read changes<br />&nbsp; ; only those controller port bits that are connected to something.<br />&nbsp; ; CAUTION: Open bus works differently on some flash cartridges.<br />&nbsp; ; The PowerPak has pull-up resistors that continuously precharge<br />&nbsp; ; the data bus with $FF.&nbsp; But because this is the same value we<br />&nbsp; ; stored in io_db, it will not change the test result.<br />&nbsp; ldx #$20<br />&nbsp; lda $3FF6,x&nbsp; ; reads $3F16 then $4016<br /><br />&nbsp; ; Bits 3-4 are open bus on a Famicom but driven on an NES based<br />&nbsp; ; on two wires of controller port 1, and usually driven low.<br />&nbsp; ; They probably won't both be true on an NES unless a Zapper is<br />&nbsp; ; plugged into port 1 and the trigger is half-pulled.<br />&nbsp; and #$18<br />&nbsp; cmp #$18<br />&nbsp; beq is_famicom<br />is_nes:<br /><br /></div>

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>7</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>