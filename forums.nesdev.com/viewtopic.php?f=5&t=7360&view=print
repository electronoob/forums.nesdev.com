<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Video on reverse engineering the 6502</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Video on reverse engineering the 6502</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=5&amp;t=7360">http://forums.nesdev.com/viewtopic.php?f=5&amp;t=7360</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>drk421</b> [ Thu Jan 06, 2011 12:38 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Video on reverse engineering the 6502</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Interesting stuff:
<br />
<br /><!-- m --><a class="postlink" href="http://www.youtube.com/watch?v=HW9AWBFH1sA">http://www.youtube.com/watch?v=HW9AWBFH1sA</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Thu Jan 06, 2011 5:36 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The NES is brought up numerous times throughout the video (especially at the very end of part 5, and the very beginning of part 6).
<br />
<br />One thing I really want to stress here is that the video (part 3 or 4, I forget) actually brings up the Zophar's Domain web site and goes through all of the NES emulators listed, noting it's quite likely that every one of those authors had to write their own 6502 core -- and chances are every one of them is buggy in some way (given that there are always edge cases emulator authors don't know of or don't implement).  I think this forum pretty much proves that true.
<br />
<br />I indirectly tried to make this point by creating <a href="http://wiki.nesdev.com/w/index.php/Emulators" class="postlink">the NES emulator list</a> on the nesdev Wiki (particularly the "Under Development" ones), and have stated a couple times here on the forum that people need to stop writing their own 6502 core and instead just use an established core that is known to work reliably and accurately.  Sorry to inject a rant/jab at folks, but it's really sad seeing everyone and their dog making an emulator when it makes more sense to improve or refine to perfection something that already exists[1].
<br />
<br />With the introduction of visual6502.org, I'm hoping that will come to fruition.
<br />
<br />The presentation mentioned above also talks about the process that was used by the visual6502.org guys to recreate the processor on a transistor, bus, and trace level -- and how the exact same technique could be used for other chips.  It would be really wonderful to have someone dedicated to working with these guys to accomplish the same thing but for the NES PPU.
<br />
<br />&lt;somewhat-off-topic&gt;
<br />[1]: I acknowledge that emulating a processor is an educational experience for someone wanting to learn how a CPU works, but um, it makes a lot more sense to start programming *on/for* the CPU.  I can't begin to count how many people show up here who have absolutely no knowledge of microprocessor architecture or what an opcode is, yet they want to make an emulator.  I don't know why this irks me so much (probably some OCD thing), but it does.  It's like people are going about learning how something works in a completely backwards manner.  Summarised version of this paragraph: my opinion is that if you want to learn how the NES "works", why not start programming a game or something on it first?  For example, if I was to want to learn how the Amiga worked, I sure as hell wouldn't start by writing an Amiga emulator -- I'd start by getting my hands on an original Motorola 68000 assembly reference manual and learn 68K.  I'd familiarise myself with the system and processor first, not jump right in and try to emulate the thing.  I don't like 68K anyway.  ;-)
<br />
<br />Footnote/story: How did *I* learn 65xxx assembly?  I started with the original Apple II+ and then moved to the Apple IIE+ doing strictly Applesoft BASIC while in school (we had a IIGS but only one and it was mainly reserved for the faculty).  As we started to get more and more into using graphics and lots of mathematical operations, I found that my programs were gradually slower and slower.  After class one day I asked my teacher how I could make them run faster, and he literally tossed me a book on 6502/65c02 machine language and introduced me to the System Monitor on the Apple II (CALL -151).  I started doing machine language first, and after I had reached my wits end with how tedious it was, asked the same teacher if there was a better way to write such code.  He pointed me to using assembly language instead of machine language and I was permitted to use his copy of Merlin 8 while at school.  Within a year or so I pretty much did all of my coding in 65c02, and then 65816 (once I got my own personal IIGS at home).  The rest is history.  Today I mainly do C and perl, but literally everything I design/code has a "bare-bones" or KISS mentality applied to it, and that all stems from working with the 65xxx series on 1MHz processors.
<br />
<br />Have I ever written an emulator?  Sure, I've helped on a couple (qNES and VeNES).  But I can't imagine starting to learn how a computer (or processor) works by writing an emulator without any prior knowledge of how a microprocessor works.  That's the point I'm trying to get across.
<br />&lt;/somewhat-off-topic&gt;

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>cpow</b> [ Thu Jan 06, 2011 6:17 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I started out wanting to learn NES by writing my own game, but very quickly got distracted by my engineering mind that never fails to land me in the depths of detail.  Even as a kid I was more interested in how the game console / game worked, and much happier staring at the screen while friends played, trying to figure it out.  [No, I didn't have a sophisticated electronics lab in my basement...still don't.]
<br />
<br />The video also mentions that the transistor-level emulation, even in C, runs about 1KHz.  That wouldn't be anywhere near sufficient for the emulator strictly written for gameplay.  But I'd be very interested in implementing it in NESICIDE.  
<br />
<br />But, as the video also shows, the 2A03 die is only 1/4 6502...so there's still a lot of potential to gain accuracy by actually doing a visual2A03 project.   <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>drk421</b> [ Thu Jan 06, 2011 10:24 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I've written some 6502 assembly, but man, it is tedious.
<br />I haven't tried tackling a big program yet, but plan to eventually.
<br />I do a lot of AVR programming in C and I think it has spoiled me. Maybe I haven't written enough assembly to write it fast enough. I've heard of people writing assembly code almost as fast as someone can write C.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>clueless</b> [ Thu Jan 06, 2011 11:25 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Video 5 of 6 (<!-- m --><a class="postlink" href="http://www.youtube.com/watch?v=N9DYmlprCKA&amp;NR=1">http://www.youtube.com/watch?v=N9DYmlprCKA&amp;NR=1</a><!-- m -->), time mark 3:13.
<br />
<br />I find it interesting that when handling a RESET, the 6502 still pushes PC and P.  FCEUX (from memory, I might be wrong), sets all regs to zero.  I'm not sure that is the power-up state of the "S" reg for a real 6502.  I'm wondering if the state to the stack can be useful in a RESET handler to determine if a NES game is running on real hardware or not.
<br />
<br />Then again, it should be fairly easy to make any emulator properly emulate this aspect of real hardware.
<br />
<br />Maybe something for Blarrg to add to his test roms?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Hamburgler</b> [ Thu Jan 06, 2011 11:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><!-- m --><a class="postlink" href="http://wiki.nesdev.com/w/index.php/CPU_power_up_state">http://wiki.nesdev.com/w/index.php/CPU_power_up_state</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>dfrechet</b> [ Thu Jan 06, 2011 4:19 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">NESICIDE wrote:</div><div class="quotecontent">But, as the video also shows, the 2A03 die is only 1/4 6502...so there's still a lot of potential to gain accuracy by actually doing a visual2A03 project.   :D</div>
<br />We are in the process of developing distributed tools for drawing the various features on chips. As seen in the above video, we already have pictures of the 2A03, even without the metal layer. You can see some here: <!-- m --><a class="postlink" href="http://uxul.org/~noname/chips/aligned/">http://uxul.org/~noname/chips/aligned/</a><!-- m -->
<br />
<br />If sufficiently many persons on this board are interested, we could certainly gather enough manpower to crowd-source the polygon drawing for the 2A03 as well as the 2C02.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ccovell</b> [ Fri Jan 07, 2011 5:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I gotta say, the whole video and set of pictures of the 6502/2A03/2C02 are really awesome.
<br />
<br />Are there any pages on NesDev or others where we are discussing the layouts of the 2A03 or 2C02 (CPU,PPU)?  For example, the CPU is certainly interesting, as it looks like (I'm no hardware guy, so correct me if I'm wrong) the audio unit in the top-right corner was basically designed into a separate chip, with its own pins, pads and everything.  Perhaps Nintendo/Ricoh even has a few of these "audio unit" chips sitting in their labs somewhere.  This chip looks like it had its own output pin (?) from the RNG and polynomial of the noise generator too.
<br />
<br />It looks like a CPU that swallowed another chip.  <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /> 
<br />
<br />Can anybody else speculate on the functions of the other areas of the CPU/PPU?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>koitsu</b> [ Fri Jan 07, 2011 5:37 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />@ccovell: a portion of the CPU die is used for the audio pathing/logic.  As for the rest, I have no idea.  This is totally something kevtris could help with determining, I bet.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>dfrechet</b> [ Fri Jan 07, 2011 5:52 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">ccovell wrote:</div><div class="quotecontent">Are there any pages on NesDev or others where we are discussing the layouts of the 2A03 or 2C02 (CPU,PPU)?  For example, the CPU is certainly interesting, as it looks like (I'm no hardware guy, so correct me if I'm wrong) the audio unit in the top-right corner was basically designed into a separate chip, with its own pins, pads and everything.  Perhaps Nintendo/Ricoh even has a few of these "audio unit" chips sitting in their labs somewhere.  This chip looks like it had its own output pin (?) from the RNG and polynomial of the noise generator too.<br /><br />It looks like a CPU that swallowed another chip.  :) </div>
<br />Huh, that's just a testing area. Nothing to do with chip function.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Fri Jan 07, 2011 7:31 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Is there a chance that someone could take the tiny pics and overlay a block diagram on top of them, showing what each part of the die does? I'd like to see exactly where the length counter tables, noise frequency tables, and DMC frequency tables are stored.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>hyarion</b> [ Sat Jan 08, 2011 8:50 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Is there a chance that someone could take the tiny pics and overlay a block diagram on top of them, showing what each part of the die does? I'd like to see exactly where the length counter tables, noise frequency tables, and DMC frequency tables are stored.</div>
<br />this is the basic structure of the die... i don't really know where to draw the lines between the tri+dmc+noise block but the dmc goes in at the top of it so it's probably somewhere around there <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />  
<br /><a href="http://img6.imageshack.us/i/screenshot20110108at435.png/" class="postlink"><img src="http://img6.imageshack.us/img6/6408/screenshot20110108at435.th.png" alt="Image" /></a>

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>