<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=6756" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2010-08-05T09:30:14-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=6756</id>
<entry>
<author><name><![CDATA[mic_]]></name></author>
<updated>2010-08-05T09:30:14-07:00</updated>
<published>2010-08-05T09:30:14-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65518#p65518</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65518#p65518"/>
<title type="html"><![CDATA[2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65518#p65518"><![CDATA[
The envelope generator has an auto-reload feature, though.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1181">mic_</a> — Thu Aug 05, 2010 9:30 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2010-08-05T08:44:38-07:00</updated>
<published>2010-08-05T08:44:38-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65516#p65516</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65516#p65516"/>
<title type="html"><![CDATA[2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65516#p65516"><![CDATA[
I always saw the linear counter as the counterpart to the volume envelope generator.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Thu Aug 05, 2010 8:44 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mic_]]></name></author>
<updated>2010-08-05T08:33:17-07:00</updated>
<published>2010-08-05T08:33:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65515#p65515</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65515#p65515"/>
<title type="html"><![CDATA[2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65515#p65515"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />To allow music engines based on the length counter to run the same code for all four PSG channels, using logic like STA $4003,x for x in [0, 4, 8, 12].<br /></div><br /><br />But then it would still have to do something like LDA #$FF / STA $4008 every 30 (video) frames or so to make sure the linear counter doesn't expire (and then LDA #$7F / STA $4008 to un-halt the length counter again) ?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1181">mic_</a> — Thu Aug 05, 2010 8:33 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2010-08-05T08:32:43-07:00</updated>
<published>2010-08-05T08:32:43-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65514#p65514</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65514#p65514"/>
<title type="html"><![CDATA[2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65514#p65514"><![CDATA[
So then the question is, what is the purpose of the linear counter? Maybe they felt the triangle didn't have enough features, or foresaw the need to have more precise control over its timing, as many games do when combining triangle and noise for a drum sound.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Thu Aug 05, 2010 8:32 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2010-08-05T08:19:39-07:00</updated>
<published>2010-08-05T08:19:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65513#p65513</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65513#p65513"/>
<title type="html"><![CDATA[2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65513#p65513"><![CDATA[
<div class="quotetitle">mic_ wrote:</div><div class="quotecontent"><br />I'm just curious about what the purpose then is for the length counter on the triangle channel?<br /></div><br />To allow music engines based on the length counter to run the same code for all four PSG channels, using logic like STA $4003,x for x in [0, 4, 8, 12].<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Thu Aug 05, 2010 8:19 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mic_]]></name></author>
<updated>2010-08-05T08:03:25-07:00</updated>
<published>2010-08-05T08:03:25-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65511#p65511</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65511#p65511"/>
<title type="html"><![CDATA[2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65511#p65511"><![CDATA[
Ah, that's much clearer. Thanks.<br /><br />I'm just curious about what the purpose then is for the length counter on the triangle channel? If the linear counter always is active and runs at a higher frequency, then the linear counter will often expire before the length counter - making the length counter pointless.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1181">mic_</a> — Thu Aug 05, 2010 8:03 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2010-08-05T07:47:22-07:00</updated>
<published>2010-08-05T07:47:22-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65510#p65510</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65510#p65510"/>
<title type="html"><![CDATA[Re: 2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65510#p65510"><![CDATA[
Your simplification doesn't look correct.<br /><br />You need the following state, with indicated number of bits:<br /><br />1 Flag<br />8 Shadow<br />7 Linear counter<br /><br />And the following behaviors:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">$4008 write:<br />    Shadow = value written<br /><br />$400B write:<br />    Flag = 1<br /><br />Linear clock:<br />    If Flag = 1<br />        Linear counter = low 7 bits of Shadow<br />    else if Linear counter &gt; 0<br />        Linear counter = Linear counter - 1<br />    <br />    If bit 7 of Shadow = 0<br />        Flag = 0<br /><br />Frequency timer output clock:<br />    If length counter and linear counter are both non-zero<br />        go to next step in triangle wave</div><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Thu Aug 05, 2010 7:47 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mic_]]></name></author>
<updated>2010-08-05T06:17:58-07:00</updated>
<published>2010-08-05T06:17:58-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65495#p65495</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65495#p65495"/>
<title type="html"><![CDATA[2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65495#p65495"><![CDATA[
The APU section at the wiki isn't the clearest piece of documentation ever written, and the simplified version is of no use for my purposes since it ignores the counters. So I wanted to ask if my interpretation was correct.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1181">mic_</a> — Thu Aug 05, 2010 6:17 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2010-08-05T05:57:17-07:00</updated>
<published>2010-08-05T05:57:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65492#p65492</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65492#p65492"/>
<title type="html"><![CDATA[2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65492#p65492"><![CDATA[
Any reason to not just implement what is <a href="http://wiki.nesdev.com/w/index.php/APU_Triangle" class="postlink">described in the Wiki</a>? Any simplification will alter its behavior.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Thu Aug 05, 2010 5:57 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mic_]]></name></author>
<updated>2010-08-05T04:48:11-07:00</updated>
<published>2010-08-05T04:48:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65480#p65480</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65480#p65480"/>
<title type="html"><![CDATA[2A03 triangle channel counters]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6756&amp;p=65480#p65480"><![CDATA[
Would this be a correct (high-level) way of handling the triangle channel's counters?<br /><br /><strong>$4008.7 clear:</strong><br />The length counter is decreased at 60 Hz (for NTSC) as long as it's non-zero.<br />The linear counter is halted.<br /><br /><strong>$4008.7 set:</strong><br />The length counter is halted.<br />The linear counter is decreased at 240 Hz (for NTSC) as long as it's non-zero.<br /><br />Writing to $400B sets the length counter, but at the same time sets $4008.7 and thus enables linear counter mode and reloads the linear counter value from $4008.<br /><br />Output is effectively stopped when either the linear counter or the length counter is zero, regardless of which of them is active.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=1181">mic_</a> — Thu Aug 05, 2010 4:48 am</p><hr />
]]></content>
</entry>
</feed>