<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=2&amp;t=571" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2005-09-18T23:18:41-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=2&amp;t=571</id>
<entry>
<author><name><![CDATA[alekhine]]></name></author>
<updated>2005-09-18T23:18:41-07:00</updated>
<published>2005-09-18T23:18:41-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4676#p4676</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4676#p4676"/>
<title type="html"><![CDATA[ca65 Mystical Problem ;)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4676#p4676"><![CDATA[
Maybe, a screenshot could help.<br /><br /><img src="http://www.iflashera.com.ar/~futacast/deposito/cual_es_el_problema.jpg" alt="Image" /><br /><br />if phpbb doesn't show the screenshot, here is too<br /><a href="http://www.iflashera.com.ar/~futacast/deposito/cual_es_el_problema.jpg" class="postlink">http://www.iflashera.com.ar/~futacast/deposito/cual_es_el_problema.jpg</a><br /><br />tnx for your patience<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=193">alekhine</a> — Sun Sep 18, 2005 11:18 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[alekhine]]></name></author>
<updated>2005-09-18T23:04:28-07:00</updated>
<published>2005-09-18T23:04:28-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4675#p4675</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4675#p4675"/>
<title type="html"><![CDATA[ca65 Mystical Problem ;)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4675#p4675"><![CDATA[
<div class="quotetitle">Quietust wrote:</div><div class="quotecontent"><br />Change "STARTUP = $80" to "STARTUP:" and it should work correctly.<br /></div><br /><br />mmhh.. i though about that but the output file was<br />exactly the same, so that<br />doesn't seems to work :/<br /><br />anyone has these files working?<br /><br />the .cfg and the .asm doing something?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=193">alekhine</a> — Sun Sep 18, 2005 11:04 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Quietust]]></name></author>
<updated>2005-09-18T20:28:38-07:00</updated>
<published>2005-09-18T20:28:38-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4673#p4673</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4673#p4673"/>
<title type="html"><![CDATA[ca65 Mystical Problem ;)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4673#p4673"><![CDATA[
Change "STARTUP = $80" to "STARTUP:" and it should work correctly.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=7">Quietust</a> — Sun Sep 18, 2005 8:28 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[alekhine]]></name></author>
<updated>2005-09-18T19:56:23-07:00</updated>
<published>2005-09-18T19:56:23-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4672#p4672</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4672#p4672"/>
<title type="html"><![CDATA[ca65 Mystical Problem ;)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4672#p4672"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />I think the values are offsets into the .nes file.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Nesasm: Byte 80 in 40D0 <br />ca65: Byte 00 in 40D0<br /></div></div><br /><br />where do you think that i must put the offsets to make my rom  work?<br /><br />i think that i'm missing something in the documentation, tutorials or manuals, and it's only for a language problem, because i usually don't have problems with coding.<br />I code in c, c++, opengl, php, assembly x86, etc and all the english stuff worked fine for me.<br /><br />probably i missed something.. :/<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=193">alekhine</a> — Sun Sep 18, 2005 7:56 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[alekhine]]></name></author>
<updated>2005-09-18T19:52:20-07:00</updated>
<published>2005-09-18T19:52:20-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4671#p4671</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4671#p4671"/>
<title type="html"><![CDATA[ca65 Mystical Problem ;)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4671#p4671"><![CDATA[
<div class="quotetitle">Memblers wrote:</div><div class="quotecontent"><br />Is it your STARTUP label in the code?<br /><br />You have STARTUP = $80<br />And your reset vector is .WORD STARTUP<br />That might make it reset at $0080 instead of $8000.  But $40D0 isn't where the reset vector would be, wouldn't that be in the CHR?<br /></div><br /><br />No, it isn't. <br />_But_ the $80 or $8000 value must go in addr 400D to work (it's wrong what i said before about the addr, 40D0. It's 400D.<br />So, value $80 in addr $400D in the rom.<br /><br />I have the same problem with c64 prgs.<br />I don't understand how, where and when put the "go here and execute" value to make my code work.<br />Any clue or documentation? =)<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=193">alekhine</a> — Sun Sep 18, 2005 7:52 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2005-09-16T04:52:28-07:00</updated>
<published>2005-09-16T04:52:28-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4592#p4592</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4592#p4592"/>
<title type="html"><![CDATA[ca65 Mystical Problem ;)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4592#p4592"><![CDATA[
I think the values are offsets into the .nes file.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Nesasm: Byte 80 in 40D0 <br />ca65: Byte 00 in 40D0<br /></div><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Fri Sep 16, 2005 4:52 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Memblers]]></name></author>
<updated>2005-09-16T00:52:12-07:00</updated>
<published>2005-09-16T00:52:12-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4588#p4588</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4588#p4588"/>
<title type="html"><![CDATA[ca65 Mystical Problem ;)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4588#p4588"><![CDATA[
Is it your STARTUP label in the code?<br /><br />You have STARTUP = $80<br />And your reset vector is .WORD STARTUP<br />That might make it reset at $0080 instead of $8000.  But $40D0 isn't where the reset vector would be, wouldn't that be in the CHR?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=10">Memblers</a> — Fri Sep 16, 2005 12:52 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[alekhine]]></name></author>
<updated>2005-09-15T20:41:06-07:00</updated>
<published>2005-09-15T20:41:06-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4583#p4583</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4583#p4583"/>
<title type="html"><![CDATA[Re: ca65 Mystical Problem ;)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4583#p4583"><![CDATA[
now i have an account here =)<br />i'm gonna rewrite this because its bad written<br /><div class="quotetitle">Anonymous wrote:</div><div class="quotecontent"><br />Ok, when i compile this, the ca65 make a exact .nes with the .nes<br />that i make with nesasm<br /><br />Any clue? <img src="http://forums.nesdev.com/images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br /><br />tnx for your time =)<br /></div><br /><br />i meant to say something like this:<br /><br />"Ok, when i compile this, the ca65 make an exact .nes with the .nes that<br />i make with nesasm, but the diference is a byte. <br />Here are the values:<br /><br />Nesasm: Byte 80 in 40D0<br />ca65:  Byte 00 in 40D0<br /><br />The .nes that doesn't work is the one compiled with ca65"<br /><br />there go =)<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=193">alekhine</a> — Thu Sep 15, 2005 8:41 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-09-15T20:28:51-07:00</updated>
<published>2005-09-15T20:28:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4582#p4582</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4582#p4582"/>
<title type="html"><![CDATA[ca65 Mystical Problem ;)]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=571&amp;p=4582#p4582"><![CDATA[
Hi, i'm from argentina and i need help with some stuff that i cannot understand with a difference that i found between the files that i assembled with two diferents assemblers.<br />(Ah, btw, sorry for my bad english, if you don't understand something, i'll try to explain my thoughts in a better (or diferent) way) <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />Ok, this is the problem.<br /><br />I was coding in NESASM for a while and without problems, when i realized that exist a REAL assembler called ca65 (from cc65.org).<br /><br />I was very happy with my discover until i began having serious problems with it.<br /><br />The same code (NesASM code and ca65 code) put the exact SAME info in the .nes file, but only ONE byte changes between them.<br /><br />It's the mysterious byte $80 at $40D0, that nesasm put in the .nes file and ca65 not. Obiously i'm doing something wrong and i can't figure out where is the problem.<br /><br />I'm going to put here my config file for ca65 and my source code:<br /><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent"># romstruct.cfg &#40;for the linker&#41;<br /># Distribucion de SEGMENTos la ROM de Nintendo<br /># Alekhine d-phenze <br /><br /># Asignacion de cachos de memoria<br />MEMORY <br />&#123;<br />   ZP:<br />      start   $02<br />      size   $1A<br />      type   rw<br />      define   yes;<br /><br />   # Header iNES<br />   HEADER:<br />      start   $00<br />      size   $10<br />      file   %O<br />      fill   yes;<br />   <br />   # 2 bancos ROM de 16kb<br />   # - startup<br />   # - code   <br />   # - rodata<br />   # - data &#40;load&#41;<br /><br />   BANK0:   <br />      start   $8000<br />      size   $7FF4   <br />      file   %O<br />      fill   yes<br />      define   yes;<br /><br />   # Vectores de Hardware al final<br />   # de el segundo ROM de 2kb<br />   BANK1:<br />      start   $FFF4<br />      size   $C<br />      file   %O<br />      fill   yes;<br /><br />   # 1 Banco CHR de 8kb<br />   CHRBANK:<br />      start   $0000<br />      size   $2000<br />      file   %O<br />      fill   yes;<br /><br />   # SRAM 2k standard &#40;-zeropage&#41;<br />   # $0100-$0200 cpu stack<br />   # $0200-$0500 3 paginas para el buffer de escritura de la PPU<br />   # $0500-$0800 3 paginas para stack de parametros de cc65<br />   SRAM:<br />      start   $0500<br />      size   $0300<br />      define   yes;<br />      <br />   # SRAM banco 8k adicionales<br />   # - data &#40;run&#41;<br />   # - bss<br />   # - heap<br />   RAM:<br />      start   $6000<br />      size   $2000<br />      define   yes;<br /><br />&#125;<br /><br /># Estructura de la ROM de Nintendo<br /><br />SEGMENTS &#123;<br />    HEADER:   load = HEADER,           type = wprot;<br />    STARTUP:  load = BANK0,            type = wprot, define = yes;<br />    CODE:     load = BANK0,            type = wprot, define = yes;<br />    RODATA:   load = BANK0,            type = wprot, define = yes;<br />    DATA:     load = BANK0, run = RAM, type = rw,    define = yes;<br />    VECTORS:  load = BANK1,            type = rw;<br />    CHARS:    load = CHRBANK,          type = rw;<br />    BSS:      load = RAM,              type = bss,   define = yes;<br />    ZEROPAGE: load = ZP,               type = zp;<br />&#125;<br /><br />FEATURES &#123;<br />    CONDES: segment = RODATA,<br />       type = constructor,<br />       label = __CONSTRUCTOR_TABLE__,<br />       count = __CONSTRUCTOR_COUNT__;<br />    CONDES: segment = RODATA,<br />       type = destructor,<br />       label = __DESTRUCTOR_TABLE__,<br />       count = __DESTRUCTOR_COUNT__;<br />&#125;<br /><br />SYMBOLS &#123;<br />    __STACKSIZE__ = $0300;     # Stack de 3 paginas<br />&#125;<br />   <br /></div><br /><br />here goes now my source code:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent"><br />; -<br />; Work.asm<br />; -<br />; Alekhine d-phenze*<br />; Para CC65 &#40;ca65.exe &amp; ld65.exe&#41;, Nintendo <br />; -<br />; Consta de los siguientes archivos:<br />; ----------------------------------<br />;   % romstrct.cfg &#40;Estructura del rom&#41;<br />;   % work.asm &#40;este archivo&#41;<br />;   % make.bat &#40;crea la rom&#41;<br />; ----------------------------------<br />;<br />; Esto genera algo en pantalla, demostrando<br />; que esta configuracion genera la ROM nes :&#41;<br />; o sea, si anda, tenemos una rom Nes para <br />; codear ;&#41;<br /><br />; ******************************************************<br />; Header iNES 10 bytes <br />; ******************************************************<br /><br />.SEGMENT &quot;HEADER&quot;<br />.byte   $4e, $45, $53, $1a   ; 'NES' + 1A<br />.byte   $01         ; 16kb PRG-ROM Numero de paginas<br />.byte   $01         ; 8kb  CHR-ROM Numero de paginas<br />.byte   $01         ; Byte de control de la Rom #1<br />.byte   $00         ; Byte de control de la Rom #2<br />            ; Byte #1: $MO<br />            ; M Define el numero de mapper<br />            ; O Define las opciones de la rom.<br />            ; El byte #2 es preferible<br />            ; dejarlo en $00 hasta ahora<br />.byte   $00, $00, $00, $00   ; Muchos ceros<br />.byte   $00, $00, $00, $00   ; muchos ceros mas<br /><br />.SEGMENT &quot;CODE&quot;<br />STARTUP = $80<br />; ***** <br />; This is a routine ONLY to make sure that it worked in a<br />; random emulator<br />; ***** <br /><br />   lda #%00001000      ; Los seteos se pueden<br />   sta $2000      ; ver en documentos <br />   lda #%01011110      ; tecnicos sobre el PPU<br />   sta $2001<br /><br />; sonido<br /><br /><br />   lda #$FF   ; typical<br />   sta $4000  ; write<br /><br />   lda #%11011011  ; % means binary number, remember the '#' for immediate values.<br />   sta $4001  ; immediate means &quot;not an address, just a number&quot;.<br /><br />   lda #$A5<br />   sta $4002<br /><br />   lda #$AB<br />   sta $4003<br /><br />   lda #%00000001<br />   sta $4015<br /><br />infinito:<br />   jmp infinito<br /><br /><br />.SEGMENT &quot;CODE&quot;<br /><br />.SEGMENT &quot;RODATA&quot;<br /><br />;********<br />; Here i put garbage for viewing where the linker put<br />; the info in the binary file<br />; i comment the .byte statament where are garbage<br />; every time i compile the source<br />;********<br />.byte $AA,$AA,$AA    ; Basura para identificar<br />         ; segmentos<br />.SEGMENT &quot;DATA&quot;<br />ourpal: .incbin &quot;our.pal&quot;<br />.byte $BB,$BB,$BB    ; Basura para identificar<br />         ; segmentos<br /><br />.SEGMENT &quot;VECTORS&quot;<br />.word 0      <br />.word STARTUP<br />.word 0         ; Basura para identificar <br />         ; segmentos<br /><br /><br /><br />.SEGMENT &quot;CHARS&quot;<br /><br />.incbin   &quot;our.bkg&quot;<br />.incbin   &quot;our.spr&quot;<br /><br /><br />.SEGMENT &quot;BSS&quot;<br /><br /><br />; *** more garbage, remember, i comment this<br />;       before compile<br />; i use these bytes to trace where the linker put the info<br />; in the final binary<br />.byte $EE,$EE,$EE   ; Basura para identificar <br />         ; segmentos<br />      <br /></div><br /><br />and now, the .bat <br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">ca65 work.asm<br />ld65 -C romstrct.cfg work.o<br />copy /Y a.out work.nes<br /></div><br /><br />Ok, when i compile this, the ca65 make a exact .nes with the .nes<br />that i make with nesasm<br /><br />Any clue? <img src="http://forums.nesdev.com/images/smilies/icon_sad.gif" alt=":(" title="Sad" /><br /><br />tnx for your time =)<p>Statistics: Posted by Guest — Thu Sep 15, 2005 8:28 pm</p><hr />
]]></content>
</entry>
</feed>