<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - SNES PowerPak 1.03b mappers</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">SNES PowerPak 1.03b mappers</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=12&amp;t=5929">http://forums.nesdev.com/viewtopic.php?f=12&amp;t=5929</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>3</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bunnyboy</b> [ Mon Jan 11, 2010 12:15 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>SNES PowerPak 1.03b mappers</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />If anyone has a console that reports the SDRAM Error, this mapper set will hopefully fix that problem.  No boot ROM flashing or hardware changes needed.  It works here on the 8 various consoles I have but won't be official until more peeps try it out.  Should also mean that the SNES mini will now be supported.  I still need to get the new portable SNES to test  <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />
<br />
<br />Also adds an autosave option for battery RAM at the saving question screen. This will save to the same file that was loaded when you started the game.
<br />
<br />Download at: <!-- m --><a class="postlink" href="http://www.retrousb.com/downloads/POWERPAK132103b.zip">http://www.retrousb.com/downloads/POWERPAK132103b.zip</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>shadowkn55</b> [ Mon Jan 11, 2010 1:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Has the sram issue with rom expanded ExHiRom games been fixed? I tried out dq3e and it still doesn't save.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mic_</b> [ Mon Jan 11, 2010 3:06 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'll try it when I get home. Does this also fix the DSP-1 detection error?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bunnyboy</b> [ Mon Jan 11, 2010 7:31 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">shadowkn55 wrote:</div><div class="quotecontent">Has the sram issue with rom expanded ExHiRom games been fixed? I tried out dq3e and it still doesn't save.</div>
<br />Nope, just those changes noted for now.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bunnyboy</b> [ Mon Jan 11, 2010 7:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">mic_ wrote:</div><div class="quotecontent">I'll try it when I get home. Does this also fix the DSP-1 detection error?</div>
<br />Yes both were the same problem, where some timing signals ended significantly later on the mini and some EU 2/1/3 systems.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zoigl</b> [ Mon Jan 11, 2010 10:04 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: SNES PowerPak 1.03b mappers</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">bunnyboy wrote:</div><div class="quotecontent">Also adds an autosave option for battery RAM at the saving question screen. This will save to the same file that was loaded when you started the game.</div>
<br />
<br />how exactly will this work ? you must still press the resetbutton for 5 seconds or so ? (i'm not sure how it works because mine is not arrived, till now)
<br />
<br />are you already in conversation with d4s for the ultra 16 save-compatibility ?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bunnyboy</b> [ Mon Jan 11, 2010 10:29 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: SNES PowerPak 1.03b mappers</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zoigl wrote:</div><div class="quotecontent">how exactly will this work ? you must still press the resetbutton for 5 seconds or so ?</div><br />You still hold reset for 5 secs and the screen asking to save appears.  But now there is an option to use the ram file that was originally loaded so you do not need to navigate and choose it again.  There are still the options to choose a different file or not save at all.<br /><br /><div class="quotetitle">Zoigl wrote:</div><div class="quotecontent">are you already in conversation with d4s for the ultra 16 save-compatibility ?</div>
<br />Don't know what that is...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>d4s</b> [ Mon Jan 11, 2010 1:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Great to see continued support for the PowerPak, will report back any problems encountered by the end of the week.
<br />
<br />
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Zoigl wrote:<br />are you already in conversation with d4s for the ultra 16 save-compatibility ?<br /><br />Don't know what that is...</div>
<br />
<br />When the PowerPak has switched to SRAM saving mode after holding reset for a couple of seconds, it will output what appears to be garbage data around range $00-3f:21c0-$00-3f:21ff.
<br />Intended or not, this breaks compatability with devices using that memory region, among these are the LifeFitness bike interface and Ultra16, which is a BIOS for the SNES of sorts I developed a couple of years ago. <a href="http://www.youtube.com/user/Dforce3000#p/u/9/Jpn7J2OUy7k" class="postlink">Ultra16 menu on youtube</a>
<br />
<br />Unless there's no way around it, it would be greatly appreciated if you could either disable that data output or move it to some other region.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>byuu</b> [ Mon Jan 11, 2010 3:11 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Mini-derail, please feel free to respond via PM.
<br />
<br />d4s, how did you get info on the LifeFitness interface? Did you disassemble the game, or did you actually buy one of those crazy ass things? Heh.
<br />
<br />Fascinating to hear that it connects to the SNES' B-bus like that. I figured it was just a fancy controller.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bunnyboy</b> [ Mon Jan 11, 2010 4:19 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />$21FF is used for the SDRAM DMA port, so that won't be moving.  Might work to use the DMA=0 config option so it never touches that port.  Sounds like cool hardware tho!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Mitch</b> [ Mon Jan 11, 2010 11:53 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I just updated to the latest mappers and it is working on my SNES jr now. I will keep an eye out for any new bugs.
<br />
<br />Mitch

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>d4s</b> [ Tue Jan 12, 2010 11:15 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">bunnyboy wrote:</div><div class="quotecontent">$21FF is used for the SDRAM DMA port, so that won't be moving.  Might work to use the DMA=0 config option so it never touches that port.  Sounds like cool hardware tho!</div><br /><br />Thanks, that's good to know!<br />Using $21c0-$21c3 myself here.<br />I'm pretty sure the PowerPak was outputting data on the whole upper $21xx range, but only in SRAM save mode. Will look into that and the new mappers later. <br /><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">d4s, how did you get info on the LifeFitness interface? Did you disassemble the game, or did you actually buy one of those crazy ass things? Heh.<br /><br />Fascinating to hear that it connects to the SNES' B-bus like that. I figured it was just a fancy controller.</div>
<br />
<br />Yeah, I finally bought one of these interface boxes after several years of hunting on ebay. Guess I'm just a sucker for crazy hardware. <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" /> 
<br />
<br />To be perfectly honest, I haven't researched it as much as I'd have liked to yet.
<br />It is an interesting piece of hardware, though. The base unit has battery-backed RAM and an RS232 interface IIRC.
<br />A PCB-shot should be in there somewhere: <a href="http://dforce3000.de/?p=filedump&amp;srch=exertainment" class="postlink">http://dforce3000.de/?p=filedump&amp;srch=exertainment</a>
<br />
<br />Will send it over if you ever feel like emulating it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>MottZilla</b> [ Tue Jan 12, 2010 1:29 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'm glad you've got hopefully all of the compatibility issues fixed now. I figured like the early NES PowerPAK issues we would see them resolved shortly. One question I wanted to ask you was about ROM loading and how you determine loading and mapping. The reason being certain strange roms like the BS-X roms have been reported not to load properly. They work just find in copiers like the GDSF7 though. So if you can share how the loader determines the cartridge setup that would be great as it would be nice to get games like the BS Shockman Zero and BS Zelda working, assuming the reports I've heard are true and they don't currently work.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>byuu</b> [ Tue Jan 12, 2010 3:48 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">It is an interesting piece of hardware, though. The base unit has battery-backed RAM and an RS232 interface IIRC.<br />A PCB-shot should be in there somewhere: <!-- m --><a class="postlink" href="http://dforce3000.de/?p=filedump&amp;srch=exertainment">http://dforce3000.de/?p=filedump&amp;srch=exertainment</a><!-- m --><br /><br />Will send it over if you ever feel like emulating it.</div>
<br />
<br />Really appreciate the offer, but I really don't think I could pull it off. Wouldn't want to deprive you of something so rare. And even if I could (I can't), the hotel overlay thing looks like a lot more fun, bleh. Besides, still have Matthew's BS-X over here collecting dust &gt;.&gt;
<br />
<br />I do notice there's an EPROM on that board, with the UV window covered. So it looks like we need to emulate the TL16C550AN (which has serial interface stuff in it, looks like it was meant for a modem, maybe an online firmware update mechanism or service mode?) and connect it to that EPROM's data.
<br />
<br /><!-- m --><a class="postlink" href="http://www.alldatasheet.co.kr/datasheet-pdf/pdf_kor/28786/TI/TL16C550AN.html">http://www.alldatasheet.co.kr/datasheet ... 550AN.html</a><!-- m -->
<br />
<br />God, all sorts of controller insanity, too. SNES to RJ45 ... I am aware you can use RJ45 as a ghetto serial cable, telxons usually do that. So all in all, wow. This is an insane amount of work for something that can't even be emulated via keyboard / mouse / gamepad. Amazing.
<br />
<br />I posted some minor software disassembly notes here:
<br /><!-- m --><a class="postlink" href="http://board.byuu.org/viewtopic.php?f=3&amp;t=477">http://board.byuu.org/viewtopic.php?f=3&amp;t=477</a><!-- m -->
<br />
<br />If you want to continue work on this sometime, let me know and I'll try and help out, but I don't think I want to do all of that work alone :/

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>d4s</b> [ Tue Jan 12, 2010 3:56 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />First impressions:
<br />-Autosave works great! (How about auto-loading *.srm files that have a filename equal to the ROM's that's been selected for loading?)
<br />-2Mbit hirom games don't work yet.(example: Hungry Dinosaurs.
<br /> Not valid by official Nintendo specs, but how about having a minimum bootable filesize of 32kbyte(lorom) and 64kbyte(hirom)? Would be great for homebrew stuff.)
<br />-no issues with SDRAM/DSP-1 errors so far on any unit.
<br />
<br />Regarding that $21xx-region issue:
<br />-after holding reset to enter SRAM saving mode, the PowerPak responds to read accesses from $21c0-$21ff. Here's what it looks like, although that picture itself doesn't prove anything in particular, of course: <a href="http://dforce3000.de/index.php?p=fdsingle&amp;uid=361" class="postlink">http://dforce3000.de/index.php?p=fdsingle&amp;uid=361</a>
<br />-DMA=0/1 doesn't affect this.
<br />-Data read appears not to be random, patterns are visible.
<br />
<br />Here's a guess:
<br />The PowerPak DMA port is accessed at $21ff by software, but you don't actually decode the full b-bus adress in hardware, just the upper two adress lines, resulting in the DMA port being accessible from $21c0-$21ff.
<br />The port just stays on after ROM loading.
<br />I assume the adjustment neccessary would be rather small, unless you don't have the full adress bus b connected to your FPGA, of course.
<br />
<br />My general experience with the b-bus is that quite a few games accidentaly access the whole bus range, most prominently during memory clearing operations. I had to put a hardware lock on the Ultra16 registers to prevent some games from messing up (Lion King comes to mind in particular).
<br />Disabling most PowerPak registers after ROM load might increase compatability. Just an idea, though.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>3</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>