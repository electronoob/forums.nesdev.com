<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=5406" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2012-02-14T17:06:29-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=5406</id>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2009-07-19T19:17:19-07:00</updated>
<published>2009-07-19T19:17:19-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49049#p49049</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49049#p49049"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49049#p49049"><![CDATA[
<div class="quotetitle">Bregalad wrote:</div><div class="quotecontent"><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">- I'm unable to get Just Breed working. The first fading screen "Just Breed" is glitched; next, it hangs like a flash<br /></div><br />Did you implement the hardware multiplier ? JB relies heavily on it.<br />And it only uses ExRAM mode for tiles all the way along, you you'll only get glitched BG if you don't implement that (but the game should be "playable", and the sprites should show up correctly).</div><br /><br />- Yes, the multiplier-thing is okay, but the ExRAM is working as read/write and as nametable, when setup by mirroring type.<br /><br />- I suspect it's a problem with IRQs. There's not much from open source emulators: I did a look in 3 different sources - they have completely different MMC5 mechanics. In other words: empirical knowledge.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sun Jul 19, 2009 7:17 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Bregalad]]></name></author>
<updated>2009-07-18T01:34:48-07:00</updated>
<published>2009-07-18T01:34:48-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49024#p49024</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49024#p49024"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49024#p49024"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />- I'm unable to get Just Breed working. The first fading screen "Just Breed" is glitched; next, it hangs like a flash<br /></div><br />Did you implement the hardware multiplier ? JB relies heavily on it.<br />And it only uses ExRAM mode for tiles all the way along, you you'll only get glitched BG if you don't implement that (but the game should be "playable", and the sprites should show up correctly).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> — Sat Jul 18, 2009 1:34 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2009-07-17T22:39:44-07:00</updated>
<published>2009-07-17T22:39:44-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49023#p49023</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49023#p49023"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49023#p49023"><![CDATA[
- OK, so CastleVania 3 and Laser Invasion seem to work fine.<br />- I'm unable to get Just Breed working. The first fading screen "Just Breed" is glitched; next, it hangs like a flash. Plus, Uncharted Waters is glitched during the intro.<br /><br />- Are 2007h reads required for proper MMC5 working? Any hints?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Fri Jul 17, 2009 10:39 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Dwedit]]></name></author>
<updated>2009-07-17T16:39:58-07:00</updated>
<published>2009-07-17T16:39:58-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49014#p49014</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49014#p49014"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=49014#p49014"><![CDATA[
Second Quest extra enemies and rising water area use MMC5 features which aren't implemented in PocketNES.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=53">Dwedit</a> — Fri Jul 17, 2009 4:39 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2009-07-17T07:22:22-07:00</updated>
<published>2009-07-17T07:22:22-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48985#p48985</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48985#p48985"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48985#p48985"><![CDATA[
As I understand it, CV3 doesn't really use much of the MMC5, treating it as essentially a VRC-6 with a different register layout.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Fri Jul 17, 2009 7:22 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2009-07-16T19:41:18-07:00</updated>
<published>2009-07-16T19:41:18-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48970#p48970</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48970#p48970"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48970#p48970"><![CDATA[
<div class="quotetitle">Disch wrote:</div><div class="quotecontent"><br />No commercial games (that I know of) use 8x8 spritse with MMC5.<br /></div><br /><br />- I don't know exactly what you mean, as I trapped writes to $2000:20h=0, setting 8x8 sprites, but probably I'm misunderstanding the things..? [CastleVania3]<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Thu Jul 16, 2009 7:41 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Disch]]></name></author>
<updated>2009-07-15T17:24:48-07:00</updated>
<published>2009-07-15T17:24:48-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48936#p48936</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48936#p48936"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48936#p48936"><![CDATA[
Docs:<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br /><strong>When in 8x16 sprite mode</strong>, both sets of registers are used.  The 'A' set is used for sprite tiles, and the<br />'B' set is used for BG.<br /><br />[snip]<br /><br /><strong>When in 8x8 sprite mode</strong>, only one set is used for both BG and sprites.  Either 'A' or 'B', depending on which<br /> set is written to last.<br /></div><br /><br />No commercial games (that I know of) use 8x8 spritse with MMC5.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=33">Disch</a> — Wed Jul 15, 2009 5:24 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2009-07-15T17:12:11-07:00</updated>
<published>2009-07-15T17:12:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48935#p48935</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48935#p48935"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48935#p48935"><![CDATA[
<div class="quotetitle">ReaperSMS wrote:</div><div class="quotecontent"><br />Assuming the doc you quoted is correct, the BG uses the B set when in 8x16 mode, last set written in 8x8 mode<br /></div><br /><br />- From Disch's mapper docs.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Wed Jul 15, 2009 5:12 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ReaperSMS]]></name></author>
<updated>2009-07-15T17:11:09-07:00</updated>
<published>2009-07-15T17:11:09-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48934#p48934</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48934#p48934"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48934#p48934"><![CDATA[
Assuming the doc you quoted is correct, the BG uses the B set when in 8x16 mode, last set written in 8x8 mode<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=8">ReaperSMS</a> — Wed Jul 15, 2009 5:11 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2009-07-15T17:03:53-07:00</updated>
<published>2009-07-15T17:03:53-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48933#p48933</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48933#p48933"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48933#p48933"><![CDATA[
- As last question: the background chr data is always from mode_b registers, or does it follow the same "rule" of 8x8 or 8x16 sprites?<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />When in 8x8 sprite mode, only one set is used for both BG and sprites.  <strong>Either 'A' or 'B', depending on which set is written to last.</strong>  If 'B' is used, $1000-1FFF always mirrors $0000-0FFF (making the 'B' set pretty worthless with 8x8 sprites)<br /></div><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Wed Jul 15, 2009 5:03 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[cpow]]></name></author>
<updated>2009-07-15T15:42:47-07:00</updated>
<published>2009-07-15T15:42:47-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48927#p48927</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48927#p48927"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48927#p48927"><![CDATA[
<div class="quotetitle">ReaperSMS wrote:</div><div class="quotecontent"><br />When in hblank, it reads the tile index from OAM, and then reads the actual pattern table data into an internal 16 byte buffer (2 bytes of pattern data per sprite, 8 sprites). In the 2C02 Technical Reference, these are referred to as Memory Fetch Phase 129 through 160.<br /><br />When rendering the visible portion of the line, it combines the data fetched during hblank for the sprites with the data fetched on the fly for the background. Given that layout, the MMC5 only has to switch the CHR banks twice: once at the beginning of hblank, over to the sprite banks, and once at the end of hblank, back to the BG banks.<br /></div><br /><br />Thanks Fx3 for asking the question...this thread cleared it up a great deal for me!<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3705">cpow</a> — Wed Jul 15, 2009 3:42 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ReaperSMS]]></name></author>
<updated>2009-07-15T15:13:45-07:00</updated>
<published>2009-07-15T15:13:45-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48926#p48926</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48926#p48926"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48926#p48926"><![CDATA[
When in hblank, it reads the tile index from OAM, and then reads the actual pattern table data into an internal 16 byte buffer (2 bytes of pattern data per sprite, 8 sprites). In the 2C02 Technical Reference, these are referred to as Memory Fetch Phase 129 through 160.<br /><br />When rendering the visible portion of the line, it combines the data fetched during hblank for the sprites with the data fetched on the fly for the background. Given that layout, the MMC5 only has to switch the CHR banks twice: once at the beginning of hblank, over to the sprite banks, and once at the end of hblank, back to the BG banks.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=8">ReaperSMS</a> — Wed Jul 15, 2009 3:13 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2012-02-14T17:06:29-07:00</updated>
<published>2009-07-15T14:52:37-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48924#p48924</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48924#p48924"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48924#p48924"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />When fetching the 8 tiles for the sprites during hblank, you use the A regs for 8x16. Anything else, you use the B regs. The two get accessed at completely different times, so there's no particular issues.<br /></div><br /><br />- I'm trying to ask <strong>how does the ppu keep the gfx banks until the sprites are rendered during the next scanline, or cycles 0~255?</strong> I know it fetches the <strong>tile index</strong>, since the rendering reads gfx data from pointers, and changing them will affect the rendering, no doubt.<br /><br />- Hard?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Wed Jul 15, 2009 2:52 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ReaperSMS]]></name></author>
<updated>2009-07-15T13:15:05-07:00</updated>
<published>2009-07-15T13:15:05-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48921#p48921</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48921#p48921"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48921#p48921"><![CDATA[
As others have mentioned, your sprite rendering is Doing It Wrong if you're having issues with when the switch is supposed to be.<br /><br />When fetching the 8 tiles for the sprites during hblank, you use the A regs for 8x16. Anything else, you use the B regs. The two get accessed at completely different times, so there's no particular issues.<br /><br />As for how it is possible in reality, the MMC5 has a pretty solid grasp of what the PPU is doing at any particular time (it has to, for the EXRAM effects) so it just knows when to apply the remapping.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=8">ReaperSMS</a> — Wed Jul 15, 2009 1:15 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tokumaru]]></name></author>
<updated>2009-07-15T11:34:18-07:00</updated>
<published>2009-07-15T11:34:18-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48917#p48917</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48917#p48917"/>
<title type="html"><![CDATA[MMC5 chr switch]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=5406&amp;p=48917#p48917"><![CDATA[
The sprite patterns for the next scanline are fetched during hblank. You might remember this was one of the reasons I had so much trouble making that border at the top of the screen a while back.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=95">tokumaru</a> — Wed Jul 15, 2009 11:34 am</p><hr />
]]></content>
</entry>
</feed>