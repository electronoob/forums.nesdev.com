<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - FamicomBox</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">FamicomBox</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=9042">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=9042</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>nocash</b> [ Mon Jun 25, 2012 9:20 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>FamicomBox</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hi, I've spent some days on (trying to) understanding the FamicomBox (a special NES with 15 game cartridge slots, and pay-per-play feature, for use in hotel rooms).
<br />There's a good and (almost) complete description of the hardware on kevtris.org - first of, here's a review of the pages:
<br />-----------------------------
<br />PAGE 1
<br /><!-- m --><a class="postlink" href="http://kevtris.org/mappers/famicombox/index.html">http://kevtris.org/mappers/famicombox/index.html</a><!-- m -->
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">then it goes back to the title. 20:23 20:44 20:45</div><br />Hmmmm.... the SNES-SuperFamicomBox does actually have a RTC chip, but I think the NES-FamicomBox doesn't have one - and the Menu program doesn't contain any time-display function. So, the "20:23 20:44 20:45" part must be some sort of copy-paste-typo.<br />-----------------------------<br />PAGE2<br /><!-- m --><a class="postlink" href="http://kevtris.org/mappers/famicombox/index1.html">http://kevtris.org/mappers/famicombox/index1.html</a><!-- m --><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">When the keyswitch is turned all the way to the left, this screen comes up [GAME &amp; TITLE COUNT DISP.]<br />And finally, if you turn the keyswitch to the right a couple clicks, you get this self test screen</div><br />Ah, the keyswitch. Even with a lot of love in detail... understanding that thing will be pretty hardcore. Let's see:<br />- It has six positions.<br />- Two of the positions are labelled OFF and ON (unknown which ones)<br />- There are Black visitor keys, and red master keys (see <!-- m --><a class="postlink" href="http://www.famicombox.jp/kaitai1.html">http://www.famicombox.jp/kaitai1.html</a><!-- m -->)<br />- The 1st position from left is the COUNT DISP stuff, this is in Bit5 in the I/O port<br />- The 2nd..6th position from left have unknown function, and are assigned to unknown Bit numbers in the I/O port (if it's equally messy as the SNES version, then the bits are probably not straightly numbered).<br />- Aside from the obvious "<strong>Nth from Left</strong>" and "<strong>Bit number</strong>" naming schemes, there are three more naming schemes: "<strong>1 2 3 4 5 6</strong>" (ASCII string found in the menu program. "<strong>1-OFF-ON-2-3-4</strong>" (depicted on the <!-- m --><a class="postlink" href="http://www.famicombox.jp/kaitai1.html">http://www.famicombox.jp/kaitai1.html</a><!-- m --> page), and "<strong>0 1 2 3 4 6</strong>" (used on the kevtris page; note the gap between 4 and 6 - I guess that are pin numbers, and pin5 would be GND or so).<br /><br />-----------------------------<br />PAGE3<br /><!-- m --><a class="postlink" href="http://kevtris.org/mappers/famicombox/index2.html">http://kevtris.org/mappers/famicombox/index2.html</a><!-- m --><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">This thing cannot run later games that use the MMC3 or anything which uses IRQs, and anything that maps stuff outside the area of 8000-FFFFh.</div>
<br />Okay... but why not?
<br />
<br />The FamicomBox &amp; Menu cartridge don't use IRQs internally (except with a Test mode adaptor), so IRQs should be available for use by games - unless the IRQ lines of the deselected games are somehow disturbing the selected game...?
<br />
<br />For the 8000h-FFFFh are, the FamicomBox is apparently masking the ROM select pin (pin 50). For other memory it would somehow need to mask memory cycles (PHI, pin 38.), and/or to output dummy-addresses (A13-A14, pin 40-41). But that isn't implemented?
<br />
<br />For the 6000h-7FFFh part. A few games are using that area for I/O, but most commonly it is used for SRAM. Now, the FamicomBox mainboard does contain 8K SRAM mapped to that address; the Menu program doesn't seem to be using that memory at all (except in test mode). I guess the memory is kept enabled even during Game-execution (?) and probably it's actually intended for use by games.
<br />
<br />Ie. Unlike NES games, FamicomBox SRAM Games won't contain any built-in SRAM, but rather use the SRAM on the mainboard. Right?
<br />And a side-note on the SRAM supply: I can't see a battery on the photos, so it's probably not battery-backed. On the other hand, there's no power-switch, so SRAM should be permanently powered; unless one unplugs the power supply.
<br />
<br />-----------------------------
<br />PAGE4
<br /><!-- m --><a class="postlink" href="http://kevtris.org/mappers/famicombox/index3.html">http://kevtris.org/mappers/famicombox/index3.html</a><!-- m -->
<br />Just some photos here.
<br />
<br />-----------------------------
<br />PAGE5
<br /><!-- m --><a class="postlink" href="http://kevtris.org/mappers/famicombox/index4.html">http://kevtris.org/mappers/famicombox/index4.html</a><!-- m -->
<br />Some more photos. Including a few details on the "CATV" connector... Does anybody know anything on that CATV thing?
<br />
<br />It seems to be intended to be connected to a computer in the hotel office or so. Ie. in COIN mode, you'd insert coins to play. And in CATV mode, your room bill would be charged automatically when playing (via a PLAY pin). There's also an ALERT pin (used when you try to steal the joypads or zapper).
<br />
<br />-----------------------------
<br />PAGE6
<br /><!-- m --><a class="postlink" href="http://kevtris.org/mappers/famicombox/index5.html">http://kevtris.org/mappers/famicombox/index5.html</a><!-- m -->
<br />Some more photos here.
<br />
<br />-----------------------------
<br />PAGE7
<br /><!-- m --><a class="postlink" href="http://kevtris.org/mappers/famicombox/index6.html">http://kevtris.org/mappers/famicombox/index6.html</a><!-- m -->
<br />Descriptions of the Pin-Outs and I/O Ports. More on that in next two posts...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>nocash</b> [ Mon Jun 25, 2012 10:08 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Pinout section PAGE7
<br /><!-- m --><a class="postlink" href="http://kevtris.org/mappers/famicombox/index6.html">http://kevtris.org/mappers/famicombox/index6.html</a><!-- m -->
<br />
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Pinout of the 26 pin connector that connects the front controls:<br /> 3 - Front LED anode (cathode is grounded)<br /> 7 - pin 3 of coin connector. connects to LED.<br /></div><br />What is that? Are there two separate LEDs, or is it both the same LED? Are the LED(s) always on? Or software controlled by 6502 CPU? Or by the Coin Timer Chip? Or by something else?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Pinout of the 26 pin connector that connects the front controls:<br /> 4 - TV/Game button (5V on other end- connected to pin 6)<br /> 6 - +5V<br /></div><br />Okay, sounds simple. Unless... is there something special wih the 5V on pin 6? (like being switched via the relay or so?)<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Pinout of the 26 pin connector that connects the front controls:<br /> 9 - GND on zapper plug (!!)<br /></div><br />That must be referring to Pin 1 of the Zapper's 7-pin connector, ie. the pin that would be GND on normal controller ports. For normal operation, the FamicomBox should output a strong LOW level, presumably via a transitor. For zapper connection check, the pin can be apparently switched to a weaker "Low-Z" level, and the Menu program can then read the voltage level of that pin - if the zapper is disconnected (guest has cut the cable), then the pin would be Low. If the zapper is connected, then zapper hardware will drag the pin High.<br />It's a bit similar to the VS-Unisystem connect check, but works with a regular 4-wire zapper (the VS connect check doesprobably using special 5-wire lightguns).<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Expansion connector (behind a small door on the back left side):<br />23 - 5007R.7<br /></div><br />According to the I/O port descriptions, 5007h.R.7 somehow connects to 5005h.W.5. If that's correct... then Expansion Pin 23 should be actually 25007h.R.7+5005h.W.5" ?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The modulator has a couple inputs:<br />Audio - mono audio from amplifier+external+coin feep<br />Video - comes from the usual transistor circuit on the PPU<br />B+    - connects to 5V<br />B+SW  - when grounded, switches the game in.  when high, lets TV signal pass through<br />GND   - connects to ground<br />40%   - undermodulates video by 40% when low.  high = normal<br /></div>
<br />That are only six inputs? The photos are showing 7-wire connection to modulator.
<br />
<br />Now the pin-outs missing on the kevtris page. The 3pin coin mech and 7pin joypad connectors are somewhat implied in the Front-panel description - ie. they should be as so:
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">3pin Coin Mechanics connector &#40;from Front Panel to External Coin Unit&#41;<br />&nbsp; 1 - &#40;pin8 of front panel PCB&#41; &#40;Low=Add credit&#41; &#40;also wired to TEST button&#41;<br />&nbsp; 2 - GND<br />&nbsp; 3 - &#40;pin7 of front panel PCB&#41; &quot;connects to LED&quot;&nbsp; &nbsp;err.. what LED, what for?<br /><br />7pin Controller Ports &#40;3 pieces; for 2 Joypads and 1 Zapper&#41;<br />&nbsp; Pin Purpose&nbsp; &nbsp; &nbsp; &nbsp; Port 1 &#40;Joy1&#41; Port 2 &#40;Joy2&#41;&nbsp; &nbsp; &nbsp; Port 3 &#40;Zapper&#41;<br />&nbsp; 1 - Ground&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;GND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;GND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5005h.W.Bit2/5007h.R.Bit2<br />&nbsp; 2 - Joypad Clock&nbsp; &nbsp;4016h.R&nbsp; &nbsp; &nbsp; &nbsp;4017h.R&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4017h.R&nbsp; &nbsp; &nbsp; &nbsp;.---------.<br />&nbsp; 3 - Joypad Strobe&nbsp; 4016h.W.Bit0&nbsp; 4016h.W.Bit0&nbsp; &nbsp; &nbsp; &nbsp;NC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 4 3 2 1 |<br />&nbsp; 4 - Joypad Data&nbsp; &nbsp; 4016h.R.Bit0&nbsp; 4017h.R.Bit0&nbsp; &nbsp; &nbsp; &nbsp;NC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | 7 6 5&nbsp; /<br />&nbsp; 5 - Supply&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+5V&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+5V&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; +5V&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'-------'<br />&nbsp; 6 - Zapper Light&nbsp; &nbsp;4016h.R.Bit3&nbsp; 4017h.R.Bit3/DIP10 4017h.R.Bit3/DIP10<br />&nbsp; 7 - Zapper Button&nbsp; 4016h.R.Bit4&nbsp; 4017h.R.Bit4/DIP10 4017h.R.Bit4/DIP10<br /></div><br /><br />And the strange CATV thing. Judging from photos and fragments from the I/O description, it should be somehow like so:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Whatever connector &#40;marked &quot;CATV INTERFACE&quot;&#41;<br />&nbsp; 1 - 5000h.RW.Bit7 Exception Trap &#40;usually strapped to GND, ie. CATV pin4&#41;<br />&nbsp; 2 - Unknown<br />&nbsp; 3 - Unknown<br />&nbsp; 4 - GND<br />&nbsp; 5 - +5V<br />&nbsp; 6 - Unknown<br />&nbsp; 7 - 5001h.W.Bit6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;Play-and-Pay &#40;unless TV mode?&#41;<br />&nbsp; 8 - 5001h.W.Bit7 and 5007h.R.Bit4 ;Joypad/Zapper-Disconnect-Alert<br /></div>
<br />Note that the kevtris I/O description claims 5000h.RW.Bit7 to be on Pin 4. But judging from the kevtris photos it looks more like Pin4=GND. Pin 1+4 are somehow "related", so I guessed 5000h.RW.Bit7 being on Pin 1 instead Pin 4 (but that may be wrong).
<br />For Pin 8, I have no clue why it has two I/O bits assigned.
<br />And for the unknown pins, both the ASCII strings in the menu, and the kevtris I/O specs are indicating that there is a "Switching Relay" (whatever that means) - maybe that thing is related to the CATV connector?
<br />
<br />EDIT: Two more pin-outs:
<br />
<br />3199 - 16pin Coin Timer/Coin Chip (1 piece; on mainboard)
<br />(assuming it has same pins as normal CICs, ie. Pin1-4 = P00..P03 etc.)
<br />  1   P00  5001h.W.Bit0 (unknown purpose)
<br />  2   P01  5001h.W.Bit1 (unknown purpose)
<br />  3   P02  5001h.W.Bit2 (unknown purpose)
<br />  4   P03  5001h.W.Bit3 (unknown purpose)
<br />  5   CL2  whatever MHz clock (or maybe NC)
<br />  6   CL1  whatever MHz clock (this one needed)
<br />  7   RES  whatever type of reset (maybe I/O controlled?)
<br />  8   GND  Supply GND
<br />  9   P10  5003h.R.Bit6 (reportedly "Money system enabled")
<br />  10  P11  5003h.R.Bit7 (unknown purpose)
<br />  11  P12               (unknown purpose)
<br />  12  P13  5001h.W.Bit4 (unknown purpose)
<br />  13  P20               (unknown purpose)
<br />  14  P21  5001h.W.Bit5 (unknown purpose)
<br />  15  P22               (unknown purpose)
<br />  16  VCC  Supply VCC
<br />Note: Reportedly, 5005h.W.Bit1 also connects to whatever 3199 pin. Moreover, the 3199 chip should connect to "a LED", sound feep, 40% video dimming, and coin-insert signal.
<br />
<br />72-Pin Cartridge Slots (16 slots: for menu cart and 15 game carts)
<br />As far as known, this is mostly same as on 72-pin NES cartridges. But, with some differences:
<br />Pin 16-19 are the 4bit SlotID; for use by the FamicomBox CIC chip (on NES carts, these pins are unused "expansion" pins).
<br />And, PRG-ROM select (Pin 50) is probably masked on unused slots. And deselecting PPU memory is... maybe... done by masking the PPU-READ signal (Pin 21) or so?
<br />And, there seems to be a problem with the /IRQ pin (see above post), and with CPU space below 8000h (see above, too).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>nocash</b> [ Mon Jun 25, 2012 12:39 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />And, the I/O section from PAGE7 
<br /><!-- m --><a class="postlink" href="http://kevtris.org/mappers/famicombox/index6.html">http://kevtris.org/mappers/famicombox/index6.html</a><!-- m -->
<br />
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">5000R: Device which caused an exception (0 = this device caused the exception)<br />0 - 6.82Hz interrupt source hit<br />1 - 8 bit timer expired @ 5003W<br />2 - controller(s) were read<br />3 - keyswitch was rotated<br />4 - money was inserted<br />5 - reset button was pressed<br />6 - watchdog timer expired (reading either controller resets this timer)<br />7 - Pin 4 of "CATV connector" went high/open<br />When 5000R is read, this register is reset, and the exception trap controller is reset.<br /></div><br /><br />"6.82Hz interrupt source" would be just a 6.82Hz square wave asserted to Reset Trap? Any clue what is that good for? And "interrupt" refers only to the Reset-exceptions (not to IRQ pin), right?<br /><br />"controller(s) were read" - what is that good for? Does it really reset as soon as controllers are read (even when no buttons are pressed)?<br /><br />"money was inserted" doesn't seem to be too useful, except maybe for automatically leaving Demo mode. The menu software seems to handle that bit also for "money has expired" situations - maybe that exception trap is used for BOTH inserted and expired?<br />And if so, I'd bet that it traps only on transitions (empty--&gt;inserted, and inserted--&gt;expired). But not on recharging (inserted--&gt;more inserted); doing a reset in that situation would be annoying.<br />And if that trap-bit doesn't trap on expired... is there an expired-trap bit elsewhere in other I/O ports?<br /><br />"Pin 4 of CATV connector" went high/open" - pretty sure that pin 4 is GND, so that must be wrong.<br /><br />-------------------------------<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">5001W Money handling register (reset to 00h on power up only)<br />6 - enable pin 7 of "CATV" connector, 1 = enable.  when in TV mode, output goes low. else output stays high<br /></div><br />I don't really understand that part. Sounds as if there are 4 possible situations (Bit6 set/cleared, and button in tv/game mode)... and then something happens?<br />My current conclusions for 5001W are:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; 0&nbsp; &nbsp; Coin Chip pin 1&nbsp; &#40;1=Ten Minutes per Coin&#41;<br />&nbsp; 1&nbsp; &nbsp; Coin Chip pin 2&nbsp; &#40;1=Twenty Minutes per Coin&#41;<br />&nbsp; 2&nbsp; &nbsp; Coin Chip pin 3&nbsp; &#40;should be always 0, except in test mode&#41;<br />&nbsp; 3&nbsp; &nbsp; Coin Chip pin 4&nbsp; &#40;should be always 0, except in test mode&#41;<br />&nbsp; 4&nbsp; &nbsp; Coin Chip pin 12 &#40;should be always 0, except in test mode&#41;<br />&nbsp; 5&nbsp; &nbsp; Coin Chip pin 14 &#40;1=Apply Minutes?&#41;<br />&nbsp; 6&nbsp; &nbsp; CATV Connector pin 7 &#40;0=Free-Menu/Demo, 1=Play-and-Pay; unless TV Mode?&#41;<br />&nbsp; 7&nbsp; &nbsp; CATV Connector pin 8 &#40;0=High=Okay, 1=Low=Joypad/Zapper-Disconnect-Alert&#41;<br /></div><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">5002W LED &amp; memory protect register (reset to 00h when CPU is reset)<br />7 - LED flash- high = flash, low = steady<br /></div><br />Okay, that does probably refer to the currently selected Red Slot-LED (not to the green Front-panel LED), right?<br />And steady means always-on, and flash means 3.414Hz blink?<br />Ah, and "low" means 0, or what?<br /><br />------------------------------<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">5004W Cart control register (reset to 00h when CPU is reset)<br />4 - row select 0<br />5 - row select 1<br />6 - Lock.  writing a 1 here unmaps all hardware<br /></div><br />I am a bit curious what the Row Select bits are doing, disabling data/address bus on unused carts? or even disabling VCC?<br /><br />"Lock.  writing a 1 here unmaps all hardware"<br />All hardware? Like the PPU, CPU, power-supply? No.<br />The bits seems to be set before starting games, so it does probably disable only the "special famicombox" hardware, and thereby switches to a regular-NES emulation mode.<br /><br />Namely, I would guess that it disables all writes (and maybe reads) to the port 500xh area. Ie. freezes all 500xh.W ports in their current state - that, of course only until a reset-trap occurs.<br /><br />Other than that, I can't imagine any other special hardware that could/should be disabled by the "lock" bit. Except maybe the SRAM at 6000h-7FFFh, but I think that memory is explicitly <em>intended</em> to be used by the games.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Proper cart selection requires setting up BOTH the desired cart # (00-0fh), AND the proper row.  The menu software uses a small table to do this.</div><br />A table? No, it does do the row selection, but it isn't using a table.<br />Unless there are different versions of the menu software? The one I have seen has CRC32=DA1EB8D2h on the 32K PRG-ROM part (=excluding iNES header and CHR-ROM).<br /><br />-------------------------------<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">5005W CATV and joypad control (reset to 00h on power up only)<br />0 - 1 = flip latching relay to position A (coil on pins 1 &amp; 10)<br />1 - connects to 3199<br />2 - turn zapper on. 1 = turn on<br />3 - enable 40% input of modulator.  1 = enable, 0 = disable<br />4 - NC<br />5 - maps to 5007R.7<br />6 - joypad enable- 1 = disable, 0 = enable<br />7 - joypad swap. 1 = normal, 0 = swap        swapping only swaps D0 and CLK<br /></div><br />Whoops.<br />First question would be: Which bits of the CATV register do have anything to do with CATV? The relay, maybe?<br /><br />For the relay bit, 1=PositionA sounds fine. But what happens on zero? 0=NoChange? Or 0=PositionB?<br /><br />"1 - connects to 3199"... but to which pin? The bit seems to be used somehow as "0=Operate, 1=Config/Reset". So far, it might actually connect to the Reset line of the 3199 chip...?<br /><br />"2 - turn zapper on. 1 = turn on" Yes, seems to be right. Or in other words: "Zapper GND (0=Disable/Low-Z; for 5007h.R connect-check, 1=Enable/GND)"<br /><br />"3 - enable 40% input of modulator.  1 = enable, 0 = disable"... in other words, that would mean 0=normal brightness, 1=dimmed picture?<br /><br />"5 - maps to 5007R.7"... according to the pin-Out section, 5007R.7 is Pin 23 on the 50-pin expansion port... so 5005R.5 would go to that pin, too, right?<br /><br />"6 - joypad enable- 1 = disable, 0 = enable" okay... not perfectly clear which pins are disabled, though not too important either. In practice, the bit seems to be used to disable joypads (maybe also zapper) in demo mode.<br /><br />------------------------------<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">5003R<br />0 - key position 0 (1 = in this position)<br />1 - key position 1<br />2 - key position 2<br />3 - key position 3<br />4 - key position 4<br />5 - key position 6<br />6 - money system enabled (pin 9 of 3199)<br />7 - pin 10 of 3199<br /></div><br />Here, bit7 seems to be left unused by the existing software, so no idea what that bit is used for.<br /><br />Bit6 means 0=NoMoney (or Money expired), 1=Money (coin timer is running), simple. Well, except - I don't know if the coin timer can be paused (eg. during menu selections, or when watching TV or so); ie. ideally it should be running only when actually playing a game.<br /><br />Bit0-5 are somewhat:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; 0&nbsp; &nbsp; Key Position 0 &#40;0=No, 1=Yes&#41; &#40;??? from left&#41; ;-&#40;demo mode?&#41;<br />&nbsp; 1&nbsp; &nbsp; Key Position 1 &#40;0=No, 1=Yes&#41; &#40;??? from left&#41; ;\SELECT GAME &#40;play modes&#41;<br />&nbsp; 2&nbsp; &nbsp; Key Position 2 &#40;0=No, 1=Yes&#41; &#40;??? from left&#41; ;/<br />&nbsp; 3&nbsp; &nbsp; Key Position 3 &#40;0=No, 1=Yes&#41; &#40;??? from left&#41; ;-SELF CHECK and GAME CHECK<br />&nbsp; 4&nbsp; &nbsp; Key Position 4 &#40;0=No, 1=Yes&#41; &#40;??? from left&#41; ;-Lockup ???<br />&nbsp; 5&nbsp; &nbsp; Key Position 6 &#40;0=No, 1=Yes&#41; &#40;1st from left&#41; ;-GAME TITLE &amp; COUNT<br /></div><br />Plenty question marks. Aside from Bit5 - there is almost nothing known.<br /><br />------------------------------<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">5007R<br />0 - TV type selection (1 = game, 0 = TV)<br />1 - keyswitch turned (1 = in middle of positions)<br />2 - 0 = zapper grounded<br />3 - pin 21 of exp. conn. (inverted)<br />4 - state of pin 8 of "CATV" connector,  0 = low, 1 = high<br />5 - relay position. 0 = position A, 1 = position B<br />6 - pin 22 of exp. conn. (inverted)<br />7 - 5005.5W (inverted)<br /></div>
<br />This one is nasty, too...
<br />
<br />"0 - TV type selection (1 = game, 0 = TV)" ... actually, the menu does boot only if that bit is 0. Assuming that it CAN boot in game mode, the bits should be vice-versa.
<br />But, actually, the menu seems to handle that bit as 9th bit of the Exception Flag register. Namely, it looks like a CIC-Error-Trap flag. Which would have nothing to do with TV/Game selection.
<br />
<br />"1 - keyswitch turned (1 = in middle of positions)"... that should be vice-versa: 1=stable position, 0=middle of positions.
<br />
<br />"2 - 0 = zapper grounded"... basically, yes. Again, the purpose is connect check, and the more relevant values (seen when zapper is NOT grounded) would be: 0=Low=Disconnected, and 1=High=Connected.
<br />
<br />"4 - state of pin 8 of "CATV" connector"... hmmm, then Pin8 is shared for 5007R.4 and 5001W.7 (=disconnect alert signal)... is that correct?
<br />
<br />"5 - relay position. 0 = position A, 1 = position B"... I really don't have much of a clue what the relay is used for. Some info fragments:
<br />The menu software does do the "flip to position A" stuff here and there, and the self-checks expect 5007R.5 to be "1=okay" - in so far, if the relay is still "flipped-to-A" at that point, then I'd expect the settings to be vice-versa: 0=B, and 1=A (though there might be something that "flips-to-B" before doing the self-check.
<br />In CATV mode, 5007R.5=1 seems to have this meaning: Prompt-User-before-Play. If the user responds NO in the DO YOU PLAY screen, then the box goes into demo mode.
<br />
<br />"7 - 5005.5W (inverted)"... again, according to the Pin-Out section, this bit does ALSO go to Pin 23 of the 50-pin expansion port. AND, the menu program seems to be somehow treating this bit as coldboot/warmboot flag. I am pretty puzzled there.
<br />
<br />----------------------
<br />
<br />Oh, and some notes on menu features: The STAFF gimmick shows up when pushing U,D,L,R,A,B,SEL,STA in the TITLE &amp; COUNT DISP screen.
<br />
<br />Then there's the SELF CHECK SCREEN DISP screen (as seen on the kevtris photos). After pushing a button, that screen is followed by list of installed games, and then the menu seems to hang-up; though that <em>might</em> be a bug in my emu.
<br />
<br />Then there should be a "FINAL CHECK MENU" screen with 7 options - but I have no clue how one is intended to enter that menu screen. Does anybody know how to get in there?
<br />
<br />And, a third test feature called AGING or AGEING test seems to be activated via the 5003R.Bit4 keyswitch position. These tests aren't listing OK/BAD results. Instead, they are programmed to lock-up with a "fatal" error message (eg. PROTECT IC ERROR), and otherwise they are passing silently (without showing any PROTECT IC OKAY message).
<br />In fact, the error messages aren't shown either (except, sometimes they are shown, but only AFTER turning the keyswitch to a different location) - seems to be a bug either in my emulator, or in the Menu program.
<br />
<br />Are that error messages showing up on real hardware? Some if the AGING tests seem to be require special test-cartridges (with RAM at 8000h and such things), so, I think you should definitely see an error message; unless the menu program is bugged.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mikejmoffitt</b> [ Mon Jun 25, 2012 1:42 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I hate to have to ask, but is Kevtris uncontactable? It seems like he'd be able to shed some useful light on this.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Jun 25, 2012 3:10 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Kev's on <a href="http://wiki.nesdev.com/w/index.php/IRC" class="postlink">#nesdev</a> regularly.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>mikejmoffitt</b> [ Mon Jun 25, 2012 4:18 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Okay, just wasn't sure if he'd disappeared or something - a lot of posts that looked like they were once useful have been edited out.
<br />Back on track, didn't mean to derail anything!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>nocash</b> [ Wed Jun 27, 2012 5:27 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yes, he seems to be uncontactable. Tried a sending a PM in this forum, but don't know if he's reading that messages. And the email address on the kevtris.org page is having a killer-spam filter that tells me that it doesn't accept messages from web.de users.
<br />Would be great if somebody could ask him to drop by, maybe via #nesdev (haven't tried there), or via a less disliked email server...

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>