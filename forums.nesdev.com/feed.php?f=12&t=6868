<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=12&amp;t=6868" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2010-08-19T10:39:04-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=12&amp;t=6868</id>
<entry>
<author><name><![CDATA[psycopathicteen]]></name></author>
<updated>2010-08-19T10:39:04-07:00</updated>
<published>2010-08-19T10:39:04-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66284#p66284</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66284#p66284"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66284#p66284"><![CDATA[
I just thought of something.  For calculating the x tile, your required to shift right 4 bits, but for y tile, you can just AND it with #$fff0.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4383">psycopathicteen</a> — Thu Aug 19, 2010 10:39 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2010-08-19T08:19:20-07:00</updated>
<published>2010-08-19T08:19:20-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66278#p66278</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66278#p66278"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66278#p66278"><![CDATA[
Or to reduce the loop overhead even further, you can build an unrolled ASL-slide in RAM and call that.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Thu Aug 19, 2010 8:19 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[psycopathicteen]]></name></author>
<updated>2010-08-19T08:06:39-07:00</updated>
<published>2010-08-19T08:06:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66276#p66276</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66276#p66276"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66276#p66276"><![CDATA[
I'm using logarithmic shifts.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">lda Y_TILE<br />ldx log&#40;WIDTH&#41;<br />loop:<br />asl<br />dex<br />bne loop<br /></div><br /><br />EDIT: I just thought of a faster code<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">lda Y_TILE<br />ora indication_bit<br />loop:<br />asl<br />bcc loop<br /></div><br /><br />It stops shifting when it detects the indication bit.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4383">psycopathicteen</a> — Thu Aug 19, 2010 8:06 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Bregalad]]></name></author>
<updated>2010-08-19T03:15:20-07:00</updated>
<published>2010-08-19T03:15:20-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66271#p66271</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66271#p66271"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66271#p66271"><![CDATA[
I don't see the problem if you only get 8x8 -&gt; 16 bit multiplication. If you want to do, say, 16x16 -&gt; 32 bit, all it takes it to compute LOW*LOW, LOW*HIGH, HIGH*LOW and HIGH*HIGH, and add/shift them together.<br />I guess the multiplication unit is the same used for more 7, and that it only works when mode 7 is not used (is this right or am I just making this one up ?). If this is the case you'd want to only use this if you're absolutely sure you don't need mode 7 in your game.<br /><br />You'd want to look the <a href="http://wiki.nesdev.com/w/index.php/Multiplication_by_a_constant_integer" class="postlink">NESdevwiki article about multiplication</a> - of course it's different on the SNES because of 16-bit mode but you get the idea on doing a multiplication without using an hardware unit.<br />And for a level which has to do frequent multiplications variable * variable, but where one of the variables is only modified rarely, it's a good option to reserve some RAM to have self-modifying code doing the multiplication by this value (that is generated by software).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> — Thu Aug 19, 2010 3:15 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[TmEE]]></name></author>
<updated>2010-08-18T22:24:07-07:00</updated>
<published>2010-08-18T22:24:07-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66265#p66265</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66265#p66265"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66265#p66265"><![CDATA[
On MD I have a so called "sector" setup, where there's always 4 active sectors that are decompressed into RAM and from within the objects are checked etc. Each sector is 16x16 metatiles in size, each metatile being 16x16 pixels. I only need 2Kbyte decomrpession buffer and all colission data etc. are derived from stage data in the zones. There's no MUL or DIV happening since there's no need, just old fashioned shifts ^^<br /><br />Gotta love powers of two ^^ (and VDP address auto increment, I can toss out nearly all VRAM location calculations with the help of it <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> )<br /><br />One linitation is that going from one end of the stage to another will require decompressing inbetween sectors... that could be remedied if you use seek tables...<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3483">TmEE</a> — Wed Aug 18, 2010 10:24 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2010-08-18T20:41:26-07:00</updated>
<published>2010-08-18T20:41:26-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66263#p66263</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66263#p66263"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66263#p66263"><![CDATA[
<div class="quotetitle">psycopathicteen wrote:</div><div class="quotecontent"><br />Too bad the Snes only has an 8 bit multiply.<br /></div><br />It has signed 16x8 as well. See M7A, M7B, MPYL, MPYM, and MPYH.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Wed Aug 18, 2010 8:41 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2010-08-18T20:03:38-07:00</updated>
<published>2010-08-18T20:03:38-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66260#p66260</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66260#p66260"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66260#p66260"><![CDATA[
Perhaps "rooms" use screen-aligned scrolling as seen in The Legend of Zelda or Smash TV or The Legend of Zelda: Link's Awakening.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Wed Aug 18, 2010 8:03 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tokumaru]]></name></author>
<updated>2010-08-18T19:28:17-07:00</updated>
<published>2010-08-18T19:28:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66258#p66258</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66258#p66258"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66258#p66258"><![CDATA[
Aren't rooms essentially small levels? I don't see much difference.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=95">tokumaru</a> — Wed Aug 18, 2010 7:28 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[psycopathicteen]]></name></author>
<updated>2010-08-18T19:34:47-07:00</updated>
<published>2010-08-18T19:25:26-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66257#p66257</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66257#p66257"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66257#p66257"><![CDATA[
If I'm doing it by level, I'll use logarithmic multiplication.<br /><br />If I'm doing it by room, I'll use the hardware multiplication.<br /><br />Which method is the better method?<br /><br /><br />Just so you know, I'm doing v-ram loading a little bit different than conventional ways.  I'm using the PPU's 16x16 pixel tile mode as opposed to metatiles, and I'm updating the screen as a whole as opposed to the conventional collumn and row method.  I'm blanking out the top and bottom 16 scanlines to have more dma time.  It might sound a little redundant, but it will make swapping out tiles so much easier.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4383">psycopathicteen</a> — Wed Aug 18, 2010 7:25 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2010-08-18T18:37:19-07:00</updated>
<published>2010-08-18T18:37:19-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66255#p66255</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66255#p66255"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66255#p66255"><![CDATA[
You could arrange your decompressed level as a set of 256x256 pixel areas, as tokumaru edited into his post while I was writing mine. Animal Crossing series does this, wherein the 16x16-metatile areas are called "acres". Under such a scheme, you could even have screens with nothing in them be a null pointer; AC uses this for the solid wall or water acres outside the area where the player character can walk. Sonic 2 for Genesis likewise uses supermetatiles, each 128x128 pixels or 8x8 metatiles. Levels have a fixed size, but an individual supermetatile (such as those representing emptiness) is reused several times in a level. The one thing that becomes more complicated with supermetatile reuse is destructible terrain; you have to reserve some parts of RAM for copy-on-write, which is why Sonic tends to use sprites for anything destructible (such as rings).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Wed Aug 18, 2010 6:37 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[ReaperSMS]]></name></author>
<updated>2010-08-18T18:35:39-07:00</updated>
<published>2010-08-18T18:35:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66254#p66254</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66254#p66254"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66254#p66254"><![CDATA[
So write a multiply function. The SNES one is 8x8=16 IIRC, and you can build whatever size you need out of that, and even do it with straight normal arithmetic if you so chose.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=8">ReaperSMS</a> — Wed Aug 18, 2010 6:35 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tokumaru]]></name></author>
<updated>2010-08-18T18:35:45-07:00</updated>
<published>2010-08-18T18:35:20-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66253#p66253</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66253#p66253"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66253#p66253"><![CDATA[
Well, the NES doesn't have any built-in multiplication and it can handle arbitrarily sized levels just fine, I'm sure the SNES can do it as well.<br /><br />In my NES game, the level map is composed of screens (256x256 pixel blocks), like Sonic 1 on the MD or Mega Man X on the SNES, and levels can be up to 64 screens tall. Since the width of the maps varies and I don't want to do a multiplication every time I want to access them, Before the level starts I pre-calculate the address of every row of screens and store in a table, so that the Y coordinate will indicate which address I must use and the X coordinate is used as an index from that address on.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=95">tokumaru</a> — Wed Aug 18, 2010 6:35 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[psycopathicteen]]></name></author>
<updated>2010-08-18T18:22:07-07:00</updated>
<published>2010-08-18T18:22:07-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66252#p66252</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66252#p66252"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66252#p66252"><![CDATA[
Too bad the Snes only has an 8 bit multiply.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4383">psycopathicteen</a> — Wed Aug 18, 2010 6:22 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tokumaru]]></name></author>
<updated>2010-08-18T16:33:48-07:00</updated>
<published>2010-08-18T16:33:48-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66251#p66251</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66251#p66251"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66251#p66251"><![CDATA[
<div class="quotetitle">psycopathicteen wrote:</div><div class="quotecontent"><br />How can it not have to do with the size of the level?  If I have 512 x 64 tiles, I have to multiply the y-tile by 512 and add it to the x-tile.  If I have 256 x 128 tiles, I have to multiply the y-tile by 256 and add it to the x-tile.<br /></div><br />Just don't hardcode the width. I'm sure the SNES can handle a dynamic multiplication. If you think it will be too slow, you can set aside some RAM and pre-calculate pointers to each row, like I do with my NES game.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=95">tokumaru</a> — Wed Aug 18, 2010 4:33 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tokumaru]]></name></author>
<updated>2010-08-18T16:31:47-07:00</updated>
<published>2010-08-18T16:31:47-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66250#p66250</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66250#p66250"/>
<title type="html"><![CDATA[level sizes]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=6868&amp;p=66250#p66250"><![CDATA[
<div class="quotetitle">psycopathicteen wrote:</div><div class="quotecontent"><br />How should I store the level then?<br /></div><br />Depends on how much ROM you have to waste! =)<br /><br />Since you're working on the SNES, which has much more RAM than the NES, it makes sense to have your whole map decompressed from whatever format you compressed it with to RAM. Once in RAM it should be nothing more than a 2D array, that you access with the good old formula <strong>Y * width + X</strong>.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=95">tokumaru</a> — Wed Aug 18, 2010 4:31 pm</p><hr />
]]></content>
</entry>
</feed>