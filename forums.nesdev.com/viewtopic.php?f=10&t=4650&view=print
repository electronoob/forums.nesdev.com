<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - nametable questions</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">nametable questions</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=10&amp;t=4650">http://forums.nesdev.com/viewtopic.php?f=10&amp;t=4650</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>GradualGames</b> [ Sat Dec 13, 2008 8:49 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>nametable questions</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />if a screen can contain up to 32x30 tiles, that means we can have 960 tiles on the screen...however a single nametable entry is 8 bits long (right??), so that means you can only have 256 possible unique tiles on the screen and the rest of the 960 must be repeated (from the 256)?  If that is true, then how does one load a .chr file without an associated nametable----or do .chr editing programs such as yy-chr output both the pattern table and the name table? If there's an easy non hand holding answer then great otherwise I'm sure I'll get it eventually.
<br />
<br />Thanks,
<br />-Zom
<br />nes noob

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Sat Dec 13, 2008 9:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The name table is 32x30 tiles big, yes, and there are 960 8-bit entries for <em>tile data</em>. There are 64 8-bit entries that follow after that in each name table which represent color attribute data (2 bits for each 2x2 block. There's more info about that in NEStech and stuff, and that doesn't seem to be the topic so I'm not going to go too in depth about that).
<br />
<br />You have a pattern table that has 256 unique tiles. Each 8-bit entry in the name table for tile data displays that corresponding tile in the pattern table. The pattern tables are drawn with a CHR editor with the intent of forming them into something meaningful on the name table. I'm not quite sure what you mean by loading the pattern table without an associated name table, could you be a little more specific?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>GradualGames</b> [ Sat Dec 13, 2008 10:59 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Celius wrote:</div><div class="quotecontent"> I'm not quite sure what you mean by loading the pattern table without an associated name table, could you be a little more specific?</div>
<br />
<br />I have attempted to use YY-CHR (a tool available from this site) in a tutorial nes program. I haven't yet found enough information to learn what exactly is in the resulting .chr files. I'm assuming it must have a pattern table, a name table, and attributes. I suppose the trick is just knowing where all these tables begin once you've loaded them into the proper location in CHR -rom? I've gotten the file to recognizably load in, but it appears that the offsets are all incorrect. I may have asked my questions prematurely as I haven't dug in as far as I'd like yet. If I'm still stuck after a while I'll be back.  Thanks, -Zom

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Sun Dec 14, 2008 12:10 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Pattern tables, and nametables/attributes are different things. CHR data refers specifically to <em>pattern</em> tables. A CHR file includes nothing but pattern table data. If you're using 8k of CHR ROM, that data is already stored on a chip and you don't have to do any writing to the PPU for pattern tables. However, with <em>name</em> tables, you have to write to the PPU. Attributes are part of the name table. So they, too, must be written to the PPU. Palette data also has to be written to the PPU.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>GradualGames</b> [ Sun Dec 14, 2008 8:37 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Ok, I understand now. The tool I was trying, yy-chr only makes the pattern tables---I will need a seperate tool for arranging/designing the name tables and attribute tables.  Upon looking at the list of tools available here, looks like there are tools that can do each of these things. Thanks, -Zom

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bbbirddd</b> [ Thu Jan 08, 2009 10:02 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>How to set up the attribute table</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have been having trouble with name tables and attribute tables. I was trying to use GBAguy's map2bin program, but I was getting annoyed with it so I decided to try other programs. I wanted something to help with making name tables and attribute tables, so I tried NES Screen Arranger but I can't figure out how to run the darn program in XP. So I decided to write the nametable into my code directly. So I came up with this:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">tilepal: .incbin &quot;our.pal&quot;&nbsp; &nbsp;&nbsp; &nbsp;; include pallete and label its location &quot;tilepal&quot;<br />ourMap2:.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />ourMap:&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 1, 2, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db 17,18,17,18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />; .incbin &quot;map20.map&quot; &nbsp; &nbsp;; include map files and label its location &quot;ourMap&quot;<br />; ourMap2: .incbin &quot;bkg21.map&quot;<br /><br />; ////////////////////////Bank 2: CHR ROM - Sprite/Background Data//////////////////////<br /><br />&nbsp; &nbsp;.bank 2&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;.org $0000<br />&nbsp; &nbsp;.incbin &quot;bkg.bkg&quot;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;.org $1000<br />&nbsp; &nbsp;.incbin &quot;our.spr&quot;</div> (I added a little extra of the code around the table so you can get a sense of where I placed it)
<br />
<br />Now, this seems to work, except I tried to make my rom so that when I press the A key, the background changes (it basically just adds ourMap2, but I don't think that's really important for my problem). When I do this, the background does change correctly, but the colors get all screwed up and some random background tiles flicker around the screen (in Nintendulator). I think the problem has to do with the fact that I'm not dealing with the attribute table part correctly, but I don't really understand it. I've looked in a number of recommended docs, but they all seem sort of unhelpful. So if anyone could give me suggestions about how I can directly deal with attribute tables in my above code (or a good method that works with XP for setting up nametables and attribute tables in a GUI) that would be excellent. Thanks  <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Thu Jan 08, 2009 10:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I bet your code isn't executed with the screen shut off. It needs to either be within natural Vblank (NMI is fired on the start of this), or in a forced Vblank. So for a quick fix, write:
<br />
<br />lda #$00
<br />sta $2001
<br />
<br />before your updating code is executed. Then afterwards, turn the screen back on with whatever settings you had before.
<br />
<br />EDIT: Try Tepple's Name Table Editor, too. This works on XP.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bbbirddd</b> [ Thu Jan 08, 2009 10:37 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Celius, yep that worked. I still get an odd effect when I execute my rom, however. It's a flickering of my background that occurs at the bottom of the screen (I only want the tiles to appear toward the top, just moving slightly up and down with A presses. It might have to do with the way I'm just adding another row onto the top of the nametable. I'll try to muck around with it a bit and see).
<br />
<br />About Tepple's Name Table Editor, where can I find that? I don't see it under the Graphics Tools.
<br />
<br />Thanks for the help!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Thu Jan 08, 2009 10:46 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I think if you click on tepples' "www" it should take you to his site, where I think you can download it. For some reason, it's not listed under the tools though...
<br />
<br />Your flickering is caused by shutting the screen off, I think. If you execute the code during Vblank, and make sure it takes less than ~2200 cycles, there shouldn't be any flickering.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bbbirddd</b> [ Thu Jan 08, 2009 11:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks I got Tepple's editor so I'll try that out. 
<br />
<br />Regarding the flickering, I think I am running it during VBlank. I'm truly a noob to both NES and assembly, so I might have this wrong. This is the code that controls the background when A is pressed:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">AKEYdown:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; code executed when A is pressed<br /><br />vblankwait1:<br />&nbsp; &nbsp;lda $2002<br />&nbsp; &nbsp;bpl vblankwait1<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #$00&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; turn the screen off<br />&nbsp; &nbsp;sta $2001 <br /><br />&nbsp; &nbsp;lda #$20&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; reset to beginning of name table<br />&nbsp; &nbsp;sta $2006<br />&nbsp; &nbsp;sta $2006<br /><br />&nbsp; &nbsp;lda BKGset&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; check which background is loaded<br />&nbsp; &nbsp;cmp #0<br />&nbsp; &nbsp;bne BG1<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;ldx #$00<br />loadNames2:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; switch to background 2 &#40;1 is loaded originally&#41;<br />&nbsp; &nbsp;lda ourMap2, x<br />&nbsp; &nbsp;inx<br />&nbsp; &nbsp;sta $2007<br />&nbsp; &nbsp;cpx #4*32<br />&nbsp; &nbsp;bne loadNames2<br />&nbsp; &nbsp;lda #1<br />&nbsp; &nbsp;sta BKGset<br /><br />&nbsp; &nbsp;lda #%00011110&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; turn the screen back on<br />&nbsp; &nbsp;sta $2001&nbsp; &nbsp;&nbsp; &nbsp;<br /><br />&nbsp; &nbsp;jmp NOTHINGdown<br />&nbsp; &nbsp;<br />BG1:<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;ldx #$00&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />loadNames3:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; switch to background 1<br />&nbsp; &nbsp;lda ourMap, x &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;inx&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;sta $2007&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;cpx #4*32 &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;bne loadNames3 &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #0<br />&nbsp; &nbsp;sta BKGset<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #%00011110&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; turn the screen back on<br />&nbsp; &nbsp;sta $2001&nbsp; &nbsp;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;jmp NOTHINGdown</div>(I have BKGset set to zero in the beginning of my code)
<br />
<br />I'm not sure how to test whether or not it takes less than 2200 cycles (and I'm also not sure what that means). I'm not sure if this is something I can see with my emulator, but I generally use Nintendulator and also have Nestopia and Jnes. Any help would be appreciated. Again, I'm new at this, so sorry if these are basic questions.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Thu Jan 08, 2009 11:37 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />How long code takes to execute is measured in "cycles". For example, "LDA #2" takes 2 cycles to execute. "LDA ($23),y" takes 5 cycles to execute. A scanline (a horizontal row of pixels on the screen) is rendered in the time it takes for the NES to execute 113.333 cycles worth of instructions. Vblank, a period of time in which no rendering takes place, lasts for 2200 cycles. It turns out with some technical stuff that a whole frame is drawn in ~30,000 cycles. For this reason, code has to be optimized so it doesn't take a really long time to execute. For cycle counts on each instruction, refer to:
<br />
<br /><!-- m --><a class="postlink" href="http://www.obelisk.demon.co.uk/6502/reference.html">http://www.obelisk.demon.co.uk/6502/reference.html</a><!-- m -->
<br />
<br />So, with this in mind, it seems that you are in a loop, starting from Vblank, looping 4*32 (128) times. Let's time the loop:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp; &nbsp; &nbsp; <br />loadNames3:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; switch to background 1<br />&nbsp; &nbsp;lda ourMap, x&nbsp; &nbsp; &nbsp;;4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;inx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;6<br />&nbsp; &nbsp;sta $2007&nbsp; &nbsp; &nbsp; ;10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp;cpx #4*32&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;12&nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp;bne loadNames3&nbsp; &nbsp;;15<br /></div>
<br />
<br />Going through the loop once takes 15 cycles. This loop is executed 128 times. 128 * 15 = 1920. That's 1920 cycles there, which means that it should take less time than is in Vblank. What might be happening is that you wait for Vblank, then you jump to the "AKey" routine, then by the time you return to the game loop, it checks for Vblank, and it reads that you're still in Vblank, and it executes the same code twice, thus spilling out of Vblank. Try putting this in the very beggining of your endless loop:
<br />
<br />WaitOutOfVblank:
<br />lda $2002
<br />bmi WaitOutOfVblank
<br />
<br />Then after that comes:
<br />
<br />WaitVblank:
<br />lda $2002
<br />bpl WaitVblank
<br />
<br />This waits until Vblank isn't being executed to check for it again. This may fix your problem.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bbbirddd</b> [ Thu Jan 08, 2009 11:45 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I pasted in both of those parts together just after my "infinite" loop starts, and you're right, it doesn't flicker anymore, but now it takes about 4 seconds before I can change the background by pressing A. Is there a way to make this a lot quicker? Is it possible to load my other nametable into $2400 and then somehow switch to it more quickly?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Thu Jan 08, 2009 11:59 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />4 seconds?? That's not normal... Nothing should take 4 seconds to execute unless you're trying to do something REALLY REALLY complex. 4 seconds is 240 frames. This should be running at a rate where it takes 1 frame to execute (1/60 of a second). Heck, even 3D could be handled on the NES in under 4 seconds (it has been, in a LOT less than 4 seconds).
<br />
<br />There has to be some other problem here. I suggest you place your controller code in the NMI routine instead of the endless loop. And then you can eliminate all "lda $2002, bpl loop" statements.
<br />
<br />Also, if you write to the name table at $2400, all you have to do is set bit 0 of $2000.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bbbirddd</b> [ Fri Jan 09, 2009 12:22 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks for the help. I think it's getting too late for me to think about this (i'm in NH). I tried to do what you said but I don't think I get it. I'll take another look in the morning. Here's my code in case you'd like to take a look:
<br />
<br />
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp;.inesprg 1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////INES Header/////<br />&nbsp; &nbsp;.ineschr 1<br />&nbsp; &nbsp;.inesmap 0<br />&nbsp; &nbsp;.inesmir 1<br />&nbsp; &nbsp;<br />; ////////////////////////Bank 1: PRG ROM - Interrupt Table/////////////////////////////<br /><br /><br />&nbsp; &nbsp;.bank 1<br />&nbsp; &nbsp;.org $FFFA<br />&nbsp; &nbsp;.dw VBlank_Routine&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; address to execute on VBlank<br />&nbsp; &nbsp;.dw Start<br />&nbsp; &nbsp;.dw 0<br /><br />; ////////////////////////Bank 0: PRG ROM - Program Code////////////////////////////////<br /><br />&nbsp; &nbsp;.bank 0<br />&nbsp; &nbsp;.org $0000&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Variables/////<br />&nbsp; &nbsp;<br />VBlankOrNo:&nbsp; &nbsp;.db 0<br />BKGset:&nbsp; &nbsp;&nbsp; &nbsp;.db 0<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Sprite DMA/////<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;.org $0300 &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; OAM copy location<br /><br />Sprite1_Y:&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; &nbsp;0&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; sprite #1's Y value<br />Sprite1_T:&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; &nbsp;0 &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; sprite #1's tile number<br />Sprite1_S:&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; sprite #1's special byte<br />Sprite1_X:&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; &nbsp;0&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; sprite #1's X value<br />UnusedSprites: &nbsp; &nbsp;.db 0<br /><br />&nbsp; &nbsp;.org $8000&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; program code location<br />&nbsp; &nbsp;<br />Start:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Screen Setup/////<br /><br />&nbsp; &nbsp;sei &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; just some stuff that's standard to do at reset<br />&nbsp; &nbsp;cld<br />&nbsp; &nbsp;ldx #$FF<br />&nbsp; &nbsp;txs <br /><br />&nbsp; &nbsp;lda #00&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; set every variable to zero<br />&nbsp; &nbsp;sta Sprite1_Y<br />&nbsp; &nbsp;sta Sprite1_T<br />&nbsp; &nbsp;sta Sprite1_S<br />&nbsp; &nbsp;sta Sprite1_X<br />&nbsp; &nbsp;sta VBlankOrNo<br />&nbsp; &nbsp;sta BKGset<br />&nbsp; &nbsp;sta UnusedSprites<br /><br />&nbsp; &nbsp;lda #$FF&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; clear OAM with $FFs &#40;except for Sprite1_* variables&#41;<br />&nbsp; &nbsp;ldx #0<br />ClearSprites:<br />&nbsp; &nbsp;sta UnusedSprites, x<br />&nbsp; &nbsp;inx<br />&nbsp; &nbsp;cpx #252<br />&nbsp; &nbsp;bne ClearSprites<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #0<br />&nbsp; &nbsp;sta $2000<br />&nbsp; &nbsp;sta $2001&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; turn the PPU off<br />&nbsp; &nbsp;<br />wait1:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; wait &#40;why?&#41;<br />&nbsp; &nbsp;lda $2002<br />&nbsp; &nbsp;bpl wait1<br /><br />wait2:<br />&nbsp; &nbsp;lda $2002<br />&nbsp; &nbsp;bpl wait2<br /><br />&nbsp; &nbsp;lda #50&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; set initial sprite position to 50,50<br />&nbsp; &nbsp;sta Sprite1_Y<br />&nbsp; &nbsp;sta Sprite1_X<br />&nbsp; &nbsp;lda #0<br />&nbsp; &nbsp;sta Sprite1_S&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; set initial sprite color<br />&nbsp; &nbsp;lda #1<br />&nbsp; &nbsp;sta Sprite1_T<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////32-Color Palette/////<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #$3F&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; $2006 = PPU memory address<br />&nbsp; &nbsp;sta $2006&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; $3F00-$3F10 = image palette location &#40;the first half of the 32 colors&#41;<br />&nbsp; &nbsp;lda #$00&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; $3F10-$3F20 = sprite palette location &#40;the second half of the 32 colors&#41;<br />&nbsp; &nbsp;sta $2006<br /><br />&nbsp; &nbsp;ldx #$00<br />loadpal:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; load 32-color pallete<br />&nbsp; &nbsp;lda tilepal, x<br />&nbsp; &nbsp;sta $2007&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; $2007 = PPU memory data<br />&nbsp; &nbsp;inx<br />&nbsp; &nbsp;cpx #32<br />&nbsp; &nbsp;bne loadpal<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Background/////<br /><br />&nbsp; &nbsp;lda #$20<br />&nbsp; &nbsp;sta $2006 &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; $2020-$23C0 = name table 0 &#40;32x25 tiles&#41;<br />&nbsp; &nbsp;sta $2006 <br /><br />&nbsp; &nbsp;ldx #$00<br />loadNames:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; load background name table &#40;bkg12.map&#41;<br />&nbsp; &nbsp;lda ourMap, x<br />&nbsp; &nbsp;inx<br />&nbsp; &nbsp;sta $2007&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; $2007 = PPU memory data<br />&nbsp; &nbsp;cpx #4*32<br />&nbsp; &nbsp;bne loadNames<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Screen Setup/////<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #%10001000&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; screen pattern table = $0000, sprite pattern table = $1000, name table = $2000<br />&nbsp; &nbsp;sta $2000<br />&nbsp; &nbsp;lda #%00011110&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; BG = black, show sprites, screen on, don't clip anything, color display<br />&nbsp; &nbsp;sta $2001&nbsp; &nbsp;<br />&nbsp; &nbsp;<br />; ------------------------Controller Loop Begin-------------------------------<br /><br />infinite:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br /><br />;WaitOutOfVblank:<br />;&nbsp; &nbsp;lda $2002<br />;&nbsp; &nbsp;bmi WaitOutOfVblank <br />&nbsp; &nbsp;<br />;WaitVblank:<br />;&nbsp; &nbsp;lda $2002<br />;&nbsp; &nbsp;bpl WaitVblank <br /><br />WaitForVBlank:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////VBlank/////&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;lda VBlankOrNo<br />&nbsp; &nbsp;cmp #1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; check if A = 1 &#40;VBlank&#41;<br />&nbsp; &nbsp;bne WaitForVBlank&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; if A = 0 loop<br />&nbsp; &nbsp;dec VBlankOrNo&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; decrease VBlankOrNo by 1 &#40;A = 0&#41;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #3&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Sprite Info Load/////<br />&nbsp; &nbsp;sta $4014&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; $4014 = sprite DMA register &#40;transfers <br />&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Controller Setup/////<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #$01&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; reset pad #1<br />&nbsp; &nbsp;sta $4016&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; $4016 = joypad #1 &#40;1 = reset, 0 = clear&#41;<br />&nbsp; &nbsp;lda #$00<br />&nbsp; &nbsp;sta $4016<br /><br /><br />VBlank_Routine:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////VBlank Routine/////<br />&nbsp; &nbsp;inc VBlankOrNo&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; at VBlank add 1 to VBlankOrNo &#40;1 if VBlank, 0 if not&#41;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Test Button Status/////<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; read A status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; if the low-order bit is equal to 1, the button is pressed<br />&nbsp; &nbsp;bne AKEYdown&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; branch to AKEYdown if <br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; read B status<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; read SELECT status<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; read START status<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; read UP status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; check if UP is pressed<br />&nbsp; &nbsp;bne UPKEYdown&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; branch to UPKEYdown if pressed<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; read DOWN status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; check if DOWN is pressed<br />&nbsp; &nbsp;bne DOWNKEYdown&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; branch to DOWNKEYdown if pressed<br /><br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; read LEFT status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; check if LEFT is pressed<br />&nbsp; &nbsp;bne LEFTKEYdown&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; branch to LEFTKEYdown if pressed<br /><br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; read RIGHT status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; check if RIGHT is pressed<br />&nbsp; &nbsp;bne RIGHTKEYdown&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; branch to RIGHTKEYdown if pressed<br />&nbsp; &nbsp;jmp NOTHINGdown<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Button Press Actions/////<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />AKEYdown:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; code executed when A is pressed<br /><br />&nbsp; &nbsp;lda #$00&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; turn the screen off<br />&nbsp; &nbsp;sta $2001 <br /><br />&nbsp; &nbsp;lda #$20&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; reset to beginning of name table<br />&nbsp; &nbsp;sta $2006<br />&nbsp; &nbsp;sta $2006<br /><br />&nbsp; &nbsp;lda BKGset&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; check which background is loaded<br />&nbsp; &nbsp;cmp #0<br />&nbsp; &nbsp;bne BG1<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;ldx #$00<br />loadNames2:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; switch to background 2 &#40;1 is loaded originally&#41;<br />&nbsp; &nbsp;lda ourMap2, x<br />&nbsp; &nbsp;inx<br />&nbsp; &nbsp;sta $2007<br />&nbsp; &nbsp;cpx #4*32<br />&nbsp; &nbsp;bne loadNames2<br />&nbsp; &nbsp;lda #1<br />&nbsp; &nbsp;sta BKGset<br /><br />&nbsp; &nbsp;lda #%00011110&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; turn the screen back on<br />&nbsp; &nbsp;sta $2001&nbsp; &nbsp;&nbsp; &nbsp;<br /><br />&nbsp; &nbsp;jmp NOTHINGdown<br />&nbsp; &nbsp;<br />BG1:<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;ldx #$00&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />loadNames3:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; switch to background 1<br />&nbsp; &nbsp;lda ourMap, x &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;inx&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;sta $2007&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;cpx #4*32 &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;bne loadNames3 &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #0<br />&nbsp; &nbsp;sta BKGset<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #%00011110&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; turn the screen back on<br />&nbsp; &nbsp;sta $2001&nbsp; &nbsp;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;jmp NOTHINGdown&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br /><br />UPKEYdown:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; code executed when UP is pressed<br />&nbsp; &nbsp;lda Sprite1_Y<br />&nbsp; &nbsp;clc<br />&nbsp; &nbsp;sbc #1&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; subtract 1 from Sprite1_Y<br />&nbsp; &nbsp;sta Sprite1_Y<br />&nbsp; &nbsp;jmp NOTHINGdown<br /><br />DOWNKEYdown:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; code executed when DOWN is pressed<br />&nbsp; &nbsp;lda Sprite1_Y <br />&nbsp; &nbsp;clc<br />&nbsp; &nbsp;adc #1&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; add 1 to Sprite1_Y<br />&nbsp; &nbsp;sta Sprite1_Y<br />&nbsp; &nbsp;jmp NOTHINGdown<br /><br />LEFTKEYdown:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; code executed when LEFT is pressed<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;lda Sprite1_S<br />&nbsp; &nbsp;and #%10111111<br />&nbsp; &nbsp;sta Sprite1_S<br />&nbsp; &nbsp;lda Sprite1_X<br />&nbsp; &nbsp;clc<br />&nbsp; &nbsp;sbc #1&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; subtract 1 from Sprite1_X<br />&nbsp; &nbsp;sta Sprite1_X<br />&nbsp; &nbsp;jmp NOTHINGdown<br /><br />RIGHTKEYdown:&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; code executed when RIGHT is pressed<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda Sprite1_S<br />&nbsp; &nbsp;ora #%01000000<br />&nbsp; &nbsp;sta Sprite1_S<br />&nbsp; &nbsp;lda Sprite1_X<br />&nbsp; &nbsp;clc<br />&nbsp; &nbsp;adc #1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; add 1 to Sprite1_X<br />&nbsp; &nbsp;sta Sprite1_X<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; return from interrupt<br />NOTHINGdown:<br />&nbsp; &nbsp;rti<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;jmp infinite<br />; ------------------------Controller Loop End---------------------------------<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; /////Include Binary Files/////<br /><br />tilepal: .incbin &quot;our.pal&quot;&nbsp; &nbsp;&nbsp; &nbsp;; include pallete and label its location &quot;tilepal&quot;<br />ourMap2:.db&nbsp; 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2<br />&nbsp; &nbsp;&nbsp; &nbsp;.db 17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18 <br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />ourMap:&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2<br />&nbsp; &nbsp;&nbsp; &nbsp;.db 17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18,17,18 <br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;.db&nbsp; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />; .incbin &quot;map20.map&quot; &nbsp; &nbsp;; include map files and label its location &quot;ourMap&quot;<br />; ourMap2: .incbin &quot;bkg21.map&quot;<br /><br />; ////////////////////////Bank 2: CHR ROM - Sprite/Background Data//////////////////////<br /><br />&nbsp; &nbsp;.bank 2&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;.org $0000<br />&nbsp; &nbsp;.incbin &quot;bkg1.bkg&quot;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;.org $1000<br />&nbsp; &nbsp;.incbin &quot;our.spr&quot;<br />&nbsp; &nbsp;<br /></div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Celius</b> [ Fri Jan 09, 2009 12:34 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The following revision should work:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">------------------------Controller Loop Begin-------------------------------<br /><br />infinite:<br />&nbsp; &nbsp;jmp infinite<br /><br />VBlank_Routine:<br />&nbsp; &nbsp;lda #3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; /////Sprite Info Load/////<br />&nbsp; &nbsp;sta $4014&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; $4014 = sprite DMA register &#40;transfers<br />&nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; /////Controller Setup/////<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #$01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; reset pad #1<br />&nbsp; &nbsp;sta $4016&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; $4016 = joypad #1 &#40;1 = reset, 0 = clear&#41;<br />&nbsp; &nbsp;lda #$00<br />&nbsp; &nbsp;sta $4016<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; /////Test Button Status/////<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; read A status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; if the low-order bit is equal to 1, the button is pressed<br />&nbsp; &nbsp;bne AKEYdown&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; branch to AKEYdown if<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; read B status<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; read SELECT status<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; read START status<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; read UP status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; check if UP is pressed<br />&nbsp; &nbsp;bne UPKEYdown&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; branch to UPKEYdown if pressed<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; read DOWN status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; check if DOWN is pressed<br />&nbsp; &nbsp;bne DOWNKEYdown&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; branch to DOWNKEYdown if pressed<br /><br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; read LEFT status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; check if LEFT is pressed<br />&nbsp; &nbsp;bne LEFTKEYdown&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; branch to LEFTKEYdown if pressed<br /><br />&nbsp; &nbsp;lda $4016&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; read RIGHT status<br />&nbsp; &nbsp;and #1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; check if RIGHT is pressed<br />&nbsp; &nbsp;bne RIGHTKEYdown&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; branch to RIGHTKEYdown if pressed<br />&nbsp; &nbsp;jmp NOTHINGdown<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; /////Button Press Actions/////<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />AKEYdown:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; code executed when A is pressed<br /><br />&nbsp; &nbsp;lda #$00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; turn the screen off<br />&nbsp; &nbsp;sta $2001<br /><br />&nbsp; &nbsp;lda #$20&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; reset to beginning of name table<br />&nbsp; &nbsp;sta $2006<br />&nbsp; &nbsp;sta $2006<br /><br />&nbsp; &nbsp;lda BKGset&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; check which background is loaded<br />&nbsp; &nbsp;cmp #0<br />&nbsp; &nbsp;bne BG1<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;ldx #$00<br />loadNames2:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; switch to background 2 &#40;1 is loaded originally&#41;<br />&nbsp; &nbsp;lda ourMap2, x<br />&nbsp; &nbsp;inx<br />&nbsp; &nbsp;sta $2007<br />&nbsp; &nbsp;cpx #4*32<br />&nbsp; &nbsp;bne loadNames2<br />&nbsp; &nbsp;lda #1<br />&nbsp; &nbsp;sta BKGset<br /><br />&nbsp; &nbsp;lda #%00011110&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; turn the screen back on<br />&nbsp; &nbsp;sta $2001&nbsp; &nbsp; &nbsp; <br /><br />&nbsp; &nbsp;jmp NOTHINGdown<br />&nbsp; &nbsp;<br />BG1:<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;ldx #$00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />loadNames3:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; switch to background 1<br />&nbsp; &nbsp;lda ourMap, x&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp;inx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp;sta $2007&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp;cpx #4*32&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;bne loadNames3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp;lda #0<br />&nbsp; &nbsp;sta BKGset<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda #%00011110&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; turn the screen back on<br />&nbsp; &nbsp;sta $2001&nbsp; &nbsp;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;jmp NOTHINGdown&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br /><br />UPKEYdown:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; code executed when UP is pressed<br />&nbsp; &nbsp;lda Sprite1_Y<br />&nbsp; &nbsp;sec<br />&nbsp; &nbsp;sbc #1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; subtract 1 from Sprite1_Y<br />&nbsp; &nbsp;sta Sprite1_Y<br />&nbsp; &nbsp;jmp NOTHINGdown<br /><br />DOWNKEYdown:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; code executed when DOWN is pressed<br />&nbsp; &nbsp;lda Sprite1_Y<br />&nbsp; &nbsp;clc<br />&nbsp; &nbsp;adc #1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; add 1 to Sprite1_Y<br />&nbsp; &nbsp;sta Sprite1_Y<br />&nbsp; &nbsp;jmp NOTHINGdown<br /><br />LEFTKEYdown:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; code executed when LEFT is pressed<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;lda Sprite1_S<br />&nbsp; &nbsp;and #%10111111<br />&nbsp; &nbsp;sta Sprite1_S<br />&nbsp; &nbsp;lda Sprite1_X<br />&nbsp; &nbsp;sec<br />&nbsp; &nbsp;sbc #1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; subtract 1 from Sprite1_X<br />&nbsp; &nbsp;sta Sprite1_X<br />&nbsp; &nbsp;jmp NOTHINGdown<br /><br />RIGHTKEYdown:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; code executed when RIGHT is pressed<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;lda Sprite1_S<br />&nbsp; &nbsp;ora #%01000000<br />&nbsp; &nbsp;sta Sprite1_S<br />&nbsp; &nbsp;lda Sprite1_X<br />&nbsp; &nbsp;clc<br />&nbsp; &nbsp;adc #1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; add 1 to Sprite1_X<br />&nbsp; &nbsp;sta Sprite1_X<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; return from interrupt<br />NOTHINGdown:<br />&nbsp; &nbsp;rti<br />; ------------------------Controller Loop End--------------------------------- <br /></div>
<br />
<br />Replace the code between the "Controller Loop Begin" and "Controller Loop End" breaks with the code above. I fixed some things so that you aren't doing anything in the endless loop, because you don't need to be doing anything in it. It's all done in the NMI.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>