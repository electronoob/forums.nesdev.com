<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - SPC7110 Reverse Engineering Project</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - SNESdev" href="http://forums.nesdev.com/feed.php?f=12" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - SPC7110 Reverse Engineering Project" href="http://forums.nesdev.com/feed.php?f=12&amp;t=4106" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '8');
	var per_page = '15';
	var base_url = './viewtopic.php?f=12&amp;t=4106';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<!--<div style="float: right;">
					<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick">
					<input type="hidden" name="hosted_button_id" value="X2HM4WNR5YT8S">
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
					<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
					</form>
				</div>-->
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=minion"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Fri Jan 18, 2019 3:23 pm<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=25">Other</a> &#187; <a href="./viewforum.php?f=23">Other Retro Dev</a> &#187; <a href="./viewforum.php?f=12">SNESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />
	

					<center>
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- NesDev Forums -->
					<ins class="adsbygoogle"
						 style="display:block"
						 data-ad-client="ca-pub-7801010229099644"
						 data-ad-slot="7979066809"
						 data-ad-format="auto"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>
					</center>
	<br />

	<div class="forumrules">
		
			<h3>Forum rules</h3><br />
			<ul><li>For making cartridges of your Super NES games, see <a href="http://forums.nesdev.com/viewforum.php?f=28" class="postlink">Reproduction</a>.</li></ul>
		
	</div>

	<br clear="all" />


<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=12&amp;t=4106&amp;start=105">SPC7110 Reverse Engineering Project</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=12"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=12&amp;t=4106"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>8</strong> of <strong>21</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 315 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=12&amp;t=4106&amp;start=90">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=12&amp;t=4106">1</a><span class="page-dots"> ... </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=60">5</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=75">6</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=90">7</a><span class="page-sep">, </span><strong>8</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=120">9</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=135">10</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=150">11</a><span class="page-dots"> ... </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=300">21</a> &nbsp;<a href="./viewtopic.php?f=12&amp;t=4106&amp;start=120">Next</a></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=12&amp;t=4106&amp;start=105&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=12&amp;t=4106&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=12&amp;t=4106&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p34251"></a>
				<b class="postauthor">neviksti</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34251"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34251#p34251"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jun 15, 2008 1:30 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Jun 22, 2006 11:39 pm<br /><b>Posts:</b> 205
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Charles MacDonald wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">I am not understanding what you are suggesting here, for isn't the whole point of that extra data bus and control structure that the SPC7110 can be accessing it completely separately of what the SNES is doing? I don't think the decompresions would work anymore if the SPC7110 lost that control.<br /></div><br /><br />Originally Kammedo and I had discussed removing the U2 ROM and replacing it with RAM, so that the SNES could populate the RAM chip with test data to be decompressed. Having the SNES be able to write to the U2 bus is important as it means the RAM could be written to. Otherwise whatever memory device would be read only, and a different course of action (such as connecting an EPROM emulator in place of the mask ROM) would be necessary.</div><br />What I was suggesting is that letting the SNES control the /RD /WR on the RAM you put in for the U2, may let you put custom data in there, but would no longer allow the SPC7110 to function as it needs to control access to U2 seperate of what the SNES is doing in order for decompressions to work.<br /><br /><div class="quotetitle">Charles MacDonald wrote:</div><div class="quotecontent">I am not familiar with the other efforts that have been made on the SPC7110, but the only thing I was interested in was finding a way to provide user-specified data for the SPC7110 to decompress.</div><br />But if you let the SNES control the /RD /WR on the RAM you put in for the U2, it may let you put custom data in there, but would no longer allow the SPC7110 to function as it needs to control access to U2 seperate of what the SNES is doing in order for decompressions to work.<br /><br /><div class="quotetitle">Charles MacDonald wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The simplest mod we came up with so far, which should let us do decompressions of custom data, was the one chip FIFO mod that was listed previously in this thread <br /></div><br /><br />Great idea, how far along has this gotten?</div><br />Kammedo was going to work on some hardware mod, but his system seems to not be working at the moment so that would be moot.  Hopefully he can get everything fixed.  In the mean time I'm working to get as much information as we can out of an unmodified cartridge.<br /><br /><div class="quotetitle">Charles MacDonald wrote:</div><div class="quotecontent">If we are using SRAM /CE to trigger the write, do we know for a fact that the data bus is valid at the negative edge of /CE as that's when the data is latched by the FIFO? Or do we need to wait until /CE *and* /WR are asserted?<br /><br />A pulse on FIFO /R gets the next byte out. Have we verified that when reading data for decompression specifically that the SPC7110 doesn't leave /OE asserted and just change the address? I'm not suggesting it does, but I like weeding out the edge cases beforehand.</div><br />You are correct, I made some assumptions which I hope hold to keep things simple.<br /><br />The data is latched at /WR (the SRAM /CE) going from GND -&gt; Vcc ( <!-- m --><a class="postlink" href="http://download.cypress.com.edgesuite.net/design_resources/datasheets/contents/cy7c433_8.pdf">http://download.cypress.com.edgesuite.n ... c433_8.pdf</a><!-- m --> ).  Based on the 65c816 datasheet ( <br /><!-- m --><a class="postlink" href="http://www.65xx.com/wdc/documentation/w65c816s.pdf">http://www.65xx.com/wdc/documentation/w65c816s.pdf</a><!-- m --> ), the data should be fine for awhile after /WR -&gt; Vcc.  Yes there's an issue if the SRAM /CE is asserted too long.  I believe it will be okay though.  I don't know of an easy way to check this.  I don't have access to any good equipment at the moment, so if anyone could check SRAM /CE vs. SNES /WR timing on an oscilloscope that would be mighty helpful.  (Also if one could check SRAM /CE vs a data line that is high while writing and low during 'bank load' to directly check data valid times, that would be really great.)<br /><br />The second one I also assumed, but sounds easier to check.<br />Could you check that for us? (I'm sorry to ask for so much help, I understand you are busy.)<br /><br /><div class="quotetitle">Charles MacDonald wrote:</div><div class="quotecontent">I would like to help with this, but I have very little free time these days. I will do what I can though plan on nothing happening. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>
<br />You've already helped, and whatever other help you can provide would be greatly appreciated ... but of course we all understand real life demands come first.
<br />
<br />Thanks again for all the info.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=716"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p34253"></a>
				<b class="postauthor">neviksti</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34253"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34253#p34253"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jun 15, 2008 1:35 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Jun 22, 2006 11:39 pm<br /><b>Posts:</b> 205
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">neviksti wrote:</div><div class="quotecontent">In the mean time I will be setting asside questions of the memory map details for a bit (since we got decompressions working anyway), and trying to figure out what the 4th byte in the table entry does by decompressing every table entry of the form $xx $00 $00 $00 I can find in the U2 ROM.  It is likely I can get all 256 combinations, or at least most of them.<br /><br />Then I'll record decompressions of every possible first compressed byte, and valid "indicator byte in the table entry" value.  This should be a good start of play data and won't require changing any hardware.</div>
<br />
<br />Alright, the first of those tests is complete!
<br />Results:
<br />
<br />The SPC7110 only considers the lowest two bits of the 'indicator' byte.  Of these decompression modes, 0,1,2 are valid, but 3 is not and the "decompreesion read" bit 7 of 480C is never asserted.  If you read $4800 anyway, you will just get all zeros.
<br />
<br />
<br />I'll start work on the second test now.  With luck I'll post some results by tonight.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=716"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p34257"></a>
				<b class="postauthor">neviksti</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34257"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34257#p34257"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jun 15, 2008 9:19 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Jun 22, 2006 11:39 pm<br /><b>Posts:</b> 205
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">The results of two more tests:
<br />
<br />I checked to see how the decompressor considered the banks mirrored.  I used table entries of the form: compression type 0, $xx, $00, $00.
<br />
<br />xx = $00-$3F worked fine as it is normal rom
<br />xx = $40-$7F just decomrpessed as all zeros
<br />xx = $80-$BF same as the $00-$3F results
<br />xx = $C0-$FF same as the $40-$7F results
<br />
<br />Keep this in mind when scouring for locations you'd like me to dump for tests.
<br />
<br />
<br />I also completed a run which gave me examples of the output for every possible first byte in the compressed data, using decompression type 0.
<br />
<br />Here's a summary:
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_0.txt">http://neviksti.com/SPC7110/firstbyte_0.txt</a><!-- m -->
<br />
<br />Here's the raw data files:
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_0.loc">http://neviksti.com/SPC7110/firstbyte_0.loc</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_0.dumped">http://neviksti.com/SPC7110/firstbyte_0.dumped</a><!-- m -->
<br />
<br />.loc contains the locations I used as the table entry for the decompression. (it is just a list of integers, 4 bytes each, LSB first... so you can read it in easily for your own analysis)
<br />
<br />.dumped is the 32kB SRAM where I stored results.
<br />The 256 entries are evenly spaced in the SRAM  (so they start every $80 bytes). Only 64 bytes of the decompressed output was stored.  The unused bytes are set to $FF (I found this made it easier to read in a hex editor).  
<br />
<br />If you send me a .loc file, I can run tests for you.
<br />
<br />
<br />The data is a bit unexpected to me.  For some reason (probably due to the SDD1) I was expecting to be able to map the first bit directly... not so.  While there appears to be a general order (so maybe this is arithmetic compression?), you can get the first output bit as a zero with the first input bit zero or one (but you can only get the first output bit set, if the first input bit is set).
<br />
<br />EDIT:
<br />Here's the results of the other decompression types.
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_1.loc">http://neviksti.com/SPC7110/firstbyte_1.loc</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_1.dumped">http://neviksti.com/SPC7110/firstbyte_1.dumped</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_1.txt">http://neviksti.com/SPC7110/firstbyte_1.txt</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_2.loc">http://neviksti.com/SPC7110/firstbyte_2.loc</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_2.dumped">http://neviksti.com/SPC7110/firstbyte_2.dumped</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_2.txt">http://neviksti.com/SPC7110/firstbyte_2.txt</a><!-- m --></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=716"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p34258"></a>
				<b class="postauthor">kammedo</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34258"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34258#p34258"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jun 15, 2008 9:47 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed May 28, 2008 5:43 am<br /><b>Posts:</b> 57
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">neviksti wrote:</div><div class="quotecontent">The results of two more tests:<br /><br />I checked to see how the decompressor considered the banks mirrored.  I used table entries of the form: compression type 0, $xx, $00, $00.<br /><br />xx = $00-$3F worked fine as it is normal rom<br />xx = $40-$7F just decomrpessed as all zeros<br />xx = $80-$BF same as the $00-$3F results<br />xx = $C0-$FF same as the $40-$7F results<br /><br />Keep this in mind when scouring for locations you'd like me to dump for tests.<br /><br /><br />I also completed a run which gave me examples of the output for every possible first byte in the compressed data, using decompression type 0.<br /><br />Here's a summary:<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_0.txt">http://neviksti.com/SPC7110/firstbyte_0.txt</a><!-- m --><br /><br />Here's the raw data files:<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_0.loc">http://neviksti.com/SPC7110/firstbyte_0.loc</a><!-- m --><br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_0.dumped">http://neviksti.com/SPC7110/firstbyte_0.dumped</a><!-- m --><br /><br />.loc contains the locations I used as the table entry for the decompression. (it is just a list of integers, 4 bytes each, LSB first... so you can read it in easily for your own analysis)<br /><br />.dumped is the 32kB SRAM where I stored results.<br />The 256 entries are evenly spaced in the SRAM  (so they start every $80 bytes). Only 64 bytes of the decompressed output was stored.  The unused bytes are set to $FF (I found this made it easier to read in a hex editor).  <br /><br />If you send me a .loc file, I can run tests for you.<br /><br /><br />The data is a bit unexpected to me.  For some reason (probably due to the SDD1) I was expecting to be able to map the first bit directly... not so.  While there appears to be a general order (so maybe this is arithmetic compression?), you can get the first output bit as a zero with the first input bit zero or one (but you can only get the first output bit set, if the first input bit is set).<br /><br />EDIT:<br />Here's the results of the other decompression types.<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_1.loc">http://neviksti.com/SPC7110/firstbyte_1.loc</a><!-- m --><br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_1.dumped">http://neviksti.com/SPC7110/firstbyte_1.dumped</a><!-- m --><br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_1.txt">http://neviksti.com/SPC7110/firstbyte_1.txt</a><!-- m --><br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_2.loc">http://neviksti.com/SPC7110/firstbyte_2.loc</a><!-- m --><br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_2.dumped">http://neviksti.com/SPC7110/firstbyte_2.dumped</a><!-- m --><br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/firstbyte_2.txt">http://neviksti.com/SPC7110/firstbyte_2.txt</a><!-- m --></div>
<br />
<br />Did you run the test with a re-initialization of the Chip for every single decompression? That is, does the test app setup table offset, pointer number etc every single time you decompress or do you simple set up the table offset and switch the pointer number? I think that this could be important. Also, could you try decompressing twice the same location in sequence? As, in, for example :
<br />
<br /><!-- m --><a class="postlink" href="http://www.yntproject.net/trash/firstbyte_0.loc">http://www.yntproject.net/trash/firstbyte_0.loc</a><!-- m -->
<br />
<br />Also, I would imagine that that the decompressed data is probably longer than the 4 bytes that are inputted as compressed data.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3536"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p34259"></a>
				<b class="postauthor">neviksti</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34259"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34259#p34259"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jun 15, 2008 10:20 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Jun 22, 2006 11:39 pm<br /><b>Posts:</b> 205
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">kammedo wrote:</div><div class="quotecontent">Did you run the test with a re-initialization of the Chip for every single decompression? That is, does the test app setup table offset, pointer number etc every single time you decompress or do you simple set up the table offset and switch the pointer number? I think that this could be important.</div><br />Here is my dumping code:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; &nbsp;ldx $00<br />&nbsp; &nbsp;stz $480B<br />&nbsp; &nbsp;lda.w loc_data,X&nbsp; &nbsp;&nbsp; &nbsp;;table address<br />&nbsp; &nbsp;sta $4801<br />&nbsp; &nbsp;lda.w loc_data+1,X<br />&nbsp; &nbsp;sta $4802<br />&nbsp; &nbsp;lda.w loc_data+2,X<br />&nbsp; &nbsp;sta $4803<br />&nbsp; &nbsp;lda #$00&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;;index<br />&nbsp; &nbsp;sta $4804<br /><br />&nbsp; &nbsp;stz $4805<br />&nbsp; &nbsp;stz $4806<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;stz Joy1Press<br />-&nbsp; &nbsp;lda Joy1Press&nbsp; &nbsp;;allow pressing A to escape loop<br />&nbsp; &nbsp;bmi +<br />&nbsp; &nbsp;lda $480C<br />&nbsp; &nbsp;bpl -&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;;When Bit 7 of 00:480C is set, Decompression is done, and<br />+&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;;data is ready to be read.<br /><br />&nbsp; &nbsp;stz $4809<br />&nbsp; &nbsp;stz $480A<br /><br />&nbsp; &nbsp;ldx #ENTRY_SIZE<br />&nbsp; &nbsp;ldy #$0000<br />-<br />&nbsp; &nbsp;lda $4800<br />&nbsp; &nbsp;sta &#91;$02&#93;,Y<br />&nbsp; &nbsp;iny<br />&nbsp; &nbsp;dex<br />&nbsp; &nbsp;bne -<br /></div><br /><br /><div class="quotetitle">kammedo wrote:</div><div class="quotecontent">Also, could you try decompressing twice the same location in sequence? As, in, for example :<br /><br /><!-- m --><a class="postlink" href="http://www.yntproject.net/trash/firstbyte_0.loc">http://www.yntproject.net/trash/firstbyte_0.loc</a><!-- m --></div><br />I didn't rerun every file, but yes I've checked that it is repeatable.<br />The program starts by running tests to make sure the connection to the cartridge, and decompression is working correctly.  The tests pass everytime so the connections are good now.<br /><br />I'll run your file in a bit.<br /><br /><div class="quotetitle">kammedo wrote:</div><div class="quotecontent">Also, I would imagine that that the decompressed data is probably longer than the 4 bytes that are inputted as compressed data.</div>
<br />I am not inputting data to be decompressed.  I have not modified the cartridge.  As mentioned above, the .txt files are merely summaries.  The raw data (and format of them) has been given so you can manipulate and test the data (including seeing more of the compressed data bytes if you have the rom file) as much as you desire.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=716"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p34261"></a>
				<b class="postauthor">neviksti</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34261"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34261#p34261"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jun 15, 2008 11:17 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Jun 22, 2006 11:39 pm<br /><b>Posts:</b> 205
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Kammedo,
<br />here are the results for your file
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/kammedo_firstbyte_0.loc">http://neviksti.com/SPC7110/kammedo_firstbyte_0.loc</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/kammedo_firstbyte_0.dumped">http://neviksti.com/SPC7110/kammedo_firstbyte_0.dumped</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/kammedo_firstbyte_0.txt">http://neviksti.com/SPC7110/kammedo_firstbyte_0.txt</a><!-- m --></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=716"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p34262"></a>
				<b class="postauthor">kammedo</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34262"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34262#p34262"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Jun 15, 2008 11:38 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed May 28, 2008 5:43 am<br /><b>Posts:</b> 57
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">neviksti wrote:</div><div class="quotecontent">Kammedo,<br />here are the results for your file<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/kammedo_firstbyte_0.loc">http://neviksti.com/SPC7110/kammedo_firstbyte_0.loc</a><!-- m --><br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/kammedo_firstbyte_0.dumped">http://neviksti.com/SPC7110/kammedo_firstbyte_0.dumped</a><!-- m --><br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/kammedo_firstbyte_0.txt">http://neviksti.com/SPC7110/kammedo_firstbyte_0.txt</a><!-- m --></div>
<br />
<br />Thanks. Now thats what I call efficiency <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" />.
<br />
<br />Intresting to see how the pattern of the first dec byte changes for even numbers. It switches for each value up to value 5, then up to value 7 it remains the same.
<br />
<br />I think what we should do also, albeit getting results, is investiganting the length of the decompressed data that you get when you feed the SPC with one of your pointers. Do you think you could add to your dumping code a report on how much data gets decompressed, as in 
<br />&lt;nr bytes decompressed&gt;&lt;decompressed bytes&gt; for example?
<br />
<br />Also, maybe it would be a good idea to search for more cases in the U2 ROM. I think that can be automated. Neviksti, do you already have something for that? I could write a small application to search for test cases (limited to 4 bytes of course)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3536"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p34277"></a>
				<b class="postauthor">caitsith2</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34277"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34277#p34277"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Jun 16, 2008 11:39 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon May 26, 2008 11:41 pm<br /><b>Posts:</b> 74
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Here is a test file.  This covers all but 433 of the first 2 bytes of compressed data,  of all 3 types.  (433 of them do not have a pointer, and as such, I used 0xFFFFF8 as the pointer, (will point to rom location 0xFDFBF7, decompression type 2, should decompress as all 0, according to your previous tests.)  
<br /><a href="http://caitsith2.net/projects/feoez.loc" class="postlink">http://caitsith2.net/projects/feoez.loc</a></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3535"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p34279"></a>
				<b class="postauthor">neviksti</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34279"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34279#p34279"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jun 17, 2008 3:06 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Jun 22, 2006 11:39 pm<br /><b>Posts:</b> 205
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">kammedo wrote:</div><div class="quotecontent">I think what we should do also, albeit getting results, is investiganting the length of the decompressed data that you get when you feed the SPC with one of your pointers. Do you think you could add to your dumping code a report on how much data gets decompressed, as in <br />&lt;nr bytes decompressed&gt;&lt;decompressed bytes&gt; for example?</div><br />I'm not sure what you mean.  There doesn't appear to be anything in the compressed data that signals "end of decompression".  So it is the program that decides how much decompressed data to read, not the hardware or U2 rom data.  As stated above, for the previous tests I read out $40 decompressed bytes.<br /><br /><div class="quotetitle">kammedo wrote:</div><div class="quotecontent">Also, maybe it would be a good idea to search for more cases in the U2 ROM. I think that can be automated. Neviksti, do you already have something for that? I could write a small application to search for test cases (limited to 4 bytes of course)</div><br />We seem to keep having miscommunication and I'm not sure what is causing it.  Of course there are more cases in the U2 rom.  We can set the table entry to any location in $400000 bytes of data rom.  <br /><br />And yes, I wrote a program (as did Caitsith2 now as well) to search through all these for the particular ones that look interesting to us.  I believe Andreas said it best: we're all capable of writing whatever utilities we need as we go along to analyze this data.  So if there are some particular datasets you'd like, by all means make a searcher for what you specifically want.  However don't worry about creating utilities for us just for the sake of it, instead focus on analyzing the data we have now <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />  <br /><br />For instance, I said above that it appears on first glance that this is arithmetic compression, while I work on collecting Caitsith's new datasets, maybe you could do some tests to find out if this is possible. (I ran some tests on the SDD1 data and found out it wasn't arithmetic compression and was confused and not sure where to go next, but at least I concretely ruled something out for myself ... if it wasn't for Andreas, I probably would have remained stuck at this point.  His input will probably save us from stumbling around too much here as well, but still take a good swing at it yourself... just please be clear in what your ideas are, how you tested it and what assumptions you made, and the raw results, and your interpretation of the results, etc.  so that we can all be on the same page. )<br /><br />-----------------<br /><div class="quotetitle">caitsith2 wrote:</div><div class="quotecontent">Here is a test file.  This covers all but 433 of the first 2 bytes of compressed data,  of all 3 types.  (433 of them do not have a pointer, and as such, I used 0xFFFFF8 as the pointer, (will point to rom location 0xFDFBF7, decompression type 2, should decompress as all 0, according to your previous tests.)  <br /><a href="http://caitsith2.net/projects/feoez.loc" class="postlink">http://caitsith2.net/projects/feoez.loc</a></div>
<br />Thanks for putting that together.  It's nice to see that indeed the vast majority of the two byte combinations can be found.
<br />
<br />I just realized that I didn't make sure my compressed data addresses weren't close to the 'wrapping boundaries' of $400000 and $C00000, which I'm not sure what the decompressor does when it hits.  I'll need to check my files to in a bit to make sure my addresses weren't near these boundaries.  I'm too tired to work on it tonight though, so maybe I'll get to it tomorrow.
<br />
<br />Can you make sure your chosen table entries don't point to compressed data within say $100 bytes or so of those boundaries?
<br />
<br />Also, since I had to use the SF3 instead of the SF7, I have no parallel port access to the system.  Unfortunately this means the system can't be automated, and I have to do it by hand.  So keep that in mind when I ask this next question:  since the interesting part of the compressed data for this set is the first two bytes, how much of the output do we really need?  If I save 8 bytes per decompression (which I admit is small, but I hope will be enough for these starting tests), and since I can only save 32kB per run, that means I need to do 256*256*3*8/32k = 48 manual runs.  Ouch!
<br />
<br />Type 0 looks the cleanest so far.  What if we just focus on that for now?
<br />16 runs is annoying but more reasonable.
<br />
<br />
<br />Also, I looked into it and none of my .loc files have the 0xFFFFF8 address you mention.
<br />Since banks $40-$7F, $C0-FF aren't valid for decompressing, they probably are not valid for reading in the table entry either (I haven't checked for certain).
<br />
<br />I looked and 0x3FFFF8 gives the table entry of: FE FD FB F7
<br />which should be type 2, location $FDFBF7
<br />None of my tests had that address either.  But since it tries to decompress from banks $FD, it should return all zeros.  Strictly speaking I only did the bank test with type 0 (but it most likely applies for all the types).
<br />
<br />
<br />Assuming just starting with type 0, and 8 bytes output is fine, would you mind modifying your program for those three things:
<br />1) make it output 16 files (for example instead of feoez.loc, maybe feoez_0.00.loc, feoez_0.01.loc, ... feoez_0.16.loc), to help keep everything separate
<br />2) make the invalid .loc entries either something blatant like $00000000, or at least point to a valid rom location (like $003FFFF8, which probably gives the output as all zeros... I can verify that first if you want).
<br />3) make sure the compressed data addresses are in the range $000000-$3FFF00, $800000-$BFFF00 so we don't accidentally have the decompressor wrap around the rom end, nor point to invalid regions.
<br />
<br />I'll try to find time tomorrow to run the files.
<br />Sorry for all the requests.  I'm exhausted tonight.  Good night everyone.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=716"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p34283"></a>
				<b class="postauthor">caitsith2</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34283"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34283#p34283"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jun 17, 2008 9:39 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon May 26, 2008 11:41 pm<br /><b>Posts:</b> 74
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Definitely test my 3FFFF8 location, and make sure it does indeed return all 0.  I will modify the program later on.  (It was already searching the 000000-3FFFFF range and 800000-BFFFFF range.)  (Just mask off the upper bit.)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3535"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p34285"></a>
				<b class="postauthor">Andreas Naive</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34285"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34285#p34285"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jun 17, 2008 11:05 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Nov 26, 2007 2:06 am<br /><b>Posts:</b> 104<br /><b>Location:</b> Madrid, Spain
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Type 0 looks the cleanest so far. What if we just focus on that for now? </div>
<br />
<br />I was about to suggest the same thing.
<br />
<br />Yesterday i was going to generate a .loc to test an idea, but i think it could be answered by caitsith2's test, so i will wait... The question i wanted to answer was: supposing the output bits are outputted in a sequential way, how many bits in the input must you look at before deciding you have to output a 0 or a 1. I was about to look at 2 byte cases around the "change of first output bit" limit. Your first test show that that number is at least of 6 input bits, but i expect it to be greater... if the number is clearly below 16 (let's say 12), maybe caitsith2's tests could answer this; if not, we could need to make further tests with some 3 bytes cases.
<br />
<br />At the same time, i'm interested in seeing how exactly the first input bit determine the output range; the rationale around this is this: if we are really facing with an arithmetic compression, as it can not be using infinite precision arithmetic, the number of bits stored in his internal variables maybe could show some kind of "quantization effect" on the output stream; by example, showing up to which output bit that first input bit can affect by studying the data around the "change of first input bit" limit. Again, caitsith2's tests could answer this or not depending on the size of such buffers (supposing that is the case how this works).</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=3445">Andreas Naive</a> on Tue Jun 17, 2008 2:28 pm, edited 1 time in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3445"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p34292"></a>
				<b class="postauthor">kammedo</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34292"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34292#p34292"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jun 17, 2008 2:04 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed May 28, 2008 5:43 am<br /><b>Posts:</b> 57
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I still havent been able to get the FEoEZ cart to work properly.I managed to get a new pc where i will install win98 on it tomorrow, and then I hope to be able to do some more testing, so I have been looking closely at Darkforce's doc and was thinking about making a short resumee just to fix the ideas (principally mines, sorry neviksty if I misleaded you <img src="./images/smilies/icon_mad.gif" alt=":x" title="Mad" /> ).
<br />
<br />
<br />We know from darkforce's doc that reading from $4800 decrements the compressed counter value (following Darkforce's naming convention). So in that sense, you can actually see reading from register $4800 as synchronizing the decompression.
<br />
<br />So we have
<br />a) a compressed table offset register ($4801/2/3)
<br />a1) a table entry selector ($4804)
<br />b) a decompressed offset counter ($4805/06 )
<br />c) a compression length counter ($4807/08 )
<br />d) a data rom (continuous read) port ($4810 )
<br />e) a data rom pointer (for reading offset)
<br />
<br />Clearly b,c,d,e are the "raw data access" counterparts of a,a1,b; but that is less interesting.
<br />
<br />In decompression mode 0, data is decompressed (i assume) 16 bits at a time with each read from $4800. In that sense it would be intresting to see if for every read the SPC fetches new data from the U2 ROM, let's call it "step mode". 
<br />While in mode 2, data is decompressed directly to bank $50, let's call it "block mode". 
<br />
<br />Now, what we know from darkforce's doc is that there is a register that maps a DMA channel. But for what? How did Darkforce come to that conclusion? Does that mean the SPC can program the other registers of that channel? I don't think so. Does the SPC have a DMA? Highly Unlikely.
<br />
<br />A last intresting register : $4808. Could it be it maps $50 as read only / writable, or, even better, it allows writes from the SNES to mirror on the U2 Bus?
<br />
<br />If I am able to get my GDSF7 to play that damn card, I am going to try this.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3536"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p34294"></a>
				<b class="postauthor">caitsith2</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34294"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34294#p34294"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jun 17, 2008 4:19 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon May 26, 2008 11:41 pm<br /><b>Posts:</b> 74
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Although type 0 is what is being focused on now,  here is the complete data sets, as required.  Even with the compressed data not starting later than data offset 0x3FFF00,  there is still exactly 433 datasets missing in total.
<br />
<br /><a href="http://caitsith2.net/projects/feoez-0.zip" class="postlink">http://caitsith2.net/projects/feoez-0.zip</a>
<br /><a href="http://caitsith2.net/projects/feoez-1.zip" class="postlink">http://caitsith2.net/projects/feoez-1.zip</a>
<br /><a href="http://caitsith2.net/projects/feoez-2.zip" class="postlink">http://caitsith2.net/projects/feoez-2.zip</a></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3535"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p34318"></a>
				<b class="postauthor">neviksti</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34318"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34318#p34318"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Jun 18, 2008 7:24 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Jun 22, 2006 11:39 pm<br /><b>Posts:</b> 205
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I didn't bother taking the time to check if my old datasets accidentally used compressed data addresses in $3FFF00-$3FFFFF, as these new datasets will supercede them anyway.
<br />
<br />Here is the type 0, 'all first two bytes' run:
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/feoez-0-results.zip">http://neviksti.com/SPC7110/feoez-0-results.zip</a><!-- m -->
<br />
<br />
<br />And, out of curiousity (and probably more along the lines of what Andreas is looking for as well), here is another dataset:
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/zerosaturation.loc">http://neviksti.com/SPC7110/zerosaturation.loc</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/zerosaturation.zdumped">http://neviksti.com/SPC7110/zerosaturation.zdumped</a><!-- m -->
<br /><!-- m --><a class="postlink" href="http://neviksti.com/SPC7110/zerosaturation.txt">http://neviksti.com/SPC7110/zerosaturation.txt</a><!-- m -->
<br />
<br />Basically, I think it is more likely to find the depth of the register for arithmetic decompression if the decompressor has already 'saturated' in giving the best probability it can to the zero bit.  From previous tests it looks like for type 0 it saturates at roughly one input bit -&gt; 128 output bits.  And thus I would take as a starting guess that the depth is 8-bit.
<br />
<br />Because  many many of the output bytes will be zero in the beginning, this file has a different format (and hence a different extension).  The first 2 bytes are the number of $00 bytes in the beginning of the decompression stream, and then the next $3E bytes are the following decompressed bytes.
<br />
<br />I think I'll take a breather and play with the data for a bit.  If you have other .loc sets, send them my way.  But I think I'm done dumping tonight.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=716"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p34322"></a>
				<b class="postauthor">neviksti</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p34322"></a></div><div style="float: right;"><a href="./viewtopic.php?p=34322#p34322"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Jun 19, 2008 12:29 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Jun 22, 2006 11:39 pm<br /><b>Posts:</b> 205
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Well, it looks like arithmetic compression using 8-bit registers to me.
<br />
<br />I tried to follow the evolution of the probability that a 1-bit would come out as more and more 0-bits come out.
<br />
<br />The cutoff values of the compressed input such that the output bits sequentially become 0-bit look to be:
<br />bit00 ... A6
<br />bit01 ... 4c0
<br />bit02 ... 1F0
<br />bit03 ... 13C
<br />bit04 ... 088
<br />bit05 ... 02E0
<br />bit06 ... 0178
<br />bit07 ... 00C4
<br />
<br />bit08 ... 006A0
<br />bit09 ... 00578
<br />bit0A ... 00450
<br />bit0B ... 00180
<br />bit0C ... 00136
<br />bit0D ... 000EC
<br />bit0E ... 000C7
<br />bit0F ... 000A2
<br />
<br />bit10 ... 0007D0
<br />bit11 ... 0006A8
<br />bit12 ... 000580
<br />bit13 ... 000458
<br />bit14 ... 000330
<br />bit15 ... 0002EC
<br />bit16 ... 000258
<br />bit17 ... 0001C4
<br />
<br />bit18 ... 0001A2
<br />bit19 ... 000158
<br />bit1A ... 00010E
<br />bit1B ... 0000C4
<br />bit1C ... 0000B3
<br />bit1D ... 0000A2
<br />bit1E ... 00007D0
<br />bit1F ... 0000748
<br />
<br />bit20 ... 00006C0
<br />bit21 ... 0000598
<br />bit22 ... 0000470
<br />bit23 ... 00003E8
<br />bit24 ... 00003A4
<br />bit25 ... 0000360
<br />bit26 ... 000031C
<br />bit27 ... 00002D8
<br />
<br />bit28 ... 0000294
<br />bit29 ... 0000200
<br />bit2A ... 000016C
<br />bit2B ... 000015c
<br />bit2C ... 000013A
<br />bit2D ... 0000118
<br />bit2E ... 00000F6
<br />bit2F ... 00000E5
<br />
<br />I've looked past this and it starts to get a bit difficult (not as obviously discrete probability values) given the limited data I can poll from the chip.
<br />
<br />
<br />It is my understanding that a binary arithmetic compression algorithm works something like this:
<br />
<br />(EDIT: This is wrong, see next few posts)
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">initialize:<br />TOP=0<br />BOTTOM=0<br /><br />for each binary bit in uncompressed data:<br />&nbsp; &nbsp; LPB = calculate/lookup least probable bit given previous history of analyzed uncompressed data<br />&nbsp; &nbsp; PROB = calculate/lookup probability of getting a LPB bit given current situation &#40;when using 8-bit regs, PROB can&nbsp; be $01-$80&#41;<br />&nbsp; &nbsp; if bit==LPB<br />&nbsp; &nbsp; &nbsp; &nbsp; BOTTOM = BOTTOM - PROB;<br />&nbsp; &nbsp; &nbsp; &nbsp; while high bit of BOTTOM == 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output a 1 bit<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BOTTOM = BOTTOM &lt;&lt; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TOP = TOP &lt;&lt; 1 <br />&nbsp; &nbsp; &nbsp; &nbsp; end while<br />&nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; TOP = TOP - PROB;<br />&nbsp; &nbsp; &nbsp; &nbsp; while high bit of TOP == 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output a 0 bit<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TOP = TOP &lt;&lt; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BOTTOM = BOTTOM &lt;&lt; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; end while<br />&nbsp; &nbsp; end if<br />end for<br /></div>
<br />
<br />I put this down so we could hopefully use common terminology.
<br />
<br />Given more and more 0 bits in the data, PROB should evolve to $01.
<br />Using the above values, it looks like PROB evolves like this:
<br />5A,5A,5A,5A, 5A,5A,5A,5A,
<br />5A,25,25,5A, 25,25,25,25,
<br />25,25,25,25, 25,11,25,25,
<br />11,25,25,25, 11,11,25,11,
<br />11,25,25,11, 11,11,11,11,
<br />11,25,25,8, 11,11,11,11,
<br />     
<br />So it looks like the probability has very discrete states and doesn't evolve very 'continuously'.  But what really bothers me is why does it keep randomly increasing the probability of getting a 1?  After 22 zeros, don't you think the probably of getting a 1 should go down or <em>at the very least stay the same</em> ?  Instead it goes up.
<br />
<br />I don't understand what I'm doing wrong.</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=716">neviksti</a> on Thu Jun 19, 2008 1:33 am, edited 4 times in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=716"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=12&amp;t=4106&amp;start=105"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=12"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=12&amp;t=4106"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>8</strong> of <strong>21</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 315 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=12&amp;t=4106&amp;start=90">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=12&amp;t=4106">1</a><span class="page-dots"> ... </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=60">5</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=75">6</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=90">7</a><span class="page-sep">, </span><strong>8</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=120">9</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=135">10</a><span class="page-sep">, </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=150">11</a><span class="page-dots"> ... </span><a href="./viewtopic.php?f=12&amp;t=4106&amp;start=300">21</a> &nbsp;<a href="./viewtopic.php?f=12&amp;t=4106&amp;start=120">Next</a></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=25">Other</a> &#187; <a href="./viewforum.php?f=23">Other Retro Dev</a> &#187; <a href="./viewforum.php?f=12">SNESdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 1 guest</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="4106" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="34">&nbsp; &nbsp;&nbsp; &nbsp;2018 NESdev Competition</option>
		
			<option value="33">&nbsp; &nbsp;&nbsp; &nbsp;2017 NESdev Competition</option>
		
			<option value="32">&nbsp; &nbsp;&nbsp; &nbsp;2016 NESdev Competition</option>
		
			<option value="31">&nbsp; &nbsp;&nbsp; &nbsp;2014 NESdev Competition</option>
		
			<option value="30">&nbsp; &nbsp;&nbsp; &nbsp;2011 NESdev Competition</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;&nbsp; &nbsp;Reproduction</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="11">&nbsp; &nbsp;&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="12" selected="selected">&nbsp; &nbsp;&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;&nbsp; &nbsp;GBDev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>


<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>