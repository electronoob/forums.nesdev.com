<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=10&amp;t=10960" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2014-01-31T11:28:49-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=10&amp;t=10960</id>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2014-01-31T11:28:49-07:00</updated>
<published>2014-01-31T11:28:49-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124786#p124786</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124786#p124786"/>
<title type="html"><![CDATA[Re: Strange 'Malware' in a Nintendo FDS ROM]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124786#p124786"><![CDATA[
Virus detectors used to just work by string matching, because neither party was particularly sophisticated. The reason the FDS file was modified was because the virus <em>also</em> just worked by string matching. Come the widespread use of the internet, and live connections with immediate payoff for infection, and it was inevitable that the arms race would accelerate to a blinding speed.<br /><br />In any case, the virus you found there is a PC virus, so it can't affect the FDS. While an FDS virus could be created, but because unlike the original XT which ran DOS, there's only the rarest of utility in using an disk unrelated to the game you're currently playing, so there's basically no infectious surface.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Fri Jan 31, 2014 11:28 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[zzo38]]></name></author>
<updated>2014-01-31T10:22:47-07:00</updated>
<published>2014-01-31T10:22:47-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124781#p124781</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124781#p124781"/>
<title type="html"><![CDATA[Re: Strange 'Malware' in a Nintendo FDS ROM]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124781#p124781"><![CDATA[
The text strings looks like the malware is designed for a PC (running IBM-DOS); I don't know why it would be in any FDS disk image.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4734">zzo38</a> — Fri Jan 31, 2014 10:22 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[3gengames]]></name></author>
<updated>2014-01-31T08:44:28-07:00</updated>
<published>2014-01-31T08:44:28-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124773#p124773</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124773#p124773"/>
<title type="html"><![CDATA[Re: Strange 'Malware' in a Nintendo FDS ROM]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124773#p124773"><![CDATA[
It's a virus. Delete it and move on. Preferably to a better way of downloading PD-ROMs.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4311">3gengames</a> — Fri Jan 31, 2014 8:44 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Kunitoki-01]]></name></author>
<updated>2014-01-31T07:05:43-07:00</updated>
<published>2014-01-31T07:05:43-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124764#p124764</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124764#p124764"/>
<title type="html"><![CDATA[Strange 'Malware' in a Nintendo FDS ROM]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=10960&amp;p=124764#p124764"><![CDATA[
While using ClamWin to scan my NES/Famicom ROMs for malware, I found this strange virus in one of my FDS files:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Bishojou Sexy Slot (19xx)(Super PIG)&#91;b&#93;.fds: Boot.Diskkiller FOUND</div><br /><br />After uploading the file on VT I got the following results:<br /><br /><a href="http://postimg.org/image/aonoqgu2b/" class="postlink"><img src="http://s29.postimg.org/aonoqgu2b/VT_Scan.jpg" alt="Image" /></a><br /><br />URL: <a href="https://www.virustotal.com/fi/file/00571dd8badfd02c9722f4953b51b5d4ee958de987746e5e44bb294fbe561bde/analysis/" class="postlink">https://www.virustotal.com/fi/file/00571dd8badfd02c9722f4953b51b5d4ee958de987746e5e44bb294fbe561bde/analysis/</a><br /><br />Once I opened the file in a hex editor, I found the following text strings:<br /><br />1)<br /><img src="http://s14.postimg.org/gsle9mlch/Text_String_01.png" alt="Image" /><br /><br />2)<br /><img src="http://s18.postimg.org/x74nxi5cp/Text_String_02.jpg" alt="Image" /><br /><br />If the attached pictures are not displayed well enough, these are the actual text strings:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Disk Killer -- Version 1.00 by COMPUTER OGRE 04/01/1989...Warning !!...Don't turn off the power or remove the diskette while Disk Killer is Processing!.PROCESSING...Now you can turn off the power....I wish you luck !</div><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Non-System disk or disk error..Replace and strike any key when ready.....Disk Boot failure...IBMBIO  COMIBMDOS  COM</div><br /><br />After some googling, I found some information about the virus; e.g. at <!-- m --><a class="postlink" href="http://www.f-secure.com/v-descs/diskkill.shtml">http://www.f-secure.com/v-descs/diskkill.shtml</a><!-- m --><br /><br />I decided to extract the contents of the disk image by using FDSList 1.2 for Windows. Entering the command <em>'FDSList &quot;Bishojou Sexy Slot (19xx)(Super PIG)[b].fds&quot; -w'</em> produced the following output:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">DISK '    '  Side A  Files 5  Maker $00  Version $00<br />-----------------------------------------------------<br />000 $00 'LOADER00' $D000-$DFFF ( 4096) &#91;CODE&#93;<br />001 $00 'NMI_MASK' $2000-$20FF (  256) &#91;CODE&#93;<br />002 $10 'TITLEDAT' $9000-$BD0F (11536) &#91;CODE&#93;<br />003 $20 'COMMON  ' $9000-$CE7F (16000) &#91;CODE&#93;<br />004 $10 'SEXYSLOT' $6000-$8FFF (12288) &#91;CODE&#93;<br />-----------------------------------------------------<br />|  44314 Bytes Used,  21112 Bytes Free,   67Full  |<br />-----------------------------------------------------<br /><br />DISK '    '  Side A  Files 13  Maker $00  Version $00<br />-----------------------------------------------------<br />000 $E0 'G_AMI   ' $D000-$D95F ( 2400) &#91;CODE&#93;<br />001 $E1 'G_MAMI  ' $D000-$DADF ( 2784) &#91;CODE&#93;<br />002 $E2 'G_ERI   ' $D000-$D9DF ( 2528) &#91;CODE&#93;<br />003 $E3 'G_EMI   ' $D000-$DA5F ( 2656) &#91;CODE&#93;<br />004 $E4 'G_EMA   ' $D000-$DA5F ( 2656) &#91;CODE&#93;<br />005 $E5 'G_RIE   ' $D000-$D9DF ( 2528) &#91;CODE&#93;<br />006 $E6 'G_MARI  ' $D000-$DADF ( 2784) &#91;CODE&#93;<br />007 $E7 'G_KKS0  ' $D000-$D95F ( 2400) &#91;CODE&#93;<br />008 $E8 'G_KKS1  ' $D000-$D95F ( 2400) &#91;CODE&#93;<br />009 $E9 'G_KKS2  ' $D000-$D9DF ( 2528) &#91;CODE&#93;<br />010 $EA 'G_ENDING' $D000-$DB7F ( 2944) &#91;CODE&#93;<br />011 $D0 'SEXY VOI' $D000-$D6FF ( 1792) &#91;CODE&#93;<br />012 $D1 'ENDVOICE' $BE00-$CF4F ( 4432) &#91;CODE&#93;<br />-----------------------------------------------------<br />|  35098 Bytes Used,  30328 Bytes Free,   53Full  |<br />-----------------------------------------------------</div><br /><br />The file containing the suspicious text strings is &quot;TITLEDAT&quot;...<br /><br /><br />I tested how ClamWin would react if I copy'n'pasted the text strings above into an empty text file which I would then scan with ClamWin. Much to my surprise, ClamWin flagged the text file as infected even though all that the file contained was the text strings – I did not add any actual malicious code there. Is there any (easy) way of finding out whether the FDS file really carries any dangerous payload? I'm not a programmer at all, and even if I was able to find an &quot;ad-hoc&quot; disassembler, I would have no easy way of telling whether the code really makes any sense.<br /><br /><br />Of course, I could simply replace all the files that were poisoned with a potentially malicious payload but it would be interesting to know whether this particular file poses any potential danger – either to a real Famicom (which sounds odd) or to some older systems such as DOS as the text string suggests that the malware was made way back in 1989... and speaking of that, I wonder why this kind of virus is residing within a Nintendo FDS ROM in the first place. Perhaps the one who infected the file thought that those who are willing to play a game called &quot;Bishojou Sexy Slot&quot; deserve to get hit by malware.<br /><br />I have attached both &quot;Bishojou Sexy Slot (19xx)(Super PIG)[b].fds&quot; and &quot;TITLEDAT&quot; if you want to tamper with the files.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6379">Kunitoki-01</a> — Fri Jan 31, 2014 7:05 am</p><hr />
]]></content>
</entry>
</feed>