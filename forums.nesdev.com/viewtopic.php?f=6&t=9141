<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - New VRC7 patch set</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - NES Music" href="http://forums.nesdev.com/feed.php?f=6" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - New VRC7 patch set" href="http://forums.nesdev.com/feed.php?f=6&amp;t=9141" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '1');
	var per_page = '';
	var base_url = '';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



	/**
	* Play quicktime file by determining it's width/height
	* from the displayed rectangle area
	*
	* Only defined if there is a file block present.
	*/
	function play_qt_file(obj)
	{
		var rectangle = obj.GetRectangle();

		if (rectangle)
		{
			rectangle = rectangle.split(',')
			var x1 = parseInt(rectangle[0]);
			var x2 = parseInt(rectangle[2]);
			var y1 = parseInt(rectangle[1]);
			var y2 = parseInt(rectangle[3]);

			var width = (x1 < 0) ? (x1 * -1) + x2 : x2 - x1;
			var height = (y1 < 0) ? (y1 * -1) + y2 : y2 - y1;
		}
		else
		{
			var width = 200;
			var height = 0;
		}

		obj.width = width;
		obj.height = height + 16;

		obj.SetControllerVisible(true);

		obj.Play();
	}


// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<!--<div style="float: right;">
					<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick">
					<input type="hidden" name="hosted_button_id" value="X2HM4WNR5YT8S">
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
					<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
					</form>
				</div>-->
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=minion"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Tue Mar 19, 2019 5:17 pm<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=6">NES Music</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />
	

					<center>
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- NesDev Forums -->
					<ins class="adsbygoogle"
						 style="display:block"
						 data-ad-client="ca-pub-7801010229099644"
						 data-ad-slot="7979066809"
						 data-ad-format="auto"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>
					</center>
	<br />


<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=6&amp;t=9141">New VRC7 patch set</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=6"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=6&amp;t=9141"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 11 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=6&amp;t=9141&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=6&amp;t=9141&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=6&amp;t=9141&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p97361"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p97361">New VRC7 patch set</a></div><div style="float: right;"><a href="./viewtopic.php?p=97361#p97361"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Aug 01, 2012 12:43 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 7317<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><strong><em>Edit: this patch set and test has been updated, see <a href="https://forums.nesdev.com/viewtopic.php?p=224838#p224838" class="postlink">the post below</a>.</em></strong><br /><strong><em>Edit: the actual patch set was finally dumped, see <a href="https://forums.nesdev.com/viewtopic.php?p=236280#p236280" class="postlink">the other post below</a>.</em></strong><br /><br /><br />I've spent some time over the last several days going over the VRC7 patch set with the CopyNES VRC7 tuner. This is about as close as I can get; some patches appear to be exact, but many have very minute differences which I could not reconcile. Also, there are many factors which make an exact match very hard; vibrato/tremolo don't synch with the note, so patches which use them are a bit variable, and there are some other random factors which seem to affect the onset of the note that I don't understand, but again they make some patches sound slightly different each time (just in the onset of the tone though).<br /><br />This is an incremental improvement on the <a href="http://nesdev.com/cgi-bin/wwwthreads/showpost.pl?Board=NESemdev&amp;Number=1440" class="postlink">patch set quietust posted a few years ago</a>. This would have taken a lot more time if it weren't for the prior work of kevtris and quietust, especially on the VRC7 tuner tool.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">rainwarrior's VRC7 patches:<br /><br />00 00 00 00 00 00 00 00<br />03 21 05 06 B8 82 42 27<br />13 41 13 0D D8 D6 23 12<br />31 11 08 08 FA 9A 22 02<br />31 61 18 07 78 64 30 27<br />22 21 1E 06 F0 76 08 28<br />02 01 06 00 F0 F2 03 F5<br />21 61 1D 07 82 81 16 07<br />23 21 1A 17 CF 72 25 17<br />15 11 25 00 4F 71 00 11<br />85 01 12 0F 99 A2 40 02<br />07 C1 69 07 F3 F5 A7 12<br />71 23 0D 06 66 75 23 16<br />01 02 D3 05 A3 92 F7 52<br />61 63 0C 00 94 AF 34 06<br />21 62 0D 00 B1 A0 54 17<br /></div><br /><br />The USB CopyNES host I used is available here:<br /><a href="https://github.com/bbbradsmith/usbcopynesblue" class="postlink">https://github.com/bbbradsmith/usbcopynesblue</a><br /><br />There are some minor source code changes to the VRC7 tuner tool; the modulator volume range is fixed (only went to 32 instead of 64), and saving files is fixed, as well as adding keyboard shortcuts Q/W/E to play the tones. I haven't uploaded a build with the fixed tool, but the source code fixes are in at that repository.<br /><br /><br />Edit: attached source code an NES/NSF for the test. (Edit: I have since made <a href="https://github.com/bbbradsmith/nes-audio-tests" class="postlink">a better test</a>, however.)</div>

					
						<br clear="all" /><br />

						<table class="tablebg" width="100%" cellspacing="1">
						<tr>
							<td class="row3"><b class="genmed">Attachments: </b></td>
						</tr>
						
							<tr>
								<td class="row2">
			<span class="gensmall"><b>File comment:</b> ca65 source code, NES ROM and NSF of VRC7 path test.</span><br />
		
			<span class="genmed">
				<img src="./styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="./download/file.php?id=7003">vrc7_patch_test.zip</a> [5.94 KiB]
			</span><br />
			<span class="gensmall">Downloaded 376 times</span>
		

		<br />
	</td>
							</tr>
						
						</table>
					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=5165">rainwarrior</a> on Tue Mar 19, 2019 1:08 pm, edited 7 times in total.</span>
						

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p97366"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p97366"></a></div><div style="float: right;"><a href="./viewtopic.php?p=97366#p97366"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Aug 01, 2012 2:34 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 7317<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">For anyone who is curious what the differences are, here's the changes in my new set, vs quietust's old one:<br /><br />quietust.vrc7 &gt; rainwarrior.vrc7:<br /><br />patch 1:<br />Modulator output: 4 &gt; 5<br />Modulator attack: 8 &gt; 11<br />Modulator decay: 13 &gt; 8<br />Carrier attack: 15 &gt; 8<br />Carrier sustain: 1 &gt; 2<br /><br />patch 2:<br />Modulator output: 5 &gt; 19<br />Feedback: 6 &gt; 5<br />Modulator attack: 9 &gt; 13<br />Modulator decay: 9 &gt; 8<br />Carrier attack: 9 &gt; 13<br />Modulator sustain: 6 &gt; 2<br /><br />patch 3:<br />Modulator output: 16 &gt; 8<br />Feedback: 2 &gt; 0<br />Modulator decay: 0 &gt; 10<br />Carrier decay: 12 &gt; 10<br />Modulator sustain: 3 &gt; 2<br /><br />patch 4:<br />Modulator rate scaling: 0 &gt; 1<br />Modulator output: 29 &gt; 24<br />Modulator attack: 9 &gt; 7<br />Modulator decay: 15 &gt; 8<br />Modulator sustain: 2 &gt; 3<br /><br />patch 6:<br />Carrier sustain: 9 &gt; 15<br /><br />patch 7:<br />Modulator output: 28 &gt; 29<br /><br />patch 8:<br />Modulator attack: 14 &gt; 12<br />Carrier attack: 8 &gt; 7<br />Carrier release: 5 &gt; 7<br /><br />patch 9:<br />Modulator sustain: 1 &gt; 0<br />Modulator rate scaling: 0 &gt; 1<br />Modulator output: 31 &gt; 37<br />Modulator attack: 8 &gt; 4<br />Modulator decay: 6 &gt; 15<br />Carrier attack: 4 &gt; 7<br />Modulator sustain: 2 &gt; 0<br /><br />patch 10:<br />Modulator output: 31 &gt; 18<br />Modulator attack: 14 &gt; 9<br />Modulator decay: 4 &gt; 9<br />Modulator sustain: 1 &gt; 4<br />Modulator release: 1 &gt; 0<br />Carrier sustain: 1 &gt; 0<br /><br />patch 11:<br />Modulator level scale: 0 &gt; 1<br />Modulator output: 43 &gt; 41<br />Carrier level scale: 1 &gt; 0<br />Feedback: 5 &gt; 7<br />Modulator attack: 11 &gt; 15<br />Modulator decay: 4 &gt; 3<br />Carrier decay: 1 &gt; 5<br />Modulator sustain: 2 &gt; 10<br />Modulator release: 4 &gt; 7<br />Carrier sustain: 15 &gt; 1<br />Carrier release: 4 &gt; 2<br /><br />patch 12:<br />Modulator rate scaling: 0 &gt; 1<br />Modulator output: 17 &gt; 13<br />Modulator attack: 9 &gt; 6<br />Carrier attack: 9 &gt; 7<br />Carrier decay: 6 &gt; 5<br />Modulator sustain: 1 &gt; 2<br /><br />patch 13:<br />Modulator attack: 8 &gt; 10<br />Modulator decay: 2 &gt; 3<br />Carrier attack: 10 &gt; 9<br />Modulator sustain: 3 &gt; 15<br />Modulator release: 1 &gt; 7<br />Carrier release: 1 &gt; 2<br /><br />patch 14:<br />Carrier vibrato: 0 &gt; 1<br />Carrier multiplier: 2 &gt; 3<br />Modulator output: 13 &gt; 12<br />Feedback: 2 &gt; 0<br />Modulator attack: 12 &gt; 9<br />Modulator decay: 3 &gt; 4<br />Carrier attack: 7 &gt; 10<br />Modulator sustain: 2 &gt; 3<br />Carrier release: 5 &gt; 6<br /><br />patch 15:<br />Modulator output: 14 &gt; 13<br />Modulator attack: 10 &gt; 11<br />Modulator sustain: 4 &gt; 5</div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=5165">rainwarrior</a> on Sun Sep 02, 2018 11:47 am, edited 1 time in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p97388"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p97388"></a></div><div style="float: right;"><a href="./viewtopic.php?p=97388#p97388"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Aug 01, 2012 8:45 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I haven't compared side-by-side with actual recordings yet... but it sounds great to me at first listen!
<br />
<br />Nice work.  :)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p182878"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p182878">Re: New VRC7 patch set</a></div><div style="float: right;"><a href="./viewtopic.php?p=182878#p182878"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Nov 13, 2016 10:29 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 7317<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Just realized I never published the ROM/NSF of the test, or its source code. Added to OP.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p206193"></a>
				<b class="postauthor">ap9</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p206193">Re: New VRC7 patch set</a></div><div style="float: right;"><a href="./viewtopic.php?p=206193#p206193"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Oct 18, 2017 12:29 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Jun 01, 2013 11:55 am<br /><b>Posts:</b> 36<br /><b>Location:</b> Maine, U.S.A.
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I found a few sustain, decay and release values are slightly off according to the waveforms in the patch test recording (internal patch first, approximated second). The set is very close, of courseâ€” I found only three instances one point off.<br /><br />It was in the process of updating my emulator that I made the following adjustments to achieve close results to the h/w recording:<br /><br />Patch #1:<br />Carrier decay 2 &gt; 1<br />Carrier sustain 2 &gt; 3<br />$&quot;03 21 05 06 B8 81 42 37&quot;<br /><br />Patch #14:<br />Carrier release 6 &gt; 7<br />$&quot;61 63 0C 00 94 AF 34 07&quot;<br /><br />Patch #15:<br />Carrier release 7 &gt; 8<br />$&quot;21 62 0D 00 B1 A0 54 18&quot;<br /><br />(Also: thanks for your work, rainwarrior.)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=6020"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p224835"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p224835">Re: New VRC7 patch set</a></div><div style="float: right;"><a href="./viewtopic.php?p=224835#p224835"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 01, 2018 4:35 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 7317<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Sorry it took me a year to find the time to review this.<br /><br />On patch 1 and 15 I think both of these are closer to the original. (I suspect we could even bump up that patch 15 release one more notch, will check soon.)<br /><br />Patch 14 looks like a regression to me. The release is now too short. You should check too, yourself, but take a look at the image below, showing my patch #14 at the top right, yours at the bottom, built-in on left.<br /><br />This is from a recording of the <strong>patch_vrc7</strong> test from: <a href="https://github.com/bbbradsmith/nes-audio-tests" class="postlink">https://github.com/bbbradsmith/nes-audio-tests</a><br /><br />(This is a slight improvement over my old patch set test, as the timing is now cycle-counted rather than polling the PPU, so different recordings can still be very precisely synchronized now.)</div>

					
						<br clear="all" /><br />

						<table class="tablebg" width="100%" cellspacing="1">
						<tr>
							<td class="row3"><b class="genmed">Attachments: </b></td>
						</tr>
						
							<tr>
								<td class="row2">
			<img src="./download/file.php?id=13439" alt="patch14_envelope_rainwarrior_vs_ap9.png" /><br />
			<span class="gensmall">patch14_envelope_rainwarrior_vs_ap9.png [ 9.02 KiB | Viewed 5178 times ]</span>
		

		<br />
	</td>
							</tr>
						
						</table>
					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=5165">rainwarrior</a> on Sun Sep 02, 2018 12:24 pm, edited 1 time in total.</span>
						

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p224838"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p224838">Re: New VRC7 patch set</a></div><div style="float: right;"><a href="./viewtopic.php?p=224838#p224838"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Sep 01, 2018 6:53 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 7317<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Did some more investigation in the VRC7 tuner. I forgot how much of a pain the LFO is, since it's free-run and not synched with anything you have to test the sounds over and over.<br /><br />Looking more closely at ap9's changes:<br /><ul><li> Patch 1 carrier decay: Yes, this is a good change.</li><li> Patch 1 carrier sustain: No, keep at 2. 3 goes too quiet. This instrument has a long decay so it takes several seconds to hit sustain, but once it does it's clearly 2 and not 3.</li><li> Patch 14 carrier release: No, keep at 6. 7 is too fast.</li><li> Patch 15 carrier release: Revised. This was a step in the right direction, some of the releases were too long, but looking at it again I think the missing ingredient was carrier key rate scaling. With KRS and carrier release of 6, I think the release is now correct.</li></ul><br />I also adjusted the modulator decay of patch 12 (should be slightly faster), and modulator attack of patch 15 (also slightly faster).<br /><br />Having the opportunity to go over these again but with a lot less difference between the current state and the goal was a big help here. Those LFO instruments were wearing me out when I worked on this 6 years ago, and I think I was able to approach them a lot more carefully with this more refined problem to deal with. Ap9's adjustment to patch 15 really helped me see what was missing there, could never get the opening of the attack right across all octaves before, but with KRS it seems to match very well now. (I actually don't really have any glaring problems in this set after going over it... it feels extremely close now in a way that it didn't last time.)<br /><br />Here's my new changes vs my previous set above and ap9's:<br /><br />Patch 1<br />Carrier decay: 2 &gt; 1 (agree with ap9)<br />Carrier sustain: 2 (stays)<br />03 21 05 06 B8 81 42 27<br /><br />Patch 12<br />Modulator decay: 6 &gt; 7<br />71 23 0D 06 67 75 23 16<br /><br />Patch 14<br />Carrier release: 6 (stays, 7 is too fast)<br />61 63 0C 00 94 AF 34 06<br /><br />Patch 15<br />Carrier KRS: off &gt; on<br />Modulator attack: B &gt; C<br />Carrier release: 7 &gt; 6<br />21 72 0D 00 C1 A0 54 16<br /><br /><br />As always, would love any verification I could get on this, but I do know how few people have the necessary tools to really go into it (it even took me a year to get around to this one). The hotswap test I linked in my last post is a useful survey of the set, but it only does 3 octaves, with release on 1 them (just as a test of release). To really verify you need to use something like the CopyNES VRC7 tuner and try out lots of octaves, etc. Like the Patch 1 sustain wasn't something that that test could catch because the notes aren't long enough for that decay length. Well, maybe someday someone will finish staining that decap and we can know for sure. :S<br /><br />Edit: I downloaded the demo of plgDavid's program, which actually has a set of VRC7 patches of its own stored in some text files. Surprisingly there's a lot of differences from all the patch sets I have archived from over the years. I guess this is a completely independent reverse engineering. Despite there being a lot of bits that are different, these patches also sound pretty close. (Though there's probably a lot of stuff that don't make a difference to the sound...)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p224854"></a>
				<b class="postauthor">plgDavid</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p224854">Re: New VRC7 patch set</a></div><div style="float: right;"><a href="./viewtopic.php?p=224854#p224854"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Sep 02, 2018 5:00 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Tue Aug 07, 2012 11:01 am<br /><b>Posts:</b> 16
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">rainwarrior wrote:</div><div class="quotecontent">Edit: I downloaded the demo of plgDavid's program, which actually has a set of VRC7 patches of its own stored in some text files. Surprisingly there's a lot of differences from all the patch sets I have archived from over the years. I guess this is a completely independent reverse engineering. Despite there being a lot of bits that are different, these patches also sound pretty close. (Though there's probably a lot of stuff that don't make a difference to the sound...)</div><br /><br />I suspect we will never get them 100% short of a more aggressive pass on the chip die (doable but very tricky apparently to delayer the protected section)<br />Especially exact EG settings of the modulator, which is the trickiest to fix imho (the exact EG settings of the carrier can be found really just with counting samples)<br />Yes our set was gathered from scratch using waveform comparison, spectrum comparison and rapid toggling between instrument 0 and x (listening for glitches or anything not smooth)<br /><br />Here it is the block of code from our app (was also published in my video), and yes they are also in separate preset xml files in the synth:<br /><br />// May 15th 2015 Hubert Lamontagne &amp; David Viens<br />const uint8_t ROM_VRC7[OPLL_INST_MAX][OPLL_INST_SIZE]={<br />    OPLL_USER_INIT_PATCH,<br />	{0x03, 0x21, 0x05, 0x06, 0xC8, 0x81, 0x42, 0x27}, // Buzzy Bell<br />	{0x13, 0x41, 0x14, 0x0D, 0xF8, 0xF7, 0x23, 0x12}, // Guitar<br />	{0x31, 0x11, 0x08, 0x08, 0xFA, 0xC2, 0x28, 0x22}, // Wurly<br />	{0x31, 0x61, 0x0C, 0x07, 0xF8, 0x64, 0x60, 0x27}, // Flute<br />	{0x22, 0x21, 0x1E, 0x06, 0xFF, 0x76, 0x00, 0x28}, // Clarinet<br />	{0x02, 0x01, 0x05, 0x00, 0xAC, 0xF2, 0x03, 0x02}, // Synth<br />	{0x21, 0x61, 0x1D, 0x07, 0x82, 0x8F, 0x10, 0x07}, // Trumpet<br />	{0x23, 0x21, 0x22, 0x17, 0xFF, 0x73, 0x00, 0x17}, // Organ<br />	{0x15, 0x11, 0x25, 0x00, 0x41, 0x71, 0x00, 0xF1}, // Bells<br />	{0x95, 0x01, 0x10, 0x0F, 0xB8, 0xAA, 0x50, 0x02}, // Vibes<br />	{0x17, 0xC1, 0x5E, 0x07, 0xFA, 0xF8, 0x22, 0x12}, // Vibraphone<br />	{0x71, 0x23, 0x11, 0x06, 0x65, 0x74, 0x10, 0x16}, // Tutti<br />	{0x01, 0x02, 0xD3, 0x05, 0xF3, 0x92, 0x83, 0xF2}, // Fretless<br />	{0x61, 0x63, 0x0C, 0x00, 0xA4, 0xFF, 0x30, 0x06}, // Synth Bass<br />	{0x21, 0x62, 0x0D, 0x00, 0xA1, 0xFF, 0x50, 0x08}  // Sweep<br />};</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5629"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p224873"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p224873">Re: New VRC7 patch set</a></div><div style="float: right;"><a href="./viewtopic.php?p=224873#p224873"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Sep 02, 2018 11:51 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 7317<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Ah, thanks for posting that set here. I wasn't sure whether it was OK to share that. Here's the differences between your set (left) and the one I posted yesterday (right):<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Patch 1<br />12 11 M attack<br /><br />Patch 2<br />20 19 M output<br />15 13 M attack<br />15 13 C attack<br />&nbsp;7&nbsp; 6 C decay<br /><br />Patch 3<br />12&nbsp; 9 C attack<br />&nbsp;2 10 C decay<br />&nbsp;8&nbsp; 2 M release<br />&nbsp;2&nbsp; 0 C sustain<br /><br />Patch 4<br />12 24 M output<br />15&nbsp; 7 M attack<br />&nbsp;6&nbsp; 3 M sustain<br /><br />Patch 5<br />15&nbsp; 0 M decay<br />&nbsp;0&nbsp; 8 M release<br /><br />Patch 6<br />&nbsp;5&nbsp; 6 M output<br />10 15 M attack<br />12&nbsp; 0 M decay<br />&nbsp;0 15 C sustain<br />&nbsp;2&nbsp; 5 C release<br /><br />Patch 7<br />15&nbsp; 1 C decay<br />&nbsp;0&nbsp; 6 M release<br /><br />Patch 8<br />34 26 M output<br />15 12 M attack<br />&nbsp;3&nbsp; 2 C decay<br />&nbsp;0&nbsp; 2 M sustain<br />&nbsp;0&nbsp; 5 M release<br /><br />Patch 9<br />&nbsp;1 15 M decay<br />15&nbsp; 1 C sustain<br /><br />Patch 10<br />&nbsp;1&nbsp; 0 M key rate scale<br />16 18 M output<br />11&nbsp; 9 M attack<br />&nbsp;8&nbsp; 9 M decay<br />10&nbsp; 2 C decay<br />&nbsp;5&nbsp; 4 M sustain<br /><br />Patch 11<br />&nbsp;1&nbsp; 0 M key rate scale<br />30 41 M output<br />10&nbsp; 3 M decay<br />&nbsp;8&nbsp; 5 C decay<br />&nbsp;2 10 M sustain<br />&nbsp;2&nbsp; 7 M release<br /><br />Patch 12<br />17 13 M output<br />&nbsp;5&nbsp; 7 M decay<br />&nbsp;4&nbsp; 5 C decay<br />&nbsp;1&nbsp; 2 M sustain<br />&nbsp;0&nbsp; 3 M release<br /><br />Patch 13<br />15 10 M attack<br />&nbsp;8 15 M sustain<br />&nbsp;3&nbsp; 7 M release<br />15&nbsp; 5 C sustain<br /><br />Patch 14<br />10&nbsp; 9 M attack<br />15 10 C attack<br />&nbsp;0&nbsp; 4 M release<br /><br />Patch 15<br />&nbsp;0&nbsp; 1 C key rate scale<br />10 12 M attack<br />15 10 C attack<br />15&nbsp; 0 C decay<br />&nbsp;0&nbsp; 4 M release<br />&nbsp;0&nbsp; 1 C sustain<br />&nbsp;8&nbsp; 6 C release</div><br /><br />I'll take a closer look at how these differ later.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p236280"></a>
				<b class="postauthor">rainwarrior</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p236280">Re: New VRC7 patch set</a></div><div style="float: right;"><a href="./viewtopic.php?p=236280#p236280"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Mar 19, 2019 1:06 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=5165_1471663472.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Jan 22, 2012 12:03 pm<br /><b>Posts:</b> 7317<br /><b>Location:</b> Canada
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Exciting news! Apparently a debug mode for the VRC7 was found via pin 15, and a few days ago Nuke.KYT used this to read out the VRC7 patch set:<br /><a href="https://siliconpr0n.org/archive/doku.php?id=vendor:yamaha:opl2#ym2413_instruments" class="postlink">https://siliconpr0n.org/archive/doku.php?id=vendor:yamaha:opl2#ym2413_instruments</a><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">0: $03 $21 $05 $06 $E8 $81 $42 $27<br />1: $13 $41 $14 $0D $D8 $F6 $23 $12<br />2: $11 $11 $08 $08 $FA $B2 $20 $12<br />3: $31 $61 $0C $07 $A8 $64 $61 $27<br />4: $32 $21 $1E $06 $E1 $76 $01 $28<br />5: $02 $01 $06 $00 $A3 $E2 $F4 $F4<br />6: $21 $61 $1D $07 $82 $81 $11 $07<br />7: $23 $21 $22 $17 $A2 $72 $01 $17<br />8: $35 $11 $25 $00 $40 $73 $72 $01<br />9: $B5 $01 $0F $0F $A8 $A5 $51 $02<br />A: $17 $C1 $24 $07 $F8 $F8 $22 $12<br />B: $71 $23 $11 $06 $65 $74 $18 $16<br />C: $01 $02 $D3 $05 $C9 $95 $03 $02<br />D: $61 $63 $0C $00 $94 $C0 $33 $F6<br />E: $21 $72 $0D $00 $C1 $D5 $56 $06</div><br /><br />I have verified this myself using the <a href="https://github.com/bbbradsmith/nes-audio-tests" class="postlink">hotswap patch test ROM</a> I wrote. I'm willing to call this a complete and correct patch dump. (Note the row numbers on that table are off by one from the usual convention.)<br /><br />The only thing that doesn't match perfectly in my side by side recordings is the patches using the vibrato LFO, which don't match phase. I thought I could reset LFO by writing $40 then $00 to $E000 (with some delays in between), but I'm not sure if this affects the vibrato LFO? It does seem to work for tremolo... unless I'm just getting incredibly lucky with timings... at any rate I don't think that matters in terms of patch correctness, since LFO phase is normally free running and not something that would be affected by patch data anyway. <em>Edit: amended description, this was a little confusing, but will investigate further...</em><br /><br />Here's the parameterized diff vs. my last set. (Mine on the left, the new dump on the right.)<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">A: rainwarrior_2.vrc7<br />B: nukeykt.vrc7<br /><br />Patch 1<br />11 14 M attack<br /><br />Patch 2<br />19 20 M output<br />13 15 C attack<br /><br />Patch 3<br />&nbsp;1&nbsp; 0 M hold sustain<br />&nbsp;9 11 C attack<br />10&nbsp; 2 C decay<br />&nbsp;2&nbsp; 0 M release<br />&nbsp;0&nbsp; 1 C sustain<br /><br />Patch 4<br />24 12 M output<br />&nbsp;7 10 M attack<br />&nbsp;3&nbsp; 6 M sustain<br />&nbsp;0&nbsp; 1 M release<br /><br />Patch 5<br />&nbsp;0&nbsp; 1 M key rate scale<br />15 14 M attack<br />&nbsp;0&nbsp; 1 M decay<br />&nbsp;8&nbsp; 1 M release<br /><br />Patch 6<br />15 10 M attack<br />&nbsp;0&nbsp; 3 M decay<br />15 14 C attack<br />&nbsp;0 15 M sustain<br />&nbsp;3&nbsp; 4 M release<br />&nbsp;5&nbsp; 4 C release<br /><br />Patch 7<br />&nbsp;6&nbsp; 1 M release<br /><br />Patch 8<br />26 34 M output<br />12 10 M attack<br />15&nbsp; 2 M decay<br />&nbsp;2&nbsp; 0 M sustain<br />&nbsp;5&nbsp; 1 M release<br /><br />Patch 9<br />&nbsp;0&nbsp; 1 M hold sustain<br />15&nbsp; 0 M decay<br />&nbsp;1&nbsp; 3 C decay<br />&nbsp;0&nbsp; 7 M sustain<br />&nbsp;0&nbsp; 2 M release<br />&nbsp;1&nbsp; 0 C sustain<br /><br />Patch 10<br />&nbsp;0&nbsp; 1 M hold sustain<br />&nbsp;0&nbsp; 1 M key rate scale<br />18 15 M output<br />&nbsp;9 10 M attack<br />&nbsp;9&nbsp; 8 M decay<br />&nbsp;2&nbsp; 5 C decay<br />&nbsp;4&nbsp; 5 M sustain<br />&nbsp;0&nbsp; 1 M release<br /><br />Patch 11<br />&nbsp;0&nbsp; 1 M key rate scale<br />&nbsp;1&nbsp; 0 M key level scale<br />41 36 M output<br />&nbsp;3&nbsp; 8 M decay<br />&nbsp;5&nbsp; 8 C decay<br />10&nbsp; 2 M sustain<br />&nbsp;7&nbsp; 2 M release<br /><br />Patch 12<br />13 17 M output<br />&nbsp;7&nbsp; 5 M decay<br />&nbsp;5&nbsp; 4 C decay<br />&nbsp;2&nbsp; 1 M sustain<br />&nbsp;3&nbsp; 8 M release<br /><br />Patch 13<br />10 12 M attack<br />&nbsp;3&nbsp; 9 M decay<br />&nbsp;2&nbsp; 5 C decay<br />15&nbsp; 0 M sustain<br />&nbsp;7&nbsp; 3 M release<br />&nbsp;5&nbsp; 0 C sustain<br /><br />Patch 14<br />10 12 C attack<br />15&nbsp; 0 C decay<br />&nbsp;4&nbsp; 3 M release<br />&nbsp;0 15 C sustain<br /><br />Patch 15<br />10 13 C attack<br />&nbsp;0&nbsp; 5 C decay<br />&nbsp;4&nbsp; 6 M release<br />&nbsp;1&nbsp; 0 C sustain</div></div>

					
							<br /><br />
							<span class="gensmall">Last edited by <a href="./memberlist.php?mode=viewprofile&amp;u=5165">rainwarrior</a> on Tue Mar 19, 2019 1:35 pm, edited 2 times in total.</span>
						<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5165"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p236298"></a>
				<b class="postauthor">NewRisingSun</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p236298">Re: New VRC7 patch set</a></div><div style="float: right;"><a href="./viewtopic.php?p=236298#p236298"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Mar 19, 2019 1:28 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu May 19, 2005 11:30 am<br /><b>Posts:</b> 880
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Wonderful! Now the only impediment to perfect VRC7 bliss is correct emu2413's annoying &quot;ladder&quot; effect that exaggerates the quantization noise compared to the available hardware recordings.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=133"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=6&amp;t=9141"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=6"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=6&amp;t=9141"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 11 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=6">NES Music</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 2 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="9141" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6" selected="selected">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="34">&nbsp; &nbsp;&nbsp; &nbsp;2018 NESdev Competition</option>
		
			<option value="33">&nbsp; &nbsp;&nbsp; &nbsp;2017 NESdev Competition</option>
		
			<option value="32">&nbsp; &nbsp;&nbsp; &nbsp;2016 NESdev Competition</option>
		
			<option value="31">&nbsp; &nbsp;&nbsp; &nbsp;2014 NESdev Competition</option>
		
			<option value="30">&nbsp; &nbsp;&nbsp; &nbsp;2011 NESdev Competition</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;&nbsp; &nbsp;Reproduction</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="11">&nbsp; &nbsp;&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="12">&nbsp; &nbsp;&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;&nbsp; &nbsp;GBDev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>


<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>