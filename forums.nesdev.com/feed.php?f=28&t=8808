<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=28&amp;t=8808" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2014-05-05T12:28:51-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=28&amp;t=8808</id>
<entry>
<author><name><![CDATA[infiniteneslives]]></name></author>
<updated>2014-05-05T12:28:51-07:00</updated>
<published>2014-05-05T12:28:51-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=128461#p128461</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=128461#p128461"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=128461#p128461"><![CDATA[
Sorry I missed your post Punch..<br /><br /><div class="quotetitle">Punch wrote:</div><div class="quotecontent"><br />Will you make available boards with built in flash chips for discrete mappers like NROM, UNROM, etc.?<br /></div><br />Yeah I actually designed a separate <a href="http://forums.nesdev.com/viewtopic.php?f=9&amp;t=10820" class="postlink">3rd version</a> of my board tailored towards discrete mappers.  There turned out to be a few hiccups found in the prototyping of greater than NROM designs.  That kept me from releasing them on time with my original plans.  I'll address the specific issues on that thread, but the good news is I've got the final design all laid out now and will be ordering the first production batch in the next week or two.  That would put their sale available in June if all goes as planned.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />How much $$$?<br /></div>Good question.  I haven't fully decided yet, they'll be comparable to the pricing of my other products.  Notably cheaper than my CPLD full flash boards.  I made those boards extra small in efforts to keep cost down and help offset the cost of providing a fully assembled flash board with no soldering required.  I also plan to have significant tiered pricing to provide benefit to homebrew production.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4832">infiniteneslives</a> — Mon May 05, 2014 12:28 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Punch]]></name></author>
<updated>2014-03-19T17:53:00-07:00</updated>
<published>2014-03-19T17:53:00-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=127009#p127009</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=127009#p127009"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=127009#p127009"><![CDATA[
It's a me again. Will you make available boards with built in flash chips for discrete mappers like NROM, UNROM, etc.? How much $$$?Now that bunnyboy doesn't do repropaks anymore I think InfiniteNESLives is the only site with a reasonable new board solution. Plus it's way easier to program a new board with the Kazzo than desoldering old mask roms.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=5877">Punch</a> — Wed Mar 19, 2014 5:53 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[yogi]]></name></author>
<updated>2014-02-26T11:41:50-07:00</updated>
<published>2014-02-26T11:41:50-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126152#p126152</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126152#p126152"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126152#p126152"><![CDATA[
I went back through my notes in regards to the mentioned odd readings. The test procedure for each Xtal group was to insert the Resistor then run through the different Capacitors, taking the readings. For the 14.970MHz Xtal group I broke this pattern; starting with 68pf and then realizing that I had skipped the 22pf, ran that test last.  <br /> SO when I entered the data in the spreadsheet, the 14MHZ/5M set was copied out of order, Sorry guys <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />  Here is an corrected xls; I also added the TC for each RC combo (very redundant, but handy for comparing different combos).<br />HCT74 Osc testing Data1.1.xls<br />Yogi<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6258">yogi</a> — Wed Feb 26, 2014 11:41 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2014-02-24T21:00:21-07:00</updated>
<published>2014-02-24T21:00:21-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126087#p126087</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126087#p126087"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126087#p126087"><![CDATA[
<div class="quotetitle">yogi wrote:</div><div class="quotecontent"><br />Are you asking in regards to the vast difference between the RC TC Res Frequency and the circuit's free-running frequency? This point has me very curious. For a single gate osc the RC should free run in the low KHz range for most these chosen values; I think with the added gates of the FF and associated Prop delays, the mode of operation is closer to the Ring Type Waveform Generator outlined at this site:<br /> <!-- m --><a class="postlink" href="http://www.electronics-tutorials.ws/waveforms/generators.html">http://www.electronics-tutorials.ws/wav ... ators.html</a><!-- m --><br /></div>I was asking about the point you've attributed to the typo.<br /><br />In Intro EE lab in college, we built a ring generator, and specifically played with the length of the wire on the long loop back. It was pretty easy to get enough inductance out of the aerial wire to get tens of volts on the input to the first inverter... In any case, I think you've got the right of it. There's no hysteresis at all with this circuit topology, the resistor just biases the inverter chain to its center point, so any oscillations we're seeing are propagation speed through the gates.<br /><br />I guess it is useful because it gives us a likely upper bound on the crystal we can use, though. Not that there are all that many fundamental-mode crystals above 20MHz...<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Mon Feb 24, 2014 9:00 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[yogi]]></name></author>
<updated>2014-02-24T19:04:34-07:00</updated>
<published>2014-02-24T19:04:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126082#p126082</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126082#p126082"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126082#p126082"><![CDATA[
<div class="quotetitle">lidnariq wrote:</div><div class="quotecontent"><br />Thanks for taking the time to explore this!<br /><br />Naïve question: any idea why the free running frequencies not independent of the value of the missing crystal? The really visible outlier is no xtal/14.96MHz/10MΩ/220pF.<br /></div><br /> Are you asking in regards to the vast difference between the RC TC Res Frequency and the circuit's free-running frequency? This point has me very curious. For a single gate osc the RC should free run in the low KHz range for most these chosen values; I think with the added gates of the FF and associated Prop delays, the mode of operation is closer to the Ring Type Waveform Generator outlined at this site:<br /> <!-- m --><a class="postlink" href="http://www.electronics-tutorials.ws/waveforms/generators.html">http://www.electronics-tutorials.ws/wav ... ators.html</a><!-- m --><br /><br />  OTOH, Are you asking about the odd free-running outputs for crystal group? In most cases the same RC combos in the different data sets are close, ~10% ( I essentially tested the same 12 combos 4 times), but a few reading aren't even close to the average.<br /><br />  For each test I changed/added/removed test components, so with the moving and handling of the breadboard, quite likely changed some of the stray C. Or RC oscillators at these frequencies are just very unstable.<br /> <br /> For the one you quoted, I'm thinking it's a transcription error (I recorded the raw meter reading then went back through my notes transcribing them into the spreadsheet. Could have been my handwriting). Or my meter acting up, it seemed sensitive to the poor test point on the breadboard and the tip on my test lead. <br /><br />  With some of the others odd readings, such as the 11.525MHz xtal data set and 68pf cap. I reran these tests and tried another 68pf cap from the same batch. The best I can say is it could be related to the unknown specs of the xtal. <br /><br /> One thing that seems the most important to me is the upper limit to the C value at these frequencies. This appears to be unrelated to the TC of the combo, as other RC combos with a similar TC allow osc lock. The Patent suggests that the RC TC should be &gt; 1/2 the period of the Xtal, which in all the test cases is true. So the questions remains how close to &quot;1/2 the Period&quot; is acceptable and what is the impact on that particular Xtal.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />I've been trying to figure out a good way to graph this but there's four dimensions of input <img src="http://forums.nesdev.com/images/smilies/icon_razz.gif" alt=":P" title="Razz" /><br /></div><br />  That would be interesting. I wish my data set was larger though <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />Yogi<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6258">yogi</a> — Mon Feb 24, 2014 7:04 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2014-02-24T14:13:11-07:00</updated>
<published>2014-02-24T14:13:11-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126074#p126074</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126074#p126074"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126074#p126074"><![CDATA[
Thanks for taking the time to explore this!<br /><br />Naïve question: any idea why the free running frequencies not independent of the value of the missing crystal? The really visible outlier is no xtal/14.96MHz/10MΩ/220pF.<br /><br />I've been trying to figure out a good way to graph this but there's four dimensions of input <img src="http://forums.nesdev.com/images/smilies/icon_razz.gif" alt=":P" title="Razz" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Mon Feb 24, 2014 2:13 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[yogi]]></name></author>
<updated>2014-02-24T11:57:10-07:00</updated>
<published>2014-02-24T11:57:10-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126061#p126061</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126061#p126061"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=126061#p126061"><![CDATA[
Last day and a half I've been  testing the HCT74 osc. I've compiled a data set of the tests to try to understand the circuit better. Keep in mind that my test circuit is on solderless breadboard which has a lot of stray C and my DMM only has a range to 4MHz with 4 digit precision. In order to test in the ranges of interest, a prescaler was constructed using a second HCT74.<br />HCT74 Osc testing Data1.xls<br /> The testing was done with a range of 3 R values, 4 C Values and 4 Xtal Frequencies. For each Xtal F, the output from the xtal osc was recorded as well as the free-running output for all RC combinations. <br />  Two Xtals, the 11.525NHz and the 14.960MHz, were pulls with unknown specs, the other two, 16MHz and 18.432MHz, are AT cut 20pF load. The former two Xtals had unexpected performance with certain RC combos that leads me to suspect cut and load differences from the later Xtals.  <br />  Some of my conclusions: <br />1 I had a connection issue in the first build of the circuit that caused the strange behavior and the need for a inverter gate buffer. Through out this round of tests, the same R/C/Xtal combos that failed on the initial circuit now work. <br />2  The circuit is fairly forgiving with the RC selection but certain combos misbehave in a unexpected way. Example: The 16MHz Xtal running @ 19MHz with 5M/150pf but measured @ 16MHz with 5M/220pf. I'm sure some of these deviations are due to the mechanical problems with the breadboard as well as errors with my DMM coupling. But it could also indicate a cut/loading issue with the Xtal in some cases.<br />3  The Xtal to Free-running relationship seems to show a lower limit to acceptable RC Frequence. The Xtal Osc fails to lock when the free-running Freq is about 10% below the Xtal Freq. Further analysis is needed to understand the limits of Pat.'s description of the relationship between the RC TC and the Xtal Period.<br />  At this point it should be clear that this circuit is quite capable, compact and could be considered as a replacement of a 'can' osc module if need be.<br />Yogi<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6258">yogi</a> — Mon Feb 24, 2014 11:57 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2014-02-22T12:37:20-07:00</updated>
<published>2014-02-22T12:37:20-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125893#p125893</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125893#p125893"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125893#p125893"><![CDATA[
<div class="quotetitle">yogi wrote:</div><div class="quotecontent"><br />My observation with the original RC osc (no Xtal in circuit) measured  @ ~16MHz.<br /></div>There's no hysteresis with this driver, and no second-order effects. Even if RC there is 22µs, it's still going to self-bias right to the middle of the transfer function and ring as fast as it can.<br />I wonder if it's actually the parasitic inductance of the 10MΩ resistor that matters here? 10MΩ is so huge ... does the osc work if you omit it entirely?<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />I haven't seem a major deviation of the Xtal F, in the range of 5-10 KHz lower than the printed F on the Xtal. This could be due , as you point out to the C, or the cal on my DMM or the tolerance of the Xtals I pulled out of my junk box <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /></div>You can usually get about 1000ppm of depression from nominal frequency by adjusting the load capacitance before the oscillator stops working... or about 16kHz on a 16MHz oscillator. Sounds consistent to me. <br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Initially, I was assuming this circuit was close to the Pierce but I'm doubting that a little.<br /></div>It certainly should be... only differences that come to mind are:<br />1- they're omitting C2/using the 2Ck input as C2.<br />2- It's not a single inverter but instead an inverter and two NOR gates<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Beyonds changing the necessary tuning tables, this will also slightly affect ADSR rates, the timers, and the various free-running LFOs (e.g. &quot;AMS&quot; and &quot;PMS&quot;). <br />[…]<br />If we can extrapolate from the OPL3, the FM LFO is fixed at Sclk÷8192, and the AM LFO is fixed at Sclk÷13440.<br /></div>I've only just started digging into the DS. But Is there a real need to maintain Sega's clk selection? With a 'new' design would there be an advantage to replicating Saga's HW? Would people want to use Sega VGM patches on a NES platform?<br /></div>I don't think there's a need to maintain complete compatibility. It involves some things that can be compensated for (changing F numbers) and accepting the things that can't (5% increase of speed of ADSRs and LFOs). Is 5.8 Hz vs 6.1 Hz something a musician would care about? I'm definitely not the right person to ask.<br /><br />OTOH, if we don't have another more convenient source of clock, using a 15.36÷2 driver vs an 8MHz source isn't so big.<br /><br />One other question: does the YM2612 have the same input clock divider available as the YM2608? If so, would we want to consider running it off M2 instead? It should be equivalent to using a 5.4 MHz crystal. (and a corresponding slowing of the ADSRs and LFOs by 30%)<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Sat Feb 22, 2014 12:37 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[yogi]]></name></author>
<updated>2014-02-22T11:50:21-07:00</updated>
<published>2014-02-22T11:50:21-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125891#p125891</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125891#p125891"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125891#p125891"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Weird. The original frequency was already just 7kHz, I'm surprised dropping it to 40Hz helped things (as opposed to, say, simply reducing the strength of the bias resistor). Or maybe the extra capacitive load did something. That large of a capacitance should definitely drop the effective frequency of the crystal, though. (How do 22pF and 370pF compare to the parallel parasitic capacitance of the crystal?)<br /></div><br />My observation with the original RC osc (no Xtal in circuit) measured  @ ~16MHz. In the early stages of my poking, I had tried a 10M with the 22pf value but it had the same problems as stated earlier. After reading the Pat.; just increasing C to ~30pF started it running without the HCT14 gate. <br />  I then began increasing C in the free running circuit till I lowered F to the range of 10MHz. <br />  I haven't seem a major deviation of the Xtal F, in the range of 5-10 KHz lower than the printed F on the Xtal. This could be due , as you point out to the C, or the cal on my DMM or the tolerance of the Xtals I pulled out of my junk box <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" />  Some test Xtals are long ago pulls from radios, and I have no idea on the specs, only the marked Freq and that is down to only 2 decimal places. The only 'known' spec is the 16MHz one, 20pf load cap AT cut, which measured spot on.<br />  Initially, I was assuming this circuit was close to the Pierce but I'm doubting that a little. Of course, may see different performance on a proper layout.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Hm. I wonder. Page 19 of the translated OPNA datasheet shows there's a selectable clock divider of 2,3, or 6 for the FM synth, but I'm not certain what else that changes. After all, the OPNA contains its own DAC, so there's no minimum clock speed to hold a serial bitstream. Anyway, when at a divider of 6 (claimed necessary for behavior above 4MHz), the output sample clock is Mclk/144. (Much like the OPL3's is Mclk/288, or the OPL2's is Mclk/72).<br /><br />Beyonds changing the necessary tuning tables, this will also slightly affect ADSR rates, the timers, and the various free-running LFOs (e.g. &quot;AMS&quot; and &quot;PMS&quot;). Not certain exactly what they're using, since their rates don't seem to be tunable.<br /><br />If we can extrapolate from the OPL3, the FM LFO is fixed at Sclk÷8192, and the AM LFO is fixed at Sclk÷13440. (MESS says these magic numbers are shared with the rest of the OPLx family, but who knows if that's true for the OPNx. Apparently the OPMx family can actually control the LFOs!)<br /></div><br /> I've only just started digging into the DS. But Is there a real need to maintain Sega's clk selection? With a 'new' design would there be an advantage to replicating Saga's HW? Would people want to use Saga VGM patches on a NES platform, sounds kind'of cool but IDK.<br />Yogi<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6258">yogi</a> — Sat Feb 22, 2014 11:50 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Jarhmander]]></name></author>
<updated>2014-02-22T09:52:34-07:00</updated>
<published>2014-02-22T09:52:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125879#p125879</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125879#p125879"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125879#p125879"><![CDATA[
<div class="quotetitle">tepples wrote:</div><div class="quotecontent"><br /><div class="quotetitle">lidnariq wrote:</div><div class="quotecontent">- Many DACs annoyingly require a clock input at 256 times the sample rate.<br /></div><br />I wonder whether that has anything to do with using a narrower (or even 1-bit) DAC and dithering to push the quantization noise into ultrasound. This is, for example, why SACD uses a sample rate of 64*CD.</div><br />Probably, these are almost certainly sigma-delta DAC.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=336">Jarhmander</a> — Sat Feb 22, 2014 9:52 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2014-02-22T09:07:00-07:00</updated>
<published>2014-02-22T09:07:00-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125877#p125877</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125877#p125877"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125877#p125877"><![CDATA[
<div class="quotetitle">lidnariq wrote:</div><div class="quotecontent"><br />- Many DACs annoyingly require a clock input at 256 times the sample rate.<br /></div><br />I wonder whether that has anything to do with using a narrower (or even 1-bit) DAC and dithering to push the quantization noise into ultrasound. This is, for example, why SACD uses a sample rate of 64*CD.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Sat Feb 22, 2014 9:07 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2014-02-21T23:07:56-07:00</updated>
<published>2014-02-21T23:07:56-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125855#p125855</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125855#p125855"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125855#p125855"><![CDATA[
<div class="quotetitle">yogi wrote:</div><div class="quotecontent"><br />Turned out it was a matter of the free running RC OSC needing to be lower; Increased my R to 10M and C to 370pF got the Xtal circuit running in the 16 MHz range <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /> My values aren't optimized; just happy it's running.<br /></div> Weird. The original frequency was already just 7kHz, I'm surprised dropping it to 40Hz helped things (as opposed to, say, simply reducing the strength of the bias resistor). Or maybe the extra capacitive load did something. That large of a capacitance should definitely drop the effective frequency of the crystal, though. (How do 22pF and 370pF compare to the parallel parasitic capacitance of the crystal?)<br /><div class="quotetitle">yogi wrote:</div><div class="quotecontent"><br />On a side note, I located the Yamaha datasheet for the YM2608 (the parent of the YM2612; the same FM core). the Interesting thing I found is it's nominal Master CLK is 8MHz, so I think Sega just under-clocked it, based on the chosen system clock. So, could use a standard 8 MHz can; but it may be better to maintain compatibility with Sega VGM values?<br /></div>Hm. I wonder. Page 19 of the translated OPNA datasheet shows there's a selectable clock divider of 2,3, or 6 for the FM synth, but I'm not certain what else that changes. After all, the OPNA contains its own DAC, so there's no minimum clock speed to hold a serial bitstream. Anyway, when at a divider of 6 (claimed necessary for behavior above 4MHz), the output sample clock is Mclk/144. (Much like the OPL3's is Mclk/288, or the OPL2's is Mclk/72).<br /><br />Beyonds changing the necessary tuning tables, this will also slightly affect ADSR rates, the timers, and the various free-running LFOs (e.g. &quot;AMS&quot; and &quot;PMS&quot;). Not certain exactly what they're using, since their rates don't seem to be tunable.<br /><br />If we can extrapolate from the OPL3, the FM LFO is fixed at Sclk÷8192, and the AM LFO is fixed at Sclk÷13440. (MESS says these magic numbers are shared with the rest of the OPLx family, but who knows if that's true for the OPNx. Apparently the OPMx family can actually control the LFOs!)<br />----------------------<br /><div class="quotetitle">infiniteneslives wrote:</div><div class="quotecontent"><br />I²S?  or I²C?  Granted I didn't look too hard, but digikey turned up a I²S DAC for $1.50, and I²C for ~$0.60.<br /></div>I²S. I²C can't maintain the necessary bandwidth (at least 2+3×9=29 bittimes per sample, so 1.4Mbit/s). But let's drop this, for the other reasons you laid out.<br /><div class="quotetitle">lidnariq wrote:</div><div class="quotecontent"><br />Then again, new old stock or working pulls of the YMF262 (OPL3) are also about the same cost as the YM3812 on ebay, and <em>its</em> DAC [YAC512] looks to be usually cheaper than the OPL3.<br /></div>Gluing these two trains of though together, I thought I'd go ahead and compare the bitstreams we're talking about here:<br /><br />YM3014 (OPL2 DAC) input format<br />- 16 clocks per sample (800kHz)<br />- monaural<br />- falling edge of word clock marks end of word<br />- three idle bit periods per word (650kbit/s)<br />- UNsigned, LITTLE endian, µ-law-like<br /><br />YMF262 (OPL3) output format<br />- 18 clocks per sample (1.79MHz)<br />- two channels interleaved per data line, two data lines, nominally quadraphonic<br />- two word clock lines, falling edge marks end of word<br />- two idle bit periods per word (3.2Mbit/s)<br />- UNsigned, LITTLE endian, PCM<br /><br />I²S stream<br />- any number of clocks per sample, but many receivers require at least 8<br />- two channels interleaved per data line<br />- word clock toggles on bit before end of word<br />- Signed, BIG endian<br />- Many DACs annoyingly require a clock input at 256 times the sample rate.<br /><br /><br />And one even bigger tangent: Since the OPL3 doesn't really support &quot;useful&quot; quadraphonics (each voice can either be mixed or skipped for each output channel), I thought it would be nifty to have controllable VCFs on the DACs' outputs, and downmix that all to mono. But a digitally controlled VCF should really be done all in DSP anyway, so that's really just a pipedream.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Fri Feb 21, 2014 11:07 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[yogi]]></name></author>
<updated>2014-02-21T17:11:43-07:00</updated>
<published>2014-02-21T17:11:43-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125846#p125846</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125846#p125846"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125846#p125846"><![CDATA[
<div class="quotetitle">lidnariq wrote:</div><div class="quotecontent"><br /><div class="quotetitle">yogi wrote:</div><div class="quotecontent">The only way I can couple to the  /2 FF is by running the /Q output through a HCT14 inverter gate.<br />[…]<br />If I directly couple the output to the CP input of the /2 stage, as per the patent doc, I see the 2MHz signal at its outputs with no division. Inputting a higher drive level signal (my 3.58MHz HCT14 osc) to the divider works fine.<br /></div>Hm. What kind of voltage swing are you seeing on /Q?<br />The only guess I have is maybe HCT voltage thresholds are inappropriate for cascading here, so this might only work with 74HC or 74AC gates. The datasheet seems to indicate a schmidt trigger input on the clock lines, though, so I'm not clear why the separate schmidt trigger inverter would work while the integrated one wouldn't.<br /><br />I was going to initially suspect loading, and suggest replacing the '14 buffer with a large resistor ... but that would have stopped the oscillator, not the ÷2.<br />You might also be able to use a large resistor divider to move the center voltage of oscillation ... but that won't help if the amplitude is too low.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Also, with the osc running I can see the 2MHz signal at the /Q - Xtal node but not at the Q output; I thought that this should  be oscillating also, due to the /Q-Reset oscillations, strange.<br /></div>Unfortunately when using the half of the 7474 as an oscillator we don't get SR latch behavior anymore: Q (per the truth table above) will remain high.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />So it seems to work in this 2chip solution but would be nice to have only 1 chip.<br /></div>Bad comes to worse, we could use a 74'1G14. (It's as cheap as a single MOSFET anyway)</div><br />(I ninja-ed your post editing my last post above.) <br />Turned out it was a matter of the free running RC OSC needing to be lower; Increased my R to 10M and C to 370pF got the Xtal circuit running in the  16 MHz range <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" />  My values aren't optimized; just happy it's running.<br />  On a side note, I located the Yamaha datasheet for the YM2608 (the parent of the YM2612; the same FM core). the Interesting thing I found is it's nom Master CLK is 8MHz, so I think Sega just under-clocked it, based on the chosen system clock. So, could use a standard 8 MHz can; but it may be better to maintain compatibility with Sega VGM values?<br />Yogi<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6258">yogi</a> — Fri Feb 21, 2014 5:11 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[lidnariq]]></name></author>
<updated>2014-02-21T16:11:43-07:00</updated>
<published>2014-02-21T16:11:43-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125843#p125843</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125843#p125843"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125843#p125843"><![CDATA[
<div class="quotetitle">yogi wrote:</div><div class="quotecontent"><br />The only way I can couple to the  /2 FF is by running the /Q output through a HCT14 inverter gate.<br />[…]<br />If I directly couple the output to the CP input of the /2 stage, as per the patent doc, I see the 2MHz signal at its outputs with no division. Inputting a higher drive level signal (my 3.58MHz HCT14 osc) to the divider works fine.<br /></div>Hm. What kind of voltage swing are you seeing on /Q?<br />The only guess I have is maybe HCT voltage thresholds are inappropriate for cascading here, so this might only work with 74HC or 74AC gates. The datasheet seems to indicate a schmidt trigger input on the clock lines, though, so I'm not clear why the separate schmidt trigger inverter would work while the integrated one wouldn't.<br /><br />I was going to initially suspect loading, and suggest replacing the '14 buffer with a large resistor ... but that would have stopped the oscillator, not the ÷2.<br />You might also be able to use a large resistor divider to move the center voltage of oscillation ... but that won't help if the amplitude is too low.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Also, with the osc running I can see the 2MHz signal at the /Q - Xtal node but not at the Q output; I thought that this should  be oscillating also, due to the /Q-Reset oscillations, strange.<br /></div>Unfortunately when using the half of the 7474 as an oscillator we don't get SR latch behavior anymore: Q (per the truth table above) will remain high.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />So it seems to work in this 2chip solution but would be nice to have only 1 chip.<br /></div>Bad comes to worse, we could use a 74'1G14. (It's as cheap as a single MOSFET anyway)<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3512">lidnariq</a> — Fri Feb 21, 2014 4:11 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[yogi]]></name></author>
<updated>2014-02-21T16:19:04-07:00</updated>
<published>2014-02-21T09:25:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125811#p125811</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125811#p125811"/>
<title type="html"><![CDATA[Re: MMC1,2,3,4/Sunsoft-5B reproduction circuit boards. INL-R]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=8808&amp;p=125811#p125811"><![CDATA[
<div class="quotetitle">lidnariq wrote:</div><div class="quotecontent"><br />google provides this link from the image in the patent: <!-- m --><a class="postlink" href="http://patentimages.storage.googleapis.com/pages/US4980655-1.png">http://patentimages.storage.googleapis. ... 0655-1.png</a><!-- m --><br /><br />The patent looks like it expired in 2003 due to failure to pay maintenance fees. It should have expired in 2007 regardless.<br /></div><br /><br />Well good news and bad news. <br />First: I'm using HCT74s, R=1M, C=22pF<br />The first tests I've run are on solderless proto boards so there is a lot of stray C, but with a 2MHz xtal the Osc side does start up fine. The only way I can couple to the  /2 FF is by running the /Q output through a HCT14 inverter gate. Also, with the osc running I can see the 2MHz signal at the /Q - Xtal node but not at the Q output; I thought that this should  be oscillating also, due to the /Q-Reset oscillations, strange. <br />  If I directly couple the output to the CP input of the /2 stage, as per the patent doc, I see the 2MHz signal at it's outputs with no division. Inputting a higher drive level signal (my 3.58MHz HCT14 osc) to the divider works fine.<br /> Moving on to a 8MHz and then a 16MHz xtal worked as per above (had to set up a second HCT 74 as a /4 prescaler; my DMM F counter tops out at 4MHz.) So it seems to work in this 2chip solution but would be nice to have only 1 chip.<br /> So I will be trying to adjust the feedback R values to get better drive out of the osc and eliminate the HCT 14 gate.<br />Yogi<br />EDIT <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /> YEA! After doing a better search and reading the Patent, I got a little better understanding of the operation. <br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />The resistance of R1 and the capacitance of C1 are selected such that the time constant R1C1 is much longer than the time for one half cycle of the crystal's resonant frequency.<br /></div><br /> This is somewhat flexible from my tests , the patent circuit ran with a verity of 14 through 16 MHz xtals; using the combo of  C=370pF and R=10M. A NOT gate was <span style="text-decoration: underline">not</span> needed! <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=6258">yogi</a> — Fri Feb 21, 2014 9:25 am</p><hr />
]]></content>
</entry>
</feed>