<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - OAM/DMC DMA tests</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="https://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="https://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="https://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="https://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="https://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - NESemdev" href="https://forums.nesdev.com/feed.php?f=3" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - OAM/DMC DMA tests" href="https://forums.nesdev.com/feed.php?f=3&amp;t=14120" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '3');
	var per_page = '15';
	var base_url = './viewtopic.php?f=3&amp;t=14120';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<!--<div style="float: right;">
					<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick">
					<input type="hidden" name="hosted_button_id" value="X2HM4WNR5YT8S">
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
					<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
					</form>
				</div>-->
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=minion"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Fri Aug 17, 2018 1:53 am<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=3">NESemdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />
	

					<center>
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- NesDev Forums -->
					<ins class="adsbygoogle"
						 style="display:block"
						 data-ad-client="ca-pub-7801010229099644"
						 data-ad-slot="7979066809"
						 data-ad-format="auto"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>
					</center>
	<br />


<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=3&amp;t=14120&amp;start=30">OAM/DMC DMA tests</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=3"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=3&amp;t=14120"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>3</strong> of <strong>3</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 40 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to page…">Go to page</a> <a href="./viewtopic.php?f=3&amp;t=14120&amp;start=15">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=3&amp;t=14120">1</a><span class="page-sep">, </span><a href="./viewtopic.php?f=3&amp;t=14120&amp;start=15">2</a><span class="page-sep">, </span><strong>3</strong></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=3&amp;t=14120&amp;start=30&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=3&amp;t=14120&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=3&amp;t=14120&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p169353"></a>
				<b class="postauthor">Drag</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p169353">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=169353#p169353"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Apr 24, 2016 8:43 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Sep 27, 2004 2:57 pm<br /><b>Posts:</b> 1249
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I see! I thought the CPU's clock signal was also used for the logic, but considering rams and roms aren't synchronous, they don't need to know the CPU's clock, and same with the controller ports. It makes sense now, thanks!</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=21"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p169367"></a>
				<b class="postauthor">fred</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p169367">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=169367#p169367"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Apr 25, 2016 1:52 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri Dec 30, 2011 7:15 am<br /><b>Posts:</b> 44<br /><b>Location:</b> Sweden
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I didn't think about the fact that INC 4014 also reads from 4014, hah. What's the expected return value? Visual2A03 returns whatever was written there last, but is this an &quot;open bus&quot; case?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=5139"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p169371"></a>
				<b class="postauthor">cpow</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p169371">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=169371#p169371"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Apr 25, 2016 6:48 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">NESICIDE developer</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3705.png" width="100" height="60" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Oct 13, 2008 7:55 pm<br /><b>Posts:</b> 1060<br /><b>Location:</b> Minneapolis, MN
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I tested DEC -- and posted about it long ago. Not INC, but similar behavior.<br /><br /><!-- l --><a class="postlink-local" href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=9033&amp;hilit=+Visual2A03">viewtopic.php?f=3&amp;t=9033&amp;hilit=+Visual2A03</a><!-- l --><br /><br />The RDY is triggered by the first write but the address given to the DMA engine is based on the second write -- which in INC and DEC case happens to be the &quot;result write&quot;. The &quot;dummy write&quot; is the first one because the CPU needs a cycle to do the increment/decrement of A.<br /><br />However, having said all of that, I just went back through my programs and adjusted the URL to accomodate the new location of the simulator.<br /><br />Something's changed/BROKEN? The program I used in the above post provides DIFFERENT RESULTS than what I reported back then??<br /><br /><a href="http://www.qmtpro.com/~nes/chipimages/visual2a03/index.html?a=fffe&amp;d=40&amp;a=fffc&amp;d=0&amp;a=0&amp;d=58a9c08d1740a9018d1340a98f8d1040a9108d1540a901a200de14408d144010fe&amp;logmore=c_rdy&amp;graphics=false" class="postlink">This is the program</a>.<br /><br />The difference? The original post shows the sprite DMA occurring from the DEC result address ($FF00...). But the new simulator shows the sprite DMA occurring from the DEC dummy address ($0000...).<br /><br />What? The earlier result didn't confuse me because it made sense. This one confuses me because it doesn't!</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3705"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p169373"></a>
				<b class="postauthor">thefox</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p169373">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=169373#p169373"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Apr 25, 2016 7:20 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=80.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Jan 03, 2005 10:36 am<br /><b>Posts:</b> 3110<br /><b>Location:</b> Tampere, Finland
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">cpow wrote:</div><div class="quotecontent">The difference? The original post shows the sprite DMA occurring from the DEC result address ($FF00...). But the new simulator shows the sprite DMA occurring from the DEC dummy address ($0000...).</div><br />I think there's a bug that it's forcing the OAM source address to $00. Probably just coincidental that it happens to be the DEC dummy address, would be better to DEC a non-zero value. (I'm not sure if Visual 2A03 is mapping readable RAM under the $4014 address, might be hard to change the value if not.)</div>

					
						<div class="postbody"><br />_________________<br /><span style="font-size: 85%; line-height: normal">Download STREEMERZ for NES from <a href="http://www.fauxgame.com" class="postlink">fauxgame.com</a>! — Some other stuff I've done: <a href="https://fo.aspekt.fi/" class="postlink">fo.aspekt.fi</a></span></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=80"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p169376"></a>
				<b class="postauthor">cpow</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p169376">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=169376#p169376"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Apr 25, 2016 7:38 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">NESICIDE developer</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3705.png" width="100" height="60" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Oct 13, 2008 7:55 pm<br /><b>Posts:</b> 1060<br /><b>Location:</b> Minneapolis, MN
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">thefox wrote:</div><div class="quotecontent">I think there's a bug that it's forcing the OAM source address to $00. Probably just coincidental that it happens to be the DEC dummy address, would be better to DEC a non-zero value. (I'm not sure if Visual 2A03 is mapping readable RAM under the $4014 address, might be hard to change the value if not.)</div><br />Confirmed with <a href="http://www.qmtpro.com/~nes/chipimages/visual2a03/index.html?a=fffe&amp;d=40&amp;a=fffc&amp;d=0&amp;a=0&amp;d=58a9c08d1740a9018d1340a98f8d1040a9108d1540a901a202de14408d144010fe&amp;logmore=c_rdy&amp;graphics=false" class="postlink">this program</a> that attempts to DEC sprite DMA with A set to $02. Instead of DMAing from $01xx... the simulator DMAs from $00xx...<br /><br />This is a new bug because clearly the DMAing previously worked as I described in the simulator. With $00 in A the DMAing occurred from $FF..</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3705"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p169379"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p169379">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=169379#p169379"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Apr 25, 2016 8:34 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">There's other bugs with the OAM DMA, too.  If the DMC cuts in during the OAM DMA, it mangles the OAM source address, possibly adding or removing reads.  I had one OAM DMA run over 700 cycles because the DMC would interrupt and move the OAM source back like $40 places</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p169380"></a>
				<b class="postauthor">cpow</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p169380">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=169380#p169380"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Apr 25, 2016 9:04 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">NESICIDE developer</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3705.png" width="100" height="60" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Oct 13, 2008 7:55 pm<br /><b>Posts:</b> 1060<br /><b>Location:</b> Minneapolis, MN
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Disch wrote:</div><div class="quotecontent">There's other bugs with the OAM DMA, too.  If the DMC cuts in during the OAM DMA, it mangles the OAM source address, possibly adding or removing reads.  I had one OAM DMA run over 700 cycles because the DMC would interrupt and move the OAM source back like $40 places</div><br /><br />I've confirmed there are indeed &quot;other bugs&quot; but they are &quot;new bugs&quot; not &quot;always there bugs.<br /><br />RE my DMC DMA during Sprite DMA testing, <a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=9009&amp;hilit=+Visual2A03" class="postlink">discussed here</a>, the DMC DMA occurs on cycles 40 and 822. In the latest simulator the <a href="http://www.qmtpro.com/~nes/chipimages/visual2a03/index.html?a=fffe&amp;d=40&amp;a=fffc&amp;d=0&amp;a=0&amp;d=58a9c08d1740a9018d1340a98f8d1040a9108d1540a9018d14408d144010fe&amp;logmore=c_rdy" class="postlink">same program</a> has a DMC DMA at cycle 38, 1404, 1836, and 2268. So it seems the engine skips a couple of cycles but then &quot;rights itself&quot;?!?<br /><br />Additionally, I noticed that previously the DMA cycles were two half-cycles of the same &quot;clock cycle&quot;. In other words, the DMA occurs on both half-cycles of CPU cycle 40. In the new simulation it's like this:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">39&nbsp; &nbsp;0017&nbsp; &nbsp;8d&nbsp; &nbsp;1&nbsp; &nbsp;STA&amp;nbsp;Abs&nbsp; &nbsp;0018&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209Bdizc&nbsp; &nbsp;1<br />39&nbsp; &nbsp;c000&nbsp; &nbsp;00&nbsp; &nbsp;1&nbsp; &nbsp;BRK&nbsp; &nbsp;0018&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209Bdizc&nbsp; &nbsp;0<br />38&nbsp; &nbsp;c000&nbsp; &nbsp;00&nbsp; &nbsp;1&nbsp; &nbsp;BRK&nbsp; &nbsp;0018&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209Bdizc&nbsp; &nbsp;0<br />38&nbsp; &nbsp;0017&nbsp; &nbsp;8d&nbsp; &nbsp;1&nbsp; &nbsp;STA&amp;nbsp;Abs&nbsp; &nbsp;0018&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209Bdizc&nbsp; &nbsp;0</div><br /><br />The DMC DMA occurs on one half-cycle of CPU cycle 38 and one half-cycle of CPU cycle 39. I'm not sure which way is properly representative of what actually happens, but something VERY strange in that it's now *different*.<br /><br />Here's what it looked like originally:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">39&nbsp; &nbsp;0018&nbsp; &nbsp;14&nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; 0019&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv-Bdizc&nbsp; &nbsp;0<br />39&nbsp; &nbsp;0018&nbsp; &nbsp;14&nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; 0019&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv-Bdizc&nbsp; &nbsp;0<br />40&nbsp; &nbsp;c000&nbsp; &nbsp;00&nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; 0019&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv-Bdizc&nbsp; &nbsp;0<br />40&nbsp; &nbsp;c000&nbsp; &nbsp;00&nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; 0019&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv-Bdizc&nbsp; &nbsp;0<br />41&nbsp; &nbsp;0018&nbsp; &nbsp;14&nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; 0019&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv-Bdizc&nbsp; &nbsp;1<br />41&nbsp; &nbsp;0018&nbsp; &nbsp;14&nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; 0019&nbsp; &nbsp;01&nbsp; &nbsp;c0&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv-Bdizc&nbsp; &nbsp;1</div><br /><br />RE the simulator crashing, have you hidden the chip display? It runs much faster when not bothering with that, but still slows down once I get to ~800 cycles. But no crash.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3705"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p169381"></a>
				<b class="postauthor">Disch</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p169381">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=169381#p169381"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Apr 25, 2016 9:23 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=33.png" width="65" height="75" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Nov 10, 2004 6:47 pm<br /><b>Posts:</b> 1849
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I got the crashing problem sorted a while ago.<br /><br />Also it looks like Visual2a03 has had this OAM problem since at least November, as in the thread you linked, thefox mentions he's having the same problem when he tried to reproduce your tests.<br /><br />Anyway, cpow, were you ever able to test what happens when DMC DMA occurs on the last few cycles of OAM?  That's really the last piece of the puzzle as far as I can tell.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=33"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p169384"></a>
				<b class="postauthor">cpow</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p169384">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=169384#p169384"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Apr 25, 2016 9:52 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">NESICIDE developer</td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3705.png" width="100" height="60" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Oct 13, 2008 7:55 pm<br /><b>Posts:</b> 1060<br /><b>Location:</b> Minneapolis, MN
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Disch wrote:</div><div class="quotecontent">Anyway, cpow, were you ever able to test what happens when DMC DMA occurs on the last few cycles of OAM?  That's really the last piece of the puzzle as far as I can tell.</div><br />I'm not confident in the simulator given the recent observations. I'll wait until it's &quot;fixed&quot;. If ever. Too bad.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3705"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p174426"></a>
				<b class="postauthor">Alyosha_TAS</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p174426">Re: OAM/DMC DMA tests</a></div><div style="float: right;"><a href="./viewtopic.php?p=174426#p174426"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Jun 28, 2016 5:27 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Jun 15, 2016 11:49 am<br /><b>Posts:</b> 69
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Hi,<br /><br />I am working on DMC DMA currently and found this thread immensely helpful, thanks for all the wealth of knowledge.<br /><br />I do have a question though about something Disch wrote in his dropbox notes in the opening post of this thread:<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">;   LDX starts at cycle 8 (after reset)<br />;   $4015 write happens on cycle 23<br />;   first DMA takes 3 cycles @ 26, 27, 28  (ignoring this because<br />;       APU hasn't fully primed yet apparently)</div><br /><br />I found this interesting, so I did a test on Visual 2A03. Instead of performing STA $4015 early on, I performed it on cycle 1400 (where the second DMC DMA usually occurs in Disch's code. )<br /><br />The result is also 3 DMA cycles instead of the normal 4:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">cycle&nbsp; &nbsp;ab&nbsp; &nbsp;db&nbsp; &nbsp;rw&nbsp; &nbsp;Fetch&nbsp; &nbsp;pc&nbsp; &nbsp;a&nbsp; &nbsp;x&nbsp; &nbsp;y&nbsp; &nbsp;s&nbsp; &nbsp;p&nbsp; &nbsp;c_rdy<br />1406&nbsp; &nbsp;0089&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;NOP&nbsp; &nbsp;0089&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1406&nbsp; &nbsp;0089&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0089&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1405&nbsp; &nbsp;0089&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0089&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1405&nbsp; &nbsp;0088&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;NOP&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1404&nbsp; &nbsp;0088&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;NOP&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1404&nbsp; &nbsp;0088&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1403&nbsp; &nbsp;0088&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1403&nbsp; &nbsp;c000&nbsp; &nbsp;00&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;0&nbsp; <br />1402&nbsp; &nbsp;c000&nbsp; &nbsp;00&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;0&nbsp; vvvvv three dead cycles instead of usual 4<br />1402&nbsp; &nbsp;0088&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;0<br />1401&nbsp; &nbsp;0088&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;0<br />1401&nbsp; &nbsp;0088&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;0<br />1400&nbsp; &nbsp;0088&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0088&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1400&nbsp; &nbsp;0087&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;NOP&nbsp; &nbsp;0087&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1&nbsp; ^^^^ Dummy read<br />1399&nbsp; &nbsp;0087&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;NOP&nbsp; &nbsp;0087&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1399&nbsp; &nbsp;0087&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0087&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1398&nbsp; &nbsp;0087&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0087&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1398&nbsp; &nbsp;0086&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;NOP&nbsp; &nbsp;0086&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1397&nbsp; &nbsp;0086&nbsp; &nbsp;ea&nbsp; &nbsp;1&nbsp; &nbsp;NOP&nbsp; &nbsp;0086&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1397&nbsp; &nbsp;4015&nbsp; &nbsp;1f&nbsp; &nbsp;0&nbsp; &nbsp;&nbsp; &nbsp;0086&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1396&nbsp; &nbsp;4015&nbsp; &nbsp;40&nbsp; &nbsp;0&nbsp; &nbsp;&nbsp; &nbsp;0086&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1396&nbsp; &nbsp;0085&nbsp; &nbsp;40&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0085&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1395&nbsp; &nbsp;0085&nbsp; &nbsp;40&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0085&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1395&nbsp; &nbsp;0084&nbsp; &nbsp;15&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0084&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1394&nbsp; &nbsp;0084&nbsp; &nbsp;15&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0084&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1394&nbsp; &nbsp;0083&nbsp; &nbsp;8d&nbsp; &nbsp;1&nbsp; &nbsp;STA&amp;nbsp;Abs&nbsp; &nbsp;0083&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1393&nbsp; &nbsp;0083&nbsp; &nbsp;8d&nbsp; &nbsp;1&nbsp; &nbsp;STA&amp;nbsp;Abs&nbsp; &nbsp;0083&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1<br />1393&nbsp; &nbsp;0083&nbsp; &nbsp;8d&nbsp; &nbsp;1&nbsp; &nbsp;&nbsp; &nbsp;0083&nbsp; &nbsp;1f&nbsp; &nbsp;a2&nbsp; &nbsp;00&nbsp; &nbsp;bd&nbsp; &nbsp;nv&amp;#8209BdIzc&nbsp; &nbsp;1</div><br /><br />Could it be that DMC DMA's are seperately triggered by writes to $4015 and the DMC bits remaining counter reaching zero? The latter seems to take 4 cycles, but does the former take 3?<br /><br />I also noticed a few cycles between when the write occurs and when the DMA starts, a few NOPs worth actually.<br /><br />So is this behaviour correct? I am trying to get sprdma_and_dmc_dma test to pass but I cannot for the life of me make it work. I always end up with exactly 1 more cycle happening for each step then I should. I think this is the reason but am not sure how to implement it.<br /><br />Any more experienced people have any ideas?<br /><br />Thanks!<br /><br />EDIT: I implemented this behaviour and now pass sprdma_and_dmc_dma perfectly. I a pretty confident it is correct.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7612"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=3&amp;t=14120&amp;start=30"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=3"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=3&amp;t=14120"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>3</strong> of <strong>3</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 40 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to page…">Go to page</a> <a href="./viewtopic.php?f=3&amp;t=14120&amp;start=15">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=3&amp;t=14120">1</a><span class="page-sep">, </span><a href="./viewtopic.php?f=3&amp;t=14120&amp;start=15">2</a><span class="page-sep">, </span><strong>3</strong></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=3">NESemdev</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 3 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="14120" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3" selected="selected">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="34">&nbsp; &nbsp;&nbsp; &nbsp;2018 NESdev Competition</option>
		
			<option value="33">&nbsp; &nbsp;&nbsp; &nbsp;2017 NESdev Competition</option>
		
			<option value="32">&nbsp; &nbsp;&nbsp; &nbsp;2016 NESdev Competition</option>
		
			<option value="31">&nbsp; &nbsp;&nbsp; &nbsp;2014 NESdev Competition</option>
		
			<option value="30">&nbsp; &nbsp;&nbsp; &nbsp;2011 NESdev Competition</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;&nbsp; &nbsp;Reproduction</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="11">&nbsp; &nbsp;&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="12">&nbsp; &nbsp;&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;&nbsp; &nbsp;GBDev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>


<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>