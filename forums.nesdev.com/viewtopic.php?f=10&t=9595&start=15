<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - How to do multiple things at once?</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Newbie Help Center" href="http://forums.nesdev.com/feed.php?f=10" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - How to do multiple things at once?" href="http://forums.nesdev.com/feed.php?f=10&amp;t=9595" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '2');
	var per_page = '15';
	var base_url = './viewtopic.php?f=10&amp;t=9595';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=register"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Sat Sep 20, 2014 3:38 pm<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=10">Newbie Help Center</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />

<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=10&amp;t=9595&amp;start=15">How to do multiple things at once?</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=10"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=10&amp;t=9595"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>2</strong> of <strong>4</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 56 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=10&amp;t=9595&amp;start=0">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=10&amp;t=9595">1</a><span class="page-sep">, </span><strong>2</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=10&amp;t=9595&amp;start=30">3</a><span class="page-sep">, </span><a href="./viewtopic.php?f=10&amp;t=9595&amp;start=45">4</a> &nbsp;<a href="./viewtopic.php?f=10&amp;t=9595&amp;start=30">Next</a></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=10&amp;t=9595&amp;start=15&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=10&amp;t=9595&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=10&amp;t=9595&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p104402"></a>
				<b class="postauthor" style="color: #AA0000">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104402">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104402#p104402"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 7:22 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_online.gif" alt="Online" title="Online" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 12423<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">FinalZero wrote:</div><div class="quotecontent">Do NTSC and PAL NES's have different hardware?</div><br />Yes. There are three major types of PPU in authentic consoles: NTSC PPU 2C02, used in the Famicom and NTSC NES; PAL PPU 2C07, used in the PAL NES (region A) and PAL NES (region B); and the RGB PPU 2C03, used in PlayChoice-10, Famicom Titler, and a few TVs with a built-in Famicom. The 2C03 has the same timing (in the NTSC vs. PAL sense) as the 2C02, but the signal is RGB component instead of composite so that it can be used with arcade monitors.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The NES doesn't read something from the television, does it?</div><br />The only time the NES can read something from the television is when a Zapper is plugged in. The Zapper can see dark and light, and it can see up and down. It uses that to see which duck you shot by making each duck bright in sequence. Otherwise, the video output is <a href="https://en.wikipedia.org/wiki/Open-loop_controller" class="postlink">open-loop</a>: the TV sends nothing back to the NES.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">And in SMB3, where you can go backwards and forwards through the stage, it must also remember whether the enemy is dead (so don't spawn it again).</div><br />Super Mario Bros. 2 and 3 have expansion RAM at $6000-$7FFF. Destruction buffers for blocks, coins, enemies, and the like are stored in RAM.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">What's the difference between a vblank and a frame? I thought that both happened 60 or 50 times per second.</div><br />Active picture time (or &quot;draw&quot;) is 240 scanlines; <a href="https://en.wikipedia.org/wiki/Vertical_blanking_interval" class="postlink">vertical blanking time</a> (or &quot;vblank&quot;) is 22 scanlines on NTSC and RGB. I'm guessing in some terminologies, the &quot;frame&quot; refers only to draw; in others, it refers to both draw and the vblank after it, and in still others, it refers to vblank and the draw after it.<br /><br />The code that runs during draw prepares buffers that will be copied to the PPU during vblank. writePictureToTV() copies these buffers so that the PPU can start using them by the next draw.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p104403"></a>
				<b class="postauthor">blargg</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104403">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104403#p104403"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 7:38 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=17.gif" width="60" height="69" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Sep 27, 2004 8:33 am<br /><b>Posts:</b> 3711<br /><b>Location:</b> Central Texas, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">The PPU is the master timebase for video; the TV locks on to its timing. This way the PPU can just output the signal and not need anything back from the TV.<br /><br />The game writes to PPU memory, and then the PPU reads this when it's generating the video frame signal output. Even if the game doesn't touch the PPU for a while, the PPU is still regularly generating video frames for the TV on its own.<br /><br />Games can't generally write to PPU memory while the PPU is reading, which is does for most of the frame. Since the TV needs time to move its electron gun back to the top of the screen, there is a blanking period (VBL). This is also a time the PPU isn't reading from any memory, so the game writes during this period. The NMI occurs when this blanking begins, so most games update sprites and background in NMI.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=17"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p104405"></a>
				<b class="postauthor">tokumaru</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104405">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104405#p104405"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 7:51 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=95.png" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Feb 12, 2005 9:43 pm<br /><b>Posts:</b> 6693<br /><b>Location:</b> Rio de Janeiro - Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">FinalZero wrote:</div><div class="quotecontent">In theory then, if I ran SMB instruction by instruction, I should see each object move one at a time, right?</div><br />You will see that the object's coordinates have changed if you look at specific bytes in RAM, but you will not be able to see it on the screen because the picture will only be rendered after the states of all the objects have been updated.<br /><br /><div class="quotetitle">FinalZero wrote:</div><div class="quotecontent">So, the loop basically looks like this?:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">main() {<br />&nbsp; while(true) {<br />&nbsp; &nbsp; updateMario();<br />&nbsp; &nbsp; updateEnemy1();<br />&nbsp; &nbsp; updateEnemy2();<br />&nbsp; &nbsp; updateEnemy3();<br />&nbsp; &nbsp; updateMusic();<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; waitForVBlank();<br />&nbsp; &nbsp; resetVBlankCounter();<br />&nbsp; &nbsp; writePictureToTV();<br />&nbsp; }<br />}</div></div><br />Yeah, kinda. There are some things missing, such as &quot;updateCamera&quot;, and enemies are hardly hardcoded like that, iterating over an array of enemies would make more sense. Also, it usually isn't <strong>while(true)</strong> (infinite loop), because the program must be able to run other loops. Games often have different loops for different parts (title screens, menus, cutscenes, main engine, etc.), because different tasks must be performed for each of them. A &quot;game over&quot; for example should break that main game loop.<br /><br />As for music, sound is usually updated after &quot;writePictureToTV&quot;, because execution time varies less in the VBlank handler than in the main loop, and you want the time between calls to &quot;updateMusic&quot; to be as constant as possible, otherwise there will be noticeable sound distortion.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">How does writePictureToTV() work though? Does the PPU do that automatically?</div><br />Kinda. The PPU renders images to the screen (60 or 50 of them per second) automatically, but you have to manually set some parameters to tell the PPU <strong>what</strong> to draw. During VBlank (meaning that the point when you called &quot;writePictureToTV&quot; is correct) is the only time the CPU can freely set these PPU parameters: things like the positions of the sprites and the tiles and palettes they use, the tiles that form the background, and so on. The PPU will render a picture whether you change these parameters or not (if you don't, it will just render the same picture again).</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=95"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p104406"></a>
				<b class="postauthor">FinalZero</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104406">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104406#p104406"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 8:00 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4131.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Dec 03, 2009 7:27 am<br /><b>Posts:</b> 134
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">and it can see up and down</div><br />How?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Active picture time (or &quot;draw&quot;) is 240 scanlines; vertical blanking time (or &quot;vblank&quot;) is 22 scanlines on NTSC and RGB.</div><br />You know, it throws me off when you measure time in scanlines.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The code that runs during draw prepares buffers that will be copied to the PPU during vblank. writePictureToTV() copies these buffers so that the PPU can start using them by the next draw.</div><br />1) Where does it copy these buffers to and from?<br />2) When does the PPU actually start drawing? Does the PPU bypass the CPU and just draw automatically?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4131"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p104408"></a>
				<b class="postauthor">FinalZero</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104408">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104408#p104408"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 8:18 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4131.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Dec 03, 2009 7:27 am<br /><b>Posts:</b> 134
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The PPU is the master timebase for video; the TV locks on to its timing. This way the PPU can just output the signal and not need anything back from the TV.<br /><br />The game writes to PPU memory, and then the PPU reads this when it's generating the video frame signal output. Even if the game doesn't touch the PPU for a while, the PPU is still regularly generating video frames for the TV on its own.<br /><br />Games can't generally write to PPU memory while the PPU is reading, which is does for most of the frame. Since the TV needs time to move its electron gun back to the top of the screen, there is a blanking period (VBL). This is also a time the PPU isn't reading from any memory, so the game writes during this period. The NMI occurs when this blanking begins, so most games update sprites and background in NMI.</div><br />This is a good explanation, so I think that i get it now.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">You will see that the object's coordinates have changed if you look at specific bytes in RAM, but you will not be able to see it on the screen because the picture will only be rendered after the states of all the objects have been updated.</div><br />Right, I understand that now.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">As for music, sound is usually updated after &quot;writePictureToTV&quot;, because execution time varies less in the VBlank handler than in the main loop, and you want the time between calls to &quot;updateMusic&quot; to be as constant as possible, otherwise there will be noticeable sound distortion.</div><br />Ah, that makes sense, to reduce distortion.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Yeah, kinda. There are some things missing, such as &quot;updateCamera&quot;, and enemies are hardly hardcoded like that, iterating over an array of enemies would make more sense. Also, it usually isn't while(true) (infinite loop), because the program must be able to run other loops. Games often have different loops for different parts (title screens, menus, cutscenes, main engine, etc.), because different tasks must be performed for each of them. A &quot;game over&quot; for example should break that main game loop.</div><br />Okay, so it'd be more like this:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">main() {<br />&nbsp; if(state == isTitleScreen) {<br />&nbsp; &nbsp; ...<br />&nbsp; } else if(state == isInStage) {<br />&nbsp; &nbsp; updateMario();<br />&nbsp; &nbsp; updateEnemies();<br />&nbsp; &nbsp; updateCamera();<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; waitForVBlank();<br />&nbsp; &nbsp; resetVBlankCounter();<br />&nbsp; &nbsp; copyValuesToPPU();<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; updateMusic();<br />&nbsp; } else if(state == isEndScreen) &#91;<br />&nbsp; &nbsp; ...<br />&nbsp; } else if(state == ...) {<br />&nbsp; &nbsp; ...<br />&nbsp; }<br />}</div><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Kinda. The PPU renders images to the screen (60 or 50 of them per second) automatically, but you have to manually set some parameters to tell the PPU what to draw. During VBlank (meaning that the point when you called &quot;writePictureToTV&quot; is correct) is the only time the CPU can freely set these PPU parameters: things like the positions of the sprites and the tiles and palettes they use, the tiles that form the background, and so on. The PPU will render a picture whether you change these parameters or not (if you don't, it will just render the same picture again).</div><br />Okay, so the name that I gave to writePictureToTV() should actually be something like copyValuesToPPU(), because the PPU is not acually writing then, because the electron gun is scrolling back up. The PPU is actually writing to the screen when the CPU is computing updateMario(), updateEnemies(), updateCamera(), right?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4131"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p104410"></a>
				<b class="postauthor">blargg</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104410">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104410#p104410"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 8:23 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=17.gif" width="60" height="69" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Mon Sep 27, 2004 8:33 am<br /><b>Posts:</b> 3711<br /><b>Location:</b> Central Texas, USA
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">The PPU is its own processor of sorts, constantly generating one frame after another based on what's in PPU memory. The CPU can merely write to PPU memory and some control registers to alter this. If the CPU doesn't do any writes to PPU memory for a while, the PPU just keeps displaying whatever is currently in PPU memory.<br /><br />There is limited time for the CPU to write to PPU memory each frame, so most programs set aside some CPU RAM to hold the data to write on the next VBL, then quickly write it when the time comes. The programs can then set up the data in this buffer at their leisure</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=17"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p104411"></a>
				<b class="postauthor">tokumaru</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104411">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104411#p104411"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 8:28 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=95.png" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Feb 12, 2005 9:43 pm<br /><b>Posts:</b> 6693<br /><b>Location:</b> Rio de Janeiro - Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">FinalZero wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">and it can see up and down</div><br />How?</div><br />You can count the time it takes for the zapper to detect light from the start of VBlank. The longer it takes, the farther it is from the top.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">1) Where does it copy these buffers to and from?</div><br />OAM (i.e. sprite attributes) is copied from any page of memory ($XX00-$XXFF) to internal memory in the PPU with a sprite DMA. You tell the PPU which page to copy from and it does the whole thing. Alternatively, you can transfer one byte at a time from anywhere, but games don't usually do this because it's too slow (there wouldn't be time to update all sprites in a single VBlank).<br /><br />Everything else can be stored anywhere, and can be written to PPU memory anywhere, through registers $2006 and $2007. Palettes (visible at $3F00-$3FFF, everything past $3F1F being mirrors) are also inside the PPU, just like OAM. Pattern tables are visible at $0000-$1FFF, and are inside the cartridge (it can be ROM or RAM). Name/attribute tables are visible at $2000-$2FFF (mirroring varies), and are physically inside the NES, but it can also be inside the cartridge (so you can have more name tables than the NES alone can provide).<br /><br />During frame processing, games will buffer whatever they need to change in the PPU, and once Vblank starts, they transfer all the data. This is not done automatically, each game needs its own code to write data to the PPU.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">2) When does the PPU actually start drawing? Does the PPU bypass the CPU and just draw automatically?</div><br />It starts a frame automatically after VBlank, regardless of what the CPU is doing. This is why the screen glitches up if programs take too long to perform their video updates and leak into the visible frame. The PPU keeps going at a steady pace, it's the program running on the CPU that has to go through the trouble of keeping up.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=95"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p104412"></a>
				<b class="postauthor">tokumaru</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104412">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104412#p104412"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 8:45 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=95.png" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Feb 12, 2005 9:43 pm<br /><b>Posts:</b> 6693<br /><b>Location:</b> Rio de Janeiro - Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">FinalZero wrote:</div><div class="quotecontent">Okay, so it'd be more like this:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">main() {<br />&nbsp; if(state == isTitleScreen) {<br />&nbsp; &nbsp; ...<br />&nbsp; } else if(state == isInStage) {<br />&nbsp; &nbsp; updateMario();<br />&nbsp; &nbsp; updateEnemies();<br />&nbsp; &nbsp; updateCamera();<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; waitForVBlank();<br />&nbsp; &nbsp; resetVBlankCounter();<br />&nbsp; &nbsp; copyValuesToPPU();<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; updateMusic();<br />&nbsp; } else if(state == isEndScreen) &#91;<br />&nbsp; &nbsp; ...<br />&nbsp; } else if(state == ...) {<br />&nbsp; &nbsp; ...<br />&nbsp; }<br />}</div></div><br />Personally, I wouldn't check for the game state every frame because that would be a waste of time and the code would look like spaghetti, specially if there are many states. I would do it more like this:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">main(){<br />&nbsp; &nbsp;state = isTitleScreen;<br />&nbsp; &nbsp;while(true){<br />&nbsp; &nbsp;&nbsp; &nbsp;switch(state){<br />&nbsp; &nbsp;&nbsp; &nbsp;case isTitleScreen: titleScreen();<br />&nbsp; &nbsp;&nbsp; &nbsp;case isGameStage: gameStage();<br />&nbsp; &nbsp;&nbsp; &nbsp;(...)<br />&nbsp; &nbsp;&nbsp; &nbsp;}<br />&nbsp; &nbsp;}<br />}<br /><br />titleScreen(){<br />&nbsp; &nbsp;;SETUP TITLE SCREEN<br />&nbsp; &nbsp;while(state == isTitleScreen){<br />&nbsp; &nbsp;&nbsp; &nbsp;;THINGS THAT HAPPEN EVERY FRAME<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;;TERMINATE TITLE SCREEN<br />}<br />gameStage(){<br />&nbsp; &nbsp;;SETUP GAME STAGE (decompress level map, clear items, etc.)<br />&nbsp; &nbsp;while(state == isGameStage){<br />&nbsp; &nbsp;&nbsp; &nbsp;;THINGS THAT HAPPEN EVERY FRAME (process player, enemies, camera, etc.)<br />&nbsp; &nbsp;}<br />&nbsp; &nbsp;;TERMINATE GAME STAGE<br />}<br />(...)</div><br />Changing states is then as easy as modifying the &quot;state&quot; variable, no matter where you are.<br /><br />If you can make your PPU buffering system generic enough, you can share it (along with the VBlank handler) among all (or at least many) game states. That way you don't have to worry about waiting for VBlank and updating music inside every freaking state loop, you could have a function handle that.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Okay, so the name that I gave to writePictureToTV() should actually be something like copyValuesToPPU(), because the PPU is not acually writing then, because the electron gun is scrolling back up. The PPU is actually writing to the screen when the CPU is computing updateMario(), updateEnemies(), updateCamera(), right?</div><br />Correct.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=95"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p104413"></a>
				<b class="postauthor">FinalZero</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104413">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104413#p104413"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 8:53 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4131.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Dec 03, 2009 7:27 am<br /><b>Posts:</b> 134
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Personally, I wouldn't check for the game state every frame because that would be a waste of time and the code would look like spaghetti, specially if there are many states. I would do it more like this:</div><br />1) I forgot to wrap a while loop around the if's and else's.<br />2) I see the inner while loop now, and get what you are saying about not checking all the possible states every frame.<br />3) Yes, your code is better formatted, and it'd end up formatting it the same way in the long run. Of course, if I was doing this in an OO language, I'd use inheritance/polymorphism. Also, you forgot break's in the switch/case statement.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4131"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p104414"></a>
				<b class="postauthor">tokumaru</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104414">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104414#p104414"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 9:01 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=95.png" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Feb 12, 2005 9:43 pm<br /><b>Posts:</b> 6693<br /><b>Location:</b> Rio de Janeiro - Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">FinalZero wrote:</div><div class="quotecontent">If I was doing this in an OO language, I'd use inheritance/polymorphism of course.</div><br />Definitely, but on the NES it will probably be either ASM or C. The code I wrote above is pretty much what I do in ASM, but I tried to describe it in a C-like language as best as I could.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Btw, you forgot break's in the switch/case statement.</div><br />I thought about putting breaks, but I figured I wasn't writing actual working C code, it was more like pseudo code, so I left out this annoying aspect of the C language. =)</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=95"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p104419"></a>
				<b class="postauthor">FinalZero</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104419">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104419#p104419"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 9:32 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4131.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Dec 03, 2009 7:27 am<br /><b>Posts:</b> 134
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">You mentioned menus before, and I want to know, what kind of loop would handle them. What about something like Dragon Warrior, where's there's lots of nested menus too? I suppose that you'd have to remember which menu is currently selected, and what index in the current menu is selected, and from these determine what hitting the d-pad up or down should do. Doing all that seems rather painful.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4131"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p104420"></a>
				<b class="postauthor">3gengames</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104420">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104420#p104420"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Dec 09, 2012 9:50 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td class="postdetails">Formerly 65024U</td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Mar 27, 2010 12:57 pm<br /><b>Posts:</b> 2132
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I'd save all the variables on a stack when each new one is called and keep track of how many are on the stack. Put a universal control value and universal output value and then when you escape, close them all. When you go 1 back, pull the vars you need a put the menu back on the screen. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /> I've never programmed one, but that seems like a pretty logical way to go about it.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4311"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p104431"></a>
				<b class="postauthor">tokumaru</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104431">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104431#p104431"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Dec 10, 2012 2:59 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=95.png" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Feb 12, 2005 9:43 pm<br /><b>Posts:</b> 6693<br /><b>Location:</b> Rio de Janeiro - Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">FinalZero wrote:</div><div class="quotecontent">What about something like Dragon Warrior, where's there's lots of nested menus too?</div><br />I would do it with sub-states, states that run inside other states (you JSR to them, so they can return). Each level (not game level, menu level <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />) would be a sub-state, and after they are done (a selection is made or it's aborted) it returns to the parent state. A pause screen could also be implemented as a sub-state.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=95"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p104440"></a>
				<b class="postauthor" style="color: #AA0000">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104440">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104440#p104440"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Dec 10, 2012 8:13 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_online.gif" alt="Online" title="Online" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 12423<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">FinalZero wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Active picture time (or &quot;draw&quot;) is 240 scanlines; vertical blanking time (or &quot;vblank&quot;) is 22 scanlines on NTSC and RGB.</div><br />You know, it throws me off when you measure time in scanlines.</div><br />The pixel clock of the NTSC PPU is defined as 945/176 MHz, which is about 5.37 MHz. One scanline equals 341 pixels, including the visible area (256 pixels), the border (24 pixels), and the horizontal blanking (61 pixels). At 5.37 MHz, 341 pixels are output in 63.5 microseconds.<br /><br />Time can also be measured in CPU cycles. On the PAL NES, the CPU runs one cycle for every 3.2 pixels, but on everything else (Famicom, PlayChoice, NTSC NES, and third-party Famicom clones designed for the PAL video system), the CPU runs one cycle for every 3 pixels, or 1.79 MHz. This makes each scanline 113.67 CPU cycles long. This makes draw 27280 cycles long and vblank 2500 cycles, although you won't be able to use all of vblank for a few reasons that you'll learn about later.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The PPU is actually writing to the screen when the CPU is computing updateMario(), updateEnemies(), updateCamera(), right?</div><br />Yes, and this is what I meant by &quot;draw time&quot;.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Of course, if I was doing this in an OO language, I'd use inheritance/polymorphism.</div><br />A switch statement can be used to implement a form of polymorphism, just one without specific support from the language. It can be implemented in assembly language using a jump table.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p104450"></a>
				<b class="postauthor">slobu</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p104450">Re: How to do multiple things at once?</a></div><div style="float: right;"><a href="./viewtopic.php?p=104450#p104450"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Dec 10, 2012 3:17 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Tue Jul 12, 2011 10:58 am<br /><b>Posts:</b> 236
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">This discussion reminds me of two things:<br /><br />How Andrew Davie handles tasks in Bolderdash for the 32600<br /><!-- m --><a class="postlink" href="http://www.atariage.com/forums/topic/198176-session-25-advanced-timeslicing/#entry2525563">http://www.atariage.com/forums/topic/19 ... try2525563</a><!-- m --><br /><br />and Proto-threads<br /><!-- m --><a class="postlink" href="http://dunkels.com/adam/pt/">http://dunkels.com/adam/pt/</a><!-- m --><br /><br />I think both approaches could make handling large amounts of objects easier for resource constrained systems.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4942"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=10&amp;t=9595&amp;start=15"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=10"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=10&amp;t=9595"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>2</strong> of <strong>4</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 56 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=10&amp;t=9595&amp;start=0">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=10&amp;t=9595">1</a><span class="page-sep">, </span><strong>2</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=10&amp;t=9595&amp;start=30">3</a><span class="page-sep">, </span><a href="./viewtopic.php?f=10&amp;t=9595&amp;start=45">4</a> &nbsp;<a href="./viewtopic.php?f=10&amp;t=9595&amp;start=30">Next</a></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=10">Newbie Help Center</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: <a href="./memberlist.php?mode=viewprofile&amp;u=6694">AbSoLuTAL</a> and 4 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="9595" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="10" selected="selected">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="11">&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="12">&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;GBDev</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>

<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>

</body>
</html>