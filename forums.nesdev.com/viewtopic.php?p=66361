<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - Emulator's main loop problem</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Newbie Help Center" href="http://forums.nesdev.com/feed.php?f=10" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Emulator's main loop problem" href="http://forums.nesdev.com/feed.php?f=10&amp;t=6852" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '1');
	var per_page = '';
	var base_url = '';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=register"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Thu Aug 30, 2012 1:42 pm<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=10">Newbie Help Center</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />

<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=10&amp;t=6852">Emulator's main loop problem</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=10"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=10&amp;t=6852"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 14 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=10&amp;t=6852&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=10&amp;t=6852&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=10&amp;t=6852&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p66114"></a>
				<b class="postauthor">comegordas</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66114">Emulator's main loop problem</a></div><div style="float: right;"><a href="./viewtopic.php?p=66114#p66114"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Aug 16, 2010 1:20 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4531.gif" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Aug 14, 2010 7:12 pm<br /><b>Posts:</b> 53
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">i've got some doubts about the emulator's main loop.
<br />
<br />i'm trying to render just the background of Balloon Fight. i know i have to execute 3 PPU cycles for each CPU cycle executed. in code:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">CPUCycles = CyclesTable&#91;Opcode&#93;;<br />PPUCycles = CPUCycles * 3;</div>
<br />
<br />but what do i have to do in each PPU cycle? should i fetch background data from the name tables?
<br />
<br />by now, what i'm doing is start the emulation with rendering turned off (i mean with bit 8 of $2002 set). so i'm waiting for the rom to make a LDA $2002 to turn on the rendering. after the rendering is set, i fetch 32 * 30 tiles (wich is the entire background), render out those tiles, and then turn the rendering off again, so the emulator can continue executing opcodes.
<br />
<br />of course this routine is absolutely worng, because i'm drawing the entire background by fetching the tiles from single name table, and the rom can switch between the name tables to make the background.
<br />
<br />so i'm confused about when should i start fetching background tiles and when should i stop. should i always wait for the rom to turn off the rendering via LDA $2002 or shomething similar? or should i force the on/off status of the rendering every N number of cycles?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4531"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p66127"></a>
				<b class="postauthor">MottZilla</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66127"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66127#p66127"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Aug 16, 2010 6:43 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=1726.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Dec 06, 2006 8:18 pm<br /><b>Posts:</b> 1799
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">You don't force anything. The software controls whether or not rendering is enabled or not. What happens on each PPU Cycle depends on various things. It also depends on how you choose to emulate the system on what exactly you need to do. For very simple games (Donkey Kong, Donkey Kong Jr, Mario Bros (not Super), 1942) you can actually just render the entire background at once when scanline 240 finishes rendering. 
<br />
<br />But the basic idea is you always execute your 3 ppu cycles per 1 cpu cycle. There are usually 341 PPU cycles per scanline, and there are 240 active scanlines, 21 vblank scanlines, and 1 prerender for NTSC. I may be wrong on the numbers, it's been awhile and I didn't look up to confirm. 
<br />
<br />So depending on the scanline currently being rendered, and the PPU cycle within the scanline, you do different things. And it depends on if rendering is active or not. You render 1 pixel for each PPU cycle for PPU Cycles 1 - 256 of each scanline. Cycles 256 and up modify certain registers at certain times, and fetch certain data. There is alot of information in documents about this sort of thing I believe.
<br />
<br />Just remember that alot of games are pretty forgiving of inaccuracy, but there are some games that are pretty brutal if things aren't very accurate to the hardware.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=1726"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p66133"></a>
				<b class="postauthor">comegordas</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66133"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66133#p66133"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Aug 16, 2010 7:46 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4531.gif" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Aug 14, 2010 7:12 pm<br /><b>Posts:</b> 53
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">thanks in advance for your reply MottZilla.
<br />
<br />supose i'm using the per-frame rendering method (i guess it'll work for some simple games, once i get the basics i should be moving for a per-scanline method). so far, this is way i've understood i've got to proceed:
<br />
<br />* start with the rendering turned off and wait for the game to turn it on
<br />* render a complete frame
<br />* turn off the rendering
<br />* execute some game code keeping trace of the CPU cycles
<br />* since it's known that a frame occurs at a given number of cycles, once the CPU cycles counter exceeds that number i should turn on the rendering and show up the new frame
<br />
<br />am i proceeding right? i've tried that way but the background drawed weren't correct. maybe i'm not proceding right, maybe i'm reading from a wrong address.
<br />
<br />this is the code i get so far to render the background:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">private void DrawBackground&#40;&#41;<br />&#123;<br />&nbsp; &nbsp;int X, Y;<br /><br />&nbsp; &nbsp;X = Y = 0;<br /><br />&nbsp; &nbsp;// 32x30 is the number of tiles showed up in the screen at the same time<br />&nbsp; &nbsp;for &#40;int k = 0; k &lt; 32 * 30; k++&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp; &nbsp; if &#40;&#40;k &gt; 0&#41; &amp;&amp; &#40;k % 32 == 0&#41;&#41;<br />&nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Y += &#40;2 * 8&#41;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;X = 0;<br />&nbsp; &nbsp; &nbsp; &#125;<br /><br />&nbsp; &nbsp; &nbsp; for &#40;int i = 0; i &lt; 8; i++&#41;<br />&nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fetch a name table entry<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte NameTableEntry = Data.VRAM&#91;NameTableAddr + i + k&#93;;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fetch the corrisponding Attribute Table entry<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte AttributeTableEntry = Data.VRAM&#91;NameTableAddr + 0x3c0 + i + k&#93;;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fetch a low-order byte of the tile<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte PatternTable_Low = Data.VRAM&#91;NameTableEntry + i&#93;;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Fetch a high-order byte of the tile<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte PatternTable_High = Data.VRAM&#91;NameTableEntry + i + 8&#93;;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Color FillColor;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bool&#91;&#93; TileBits = new bool&#91;16&#93;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for &#40;int j = 0; j &lt; 8; j++&#41;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Fetch the first color bit<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TileBits&#91;j&#93; = Convert.ToBoolean&#40;&#40;PatternTable_Low &gt;&gt; &#40;7 - j&#41;&#41; &amp; 0x1&#41;;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Fetch the second color bit<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TileBits&#91;j + 8&#93; = Convert.ToBoolean&#40;&#40;PatternTable_High &gt;&gt; &#40;7 - j&#41;&#41; &amp; 0x1&#41;;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Combine the color bits into a pallete index<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FillColor = Data.Pallete&#91;&#40;Convert.ToUInt16&#40;TileBits&#91;j + 8&#93;&#41; * 2&#41; + Convert.ToUInt16&#40;TileBits&#91;j&#93;&#41;&#93;;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Surface Pixel = new Surface&#40;2, 2&#41;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pixel.Fill&#40;FillColor&#41;;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Blit the pixel into the screen buffer<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Screen.Blit&#40;Pixel, new Point&#40;X + j * 2, Y + i * 2&#41;&#41;;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#125;<br />&nbsp; &nbsp; &nbsp; &#125;<br /><br />&nbsp; &nbsp; &nbsp; X += &#40;2 * 8&#41;;<br /><br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;// Render the entire frame<br />&nbsp; &nbsp;Screen.Update&#40;&#41;;<br /><br />&nbsp; &nbsp;return;<br />&#125;</div>
<br />
<br />NameTableAddr -&gt; the Name Table base address
<br />TileBits -&gt; each one of the bits of a pattern table entry
<br />
<br />roughly coded in C# + SDL. note that i'm still not fetching the two upper color bits from the Attribute Table data, that's up to be done later.
<br />the rest of the code should be self explanatory, anyway feel free to ask.
<br />
<br />note that i'm just trying to draw the background, wich is the lowest point of the video emulation.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4531"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p66195"></a>
				<b class="postauthor">MottZilla</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66195"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66195#p66195"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Aug 17, 2010 1:46 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=1726.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Dec 06, 2006 8:18 pm<br /><b>Posts:</b> 1799
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">First off, you don't "turn off rendering" if you mean modifying the NES registers to turn it off. Only the game software should control if rendering is active. But remember, there is the emulated NES's "rendering" and your emulator's rendering. Two separate things.
<br />
<br />The thing I recommend you doing for now (you can improve and change this later) would be to execute 113 (or 114) CPU cycles, and then increase a Scanline variable. This way you can track what your emulated NES is doing video wise. So you can start at 0 and work your way up to 261 (giving you 262 scanlines). You could make scanlines 0 - 239 your "active" scanlines where the screen is being drawn. Then scanlines 240 - 260 are your VBlank scanlines where nothing is drawn, and the game will be informed its in VBlank by your emulator setting the Vertical Blank flag in register $2002 and also by executing a NMI interrupt on the CPU. On scanline 261 nothing needs to happen other than just letting time pass, letting the cpu execute cycles. 
<br />
<br />So what you can do then after this is after scanline 239 is done and you increase the counter to 240, you can set the VBlank flag in $2002, trigger your NMI, and execute your emulator's code to draw the screen/nametable/background. Assuming your CPU code is good and you implement the registers needed correctly you should be able to get simple games like Donkey Kong running and showing their backgrounds.
<br />
<br />By the way, this is a good way to start, by just drawing the background. And then later you can add decoding the Attribute Table so the backgrounds use the right colors. Then you can add Sprite rendering. After that simple games would be playable if you add input emulation. Then maybe you'll try adding scrolling. After that maybe you'll consider doing scanline rendering instead of full frame rendering. There is alot you can do but you should build up to it since I assume this is your first emulator.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=1726"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p66208"></a>
				<b class="postauthor">comegordas</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66208"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66208#p66208"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Aug 17, 2010 4:09 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4531.gif" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Aug 14, 2010 7:12 pm<br /><b>Posts:</b> 53
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">thank you very very much MottZilla, you've been as clear as water. on to code now!</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4531"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p66266"></a>
				<b class="postauthor">comegordas</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66266"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66266#p66266"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Wed Aug 18, 2010 11:26 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4531.gif" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Aug 14, 2010 7:12 pm<br /><b>Posts:</b> 53
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">back again MotZilla. i tried to follow your advices, but i'm still having problems with the background rendering.
<br />
<br />i'll let my code explain it for me, since i consider it's self explanatory. my apologize in advance if someone considers that i'm being insulting by doing this. no intention to get pissed anybody. i'm not being lazzy, it's just sometimes it's not easy when you are a non-native english speaker. so "go take an english class" are going to be consider a constructive reply XD
<br />
<br />this is my emulator's main loop:
<br />
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">while&#40;CPU_Running &#41;<br />&#123;<br />&nbsp; &nbsp; if&#40;Scanline &lt; 240&#41; // the active scanlines<br />&nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; RunScanline&#40;&#41;; // draw a single scanline<br />&nbsp; &nbsp; &nbsp; &nbsp; Scanline++; // increment the scanlines counter<br />&nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; else if&#40;Scanline &lt; 262&#41; // the VBlank scanlines<br />&nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; PPU_2002 |= 0x80; // tell the game we're in VBlank so it can execute code<br />&nbsp; &nbsp; &nbsp; &nbsp; Scanline++; // increment the scanlines counter<br />&nbsp; &nbsp; &nbsp; &nbsp; CyclesCPU -= 114; // decrement the CPU cc's counter<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; while&#40;CyclesCPU &lt;= 114&#41; // execute 114 CPU cc's<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OpCode = RAM&#91;PC&#93;; // fetch opcode<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EjecuarOpCode&#40;OpCode&#41;; // execute opcode<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CyclesCPU += CyclesTable&#91;OpCode&#93;; // increment the CPU cc's counter<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; else if&#40;Scanline == 262&#41;&nbsp; // if it's the last scanline, reset the scanlines counter<br />&nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; Scanline = 0;<br />&nbsp; &nbsp; &#125;<br />&#125;</div><br /><br />and this is my (so very basic) ppu engine:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">void RunScanline&#40;&#41;<br />&#123;<br />&nbsp; &nbsp; int i, j, Y;<br />&nbsp; &nbsp; byte NT_Entry, PT_Entry_Low, PT_Entry_High;<br />&nbsp; &nbsp; word PT_Addr, NT_Addr;<br />&nbsp; &nbsp; byte ColorBit0, ColorBit1, ColorIndex;<br /><br />&nbsp; &nbsp; if&#40;Scanline == 0&#41; // the dummy scanline<br />&nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; // TODO. Nothing here yet...<br />&nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; else if&#40;&#40;Scanline &gt; 0 &#41; &amp;&amp; &#40;Scanline &lt;= 240&#41;&#41; // the active scanlines<br />&nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; switch&#40;READ_BIT&#40;PPU_2000,4&#41;&#41; // fetch base pattern table address<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0: PT_Addr = 0x0000; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 1: PT_Addr = 0x1000; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; switch&#40;PPU_2000 &amp; 0x3&#41; // fetch base name table address<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0: NT_Addr = 0x2000; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 1: NT_Addr = 0x2400; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 2: NT_Addr = 0x2800; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 3: NT_Addr = 0x2c00; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; for&#40;i = 0; i &lt; 32; i++&#41; // the basic background drawing loop<br />&nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NT_Entry = VRAM&#91;NT_Addr + i&#93;; // fetch tile number<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Y = &#40;Scanline - 1&#41; % 8; // fetch tile byte-line number<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PT_Entry_Low = VRAM&#91;PT_Addr + &#40;NT_Entry * 16&#41; + Y&#93;; // fetch the lower sliver from the pattern table<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PT_Entry_High = VRAM&#91;PT_Addr + &#40;NT_Entry * 16&#41; + Y + 8&#93;; // fetch the upper sliver from the pattern table<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Y++; // increment the tile byte-line number<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for&#40;j = 7; j &gt;= 0; j--&#41; // render the 1x8 pixel sliver of the tile<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorBit0 = READ_BIT&#40;PT_Entry_Low,j&#41;; // fetch the lower color bit<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorBit1 = READ_BIT&#40;PT_Entry_High,j&#41;; // fetch the upper color bit<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ColorIndex = &#40;ColorBit1 &lt;&lt; 1&#41; | ColorBit0; // combine the color bits into a pallete index<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; switch&#40;ColorIndex&#41; // render a single pixel<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 0: putpixel&#40;screen,&#40;i * 8&#41; + &#40;&#40;j * &#40;-1&#41;&#41; + 7&#41;,Scanline - 1,COLOR_0&#41;; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 1: putpixel&#40;screen,&#40;i * 8&#41; + &#40;&#40;j * &#40;-1&#41;&#41; + 7&#41;,Scanline - 1,COLOR_1&#41;; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 2: putpixel&#40;screen,&#40;i * 8&#41; + &#40;&#40;j * &#40;-1&#41;&#41; + 7&#41;,Scanline - 1,COLOR_2&#41;; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 3: putpixel&#40;screen,&#40;i * 8&#41; + &#40;&#40;j * &#40;-1&#41;&#41; + 7&#41;,Scanline - 1,COLOR_3&#41;; break;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &nbsp; &nbsp; &#125;<br />&nbsp; &nbsp; &#125;<br /><br />&nbsp; &nbsp; return;<br />&#125;</div>
<br />
<br />as you can see, there's no attribute table data implementation yet.
<br />after that, this is what the screen shows up (the game is Donkey Kong Jr, but the i'm getting the same crappy results on every game):
<br />
<br /><img src="http://img64.imageshack.us/img64/7435/47310216.jpg" alt="Image" />
<br />
<br />and after a little while, that image turns into this one:
<br />
<br /><img src="http://img24.imageshack.us/img24/3474/31822826.jpg" alt="Image" />
<br />
<br />i tryed it by setting the register $2002 to 0 at startup, and by setting the bit #7 to 1, and by setting the bit #7 to 0, and there's no difference between one way or another. it shows the same images or either nothing.
<br />
<br />by the way, i'm setting the bit #7 of $2002 every time the game reads from it, as NESTECH says. also, there's no implementation of scrolling yet in my emu. maybe i'm too stupid but i really don't understand Loopy's document, wich seems has to very important. anyway, there's no scrolling in the game's background that i'm testing my emu with (at least in the title screen). or maybe i'm wrong? there's scrolling and that's way i'm not showing the tiles correctly?
<br />
<br />since all the tiles that comes up to screen are the same, it's clear that i'm not fetching the tile address correctly, or i'm fetching it in wrong a moment. also, i tried it by executing some game code for the first 20 scanlines before the program goes into the main loop, so it have enough time to modify the VRAM and set up the background, but nothing changed.
<br />
<br />this is getting me so frustrated... i'm spending hours and hours in coding, reading and changing things into my program, but all i'm getting is my head hitting the wall. oh lord have mercy! XD
<br />
<br />i'm not asking for code, i'm just looking for someone to shed some light here. any reply will be highly apreciated.
<br />
<br />peace out!
<br />
<br />EDIT: just in case, this is what FCEUXDSP Name Table viewer show:
<br />
<br /><img src="http://img340.imageshack.us/img340/6426/90167299.jpg" alt="Image" />
<br />
<br />so gues yeah... i'm totally fetching the tiles from anywhere but the VRAM <img src="./images/smilies/icon_sad.gif" alt=":(" title="Sad" /></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4531"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p66274"></a>
				<b class="postauthor">Hamburgler</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66274"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66274#p66274"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Aug 19, 2010 7:17 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Jul 04, 2007 8:40 am<br /><b>Posts:</b> 36
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="codetitle"><b>Code:</b></div><div class="codecontent">NT_Entry = VRAM&#91;NT_Addr + i&#93;; // fetch tile number </div><br />You're only drawing the topmost line's worth of tiles on every scanline.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">NT_Entry = VRAM&#91;NT_Addr + &#40;&#40;scanline / 8&#41; * 32&#41; + i&#93;; // fetch tile number </div>
<br />It also looks like you may have a mirroring issue, or something else that's making you draw from the wrong page with all the '0' tiles.
<br />
<br />Try forcing all reads and writes to one nametable (0x2000) and see what that turns up for you.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3370"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p66287"></a>
				<b class="postauthor">MottZilla</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66287"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66287#p66287"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Aug 19, 2010 11:30 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=1726.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Dec 06, 2006 8:18 pm<br /><b>Posts:</b> 1799
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">First up, the PPU $2002 VBlank flag is set ONCE. When VBlank begins, you set the flag. You do not continue to set the flag for every scanline in Vblank. Next, be sure that when the CPU reads $2002, that after you return the value, you CLEAR the VBlank flag. That is the correct behavior. 
<br />
<br />Next your main loop seems confusing to me. Are you executing CPU Cycles before drawing the line? Or are you even executing CPU Cycles for all scanlines and not just for VBlank scanlines?
<br />
<br />Next, you are setting the VBlank flag in $2002, that's good. But I see no mention of triggering a NMI interrupt. If you don't do this, you won't see anything but those 0 tiles and stuff like that. Be sure to properly implement the NMI interrupt before expecting games to do very much. 
<br />
<br />So I would do those things first. Then let us know if you still have problems after that or have questions about it.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=1726"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p66290"></a>
				<b class="postauthor">comegordas</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66290"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66290#p66290"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Aug 19, 2010 12:26 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4531.gif" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Aug 14, 2010 7:12 pm<br /><b>Posts:</b> 53
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Hamburgler: thanks! didn't note that. my brain went fried last night! the results are still the same, but you we're right, i was reading always the topmost line of every tile <img src="./images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /> 
<br />
<br />MottZilla:
<br />
<br /><div class="quotetitle">MottZilla wrote:</div><div class="quotecontent">the PPU $2002 VBlank flag is set ONCE. When VBlank begins, you set the flag</div><br />dind't know that. so i guess it can be easily corrected like:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">if&#40;Scanline &lt; 240&#41; // the active scanlines<br />&#123;<br />&nbsp; &nbsp; RunScanline&#40;&#41;;<br />&nbsp; &nbsp; Scanline++;<br /><br />&nbsp; &nbsp; // and that's all... no manullay setting/resetting of the VBL flag<br /><br />&#125;<br />else if&#40;Scanline &lt; 262&#41; // the VBlank scanlines<br />&#123;<br />&nbsp; &nbsp; if&#40;Scanline == 240&#41; PPU_2002 |= 0x80; // manually set the VBL flag at start of VBlank<br /><br />&nbsp; &nbsp; // execute some game code here, but no manually handling<br />&nbsp; &nbsp; // of the VBL flag<br /><br />&#125;</div><br /><br /><div class="quotetitle">MottZilla wrote:</div><div class="quotecontent">be sure that when the CPU reads $2002, that after you return the value, you CLEAR the VBlank flag</div><br />yes, i'm reseting the VBL flag AFTER the read occurs and returning the correct value.<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">tmp2002 = PPU_2002;<br />PPU_2002 &amp;= 0x7f;<br />return tmp2002;</div><br />so the behavior is right.<br /><br /><div class="quotetitle">MottZilla wrote:</div><div class="quotecontent">Are you executing CPU Cycles before drawing the line?</div><br />yes, that's what i'm doing. as you can see in the code, i'm firstly rendering the first 240 scanlines, and then execute code for the scanlines #240 to #262, wich are the VBlank ones.<br /><br />as for the NMI's, i've been reading about them but didn't know that we're indispensable in such a low point of rendering. sorry about that. so on NMI handling now...<br /><br />as far as i read, a NMI is triggered at the start of a new frame. since my main loop is scanline based, i should be triggering a NMI at the end of scanline #262. but bit #7 of $2000 is wich controls if the NMI is triggered or not when VBlank is reached, so i should be checking if it is set before i go into the NMI routine. therefore, the basics should be like:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">...<br />else if&#40;Scanline == 262&#41;<br />&#123;<br />&nbsp; &nbsp; Scanline = 0; // reset scanline counter<br />&nbsp; &nbsp; TriggerNMI&#40;&#41;;<br />&#125;</div>
<br />
<br />am i being correct? sorry if my question is stupid, but there's a LOT of things involved here and sometimes i got confused :\</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4531"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p66291"></a>
				<b class="postauthor">tokumaru</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66291"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66291#p66291"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Thu Aug 19, 2010 12:35 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=95.png" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Feb 12, 2005 9:43 pm<br /><b>Posts:</b> 5251<br /><b>Location:</b> Rio de Janeiro - Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">comegordas wrote:</div><div class="quotecontent">as for the NMI's, i've been reading about them but didn't know that we're indispensable in such a low point of rendering.</div><br />Lots of games do all of their rendering in the NMI, and some have all of their code running inside the NMI, so if you don't emulate NMIs nothing will ever show up on the screen for those games.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">as far as i read, a NMI is triggered at the start of a new frame.</div>
<br />The NMI is triggered when VBlank starts.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=95"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p66344"></a>
				<b class="postauthor">comegordas</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66344"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66344#p66344"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Aug 20, 2010 11:11 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4531.gif" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Aug 14, 2010 7:12 pm<br /><b>Posts:</b> 53
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">well well well... spent last day reading 'n coding and finally got some good results.
<br />
<br />i've added a simply NMI implementation to my emu. what i'm doing is at scanline #240, when VBlank starts, i set $2002.7 to 1 so the game knows that VBlank has started. after that if $2000.7 is set, i push the PC and the status byte and go into the NMI routine. important: as i read, after push the status byte i've got to raise the interrupt flag status byte BEFORE i go into the NMI routine. is it ok? don't remember now in wich doc i read it (read that yesterday too late at night), but that was the only one doc wich mentioned that, that's why i'm asking.
<br />
<br />have a simply question now: assuming that the game setted $2000.7 to 0 (so no NMI will be triggered at start of VBlank) and i went into the NMI routine, do i have to force that bit to 1 at the END of VBlank, saying to the game that in the NEXT VBlank an NMI will be triggered if it doesn't disable it? i've tried setting and resseting that bit and worked for some games but not for others. maybe it's an opcode emulation problem, as i mention at the end of the post.
<br />
<br />finally, balloon fight gave me this beautiful image:
<br />
<br /><img src="http://img696.imageshack.us/img696/9785/balloon.gif" alt="Image" />
<br />
<br />donkey kong jr. wasn't bad at all...
<br />
<br /><img src="http://img814.imageshack.us/img814/6919/kong.gif" alt="Image" />
<br />
<br />...but 10 Yard Fight :\
<br />nothing showed up with this last rom. seems like the game falls into an infinite bucle, so probably is an opcode emulation problem.
<br />
<br />so i've to say THANKS to all the people here who helped me out. this is something i always wanted to do since i was 14 and started to learn programming. but there's a lot yet to do... <img src="./images/smilies/icon_wink.gif" alt=";)" title="Wink" /></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4531"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p66347"></a>
				<b class="postauthor" style="color: #AA0000">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66347"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66347#p66347"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Aug 20, 2010 11:23 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="http://pineight.com/nes/terrible/PSRFX.png" width="100" height="56" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 9047<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">comegordas wrote:</div><div class="quotecontent">...but 10 Yard Fight :\<br />nothing showed up with this last rom. seems like the game falls into an infinite bucle</div><br />A lot of early NES games run entirely in the NMI handler, where the main thread is just<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">forever: jmp forever</div><br />Super Mario Bros. is the same way.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">so probably is an opcode emulation problem.</div>
<br />If you suspect CPU problems, the next step is probably to run nestest.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p66352"></a>
				<b class="postauthor">MottZilla</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66352"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66352#p66352"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Aug 20, 2010 11:57 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=1726.jpg" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Dec 06, 2006 8:18 pm<br /><b>Posts:</b> 1799
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Again, do not "force" bits. If the software disables NMI on VBlank, that's what happens. The game may intend for this to happen and if you force it to happen differently you may crash the game. 
<br />
<br />You should definitely run the NES CPU test rom next. It can spot potential problems with your CPU core which most likely you will have a few errors. Or maybe you have some addressing mode errors. These can be found or atleast get you pointed in the right direction by the test rom. 
<br />
<br /><!-- m --><a class="postlink" href="http://blargg.parodius.com/nes-tests/instr_test-v2.zip">http://blargg.parodius.com/nes-tests/instr_test-v2.zip</a><!-- m --></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=1726"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p66361"></a>
				<b class="postauthor">comegordas</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p66361"></a></div><div style="float: right;"><a href="./viewtopic.php?p=66361#p66361"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Aug 20, 2010 1:26 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=4531.gif" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Aug 14, 2010 7:12 pm<br /><b>Posts:</b> 53
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">ok thanks! let's test it! <img src="./images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4531"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=10&amp;t=6852"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=10"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=10&amp;t=6852"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>1</strong> of <strong>1</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 14 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=10">Newbie Help Center</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: <span style="color: #9E8DA7;" class="username-coloured">Google [Bot]</span> and 1 guest</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="6852" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="10" selected="selected">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="11">&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;NESdev China</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="12">&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;GBDev</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>

<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>

</body>
</html>