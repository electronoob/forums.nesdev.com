<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - SNES NSF player</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">SNES NSF player</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=5&amp;t=470">http://forums.nesdev.com/viewtopic.php?f=5&amp;t=470</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Fri Aug 05, 2005 2:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>SNES NSF player</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Whow, I'm impressed. It really rocks, you can see an interactive volume jauge for all channels, also you can see if the games uses sweep/decay/timer, you can see "dots" that shows the pitch and also the volume, see a keyboard to show the notes, and see the APU registers and all their content. It's the best NSF player out there ! Also, a lot of NSF inclued have gamplay's sound effect with them, that's really cool.
<br />The only problem is that there is sometimes glitches when using the sweep registers and the triangle's timer (maybe it's something with $4017) and also, it runs only on ZSNES, and you can't play NSF with a size higher than 32k and/or NSF that have bankwitching in them. Also, it doesn't supports DPCM, MMC5, VRC6 and so on (MMC5 should be really easy to implement, and I really would see Just Breed working on it).
<br />You really should make a Win32 version of it ! That would rock !
<br />
<br />PS : Where did you found the NSFs with sound effects ? That's so cool...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Memblers</b> [ Thu Aug 11, 2005 2:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Oops, I didn't notice this post until just now.  Man, what else have I been missing? <img src="./images/smilies/icon_surprised.gif" alt=":o" title="Surprised" />
<br />
<br />Thanks, I'm glad you liked the visual features.  It's really the only way to distinguish from other NSF players.  Most of them are winamp plugins so you can only listen to the NSFs in the background, my NSF player takes the foreground approach, heheh.  I always liked Cubic Player, so I wanted to write something similar to it.
<br />
<br />I'm wanting to port some of it to NES (actually where it started).  It's really easy to intercept the sound register writes.
<br />
<br />But yeah, the sound emulation isn't too great.  I was really pleased to get it working so well with the SPC's timers though.  I didn't know about $4017's effect at the time, so that aspect isn't emulated at all.
<br />
<br />I think it already has a win32 version, since it runs well enough in ZSNESW, heheh.  I've heard from someone who used it on their Dreamcast, so I imagine it'll run on about any system that can emulate SNES.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Memblers</b> [ Thu Aug 11, 2005 2:55 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: SNES NSF player</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent">PS : Where did you found the NSFs with sound effects ? That's so cool...</div>
<br />
<br />It's from all the NSFs on my disk, they should be mostly the same as the ones at <a href="http://zophar.net/nsf/" class="postlink">http://zophar.net/nsf/</a> (if that page ever gets fixed).
<br />
<br />When you don't clear RAM between songs, sometimes the sound effects will play over the music.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Aug 11, 2005 4:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Memblers wrote:</div><div class="quotecontent">Thanks, I'm glad you liked the visual features.  It's really the only way to distinguish from other NSF players.  Most of them are winamp plugins so you can only listen to the NSFs in the background</div>
<br />Of course, if you pop up a Winamp visualization and maximize it, then you can listen in the foreground and get visual features.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Fri Aug 12, 2005 12:25 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, all nsf I have are witout sound effects. Playing them over the music would be even more cool !
<br />By meaning Win32 version, I would mean witout have to uses ZSNES. Well, ZSNES is more or less to the SNES what Nesticle is to the NES.
<br />The real problem is that it can't play any NSF that have a size over 32kb, or that have any kind of bankswitching. It's a shame that it doesn't play the majority of nsf out there  <img src="./images/smilies/icon_cry.gif" alt=":cry:" title="Crying or Very sad" /> 
<br />Only the music from old games, and only few new games works. I really tried to modify the Just Breed's nsf to reduce its size to 32kb (with only some of the songs in it at the same time), and to remove any kind of banksithing, but even if it plays fine in any other NSF player, it doesn't work with the SNES nsf player (even if it would, all MMC5 channels would be lost, heh...). Even to play simple songs, the fact to have to modify your nsf file to fill a whole 32kb file, then to have to save it under a SRM file, that would overwrite the previous one, is frustrating. Imagine the same, where you simply have to load the nsf file you want, that would be so great !
<br />Also, Solar Jetman sometimes play wrong notes, and sometimes when the sweeps are used, the visualisation get suck.
<br />What's Cubic player ?
<br />About porting it on the nes, it would be pretty easy, without bankswitching. You just have to copy all the code, and replace all opcode writing to any sound registers by jsr (both are 3 bytes) and eventually go into a routine that effectively write to it, but also write copy of its in some RAM to do the visual effects.
<br />The SPC is a great sound chip, but effectively, nothing can easily the sound that the NES does.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>blargg</b> [ Fri Aug 12, 2005 7:05 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad  wrote:</div><div class="quotecontent">You just have to copy all the code, and replace all opcode writing to any sound registers by jsr (both are 3 bytes) and eventually go into a routine that effectively write to it, but also write copy of its in some RAM to do the visual effects.</div>
<br />
<br />Nice, I had forgotten about this style of patching. An opcode could also be replaced with the single-byte BRK, giving more flexibility. Even with this how do you handle indexed and indirect modes? An evil NSF could use $3f18,x, or (0),y to access APU registers.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sat Aug 13, 2005 12:56 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">blargg wrote:</div><div class="quotecontent">Nice, I had forgotten about this style of patching. An opcode could also be replaced with the single-byte BRK, giving more flexibility. Even with this how do you handle indexed and indirect modes? An evil NSF could use $3f18,x, or (0),y to access APU registers.</div>
<br />The $3f18,x can be detected easily, because it can write to nothing else than the sound registers scince there is nothing mapped to $3f00-$3fff. However, the ($0),Y would effectively be impossible to detect like this. But I can't really see the utility of this, scince the adress in ($0) would be always the same. Also, the ($0,X) would be near impossible to detect. Not only we don't know if it writes to RAM or to sound registers, but also the opcode is only 2 bytes, so your BRK thing would be needed.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jagasian</b> [ Sat Aug 13, 2005 10:05 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I am confused.  Are you guys talking about an player that runs on the SNES, which plays NES NSF audio files, or are you talking about a player that runs on the PC, which plays SNES audio files?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Aug 13, 2005 11:28 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />We're talking about a Super NES based NSF player in comparison to PC based NSF players. Nobody brought up SPC players.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Memblers</b> [ Sat Aug 13, 2005 3:56 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Bregalad: Cubic Player was an old DOS program for playing music files.  It was especially good with a lot of MOD formats, like XM, S3M, etc.  I used to use it all the time, and still do, sometimes.
<br />
<br />And yeah, I when I started the program on NES I had it playing all Capcom NSFs (since they all load at $8000-$BFFF) and I used the replacing sound writes with JSRs trick.  For the inevitable indexing I just had different routines for each kind of write (seperate ones for A,X,Y and various indexing).  I never released that rom though, since I didn't finish the graphics and intro, but it eventually got leaked out as "Capcom OST (PD).nes".  I haven't uploaded it on here, but it's all over the net.  It's pretty old now, heheh.
<br />
<br />Jagasian:  Try it out here, if you haven't yet: <a href="http://nesdev.com/#DocsSNES" class="postlink">http://nesdev.com/#DocsSNES</a>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sun Aug 14, 2005 1:15 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The Capcom OST is really cool, apart that the font is unreadable.
<br />Also, the volume bars are missing scince the SNES version.
<br />There sould also be a Squaresoft OST, heh.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jagasian</b> [ Sun Aug 14, 2005 8:55 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Memblers wrote:</div><div class="quotecontent">Bregalad: Cubic Player was an old DOS program for playing music files.  It was especially good with a lot of MOD formats, like XM, S3M, etc.  I used to use it all the time, and still do, sometimes.<br /><br />And yeah, I when I started the program on NES I had it playing all Capcom NSFs (since they all load at $8000-$BFFF) and I used the replacing sound writes with JSRs trick.  For the inevitable indexing I just had different routines for each kind of write (seperate ones for A,X,Y and various indexing).  I never released that rom though, since I didn't finish the graphics and intro, but it eventually got leaked out as "Capcom OST (PD).nes".  I haven't uploaded it on here, but it's all over the net.  It's pretty old now, heheh.<br /><br />Jagasian:  Try it out here, if you haven't yet: <a href="http://nesdev.com/#DocsSNES" class="postlink">http://nesdev.com/#DocsSNES</a></div>
<br />
<br />Damn this is cool!  If you can emulate NES sound on a SNES, then how much farther away are you from making a NES emulator for the SNES?  It would be an interesting proof of concept to see a NES emulator that ran on the SNES and only supported... say... NROM, sound and all.  The NES for SNES hacks never had sound, did they?
<br />
<br />The SNES had a weak market share in the beginning.  If only Nintendo had built in a small emulator into the SNES and a 72-pin toploading NES slot, it could have done the emulation in software.  Then they'd just have to get the emulator working with the official commercial games.  The Sega Genesis would have never gotten any respectible market share if Nintendo had done that, as the SNES would instantly have had a huge game library... and none of the front-loader or crappy RF top-loader issues.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sun Aug 14, 2005 9:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Jagasian wrote:</div><div class="quotecontent">The Sega Genesis would have never gotten any respectible market share if Nintendo had done that, as the SNES would instantly have had a huge game library</div>
<br />The Sega Genesis had an adapter to play over 90 percent of Sega Master System games because Sega followed the same back-compatibility route that Sony would later follow in the PS2: make the old system's processor the new system's I/O processor.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sun Aug 14, 2005 10:13 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, the SNES is far to be powerfull enough to emulate the NES (I think). It has a similar, but faster CPU, but a very different PPU and even more different APU. The SNES nsf player is extremely cool, but it doesn't sound like the NES unless you remove the "sampling interpolation" in the sound options of ZSNES.
<br />Yeah, the SNES could run the code of a NES game fine, but what about the PPU writes and the APU writes ? It would write only in the SNES RAM, nothing else.
<br />And about emulating it, it would me by far too much slower, and pretty crazy to have a processor emulating itself.
<br />
<br />I never owned any Sega console, so I don't know how this compability had worked.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Memblers</b> [ Sun Aug 14, 2005 5:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Jagasian wrote:</div><div class="quotecontent">Damn this is cool!  If you can emulate NES sound on a SNES, then how much farther away are you from making a NES emulator for the SNES?  It would be an interesting proof of concept to see a NES emulator that ran on the SNES and only supported... say... NROM, sound and all.  The NES for SNES hacks never had sound, did they?<br /></div>
<br />
<br />That's something I wanted to try, actually.  But I probably won't now.  For all the hacking needed, just for specific games, bleh.  I actually had to do a fair amount of hacking of the NSFs in the player, but that was usually due to some games zeropage use/abuse (things like STA $0000 instead of STA $00, because I ran the code in a bank that was all RAM, seperate from the real zeropage).
<br />
<br />I was thinking before it could possibly be done in a general way (replacing PPU register writes/reads with JSRs), but otherwise it'd be big pile of hacks, heheh.  I like those NES games hacked to run on SNES though, I just wish there was an easy way to put my sound emulator in there with them.  I think I noticed all the games were ones without scrolling though.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>