<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - PowerPak Expansion Audio Volume</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">PowerPak Expansion Audio Volume</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=6&amp;t=5092">http://forums.nesdev.com/viewtopic.php?f=6&amp;t=5092</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>B00daW</b> [ Sun Apr 19, 2009 3:57 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>PowerPak Expansion Audio Volume</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />NSF
<br /><!-- m --><a class="postlink" href="http://average.truechiptilldeath.com/filedump/zzzv_-_fell_plot.nsf">http://average.truechiptilldeath.com/fi ... l_plot.nsf</a><!-- m -->
<br />
<br />Hardware Record
<br /><!-- m --><a class="postlink" href="http://average.truechiptilldeath.com/filedump/zzzv_-_fell_plot.mp3">http://average.truechiptilldeath.com/fi ... l_plot.mp3</a><!-- m -->
<br />
<br />I'm using a PowerPak and a 47K ohm resistor.  Do any of you notice that the VRC6 audio is really loud half way through the song?
<br />
<br />By the way, this track is made by a friend on the latest stable version of FamiTracker.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Sun Apr 19, 2009 7:21 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />If I can find the time to build my VRC6 dev-cart, I could always test it later on it.  That would be the best test to confirm it. I will see what I can do.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>loopy</b> [ Sun Apr 19, 2009 8:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I didn't spend a whole lot of time tweaking the volume levels just right, so I'm not surprised.  I did enough to make it sound "pretty good" to my ears and moved on.  Comparing it to the Real Thing instead of a software NSF player would be nice though.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Sun Apr 19, 2009 8:27 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">loopy wrote:</div><div class="quotecontent">Comparing it to the Real Thing instead of a software NSF player would be nice though.</div>
<br />
<br />This is what I had in mind since a reference sound should help to tweak the powerpak properly.  I need to make that dev-cart for one of my project anyway so this give me another incentive to find the time to put the sockets on it (if my child let me to..).
<br />
<br />
<br />@B00daW: can you find a way to ask your friend to make from famitracker a nes version of this file?  This way I would just need to remove the header and copy the file on the flash eprom.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>B00daW</b> [ Mon Apr 20, 2009 5:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have the FTM.  Here's the <a href="http://average.truechiptilldeath.com/filedump/zzzv_-_fell_plot.prg" class="postlink">PRG</a>.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Mon Apr 20, 2009 7:19 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">B00daW wrote:</div><div class="quotecontent">I have the FTM.  Here's the <a href="http://average.truechiptilldeath.com/filedump/zzzv_-_fell_plot.prg" class="postlink">PRG</a>.</div>
<br />
<br />ok, great.  I will try to find some time this week to make the cart.  If I remove just the PRG-ROM that should be enough to do the testing.  Once I have it up and running and can record it, I will do an MP3 of it.
<br />
<br />edit:
<br />
<br />There is one issue thought.  Do we know how Famitracker uses the VRC6 registers? Because if it uses the Akumajou dracula way, I will need to make a custom build of the driver since I will use a Madara cart for the dev-cart (a lot cheaper than akumajou dracula to get).  Did Jsr mention anything about it?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>B00daW</b> [ Mon Apr 20, 2009 2:26 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I guess check the source or check out the registers in FCEUX. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Mon Apr 20, 2009 7:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">B00daW wrote:</div><div class="quotecontent">I guess check the source or check out the registers in FCEUX. <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>
<br />
<br />There is good chance that the answer is in the apu.s module were all the APU writes are done (unless Jsr changed the structure of it).  I will give it a look during my lunch time since I will need to update the driver for my own needs soon.
<br />
<br />If the write are the same as Akumajou, I will make a new driver and the only thing I will need is the music/dpcm data.
<br />
<br />edit:
<br />
<br />It's not in the APU module but in the vrc6.s instead. The mapping is for Akumajou. The file is quite small so it should be quite easy to inverse the registers.
<br />
<br />edit2:
<br />
<br />I re-converted the driver to work with my sample and added a few flags along the way:
<br />
<br />- You can again disable/enable any channels (VRC6 included). Restoring channel is still not perfect
<br />- You can decide which note table to insert a compile time (PAL/NTSC)
<br />- You can select which VRC6 board you want to use (Akumajou or Madara/Esper dream)
<br />- You can include VRC6 or not (option was already there)
<br />- You can define a list of song in a table and can be located anywhere you want
<br />
<br />My test sample is now working with the new driver. I will need the data/dpcm bin files so I can compile it in my sample. What is left is just to make the dev cart.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>B00daW</b> [ Tue Apr 21, 2009 7:04 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><!-- m --><a class="postlink" href="http://user.tninet.se/~zxy965r/nsf.zip">http://user.tninet.se/~zxy965r/nsf.zip</a><!-- m --> NSF Live! allows users to rip DPCM sample data out of NSFs.  Enjoy <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>jsr</b> [ Tue Apr 21, 2009 7:37 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />This reminded me that I was going to figure out the mixing level of VRC6 and the internal audio as I haven't seen it documented anywhere. So I made some quick tests with a Madara-cart and the result wasn't very surprising, the amplitude of VRC6 pulse channel levels was exactly as the internal pulse channels on the same volume levels. The sawtooth channel has one bit extra connected to the DAC so it's able to play twice as loud. (As explained in Kevins VRC6 chip info document).
<br />
<br />I haven't checked many emulators but it seems Nintendulator gets it right. NSFplay however doesn't, the default settings are too quiet.
<br />
<br />B00daW: If you want to tweak the Powerpak audio, just compare the pulse channels of VRC6 and 2A03 on the same amplitude and adjust the resistor until they both measure the same. (I assume the mixing inside the powerpak is linear.)
<br />
<br />Banshaku: It is the Akumajou order, but this can easily be changed in the NSF with a hex editor. (The PRG-image probably won't work properly as it doesn't set up the banks for the VRC6 mapper.)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Tue Apr 21, 2009 8:38 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">jsr wrote:</div><div class="quotecontent">It is the Akumajou order, but this can easily be changed in the NSF with a hex editor. (The PRG-image probably won't work properly as it doesn't set up the banks for the VRC6 mapper.)</div>
<br />
<br />For the PRG file, I had a feeling this would be the case so I already started to prepare my test sample with the updated driver source code. It's already compiling and working (in emulators).  I just need B00daW's music binary data+DPCM to compile it inside.
<br />
<br />I just inserted a new flag so you can select either the Akumajou or Madara/Esper dream board at compile time: it just replace the value of a few symbolic constants. Not many people may need that but at least it will be there.  I still plan to use Famitracker for my future game(s)/tech testing so I updated again the driver with my needs.  I still have a some issue with restoring the channels but I will figure it out later.
<br />
<br />I saw that in the main driver code that you inserted some stubs method for "maybe" disabling channels. Do you plan do add this option in a near future? <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />
<br />
<br />
<br />@B00daW: Based on JSR comments, do you still need to test it on the real thing?  Once I get the data, I can still do it someday.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>B00daW</b> [ Tue Apr 21, 2009 9:07 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I was under the assumption that the audio values were wrong per the PowerPak.  I have a 47K resistor installed, which is the popular prescription.
<br />
<br />So VRC6 channels are loud naturally, but are other expansion audio channels loud as well?
<br />
<br />Basically, am I noticing a problem or is it a lot of nothing?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>jsr</b> [ Thu Apr 23, 2009 4:41 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Banshaku wrote:</div><div class="quotecontent">I saw that in the main driver code that you inserted some stubs method for "maybe" disabling channels. Do you plan do add this option in a near future? <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div><br />Yes those methods are now functional and will available in the next version to make it easier to add sound effects. <br /><br /><div class="quotetitle">B00daW wrote:</div><div class="quotecontent">So VRC6 channels are loud naturally, but are other expansion audio channels loud as well?</div>
<br />To clarify, it shouldn't be much louder than the internal channels. I don't know about other channels, but I got a few other carts that I'll check sometime. (I suspect the same result.)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Banshaku</b> [ Thu Apr 23, 2009 6:52 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">jsr wrote:</div><div class="quotecontent">Yes those methods are now functional and will available in the next version to make it easier to add sound effects. </div>
<br />
<br />This is good news!  I will be more than happy to use it when it comes out.  Is it planned for version 3.0?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bucky o'hare</b> [ Tue May 19, 2009 2:39 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Regarding the powerpak and audio expansion-
<br />I was trying out some FDS games last night. The wavetable audio seems to be slightly out of tune, noticeably different than using Nestopia or listening to an NSF in notsofatso / nsfplug. I could provide samples later on if anyone is interested.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>