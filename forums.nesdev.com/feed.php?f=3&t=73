<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=73" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2005-07-02T12:24:50-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=73</id>
<entry>
<author><name><![CDATA[NewRisingSun]]></name></author>
<updated>2005-07-02T12:24:50-07:00</updated>
<published>2005-07-02T12:24:50-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2615#p2615</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2615#p2615"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2615#p2615"><![CDATA[
R = Y + sin(112°)*0.83*2 + cos(112°)*0.83*2<br />G = Y + sin(252°)*0.3*2 + cos(252°)*0.3*2<br />B = Y + sin(0°)*1*2 + cos(0°)*1*2<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=133">NewRisingSun</a> — Sat Jul 02, 2005 12:24 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[hap]]></name></author>
<updated>2005-07-02T07:05:34-07:00</updated>
<published>2005-07-02T07:05:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2613#p2613</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2613#p2613"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2613#p2613"><![CDATA[
<div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br />R-Y: 112° ´ 0.83, G-Y: 252° ´ 0.3 (B-Y: 0° ´ 1)<br /><br />This would translate into the following decoder matrix:<br />R = Y + 1.539*V - 0.622*U<br />G = Y - 0.571*V - 0.185*U<br />B = Y + 0.000*V + 2.000*U<br /></div><br /><br />How did you get those values from those angles ? When I don't understand something, I just do trial-and-error, and the only one I could find was tan(252)/2=1.539<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=115">hap</a> — Sat Jul 02, 2005 7:05 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2005-07-01T05:42:23-07:00</updated>
<published>2005-07-01T05:42:23-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2604#p2604</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2604#p2604"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2604#p2604"><![CDATA[
<div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br />I don't know anything about current RCA sets --- they're not even sold here in Europe.<br /></div><br />Are there any sets sold under the name THOMSON? Those are made by the same company as current RCA or current GE sets.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Fri Jul 01, 2005 5:42 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[NewRisingSun]]></name></author>
<updated>2005-07-01T01:00:14-07:00</updated>
<published>2005-07-01T01:00:14-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2601#p2601</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2601#p2601"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2601#p2601"><![CDATA[
I don't know anything about current RCA sets --- they're not even sold here in Europe.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=133">NewRisingSun</a> — Fri Jul 01, 2005 1:00 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-06-30T18:13:29-07:00</updated>
<published>2005-06-30T18:13:29-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2595#p2595</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2595#p2595"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2595#p2595"><![CDATA[
I've been trying to come up with a NES palette of my own for the longest time. I tried using the vid capture method to grab colors (or more than one card) but the results of that are way off. I'd tried Kevin Horton's generator but could never get satisfactory results. I just found your (AWJ) method a few days ago, and it's better than Kevin's but still doesn't do it for me <img src="http://forums.nesdev.com/images/smilies/icon_razz.gif" alt=":P" title="Razz" /> <br /><br />What I ended up doing a while back is color calibrating my TV and monitor as best I could and just winging my own pallete by eyeballing it from the NES playing on the TV. I'm still not %100 pleased with it, but I think it's pretty good. Like NewRisingSun said, I don't think there is a perfect hard coded palette.<br /><br />My results from my palette are interesting though, the hue shifts are quite uneven and so is the saturation, but to a lesser extent. I also noticed there is quite a difference between the color from RF output and composite output. The composite colors seem to be distributed better than RF (no surprise) but I actually found the RF colors to be more fitting and pleasing to the eye in most cases. BTW, I'm using an NTSC TV/NES.<br /><br />I am very interested in what you guys come up with here <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><br />NewRisingSun, this is a somewhat strange question, but it seems you may know or be able to find this out. The TV I'm using for my NES and other older consoles is a 27" RCA model# 27F630T. I'm wondering if you know how to enter the service mode on this? I've looked elsewhere on the net but have never found a combo that works. My screen geometry is messed up, it's rotated I would guess about 5 - 10 degrees. Very apparent with computer generated images.<p>Statistics: Posted by Guest — Thu Jun 30, 2005 6:13 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[NewRisingSun]]></name></author>
<updated>2005-06-30T11:40:19-07:00</updated>
<published>2005-06-30T11:40:19-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2592#p2592</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2592#p2592"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2592#p2592"><![CDATA[
<div class="quotetitle">AWJ wrote:</div><div class="quotecontent"><br />I was wondering a while ago exactly where the 0.877 and 0.493 coefficients in the YUV matrix came from.<br /></div><br /><br />Well, the low peak of the video signal must not go below a level of -0.33:<br />Luma - Chroma &gt; -0.33<br /><br />The nature of quadrature modulation means we can write it like this:<br />Y - sqrt (V² + U²) &gt; -0.33<br /><br />For R=1.0 or B=1.0, this would be violated if we just used V=R-Y and U=B-Y. Therefore, we need to scale them in such a way that R=1.0 and B=1.0 are just within range.<br />Let coR, coG, coB be given (they'd be 0.299, 0.587 and 0.114 in current implementations), and scR, scB the scale factors for R-Y,B-Y that we're looking for. The following must be fulfilled simultaneously (sorry, don't know how to do this in HTML):<br /><br /><img src="http://www.lau-net.de/~nl2305/scales.png" alt="Image" /><br /><br />The first line is for R=1.0, which means Y=coR, R-Y=1-coR, B-Y=0-coR. The second line is for B=1.0, you get the idea.<br />Have a lot of fun working out the scale factors from that. <img src="http://forums.nesdev.com/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /> <br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />It would be great if you could point me to a general formula for converting between color temperatures.  The page you linked to has the following matrices for converting between NTSC and EBU (=PAL?) colors:<br /></div><br /><br />The general algorithm would be to convert from (linear!) RGB values for the source phosphor to CIE XYZ values, and then from those to linear RGB values for the target phosphor. Setting up RGB&lt;-&gt;XYZ matrices from a given set of chromaticities is somewhat involved and best shown using C code, not a formula.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Are these color temperature conversions, or something else?  (And are they even correct, or are some of the signs reversed again?)  The page mentions that NTSC and EBU have different "white points", which I understand is related to color temperature (but am likely completely wrong)<br /></div><br /><br />Color temperature means white point. These equations are basically right, however meaningless since those "NTSC primaries" this page and other people keep talking about are completely obsolete (no real non-ancient NTSC TV uses them); unless you're trying to emulate the look of a <a href="http://home.att.net/~pldexnis/restoretv.html" class="postlink">1954 RCA CT-100 TV</a> set, you'd use "real world" primaries from actual monitor profiles, not these theoretical NTSC/SMPTE-C/EBU values.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=133">NewRisingSun</a> — Thu Jun 30, 2005 11:40 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-06-30T10:40:21-07:00</updated>
<published>2005-06-30T10:40:21-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2590#p2590</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2590#p2590"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2590#p2590"><![CDATA[
<div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br />Both 100% red and 100% blue are completly legal NTSC colors, in fact, the 0.877 and 0.493 coeffecients were deliberately chosen so that 100% red and 100% blue, which do occur in nature, WOULD be legal. 100% yellow is "illegal" in NTSC because the upper peak of the modulation exceeds 120 IRE (reaches about 133 IRE).<br />By the way, there's one more systematic difference between Japanese and "real" (American) NTSC: the NTSC standard calls for a 7.5% setup, Japanese devices however use 0%. I think you can even select between these two on some camcorders...<br /></div><br /><br />Yeah, I remember reading somewhere about the difference in black levels between standard NTSC and "NTSC-J".<br /><br />I was wondering a while ago exactly where the 0.877 and 0.493 coefficients in the YUV matrix came from.  I was able to work out that their ratio determined the angle of G-Y, and presumably was chosen so that G-Y would be more or less equidistant from R-Y and B-Y (it's actually just a bit closer to B-Y)<br /><br /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br />By the way, you wrote that you'd like to emulate the output for a variety of displays; that would mean you'd also have to adjust to different phosphor types, effectively necessitating complete color management, Photoshop-like. Basically what you'd want is a general conversion algorithm for RGB values between sets of given phosphor chromaticities. I've written a couple of C code lines for this, tell me if you need anything.<br /></div><br /><br />It would be great if you could point me to a general formula for converting between color temperatures.  The page you linked to has the following matrices for converting between NTSC and EBU (=PAL?) colors:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&#91;Rntsc&#93;   &#91;0.6984  0.2388  0.0319&#93;&#91;Rebu&#93;<br />&#91;Gntsc&#93; = &#91;0.0193  1.0727 -0.0596&#93;&#91;Gebu&#93;<br />&#91;Bntsc&#93;   &#91;0.0169  0.0525  0.8450&#93;&#91;Bebu&#93;<br /><br /><br />&#91;Rebu&#93;   &#91; 1.4425 -0.3173 -0.0769&#93;&#91;Rntsc&#93;<br />&#91;Gebu&#93; = &#91;-0.0275  0.9350  0.0670&#93;&#91;Gntsc&#93;<br />&#91;Bebu&#93;   &#91;-0.0272 -0.0518  1.1081&#93;&#91;Bntsc&#93;</div><br /><br />Are these color temperature conversions, or something else?  (And are they even correct, or are some of the signs reversed again?)  The page mentions that NTSC and EBU have different "white points", which I understand is related to color temperature (but am likely completely wrong)<br /><br />As you've probably guessed by now, my knowledge of this stuff is pretty fragmentary and mostly gleaned from a lot of Googling and doing math by hand.  My background is in biology, not color science...<p>Statistics: Posted by Guest — Thu Jun 30, 2005 10:40 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[NewRisingSun]]></name></author>
<updated>2005-06-29T22:44:41-07:00</updated>
<published>2005-06-29T22:44:41-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2584#p2584</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2584#p2584"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2584#p2584"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />(Yes, I know these are too saturated to be legal NTSC colors, but the math is simplest this way...)<br /></div><br /><br />Both 100% red and 100% blue are completly legal NTSC colors, in fact, the 0.877 and 0.493 coeffecients were deliberately chosen so that 100% red and 100% blue, which do occur in nature, WOULD be legal. 100% yellow is "illegal" in NTSC because the upper peak of the modulation exceeds 120 IRE (reaches about 133 IRE).<br />By the way, there's one more systematic difference between Japanese and "real" (American) NTSC: the NTSC standard calls for a 7.5% setup, Japanese devices however use 0%. I think you can even select between these two on some camcorders...<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Since you've made it clear that this isn't what those numbers mean in the first place, this discussion is probably meaningless.<br /></div><br /><br />Your equations would be right if it was about the R axis, not the R-Y axis... <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />By the way, the RGB-to-YIQ matrix on that page you linked to has a couple of the signs backwards.<br /></div><br /><br />Right, I've been meaning to email the author of those pages a couple of times, but always forgot... <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />I suspected such, but every NES dever I asked insisted that NTSC and PAL units produced the exact same colors. Thanks for the confirmation.<br /></div><br /><br />I must say though that I have never seen an American NES unit in operation, I have only seen a PAL NES as well as Japanese Famicoms, Twin Famicoms and AV Famicoms; so MAYBE the American NES produces hues like the PAL NES, though I think that's extremely unlikely, as the PPU is the same.<br /><br />By the way, you wrote that you'd like to emulate the output for a variety of displays; that would mean you'd also have to adjust to different phosphor types, effectively necessitating complete color management, Photoshop-like. Basically what you'd want is a general conversion algorithm for RGB values between sets of given phosphor chromaticities. I've written a couple of C code lines for this, tell me if you need anything. <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=133">NewRisingSun</a> — Wed Jun 29, 2005 10:44 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-06-29T21:23:34-07:00</updated>
<published>2005-06-29T21:23:34-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2583#p2583</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2583#p2583"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2583#p2583"><![CDATA[
<div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">For a standard NTSC decoder, the angles of the pure primary colors from the Q axis are:<br /></div><br /><br />Nonono, that's completely wrong. If you want to convert RGB values to NTSC and back, you need to use the proper matrices. Trigonometry alone won't get you anywhere until you're using the proper scale factors.<br />See <!-- m --><a class="postlink" href="http://wwwzenger.informatik.tu-muenchen.de/lehre/vorlesungen/graphik/info/csc/COL_29.htm">http://wwwzenger.informatik.tu-muenchen ... COL_29.htm</a><!-- m --></div><br /><br />I think you misunderstood what I was doing.  I was using the "proper" matrix:<br />    <br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&#91; R &#93;   &#91; 1  0.956  0.621 &#93;&#91; Y &#93;<br />&#91; G &#93; = &#91; 1 -0.272 -0.647 &#93;&#91; I &#93;<br />&#91; B &#93;   &#91; 1 -1.106  1.703 &#93;&#91; Q &#93;</div><br /><br />What I was doing was <em>inverting</em> this matrix to find the NTSC hues of SMPTE red, SMPTE green and SMPTE blue.  An equivalent (and simpler) way of doing it would have been to start with the inverse matrix:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&#91; Y &#93;   &#91; 0.299  0.587  0.114 &#93;&#91; R &#93;<br />&#91; I &#93; = &#91; 0.596 -0.274 -0.322 &#93;&#91; G &#93;<br />&#91; Q &#93;   &#91; 0.211 -0.523  0.312 &#93;&#91; B &#93;</div><br /><br />and just plug in RGB triplets of (1, 0, 0), (0, 1, 0) and (0, 0, 1)  (Yes, I know these are too saturated to be legal NTSC colors, but the math is simplest this way...)<br /><br />Doing this I get:<br /><br />RGB(1, 0, 0) = YIQ(0.299, 0.596, 0.211)<br />hue = tan-1(0.596 / 0.211) = 70.5°<br /><br />RGB(0, 1, 0) = YIQ(0.587, -0.274, 0.523)<br />hue = tan-1(-0.274 / -0.523) = 207.7°<br /><br />RGB(0, 0, 1) = YIQ(0.114, -0.322, 0.312)<br />hue = tan-1(-0.322 / 0.312) = -45.9°<br /><br />...which are exactly the same hues as I got by inverting the YIQ-to-RGB matrix (as expected).<br /><br />Since you've made it clear that this isn't what those numbers mean in the first place, this discussion is probably meaningless.<br /><br />By the way, the RGB-to-YIQ matrix on that page you linked to has a couple of the signs backwards.<br /><br /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Previously you referred to I and Q being 105°-120° apart on Japanese decoders, but now you're talking in terms of U and V. Could you clarify what you meant earlier in reference to Japanese equipment?<br /></div><br /><br />It's just different ways of talking about the same thing:</div><br /><br />Yes, I already know what the relationship between I/Q and U/V is.  Sorry, I understand what you meant now.<br /><br /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Since PAL uses YUV instead of YIQ, are the hues on a PAL PPU "rotated" one step compared to a NTSC PPU?<br /></div><br /><br />The PAL NES creates hues that are rotated half a step (15°) vs. the NTSC PPU, making color x8 look like SMPTE yellow (R=G). Forget about "hard-coded" palettes, they're based on what emulator authors think "looks good". Yes, the PAL NES actually creates different colors than the NTSC NES.</div><br /><br />I suspected such, but every NES dever I asked insisted that NTSC and PAL units produced the exact same colors.  Thanks for the confirmation.<p>Statistics: Posted by Guest — Wed Jun 29, 2005 9:23 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[NewRisingSun]]></name></author>
<updated>2005-06-29T22:53:44-07:00</updated>
<published>2005-06-29T15:31:58-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2578#p2578</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2578#p2578"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2578#p2578"><![CDATA[
<div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />For a standard NTSC decoder, the angles of the pure primary colors from the Q axis are:<br /></div><br /><br />Nonono, that's completely wrong. If you want to convert RGB values to NTSC and back, you need to use the proper matrices. Trigonometry alone won't get you anywhere until you're using the proper scale factors.<br />See <!-- m --><a class="postlink" href="http://wwwzenger.informatik.tu-muenchen.de/lehre/vorlesungen/graphik/info/csc/COL_29.htm">http://wwwzenger.informatik.tu-muenchen ... COL_29.htm</a><!-- m --><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Previously you referred to I and Q being 105°-120° apart on Japanese decoders, but now you're talking in terms of U and V. Could you clarify what you meant earlier in reference to Japanese equipment?<br /></div><br /><br />It's just different ways of talking about the same thing:<br />V = 0.877*(R-Y)<br />U = 0.493*(B-Y)<br />I = V plus 33 degrees<br />Q = U plus 33 degrees.<br /><br />R-Y is at 90 degrees, as is V.<br />B-Y is at 0 degrees, as is U.<br />I is at 123 degrees.<br />Q is at 33 degrees.<br /><br />You can decode the same signal either using I and Q, or U and V; the result is the same except that the hue offset is different, which is okay since all NTSC decoders have a hue control anyway.<br />I and Q, as well as U and V, are 90° apart in standard; they are further apart (up to 120°) in common implementations.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Since PAL uses YUV instead of YIQ, are the hues on a PAL PPU "rotated" one step compared to a NTSC PPU?<br /></div><br /><br />The PAL NES creates hues that are rotated half a step (15°) vs. the NTSC PPU, making color x8 look like SMPTE yellow (R=G). Forget about "hard-coded" palettes, they're based on what emulator authors think "looks good". Yes, the PAL NES actually creates different colors than the NTSC NES.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />I think I'd rather see the algorithm you used to create those palettes.<br /></div><br /><br />Well, what did I just post before, about "Yellowness" and such... <img src="http://forums.nesdev.com/images/smilies/icon_rolleyes.gif" alt=":roll:" title="Rolling Eyes" /><br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />This algorithm could be used for emulation of other composite video hardware similar to the NES PPU in the way they produced colors, such as the Atari TIA family and the Commodore VIC, VIC II and TED (used in the VIC20, C64/C128 and Plus4/C16 respectively<br /></div><br /><br />Well, these are American machines, so try the US decoder matrix I gave you. You can also convert SNES RGB values to YUV using the standard encoder matrix and back to RGB using the "Sony US TV" decoder matrix if you're in the mood. <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=133">NewRisingSun</a> — Wed Jun 29, 2005 3:31 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-06-29T13:49:43-07:00</updated>
<published>2005-06-29T13:49:43-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2576#p2576</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2576#p2576"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2576#p2576"><![CDATA[
This time not only did I forget my name, I left a sentence unfinished.  What I meant to say in the second-last paragraph was "This algorithm could be used for emulation of other composite video hardware similar to the NES PPU in the way they produced colors, such as the Atari TIA family and the Commodore VIC, VIC II and TED (used in the VIC20, C64/C128 and Plus4/C16 respectively)<p>Statistics: Posted by Guest — Wed Jun 29, 2005 1:49 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-06-29T13:43:50-07:00</updated>
<published>2005-06-29T13:43:50-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2575#p2575</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2575#p2575"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2575#p2575"><![CDATA[
<div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br />It is true that x1-xc colors oscillate between the x0 and xd values, HOWEVER that information is only relevant when you're dealing in voltage levels --- it's unusable if you're trying to deduce saturations from a "TV-captured" palette, because there is not a set of x0/xd values that is not clipped --- for 0x and 1x, the d color is clipped at zero; for 2x and 3x, the 0 color is clipped at 255 (or 1.0, whatever your notation is).<br />Chances are that the 3x colors are just as saturated as the rest (level-wise), but appear less saturated because most TVs "hard clip" the input signal at 120 IRE, thus reducing modulation and therefore, saturation.<br /></div><br /><br />So, can someone use a scope and get the actual voltage levels for all the x0 and xD colors?<br /><br /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br />The coefficients indeed differ from manufacturer to manufacturer and from model to model, but the algorithms are more-or-less the same. For example, a given US TV set might use a color decoder with the following characteristics (taken from a Sony service manual):<br /><br />R-Y: 112° x 0.83, G-Y: 252° x 0.3 (B-Y: 0° x 1)<br /><br />This would translate into the following decoder matrix:<br />R = Y + 1.539*V - 0.622*U<br />G = Y - 0.571*V - 0.185*U<br />B = Y + 0.000*V + 2.000*U<br /></div><br /><br />Hmm, it looks like I misunderstood what those angles meant.  I assumed that 112° and 252° were the angles of the hues that decoded to pure red (R &gt; G = B) and pure green (G &gt; R = B) relative to the hue that decoded to pure blue (B &gt; R = G)  For a standard NTSC decoder, the angles of the pure primary colors from the Q axis are:<br /><br />R = tan-1[(-0.647 - 1.703)/(-1.106 + 0.272)] = 70.5°<br />G = tan-1[( 0.621 - 1.703)/(-1.106 - 0.956)] = 207.7°<br />B = tan-1[( 0.621 + 0.647)/(-0.272 - 0.956)] = -45.9°<br /><br />The angle between red and blue is 116.4° and the angle between green and blue is 253.6°, which are very close to the angles given in the Sony datasheet, so you can see why I thought along these lines.<br /><br />Previously you referred to I and Q being 105°-120° apart on Japanese decoders, but now you're talking in terms of U and V.  Could you clarify what you meant earlier in reference to Japanese equipment?<br /><br /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent"><br />Anyway, maybe you'd like to see my calculated "Japanese" palettes, which I like very much and match those old Japanese TVs I've seen:<br /><!-- m --><a class="postlink" href="http://www.lau-net.de/~nl2305/6500K.pal">http://www.lau-net.de/~nl2305/6500K.pal</a><!-- m --><br /><!-- m --><a class="postlink" href="http://www.lau-net.de/~nl2305/9300K.pal">http://www.lau-net.de/~nl2305/9300K.pal</a><!-- m --><br /></div><br /><br />I think I'd rather see the algorithm you used to create those palettes.  What I'm really interested in is not creating a single "perfect" NES palette, but an algorithm with parameters which can be tweaked to simulate the colors produced on a variety of displays.  This algorithm could be used in emulators of other <br /><br />Before I forget, I had one question about the PAL version of the NES.  Since PAL uses YUV instead of YIQ, are the hues on a PAL PPU "rotated" one step compared to a NTSC PPU?  I've never seen a PAL NES in operation, but the "PAL palettes" for emulators I've seen (such as the one hardcoded into FCEUltra) all make hue x8 orange-yellow, not green-yellow.<p>Statistics: Posted by Guest — Wed Jun 29, 2005 1:43 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[NewRisingSun]]></name></author>
<updated>2005-06-29T11:50:39-07:00</updated>
<published>2005-06-29T11:50:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2574#p2574</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2574#p2574"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2574#p2574"><![CDATA[
<div class="quotetitle">tepples wrote:</div><div class="quotecontent"><br />If you do not emulate "artifact colors", then the bricks in underground levels of Super Mario Bros. won't look like those on real NES hardware. Instead, they might look like the bricks on a VS Unisystem or a PlayChoice 10.<br /></div><br /><br />The NES does not use "artifact colors", period. Forget about them, they only apply to the Apple ][ and the CGA 160x200 composite color mode. It doesn't apply the NES simply because the NES generates colors differently. The word "artifact colors" has a specific meaning which does not apply to the NES PPU. <br /><br />What you're describing is the result of the fact that the PPU generates the luminance and the chrominance portion of the video signal in the same process and that it generates square waves instead of sine waves --- it has nothing to do with "artifact colors". The "shimmering" by the way only occurs in the NTSC PPU, the PAL PPU has constant "jagginess".<br /><br />I don't even know whether that's worth emulating --- after all, it doesn't affect the COLOR of a pixel, only the placement.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />NES-based arcade hardware generated RGB from a palette stored in a PROM,<br /></div><br /><br />Right, but keep in mind that the palette found in RGB PPUs is not accurate in that it would correctly represent what NES games should look like --- several PlayChoice 10 games (Volleyball, Punch-Out) actually had their color values changed in the game code from their regular cartridge versions to look better on the PC10 PPU.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />That would mean that the lightest row of non-gray colors is approximately half as saturated as the other three rows.<br /></div><br /><br />It is true that x1-xc colors oscillate between the x0 and xd values, HOWEVER that information is only relevant when you're dealing in voltage levels --- it's unusable if you're trying to deduce saturations from a "TV-captured" palette, because there is not a set of x0/xd values that is not clipped --- for 0x and 1x, the d color is clipped at zero; for 2x and 3x, the 0 color is clipped at 255 (or 1.0, whatever your notation is).<br />Chances are that the 3x colors are just as saturated as the rest (level-wise), but appear less saturated because most TVs "hard clip" the input signal at 120 IRE, thus reducing modulation and therefore, saturation.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Can you provide more details as to how US and Japanese sets differ from each other and from the NTSC specification, or does it vary from manufacturer to manufacturer?<br /></div><br /><br />The coefficients indeed differ from manufacturer to manufacturer and from model to model, but the algorithms are more-or-less the same. For example, a given US TV set might use a color decoder with the following characteristics (taken from a Sony service manual):<br /><br />R-Y: 112° ´ 0.83, G-Y: 252° ´ 0.3 (B-Y: 0° ´ 1)<br /><br />This would translate into the following decoder matrix:<br />R = Y + 1.539*V - 0.622*U<br />G = Y - 0.571*V - 0.185*U<br />B = Y + 0.000*V + 2.000*U<br /><br />This matrix represents a typical "red boost", supposedly making flesh tones more "natural" on 9300K phosphors (manufacturers use 9300K phosphors because they look "brighter" than the 6500K that the standard calls for). Looks a little like Chris Covell's old captured palette.<br /><br />Again, other sets might use different coefficients, but the algorithm is basically the same, at least for US sets.<br /><br />Japanese TV sets are a different story, because Asian fleshtones are different; instead of a "red boost", you have a "yellow boost". Basically, "Yellowness" is (I-Q), so, to boost yellows, you'd do something like this:<br />Yellowness = (I-Q);<br />if (Yellowness &gt; 0) {<br />  I = I + Yellowness*factor;<br />  Q = Q - Yellowness*factor;<br />}<br />"factor" would of course be &lt; 1. The decoding matrix would be more-or-less like the above with a little less gain in the red channel, I suppose.<br /><br />Only as a general idea though, I don't know the exact coefficients for any given set because newer Japanese TVs (to whose service manuals I have access) don't use "yellow boost" anymore because everyone over there uses Digital TV now and thus these "picture improvement" features have become obsolete. Consequently, the matrices listed in today's Japanese TV's service manuals are basically like the same as the NTSC standard's.<br /><br />Anyway, maybe you'd like to see my calculated "Japanese" palettes, which I like very much and match those old Japanese TVs I've seen:<br /><!-- m --><a class="postlink" href="http://www.lau-net.de/~nl2305/6500K.pal">http://www.lau-net.de/~nl2305/6500K.pal</a><!-- m --><br /><!-- m --><a class="postlink" href="http://www.lau-net.de/~nl2305/9300K.pal">http://www.lau-net.de/~nl2305/9300K.pal</a><!-- m --><br /><br />Use the first one if your PC monitor is set to 6500K (it usually is if you've calibrated your monitor for photoshop) --- it will simulate the blueish picture of a 9300K monitor; if your PC monitor is set to 9300K (which most monitors are factory-setting-wise), use the second one, it's like the "raw output". Make sure you're getting the right one for accuracy --- if you use the 6500K.pal on a 9300K monitor, it'll look way too blue; if you use the 9300K.pal on a 6500K monitor, it'll look too yellowish. <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br />Notice how the yellow boost that is applied in these palettes makes SMB3's color combinations of 0x27 and 0x36 actually look sensible, or likewise 0x29 and 0x38 in Ice Climber and others.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=133">NewRisingSun</a> — Wed Jun 29, 2005 11:50 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Anonymous]]></name></author>
<updated>2005-06-27T20:18:14-07:00</updated>
<published>2005-06-27T20:18:14-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2551#p2551</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2551#p2551"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2551#p2551"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />I take it Nintendo's arcade boxes used RGB (why use lossy modulation schemes when you can just send the color components directly to the CRT?).<br /></div><br /><br />Yes, NES-based arcade hardware generated RGB from a palette stored in a PROM, like typical arcade video hardware of the time (more modern arcade hardware has fully software-defined palettes, like a SNES or a PC's VGA card).  The only unusual thing about Nintendo's arcade hardware was that the color PROM was embedded right in the PPU rather than being on a separate chip; games with different palettes used different PPU models.  This may have been intended as a form of copy protection.<p>Statistics: Posted by Guest — Mon Jun 27, 2005 8:18 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2005-06-27T15:31:07-07:00</updated>
<published>2005-06-27T15:31:07-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2550#p2550</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2550#p2550"/>
<title type="html"><![CDATA[A new NTSC palette generator]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=73&amp;p=2550#p2550"><![CDATA[
<em>If you do not emulate "artifact colors", then the bricks in underground levels of Super Mario Bros. won't look like those on real NES hardware. Instead, they might look like the bricks on a VS Unisystem or a PlayChoice 10. </em><br /><br />And they won't shimmer when you scroll the screen (bothersome or not, it was part of the NES experience). I take it Nintendo's arcade boxes used RGB (why use lossy modulation schemes when you can just send the color components directly to the CRT?).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Mon Jun 27, 2005 3:31 pm</p><hr />
]]></content>
</entry>
</feed>