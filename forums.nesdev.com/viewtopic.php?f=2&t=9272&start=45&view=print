<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - IF macro for ca65</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">IF macro for ca65</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=9272">http://forums.nesdev.com/viewtopic.php?f=2&amp;t=9272</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>4</strong> of <strong>4</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Movax12</b> [ Mon Oct 28, 2013 12:27 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Please Help me Understand This Schematic Portion</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I have all kinds of modular stuff going on for my game project. I have a global config file that has a bunch of options that can vastly change what is output. This part of the project stands on its own though, and I like the fact it doesn't need any library code or memory on it's own. I do imagine that I would release the rest of my ideas and some library stuff at some point, which may be closer to batari BASIC. The flexibility of the syntax with ca65hl is already much more developed however.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>slobu</b> [ Mon Oct 28, 2013 12:37 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Please Help me Understand This Schematic Portion</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Movax12 wrote:</div><div class="quotecontent">I have all kinds of modular stuff going on for my game project. I have a global config file that has a bunch of options that can vastly change what is output. This part of the project stands on its own though, and I like the fact it doesn't need any library code or memory on it's own. I do imagine that I would release the rest of my ideas and some library stuff at some point, which may be closer to batari BASIC. The flexibility of the syntax with ca65hl is already much more developed however.</div><br /><br />Are you familiar with NESHLA?<br /><!-- m --><a class="postlink" href="http://neshla.sourceforge.net/">http://neshla.sourceforge.net/</a><!-- m --><br /><br />Does this project compare with that (as far as results not implementation)?.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Movax12</b> [ Mon Oct 28, 2013 1:13 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IF macro for ca65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Odd that the sub-subject header is wrong on the last two posts.. forum bug?<br /><br />Anyway, yes, read the 1st post, I used to use NESHLA. I would consider the abilities of ca65hl to be comparable but more advanced.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Oct 28, 2013 4:22 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IF macro for ca65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Movax12 wrote:</div><div class="quotecontent">Odd that the sub-subject header is wrong on the last two posts.. forum bug?</div><br />If you push the quote button, phpBB 3 copies the quoted post's subject into your post's subject. Otherwise, it copies the first post's current subject (which the Subject Fairy may have since edited) into your post's subject. If you click quote, delete the entire quoted post, and write something else entirely, your post still gets the quoted post's subject.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>darkhog</b> [ Sat Nov 16, 2013 11:26 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IF macro for ca65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Could you make some kind of central site with all of your code? Tried to find something on your blog, but it is mixed with disassembly of SMB and whatnot. Also your code formatting makes my eyes hurt (hint: using blue color for background, white for keywords and yellow for code works only in 80x25 terminal that uses DOS font, in 320x240, on anything different it just hurt people's eyes). Anyway, since I'm learning NES assembly now (with ca65), your macro will be useful for me.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Movax12</b> [ Sat Nov 16, 2013 11:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Check page 3 of this thread for the assembla link. Check out the wiki. Sorry you don't like the colors, my eyes like it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>darkhog</b> [ Sat Nov 16, 2013 12:42 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IF macro for ca65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks! Have a  <img src="./images/smilies/Mfr_icon_homebrew.png" alt=":beer:" title="Beer" /> on me!<br /><br />Anyway, since you are pretty knowledgeable, could you do some macros for following things:<br />- Setting tile ID in nametable at specific x,y, so I can plot tiles onto nametable (very important if you are going to make something more advanced than scrolling static screen)<br />- Plotting 16-bit numbers on screen for things like score, etc. (as decimals)<br /><br />I won't mislead you: I am quite noob (yet) when it comes to NES development and this would give me boost I need to explore this further.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Shiru</b> [ Sat Nov 16, 2013 1:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IF macro for ca65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />darkhog, as a beginner NES software developer, you'd really better to forget about macros for now, until you learn some 6502 assembly and the NES HW basics (memory map, at least), maybe by reading through the Nerdy Nights. These two things you asking aren't how the things on the NES works. Setting up a VRAM address or a RAM pointer to given x,y with a macro could work, but it'll lead to inefficient code, forcing you to provide x,y in a specific, not-so-optimal way. Displaying score with a macro is just nonsense, it should be done with a subroutine instead, because macro will duplicate the (not so short) code at every call, which will give program memory overhead for near-zero CPU speed gain. Not to mention that there are many ways to display score, each one has its specifics and should be used accordingly.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>darkhog</b> [ Sat Nov 16, 2013 2:36 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IF macro for ca65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Shiru wrote:</div><div class="quotecontent">darkhog, as a beginner NES software developer, you'd really better to forget about macros for now, until you learn some 6502 assembly and the NES HW basics (memory map, at least), maybe by reading through the Nerdy Nights. These two things you asking aren't how the things on the NES works. Setting up a VRAM address or a RAM pointer to given x,y with a macro could work, but it'll lead to inefficient code, forcing you to provide x,y in a specific, not-so-optimal way. Displaying score with a macro is just nonsense, it should be done with a subroutine instead, because macro will duplicate the (not so short) code at every call, which will give program memory overhead for near-zero CPU speed gain. Not to mention that there are many ways to display score, each one has its specifics and should be used accordingly.</div><br />Then as subroutines, geez...<br /><br />Also for setting specific tile on specific x/y I was thinking about stuff like that:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">;store previous values of registers<br />sta zp_tempa<br />stx zp_tempx<br />sty zp_tempy<br />lda #$3b ; load tile to put on tilemap<br />ldx #5 ;load x of tile<br />ldy #5 ; load y of tile<br />jsr place_tile<br />;restoring old values of registers:<br />lda zp_tempa<br />ldx zp_tempx<br />ldy zp_tempy</div><br /><br />Without routine like that making discrete changes to nametable such as putting score, updating lifebars, etc. is impossible if you don't want to update whole nametable.<br /><br />Also I was using displaying score as example. Another one may be displaying current level number, etc. - anything that involves displaying decimal 16bit number on screen. I just want general routine to display decimal numbers, that's all.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Nov 16, 2013 3:07 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IF macro for ca65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />To translate a 16-bit number from binary to decimal, you could use <a href="http://wiki.nesdev.com/w/index.php/16-bit_BCD" class="postlink">this subroutine</a> that takes about 700 cycles (6 scanlines) to get the digits, and then you could make another subroutine that runs during vblank and prints the digits to the screen. In my current project, there are four steps: get the digits, convert them to an ASCII string, render the string to tiles, and copy the tiles to the screen.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Shiru</b> [ Sat Nov 16, 2013 3:25 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IF macro for ca65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Well, macros vs subrotines is not 'geez', they are competely different things, related to different entities (specific translator vs CPU). This difference means that you are asking a random guy who is good is in making macros for cc65 in a thread about macros for cc65 to give you some random code, i.e. you are asking to do completely different thing.<br /><br />If you are understand how the NES video hardware workds, you should understand that setting a tile in a nametable is not so straightforward thing. If your nametable is just 1024 bytes in the main RAM, it is one thing. If it is in the VRAM (actual nametable), and the rendering is disabled, it is another. If you need to update tiles when rendering is enabled (your case, as you have mentioned scrolling), this is a whole range of different things: updating sequences of random tiles, updating columns or rows, updating only tiles or attributes, etc, etc, etc. A lot of things should be considered to provide some solution to the task. It can't be as simple as 'please make me a macro', it is a whole topic to be discussed, with certain level of knowledge considered (about the HW, about your specific needs, etc).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Movax12</b> [ Sun Nov 17, 2013 12:58 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: IF macro for ca65</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />darkhog, I'm more than happy to help you with a specific macro question if you would like, but macros aren't subroutines, though they can call subroutines, it's not the same thing.<br /><br />Writing a macro to do some nametable functions is doable, but, as Shiru says, there are many different things that need to be considered, and such a macro would have to be very generic with lots of options to suit different uses, or very specific to what is needed at the time. <br /><br />If your macro was writing to a vram buffer, for example, you still need to have a separate routine to copy that data to screen when NMI was triggered.<br /><br />Think of a macro as a routine that is called when assembling the code, that outputs 6502 assembly, or other macros until only 6502 assembly is left. The assembler then assembles that code. The macro can not eliminate actually writing the code.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>4</strong> of <strong>4</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>