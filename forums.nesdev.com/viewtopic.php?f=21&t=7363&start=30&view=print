<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Some image conversions I made</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Some image conversions I made</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=21&amp;t=7363">http://forums.nesdev.com/viewtopic.php?f=21&amp;t=7363</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>3</strong> of <strong>7</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>RLError</b> [ Wed Jan 26, 2011 10:56 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">There's also <a href="http://www.geocities.jp/littlimi/bad_apple_2.htm" class="postlink">this</a>.</div>
<br />
<br />All of the demos linked to in this thread are awesome, but WOW! THIS demo is INCREDIBLY mind-blowing! My goodness! It was a immense shock to me when I loaded it up and experienced it in its entirety. I hope more people get a chance to see this.
<br />
<br />Oh, and
<br /><img src="http://img210.imageshack.us/img210/8751/transwas.png" alt="Image" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Shiru</b> [ Wed Jan 26, 2011 11:29 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><a href="http://sprite-ripper.narod.ru/works.html" class="postlink">There</a> are two other animation NES demos, ones which marked 001 and 002.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>RLError</b> [ Wed Jan 26, 2011 1:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />These animations are pretty cool. I'm a little disappointed because I found out that the animation and music in that Bad Apple demo wasn't made just for the demo. It's still pretty cool and it's obviously an impressive feat.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Onju_Asakura</b> [ Sun Mar 20, 2011 11:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The Dinosaur looks like freakin' holographic 3D 0.0

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Thu Aug 04, 2011 6:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I decided to release the tool which was used for these conversions. Download it <strong><a href="http://kkfos.aspekt.fi/downloads/nes-image-converter-0.1.1.zip" class="postlink">HERE</a></strong>.
<br />
<br />EDIT: Note: There's a small bug in the tool, there can't be spaces in the path of the image.
<br />
<br /><span style="text-decoration: underline"><span style="font-size: 150%; line-height: normal">Basic usage</span></span>
<br />
<br />This tool takes a 256x480 or 512x240 resolution image and attempts to convert it to be displayed on NES to the best of its abilities. You can of course also convert a 256x240 image (so it won't flicker) by resizing it (using nearest neighbor filtering) to 256x480 or 512x240, then converting.
<br />
<br />To use it, first of all you'll need to download and install <a href="http://www.imagemagick.org/script/binary-releases.php#windows" class="postlink">ImageMagick</a> (download the file ImageMagick-x.x.x-x-Q16-windows-dll.exe). After installing, open up command line and type "convert --version" to verify it installed succesfully. It should print something like this:
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">Version: ImageMagick 6.7.1-2 2011-08-02 Q16 http://www.imagemagick.org<br />Copyright: Copyright &#40;C&#41; 1999-2011 ImageMagick Studio LLC<br />Features: OpenMP<br /></div>
<br />You'll also need some version of the .NET runtime, I'm not exactly sure which. But you probably have it anyways if you're not using an ancient version of Windows.
<br />
<br />In the package there's a file named "sample.png" which looks like this:
<br />
<br /><img src="http://thefox.aspekt.fi/sample.png" alt="Image" />
<br />
<br />Drag &amp; drop "sample.png" over the file "convert-256x480.cmd". After a little while it should have been converted to "sample.nes". Open the ROM in your favourite emulator to verify it works. I prefer Nestopia, since it seems to be the best at keeping a stable frame rate. If it worked, CONGLATURATION!!! If not, drop me a line.
<br />
<br /><span style="text-decoration: underline"><span style="font-size: 150%; line-height: normal">Preparing images for conversion</span> (with Photoshop)</span>
<br />
<br />So how to prepare your own images for converting? You can't use just any arbitrary image. Here are the restrictions:
<br />
<br />- Resolution must be 256x480 or 512x240.
<br />- All colors in the image must be from Nestopia's YUV palette! Photoshop palette file is included in the package (nestopia-yuv-palette.act).
<br />- Bit depth of the input image doesn't matter (at least 8 bpp and 24 bpp work).
<br />
<br />Here's a process I've found to work fairly well for preparing arbitrary images. Let's take this random image from the internet for example:
<br />
<br /><img src="http://thefox.aspekt.fi/sample2-0.jpg" alt="Image" />
<br />
<br />First I'm going to resize it down to 512x240 (from menu Image -&gt; Image Size). 256x480 could be used as well, it's your choice. Looks like this:
<br />
<br /><img src="http://thefox.aspekt.fi/sample2-1.jpg" alt="Image" />
<br />
<br />Now we need to reduce the number of colors in the image. Go to menu Image -&gt; Mode and choose Indexed Color. This dialog will pop up:
<br />
<br /><img src="http://thefox.aspekt.fi/sample2-2.png" alt="Image" />
<br />
<br />Color amount between 9-12 seems to work the best. The higher the number of colors, harder it is for the converter to give good results. I like to use Pattern dithering, but Diffusion can produce nice results as well.
<br />
<br />The result looks like this:
<br /><img src="http://thefox.aspekt.fi/sample2-3.png" alt="Image" />
<br />
<br />Next step is to make the colors compatible with NES palette. First we need to convert the image back to RGB. Choose to Image -&gt; Mode -&gt; RGB Color.
<br />
<br />At this point it's usually good to make some adjustments to the image to make it better suited for NES. For example, pump up the contrast from Image -&gt; Adjustments -&gt; Brightness/Contrast.  Image -&gt; Adjustments -&gt; Curves is another useful one. High contrast images tend to work better because there aren't very many shades of colors available on NES. The adjustments here are really the key to getting decent looking results, along with the complexity of the image.
<br />
<br />Here's the image after my adjustments:
<br /><img src="http://thefox.aspekt.fi/sample2-4.png" alt="Image" />
<br />
<br />Now let's apply the NES palette. Go again to Image -&gt; Mode and choose Indexed Color. Under "Palette", choose "Custom...". In the "Color Table" dialog press "Load..." and navigate to the file "nestopia-yuv-palette.act". Be sure to turn Dithering off at this point! While it might look better, it'll make the image too complex to convert well. Take a look at the preview, and if it looks like shit, go back to adjusting the image.
<br />
<br />Press OK, and here's the result:
<br />
<br /><img src="http://thefox.aspekt.fi/sample2-5.png" alt="Image" />
<br />
<br />Now the image is ready to be converted. Save it in PNG format, and drag&amp;drop the resulting PNG over "convert-512x240.cmd" to convert it. Pray to your deity of choice that it will be converted well.
<br />
<br />Open the ROM in your favourite emulator to enjoy the fruits of your labor... It should look something like this:
<br />
<br /><img src="http://thefox.aspekt.fi/sample2-6.jpg" alt="Image" />
<br />
<br />That's all! As usual, if you make something cool with this, let me know!
<br />
<br />EDIT: Forgot to mention, in this latest version of image viewer button A can be pressed to skip over one frame, making it possible to adjust the even/odd field on displays such as HDTVs which treat the signal as interlaced. This can be used to make 256x480 images look better (or rather, a little bit less bad) on those displays.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Fri Aug 05, 2011 12:10 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Cool, I can't wait to get back home to try it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Bregalad</b> [ Sun Aug 14, 2011 3:29 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">To use it, first of all you'll need to download and install ImageMagick. </div>
<br />Dead link

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>LocalH</b> [ Tue Sep 13, 2011 2:02 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That composite shot reminds me of why many Genesis/MD artists have used vertical dithering (well, now that I think about it, it's more accurately termed horizontal dithering). No vertical blending means that dithering on the Y axis sticks out like a sore thumb. Give me a bit to get back to my PC and I'll post my ImageMagick dithering threshold map for doing X-only dithering (and I'm experimenting with a technique to flip the map and make fieldrate flickering acceptable in many more cases so that might be useful too - C64 democrews have flickered for years without complaint, and they're primarily PAL). ImageMagick can also take a second input image containing the target colorset (which can hold more than 256 colors, btw), which is really handy for making proper 9-bit images for the MD and would also be useful for targeting either the YUV or RGB palette for the NES.
<br />
<br />I'll also do a test using that same image, with the only change to your script being to use my X-only dithering map (well, that and moving the color reduction from Photoshop to ImageMagick, using a remap image derived from your Photoshop palette).
<br />
<br />Edit: After doing some experiments, it turns out that things don't work so well with the flickering (although part of the difficulty is the non-RGB palette of the NES, as the -remap parameter is a color reduction step, not just a color mapping tool, so I'm finding it a pain in the ass to make IM use the PPU YUV palette as the colormap to reduce to, and same thing with the -colors switch). Am I just having trouble grokking IM or is what I'm wanting to do only possible with IM for the MD because of the regular 8-level RGB?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thefox</b> [ Tue Sep 13, 2011 8:12 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Bregalad wrote:</div><div class="quotecontent"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">To use it, first of all you'll need to download and install ImageMagick. </div><br />Dead link</div><br />Sorry, missed this earlier. Fixed now.<br /><br /><div class="quotetitle">LocalH wrote:</div><div class="quotecontent">ImageMagick can also take a second input image containing the target colorset (which can hold more than 256 colors, btw), which is really handy for making proper 9-bit images for the MD and would also be useful for targeting either the YUV or RGB palette for the NES.</div><br />Yep, but the resulting images are usually way too dithered to work well on the NES, that is, they contain way too many colors inside an attribute block. Dithering to an arbitrary colorset can be done with Photoshop as well (and at least previously Photoshop's dithering algorithms looked much better than ImageMagick's), but like said, it just doesn't work very well.<br /><br />The attribute limitations really are a pain in the ass for realistic images like these.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">After doing some experiments, it turns out that things don't work so well with the flickering (although part of the difficulty is the non-RGB palette of the NES, as the -remap parameter is a color reduction step, not just a color mapping tool, so I'm finding it a pain in the ass to make IM use the PPU YUV palette as the colormap to reduce to, and same thing with the -colors switch). Am I just having trouble grokking IM or is what I'm wanting to do only possible with IM for the MD because of the regular 8-level RGB?</div>
<br />I'm not sure.
<br />
<br />Btw here are some new images I've converted: <!-- m --><a class="postlink" href="http://thefox.aspekt.fi/new-images.zip">http://thefox.aspekt.fi/new-images.zip</a><!-- m --> (Nestopia preferred, it seems to be the best at keeping a stable framerate).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>LocalH</b> [ Fri Sep 16, 2011 12:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Very nice images, the use of alternation at the frame rate (I call it "color-interlacing" from my days learning about the C64) is quite good for color blending (as long as the two colors being alternated are similar in luminance, obviously alternating black and white is not good). It would certainly be nice if the NES had a way to shift the image by a half-pixel, then you could also simulate double horizontal resolution (like they do on the C64 by using two multicolor images, which of course use double-wide pixels, and then one of the two images is offset by one hires pixel in hardware). And still in such cases you'd only really get good results on RGB PPUs, as the composite color phasing interferes with precise NES pixel placement.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zelex</b> [ Tue Sep 27, 2011 11:29 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Theoretically, couldn't you change the palette as the PPU draws the frame (per pixel or per tile) and get dramatically more colors?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Dwedit</b> [ Tue Sep 27, 2011 11:51 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You can, but the screen needs to be turned off for about a scanline worth of time.  And you'll see the colors you write to the palette drawn on the screen.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>jpx72</b> [ Wed Sep 28, 2011 2:33 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Very nice application, thanks for the long description!
<br />I was able to do a <a href="http://jpx72.detailne.sk/Famicom.nes" class="postlink">nice famicom picture</a> but I wasn't able to use the palette provided, I'm using PaintshopPro and every palette editor is showing "wrong file" when trying to open your *.act palette <img src="./images/smilies/icon_sad.gif" alt=":(" title="Sad" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Sep 28, 2011 4:12 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Zelex wrote:</div><div class="quotecontent">Theoretically, couldn't you change the palette as the PPU draws the frame (per pixel or per tile) and get dramatically more colors?</div>
<br />That works for a few special cases like Blargg's flowing palette demo (<a href="http://www.youtube.com/watch?v=ecJiKqQonDc" class="postlink">video</a>; <a href="http://nesdev.com/bbs/viewtopic.php?t=6502" class="postlink">discussion</a>).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Zelex</b> [ Wed Sep 28, 2011 7:53 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />This also makes me wonder if a Mode 7 like effect is possible on the NES.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>3</strong> of <strong>7</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>