<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>nesdev.com &bull; View topic - First Sprite Designs - Opinions?</title>

<link rel="alternate" type="application/atom+xml" title="Feed - nesdev.com" href="http://forums.nesdev.com/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - News" href="http://forums.nesdev.com/feed.php?mode=news" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="http://forums.nesdev.com/feed.php?mode=forums" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://forums.nesdev.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Active Topics" href="http://forums.nesdev.com/feed.php?mode=topics_active" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - NES Graphics" href="http://forums.nesdev.com/feed.php?f=21" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - First Sprite Designs - Opinions?" href="http://forums.nesdev.com/feed.php?f=21&amp;t=13049" />

<link rel="stylesheet" href="./style.php?id=1&amp;lang=en" type="text/css" />

<script type="text/javascript">
// <![CDATA[


function popup(url, width, height, name)
{
	if (!name)
	{
		name = '_popup';
	}

	window.open(url.replace(/&amp;/g, '&'), name, 'height=' + height + ',resizable=yes,scrollbars=yes,width=' + width);
	return false;
}

function jumpto()
{
	var page = prompt('Enter the page number you wish to go to:', '5');
	var per_page = '15';
	var base_url = './viewtopic.php?f=21&amp;t=13049';

	if (page !== null && !isNaN(page) && page == Math.floor(page) && page > 0)
	{
		if (base_url.indexOf('?') == -1)
		{
			document.location.href = base_url + '?start=' + ((page - 1) * per_page);
		}
		else
		{
			document.location.href = base_url.replace(/&amp;/g, '&') + '&start=' + ((page - 1) * per_page);
		}
	}
}

/**
* Find a member
*/
function find_username(url)
{
	popup(url, 760, 570, '_usersearch');
	return false;
}

/**
* Mark/unmark checklist
* id = ID of parent container, name = name prefix, state = state [true/false]
*/
function marklist(id, name, state)
{
	var parent = document.getElementById(id);
	if (!parent)
	{
		eval('parent = document.' + id);
	}

	if (!parent)
	{
		return;
	}

	var rb = parent.getElementsByTagName('input');
	
	for (var r = 0; r < rb.length; r++)
	{
		if (rb[r].name.substr(0, name.length) == name)
		{
			rb[r].checked = state;
		}
	}
}



// ]]>
</script>
</head>
<body class="ltr">

<a name="top"></a>

<div id="wrapheader">

	<div id="logodesc">
	</div>

	<div id="menubar">

		<table width="100%" cellspacing="0">
		<tr>
			<td rowspan="2"><a href="./index.php"><img src="./styles/subsilver2/imageset/site_logo.gif" alt="" title="" /></a></td>
			<td width="100%" align="center"><h1>nesdev.com</h1><span class="gen">NES Development and Strangulation Records message boards</span></td>
		</tr>
		<tr>
			<td align="center">
				<!--<div style="float: right;">
					<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
					<input type="hidden" name="cmd" value="_s-xclick">
					<input type="hidden" name="hosted_button_id" value="X2HM4WNR5YT8S">
					<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
					<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
					</form>
				</div>-->
				<a href="./faq.php"><img src="./styles/prosilver/theme/images/icon_mini_faq.gif" width="12" height="13" alt="*" /> FAQ</a>
				&nbsp; &nbsp;<a href="./search.php"><img src="./styles/prosilver/theme/images/icon_mini_search.gif" width="12" height="13" alt="*" /> Search</a>
				<br />	
				 &nbsp;<a href="./ucp.php?mode=minion"><img src="./styles/prosilver/theme/images/icon_mini_register.gif" width="12" height="13" alt="*" /> Register</a>
					&nbsp; &nbsp;<a href="./ucp.php?mode=login"><img src="./styles/prosilver/theme/images/icon_mini_login.gif" width="12" height="13" alt="*" /> Login</a>&nbsp;
			</td>
		</tr>
		</table>
	</div>

	<div id="datebar">
		<table width="100%" cellspacing="0">
		<tr>
			<td class="gensmall"></td>
			<td class="gensmall" align="right">It is currently Fri Aug 17, 2018 1:18 am<br /></td>
		</tr>
		</table>
	</div>

</div>

<div id="wrapcentre">

	
	<p class="searchbar">
		<span style="float: left;"><a href="./search.php?search_id=unanswered">View unanswered posts</a> | <a href="./search.php?search_id=active_topics">View active topics</a></span>
		
	</p>
	

	<br style="clear: both;" />

	<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=21">NES Graphics</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>

	<br />
	

					<center>
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- NesDev Forums -->
					<ins class="adsbygoogle"
						 style="display:block"
						 data-ad-client="ca-pub-7801010229099644"
						 data-ad-slot="7979066809"
						 data-ad-format="auto"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>
					</center>
	<br />


<div id="pageheader">
	<h2><a class="titles" href="./viewtopic.php?f=21&amp;t=13049&amp;start=60">First Sprite Designs - Opinions?</a></h2>


	<p class="moderators">Moderator: <a href="./memberlist.php?mode=group&amp;g=320">Moderators</a></p>

</div>

<br clear="all" /><br />

<div id="pagecontent">

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=21"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=21&amp;t=13049"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>5</strong> of <strong>9</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 132 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=21&amp;t=13049&amp;start=45">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=21&amp;t=13049">1</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=15">2</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=30">3</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=45">4</a><span class="page-sep">, </span><strong>5</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=75">6</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=90">7</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=105">8</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=120">9</a> &nbsp;<a href="./viewtopic.php?f=21&amp;t=13049&amp;start=75">Next</a></b></td>
		
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat">
			<table width="100%" cellspacing="0">
			<tr>
				<td class="nav" nowrap="nowrap">&nbsp;
				<a href="./viewtopic.php?f=21&amp;t=13049&amp;start=60&amp;view=print" title="Print view">Print view</a>
				</td>
				<td class="nav" align="right" nowrap="nowrap"><a href="./viewtopic.php?f=21&amp;t=13049&amp;view=previous">Previous topic</a> | <a href="./viewtopic.php?f=21&amp;t=13049&amp;view=next">Next topic</a>&nbsp;</td>
			</tr>
			</table>
		</td>
	</tr>

	</table>


	<table class="tablebg" width="100%" cellspacing="1">
	
		<tr>
			<th>Author</th>
			<th>Message</th>
		</tr>
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p152585"></a>
				<b class="postauthor">Sik</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152585">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152585#p152585"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Aug 07, 2015 10:40 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Aug 12, 2010 3:43 am<br /><b>Posts:</b> 1589
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Reading the whole initialization stuff... Something I'd like to remark: you should never rely on startup values from a mapper because it's likely they won't get restored when the Reset button is pressed. It's annoying when a game doesn't respond properly to the Reset button =P</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4526"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p152594"></a>
				<b class="postauthor" style="color: #FF3300">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152594">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152594#p152594"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Aug 07, 2015 11:34 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 20409<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">Sik wrote:</div><div class="quotecontent">It's annoying when a game doesn't respond properly to the Reset button =P</div><br />Even more annoying is when the game uses the Reset button to exit a particular level, as in that <em>X-Men</em> game for Sega Genesis. If you're in that level, it goes to the next level. If you're in any other level, it starts the game over.<br /><br />Then the other problem is in a multicart like <em>Super Mario Bros./Duck Hunt</em>. Should Reset go back to the game select or to the game's own menu? In <em>SMB/DH</em>, it goes back to game select. In <em>Action 52</em>, it goes back to an unskippable cut scene followed by game select. In <em>Action 53</em>, it's a bit inconsistent: NROM games go back to game select, while bigger games go back to the game's title screen and are expected to have &quot;quit&quot; on the menu.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p152596"></a>
				<b class="postauthor">dougeff</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152596">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152596#p152596"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Aug 07, 2015 12:06 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7008_1483937093.png" width="86" height="90" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Fri May 08, 2015 7:17 pm<br /><b>Posts:</b> 2200<br /><b>Location:</b> DIGDUG
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">And when you're writing with extra program banks, how are you supposed to write code in memory spaces that are identical addresses to ones you've already written in the same program? Wouldn't the assembler throw up a flag? It's not like it understands that you're using a mapper. Do you write it in a different file and include it as a bin?</div><br /><br />I was going to answer this, but I think I'll leave this to the more experienced people here. Do you guys compile each bank separately and have a final file with a bunch of 'incbin' statements, or do you have each bank in separate ASM files and have a final file with a bunch of 'include' statements?</div>

					
						<div class="postbody"><br />_________________<br /><a href="http://nesdoug.com" class="postlink">nesdoug.com</a> -- blog/tutorial on programming for the NES</div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7008"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p152598"></a>
				<b class="postauthor" style="color: #FF3300">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152598">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152598#p152598"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Aug 07, 2015 12:26 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 20409<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I have .asm files dedicated to each need (player, metasprite, sprite cel loading, background loading, menus, etc.), and each file places data into the segments associated with separate banks as needed.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p152603"></a>
				<b class="postauthor">Kasumi</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152603">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152603#p152603"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Fri Aug 07, 2015 1:25 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3504.gif" width="48" height="48" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Apr 02, 2008 2:09 pm<br /><b>Posts:</b> 1174
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">It tells you to put that code at the end of each 16384 bank. That's the only code it tells you to put there. It doesn't say to put the NMI handler or anything like that there.</div><br />Well, because it doesn't need the NMI handler at the end of every bank. What is guaranteed to happen when the console turns on? The game starts executing from the RESET vector's address. <br /><br />The very first instruction SEI makes it so an IRQ won't fire. Yes, it might be <em>possible</em> for an NMI to fire in the very few instructions (probably less than 4) before you disable them, and then the game might crash. But usually the user would just think, &quot;Oh, I need to blow on my cartridge.&quot;  <img src="./images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" /> <br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">So i imagine you couldn't .org $FFFA, because it might be in the first bank. So how would you make sure that what you're writing actually occupies the last 16 bytes without a .org? And when you're writing with extra program banks, how are you supposed to write code in memory spaces that are identical addresses to ones you've already written in the same program? Wouldn't the assembler throw up a flag? It's not like it understands that you're using a mapper. Do you write it in a different file and include it as a bin?</div><br />Most of this isn't terribly important if you're not using MMC1, and a lot of solutions to the potential problems you lay out are assembler specific. But the one question to answer is, &quot;How are you supposed to write code in memory spaces that are identical addresses to ones you've already written in the same program?&quot;<br /><br />And the answer is, you just do. .org $8000 in multiple banks and just write code. How the assembler knows whether or not that's a new bank varies a lot between assemblers.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Now, I know that name is only for coding and is interpreted by the assembler and doesn't make it to the actual program. but won't the assembler say, &quot;You have two labels for reset_stub and I can't put both of them at $FFFC.&quot;?</div><br />Depends on the assembler.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">3. I'm going to guess that when you write a bank, even if you can't know for sure if it will be booted on startup, then you'll know for sure that if it will be loaded into the top or bottom. That's gotta be true, right? Well, you said that this could actually happen.</div><br />No, you don't necessarily even know that at startup for some mappers. So that reset stub really does need to be in all banks. <br /><br />That said, when you design your bank layout, you do design it so that it would always be swapped in at a particular place. (Whereever it's .org'd to.) <br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"> It says that reset (the rest of the reset instruction not in the stub) must be located in $C000-$FFED. What about the nmi instructions and the irq instructions? Won't those have to be at the same point in all four banks in case any of those banks landed to where the vector addresses are pointing? If you could put a bank in the top that goes in the bottom, it seems like you're going to have to put copies of all of your interrupt instructions in every single bank. Why would you ever want to switch a bank between the top and bottom of your code? I can't imagine a situation in which a program would benefit from flipping the top and bottom halves in a way that couldn't be better achieved through branching and subroutines.</div><br />This may make more sense if you read the MMC1 documentation, specifically load: <!-- m --><a class="postlink" href="http://wiki.nesdev.com/w/index.php/MMC1#Load_register_.28.248000-.24FFFF.29">http://wiki.nesdev.com/w/index.php/MMC1 ... .24FFFF.29</a><!-- m --><br />When you write a set high bit to $8000, it ensures that mapped to $C000-$FFFF is the last 16 kilobytes of your PRG ROM. So if you've got sixteen 16KB banks, bank15 now occupies $C000-$FFFF. Another way to say it is the reset label needs to be in that bank. But that initialize code only ensures $C000-$FFFF. Nothing is guaranteed about $8000-$BFFF, but reset should take care of that. And yes, it's possible for an NMI to fire but typically reset would just disable it. You could put a disable NMI under reset_stub, but because that's duplicated everywhere, it becomes a waste. reset_stub is designed the do the absolute minimum to ensure the rest of the reset is only done once. THAT should set up $8000-$BFFF and then NMIs could be reenabled and everything would be cool.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"> If I could hear that there is no way a person could ever want to switch a bank between the top and the bottom and it's just a glitch in the mapper that you have to account for then I'd feel decent at least about getting it.</div><br />There are reasons you might want to do that. And even if not, some people would prefer to have their code fixed at $8000 all the time, and some people would prefer their code fixed at $C000 all the time so the mapper supports both. And people aren't responsible for which of those two behaviors the mapper boots with. It's &quot;random&quot;. The reset_stub ensures that $C000 is fixed to the last bank. Less random. Then reset would set it up exactly how you like.</div>

					
						<div class="postbody"><br />_________________<br /><!-- m --><a class="postlink" href="https://kasumi.itch.io/indivisible">https://kasumi.itch.io/indivisible</a><!-- m --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3504"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p152663"></a>
				<b class="postauthor">darryl.revok</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152663">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152663#p152663"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Aug 08, 2015 2:00 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7129_1443779090.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Jul 25, 2015 1:22 pm<br /><b>Posts:</b> 501
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">I could swear I saved the draft I typed earlier. Ugh. I'll get back to the off topic things later. You guys did actually answer my questions, as convoluted as they were. Thank you for taking the time to help a confused n00b.<br /><br />So, I'm just going to see if I can break down what I need to get MMC3 functionality and how to start coding CHR bank switches. I'll start with the iNES header.<br /><br /><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">It's not so much &quot;changing&quot; as it is &quot;creating&quot; the iNES header. Anyway, I don't remember you mentioning which assembler you're using, so I can't say much about how to set things up.<br /></div><br /><br />I am using ASM6. I hear people say CA65 is better. I'm honestly not opposed to switching, I just started with ASM6 because I found a version of the Nerdy Nights tutorial for ASM6 so I had a place to start there. I did find more documentation on CA65 however, and I can see that it has a more robust directives list, so that's one benefit I can see from it, but other than that I'm not sure how the assemblers differ.<br /><br />So from the iNES NESDEV Wiki Page, I see:<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">An iNES file consists of the following sections, in order:<br />Header (16 bytes)<br />Trainer, if present (0 or 512 bytes)<br />PRG ROM data (16384 * x bytes)<br />CHR ROM data, if present (8192 * y bytes)<br />PlayChoice INST-ROM, if present (0 or 8192 bytes)<br />PlayChoice PROM, if present (16 bytes Data, 16 bytes CounterOut) (this is often missing, see PC10 ROM-Images for details)</div><br /><br />So, on my program, taken from Nerdy Nights, I have:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">byte &quot;NES&quot;,$1a&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; basically &quot;NES&quot; plus a terminator<br />byte $01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 1x16 PRG-ROM block ($c000)<br />byte $01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 1 CHR-ROM block<br />byte $00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; dontcare<br />byte $00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; dontcare<br />dsb 8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 8 bytes padding</div><br /><br />Hopefully now I'm ready to come back to this part and understand it. This is all in the first 16 bytes so obviously it's just the header. From the wiki, I see:<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">The format of the header is as follows:<br />0-3: Constant $4E $45 $53 $1A (&quot;NES&quot; followed by MS-DOS end-of-file)<br />4: Size of PRG ROM in 16 KB units<br />5: Size of CHR ROM in 8 KB units (Value 0 means the board uses CHR RAM)<br />6: Flags 6<br />7: Flags 7<br />8: Size of PRG RAM in 8 KB units (Value 0 infers 8 KB for compatibility; see PRG RAM circuit)<br />9: Flags 9<br />10: Flags 10 (unofficial)<br />11-15: Zero filled</div><br /><br />So 0-3 are ALWAYS &quot;NES&quot;,$1a because that's what it expects. That's easy enough to remember. I don't think there's any practical reason why I'd need to understand that better.<br /><br />4- So, at this point, I have just the basic non-switch PRG ROM, but I feel I need to understand this. My program has $01 as the entry, so what is 00? Just a non-existent program? I guess the big question for this is, &quot;If my banks are switchable but not loaded, are they included in this total?&quot; Instinctually I would think no, because they're not part of the program loaded by the CPU as $8000-$FFFF, however after a little more thought, I'm thinking the answer is yes, since this is just telling an emulator how large of ROM space it has to draw PRG code from, so I'm going to guess yes. Is that correct? If I had a total of 64KB of program data between all of my banks, would the answer be 07?<br /><br />5- This seems to be the largely same formula as PRG ROM except with 8 KB, but this is where I'll actually be making adjustments for what I'm doing. Now with my MMC3 individual banks will be smaller than 8KB each, but it looks like I need to add them to my program in 8K chunks. Seems there's no option to do otherwise. So does this mean that I need to create 2 2K blocks for every 4 1K blocks? And would I need to order them a certain way so that they would be loaded properly? I'm getting ahead of myself from the header here, but I'll certainly need to know that much.<br /><br />I'm imagining that I have to structure my CHR-ROM in 2 x 2KB blocks followed by 4 x 1KB block. So, if I just needed to add more 1KB blocks, I'd have to add an extra 4KB at the beginning for filler. Is that correct, or could I dedicate an entire 8K chunk to 1K character animation blocks?<br /><br />6- Okay this is where it gets trickier. My program just says $00 for now. Okay, so bit zero is for mirroring, I get that. If bit 3 is 1, then it looks like it ignores bit 0. Bit 1 means that it contains a battery backed RAM, so I'll skip over that for now. Same with Bit 2 and the trainer. I don't even know what the trainer is. (explains later in the article; don't need it) Then there's the lower nybble of the mapper number. So a nybble is 4 bits. Mapper number is 04, 118, or 119. I'm going to just guess 04 is the most common one. So, the lower nybble of 04 is 0100, right? If that's correct, how would the software distinguish between mappers numbered greater than 0-15? Maybe I'll answer that myself before I get to the end of this post.<br /><br />7-Alright, another byte. This one looks like a lot of stuff that I don't need at all. Bit 0, VS Unisystem, no, 0. PlayChoice-10, no, 0. NES 2.0, no, 0. Then there's that upper nybble. All zeros for this one. Okay so that's all zeros in this byte.<br /><br />8- Okay, now the PRG-RAM. I have to admit, I am confused on PRG-RAM. That's where you write your data for battery-backed save games, right? Is there any other reason that you'd use it? I see it would get addressed at $6000-$7FFF. This is completely separate from extra VRAM for 4-screen mirroring isn't it?<br /><br />9- Basically looks like it should just be zero. Even if designing for PAL it says it doesn't really do much.<br /><br />10- It says this byte is not part of the official specification. Should I just fill it with 0s or try to answer the questions in it? TV system, NTSC, so 0 for bits 0 and 1, PRG RAM, not present I imagine? As I said, program RAM isn't something that I understand the idea of too well other than for saving games. And as far as bus conflicts on my board, I'm going to hope that my virtual board has so bus conflicts, so I'd go with 0 on that one too.<br /><br />11-15- Zero filled. Simple. It looks like in ASM6, I just use dsb 5 to fill that space zeroes.<br /><br />So if I have figured this correctly, this should be the header I need:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">byte &quot;NES&quot;,$1a&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; basically &quot;NES&quot; plus a terminator<br />byte $01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 1x16 PRG-ROM block ($c000)<br />byte $02&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 2 CHR-ROM blocks<br />byte $%01000001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; vertical mirroring, mapper #004<br />dsb 9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 9 bytes padding</div><br /><br />So as long as I'm correct I feel like I have most of an understanding on how to build the header, although I am confused on a few things like PRG-RAM and arrangement of CHR banks.<br /><br />Thanks again for all of the assistance!</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7129"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p152675"></a>
				<b class="postauthor" style="color: #FF3300">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152675">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152675#p152675"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Aug 08, 2015 2:52 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 20409<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">darryl.revok wrote:</div><div class="quotecontent">So 0-3 are ALWAYS &quot;NES&quot;,$1a because that's what it expects. That's easy enough to remember. I don't think there's any practical reason why I'd need to understand that better.<br /><br />4- So, at this point, I have just the basic non-switch PRG ROM, but I feel I need to understand this. My program has $01 as the entry, so what is 00?</div><br />The meaning of $00 in this byte is not defined in original iNES format.<br /><br /><div class="quotetitle">darryl.revok wrote:</div><div class="quotecontent">If I had a total of 64KB of program data between all of my banks, would the answer be 07?</div><br />A 65536 byte PRG ROM would be $04, as it is measured in 16384 byte units.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Now with my MMC3 individual banks will be smaller than 8KB each, but it looks like I need to add them to my program in 8K chunks.</div><br />It's actually stricter than that. Existing MMC3 boards require the size of CHR ROM to be a power of 2: 32768 bytes, 65536 bytes, 131072 bytes, or 262144 bytes.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Seems there's no option to do otherwise. So does this mean that I need to create 2 2K blocks for every 4 1K blocks?</div><br />Not necessarily. It's fine to have a game that only ever uses two 2K blocks and sixty 1K blocks. This would be a 65536 byte CHR ROM: 64 1K blocks, and $08 in byte 5 of the header.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">And would I need to order them a certain way so that they would be loaded properly?</div><br />Other than that each 2K block starts on a 2K boundary (no straddling, say, $07-$08), order doesn't matter in standard MMC3 boards (mapper 4).<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">could I dedicate an entire 8K chunk to 1K character animation blocks?</div><br />Yes.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">6- Okay this is where it gets trickier. My program just says $00 for now. Okay, so bit zero is for mirroring, I get that. If bit 3 is 1, then it looks like it ignores bit 0.</div><br />Correct. In fact, bit 0 never matters for existing MMC3 games, as MMC3 games are supposed to configure mirroring at runtime. Only one MMC3 game was ever released with bit 3 turned on: <em>Rad Racer II</em>.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">8- Okay, now the PRG-RAM. I have to admit, I am confused on PRG-RAM. That's where you write your data for battery-backed save games, right? Is there any other reason that you'd use it?</div><br />The battery-less PRG RAM in a TSROM is just an extra block of RAM that a game can use for any purpose. <em>Super Mario Bros. 3</em> and <em>M.C. Kids</em> use it to cache the decompressed level maps. Some other games were engineered not to need it, as it's an extra cost option at manufacturing time.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">[PRG RAM] is completely separate from extra VRAM for 4-screen mirroring isn't it?</div><br />Yes. PRG RAM is on the CPU side of the bus, and 4-screen VRAM is on the PPU side.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">And as far as bus conflicts on my board, I'm going to hope that my virtual board has so bus conflicts, so I'd go with 0 on that one too.</div><br />MMC3 never has bus conflicts.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />So if I have figured this correctly, this should be the header I need:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">byte &quot;NES&quot;,$1a&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; basically &quot;NES&quot; plus a terminator<br />byte $01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 1x16 PRG-ROM block ($c000)<br />byte $02&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 2 CHR-ROM blocks<br />byte $%01000001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; vertical mirroring, mapper #004<br />dsb 9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; 9 bytes padding</div></div><br />This looks reasonable. It gives you 16384 bytes PRG ROM, 16384 bytes CHR ROM, and the most common MMC3 configuration.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p152715"></a>
				<b class="postauthor">darryl.revok</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152715">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152715#p152715"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Aug 08, 2015 5:36 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7129_1443779090.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Jul 25, 2015 1:22 pm<br /><b>Posts:</b> 501
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">tepples wrote:</div><div class="quotecontent"><div class="quotetitle">darryl.revok wrote:</div><div class="quotecontent">If I had a total of 64KB of program data between all of my banks, would the answer be 07?</div><br />A 65536 byte PRG ROM would be $04, as it is measured in 16384 byte units.</div><br /><br />My mistake. I got the CHR and PRG mixed up.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">It's actually stricter than that. Existing MMC3 boards require the size of CHR ROM to be a power of 2: 32768 bytes, 65536 bytes, 131072 bytes, or 262144 bytes.</div><br /><br />Okay, I just noticed something I should have asked. 00 infers 8 KB, so does 01 infer 8 KB or 16 KB? I wrote my header in the last post as if it 00 and 01 would both infer 8 KB,<br /><br />So does this mean there are only 6 valid options; $00, $01, $04, $08, $10, $20, and $40?<br /><br />Does this restriction also apply to the PRG ROM? If not, what values does the board allow for that?<br /><br />That would make the header I wrote of $02 invalid, correct?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">And would I need to order them a certain way so that they would be loaded properly?</div><br />Other than that each 2K block starts on a 2K boundary (no straddling, say, $07-$08), order doesn't matter in standard MMC3 boards (mapper 4).<br /><br />Gotcha. I need to get past the header before I can break down and understand how the bank #s are assigned to a 2K or 1K slot, but since our only options with this one are 1K blocks or 2K blocks, that could be simplified in a sense to say that a 2K block always needs to be on an even # of kilobytes in ROM space, correct?<br /><br />Like, say you were at 9K position and you need to add another 2K block, you'd have to add 1K block first?<br /><br />It would make more sense I can imagine to have all of the 2K and then the 1K, but I could see where somebody might not want to go back and change everything if they already built their program and just need another bank.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Correct. In fact, bit 0 never matters for existing MMC3 games, as MMC3 games are supposed to configure mirroring at runtime. Only one MMC3 game was ever released with bit 3 turned on: <em>Rad Racer II</em>.</div><br /><br />I can understand why this was rarely used during the NES life because of the expense, but I'm curious how expensive it would be to do this on a cart today, with the drop of RAM prices. Just seems like an under utilized feature.<br /><br />Also, would this be able to share physical memory with PRG-RAM? Like, could you assign part of the RAM to the CPU and part to the PPU?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><em>Super Mario Bros. 3</em> and <em>M.C. Kids</em> use it to cache the decompressed level maps. Some other games were engineered not to need it, as it's an extra cost option at manufacturing time.</div><br /><br />So they just needed to store more information than they had room for in CPU memory space?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">This looks reasonable. It gives you 16384 bytes PRG ROM, 16384 bytes CHR ROM, and the most common MMC3 configuration.</div><br />But invalid if used on extra hardware because of the improper CHR ROM size, correct?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7129"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p152720"></a>
				<b class="postauthor">Kasumi</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152720">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152720#p152720"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Aug 08, 2015 6:12 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=3504.gif" width="48" height="48" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Wed Apr 02, 2008 2:09 pm<br /><b>Posts:</b> 1174
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Okay, I just noticed something I should have asked. 00 infers 8 KB</div><br />0 refers to 0 KB. Which means the game is using RAM, not ROM for its graphics.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">That would make the header I wrote of $02 invalid, correct?</div><br />No. 2 * 8 = 16. Which is 2^4, so it's a power of 2.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Does this restriction also apply to the PRG ROM? If not, what values does the board allow for that?</div><br />Max PRG ROM for standard MMC3 boards is 512 KB.<br />So 16, 32, 64, 128, 256 and 512 are all valid.<br />Which by extension means<br />1, 2, 4, 8, 16, and 32 are all valid numbers for the number of 16KB PRG banks.<br /><br />Max CHR is 256KB.<br />1, 2, 4, 8, 16, 32 are all valid for the number of CHR Banks. (And 0, which is CHR RAM)<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Gotcha. I need to get past the header before I can break down and understand how the bank #s are assigned to a 2K or 1K slot, but since our only options with this one are 1K blocks or 2K blocks, that could be simplified in a sense to say that a 2K block always needs to be on an even # of kilobytes in ROM space, correct?</div><br />That's pretty much it. So... 256 values are available. For 1KB switching obviously each one corresponds exactly to that block. For 2KB, every two values gets the same results.<br /><br />Writing 0 to the 2KB side gives you the first two KB. Writing 1 also gives you the first two KB. 2 gives you the next two KB. etc. <br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Like, say you were at 9K position and you need to add another 2K block, you'd have to add 1K block first?</div><br />Right. And your logic about putting all 2KB blocks first is also sound design. What I do is have a define for the 2KB blocks end. So I don't have to change anything in my program even if I add more 2KB banks.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">So they just needed to store more information than they had room for in CPU memory space?</div><br />Or they just wanted it. It's possible to design a game that does similar things to those two without it, I think.<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">But invalid if used on extra hardware because of the improper CHR ROM size, correct?</div><br />2 is valid. See above.</div>

					
						<div class="postbody"><br />_________________<br /><!-- m --><a class="postlink" href="https://kasumi.itch.io/indivisible">https://kasumi.itch.io/indivisible</a><!-- m --></div>
					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=3504"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p152726"></a>
				<b class="postauthor" style="color: #FF3300">tepples</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152726">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152726#p152726"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sat Aug 08, 2015 7:17 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sun Sep 19, 2004 11:12 pm<br /><b>Posts:</b> 20409<br /><b>Location:</b> NE Indiana, USA (NTSC)
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">darryl.revok wrote:</div><div class="quotecontent">Okay, I just noticed something I should have asked. 00 infers 8 KB, so does 01 infer 8 KB or 16 KB? I wrote my header in the last post as if it 00 and 01 would both infer 8 KB,</div><br />00 means CHR RAM in the typical size for the mapper, and on most mappers this is 8192 bytes. (It's larger on CPROM, Oeka Kids, and RacerMate mappers.)<br /><br />$01 means 8192 byte CHR ROM. $02 means 16384 byte CHR ROM.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">So does this mean there are only 6 valid options; $00, $01, $04, $08, $10, $20, and $40?</div><br />You forgot $02. For common mappers, this is true.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Does this restriction also apply to the PRG ROM?</div><br />For common mappers, this is true. There are only a few uncommon boards that allow non-power-of-2 PRG ROM sizes.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">That would make the header I wrote of $02 invalid, correct?</div><br />2 is a power of 2, so 2 is valid. PRG ROM size = 2 means 32768 bytes. CHR ROM size = 2 means 16384 bytes. <em>Tetris</em> by Tengen and <em>Tetris</em> by Nintendo are examples of games with PRG ROM size = 2 and CHR ROM size = 2.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">a 2K block always needs to be on an even # of kilobytes in ROM space, correct?</div><br />Yes.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Like, say you were at 9K position and you need to add another 2K block, you'd have to add 1K block first?</div><br />Yes.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Also, would this be able to share physical memory with PRG-RAM? Like, could you assign part of the RAM to the CPU and part to the PPU?</div><br />That would be expensive to put in an actual game, as one memory controller would have to sit in front of a fast memory serving requests from both buses. Nevertheless, <a href="http://forums.nesdev.com/viewtopic.php?f=9&amp;t=13042" class="postlink">kevtris's forthcoming NES flash adapter</a> has an FPGA acting as the memory controller, going to both buses and a big, fast DRAM. This FPGA does the mappers and the Game Boy emulation.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=9"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p152791"></a>
				<b class="postauthor">Sik</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152791">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152791#p152791"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Sun Aug 09, 2015 3:19 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Thu Aug 12, 2010 3:43 am<br /><b>Posts:</b> 1589
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Even more annoying is when the game uses the Reset button to exit a particular level, as in that <em>X-Men</em> game for Sega Genesis. If you're in that level, it goes to the next level. If you're in any other level, it starts the game over.</div><br />For the record, originally you were just supposed to do something in-game but playtesters would keep resetting the console instead, so they changed the solution to that level... (doesn't hide the fact it's bullshit and that they should have modified the instructions instead)<br /><br />At least it doesn't crash...<br /><br /><div class="quotetitle">tepples wrote:</div><div class="quotecontent">Then the other problem is in a multicart like <em>Super Mario Bros./Duck Hunt</em>. Should Reset go back to the game select or to the game's own menu? In <em>SMB/DH</em>, it goes back to game select. In <em>Action 52</em>, it goes back to an unskippable cut scene followed by game select. In <em>Action 53</em>, it's a bit inconsistent: NROM games go back to game select, while bigger games go back to the game's title screen and are expected to have &quot;quit&quot; on the menu.</div><br />Honestly, I'd expect a multicart to always return to the game select (like it was power on).</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=4526"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p152964"></a>
				<b class="postauthor">darryl.revok</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152964">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152964#p152964"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Aug 11, 2015 3:40 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7129_1443779090.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Jul 25, 2015 1:22 pm<br /><b>Posts:</b> 501
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">tokumaru wrote:</div><div class="quotecontent">Can you just imagine how things were before the internet? These days it seems like people want everything to be handed to them in a silver platter. Well, back in the 80's and 90's people didn't have video tutorials on YouTube detailing every little thing they had to do and somehow people still managed to learn assembly and make games.</div><br /><br />I wanted to get back to this when I got a chance. The last thing I want to do is express disrespect for the people who have gone before me and put this information out to make it even possible to learn. If I can't understand the technical sheets, that's my own fault for not being experienced enough, and it will come with time. The information is priceless to those who wish to develop for the console.<br /><br />Not everybody that wanted to learn 6502 assembly in the 80s and 90s was able to do so. I say this because making games for the NES or SNES was the biggest thing I wanted to do. I was a kid and I honestly had no idea what was required to do so. I started playing with BASIC because it's what was available to me. It was literally on the computer we had so it was what I had. That was just about the only place I could go. There wasn't anywhere a kid like me in Kentucky could go to speak with fellow nerds and be handed the esoteric knowledge passed down from the Atari generation. I really had no clue.<br /><br />I could go to the book store and pick up a book on BASIC, but I didn't see a book on NES programming or I would have taken that route instead. There could have been a book sitting right there on 6502 Assembly and I wouldn't have had a clue what it was. Was it my fault for not knowing that? Maybe, but at that age, and during that time, it's hard to imagine how I would have found out. Nintendo Power didn't explicitly mention it, not at least that I can recall. At the time, it may not have been feasible anyway. Sure, the code hasn't changed, but there were no emulators, or CHR convertors, at least most likely that weren't proprietary.<br /><br />I guess I have a somewhat selfish perspective because what I really want are more new games to play and more people making new games. I think the idea of an obsolete video game console is challenged when new games are being developed for them that can be just as entertaining as ones developed for modern consoles, and the development is actual feasible for the &quot;little guy&quot;. Once I'm here, and I've taken the plunge, it's my responsibility to learn and understand the more technical aspects. I'm glad the reference material is available. What I mean to say is that I almost didn't think it was possible, and I bet a lot of people who think they might be interested end up feeling the same way. I don't think what I feel is missing is even necessarily tutorials for the first steps, (not to say that more of those wouldn't be great) just like a gateway for the completely inexperienced person to see, yes, it is possible, no, it's not necessarily easy and it's a lot of work, but there are plenty of tools and techniques, here's what you need to know and consider before deciding if you want to go into this hobby, and here's where to go if you decide to do so. I dunno, I guess there's stuff like that, so I don't really know why I was complaining; maybe I just burnt myself out that day and got frustrated. <br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Retro software development is a niche thing, it's not profitable, so there's obviously not gonna be as much material about it as there is for current technologies. Whatever is out there is the work of hobbyists, who don't always have a lot of free time.</div><br />Well if there's ever any way I can give back to the community and spend some time to do something that would help get more people involved, I'd like to do so.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">...and do things according to the book, with help from people in this forum, things will slowly fall into place as you go. </div><br /><br />This is where the forum becomes invaluable. If &quot;the book&quot; are some of the beginner tutorials available, I've learned from some people in here that the practices in those aren't always the best. Still, even getting to a point to understand why something might not be the best way takes some work,</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7129"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p152984"></a>
				<b class="postauthor">tokumaru</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p152984">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=152984#p152984"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Aug 11, 2015 9:29 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=95.png" width="80" height="80" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Feb 12, 2005 9:43 pm<br /><b>Posts:</b> 10714<br /><b>Location:</b> Rio de Janeiro - Brazil
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody"><div class="quotetitle">darryl.revok wrote:</div><div class="quotecontent">If &quot;the book&quot; are some of the beginner tutorials available</div><br />I actually meant to say &quot;by the book&quot;, which means following the most up to date documentation, which is the wiki. Of course the wiki alone is not very helpful for beginners, but whenever you come across a hardware interaction you're not familiar with when using tutorials or going through other peoples' codes, it's a good idea to check what the wiki has to say about it. If something seems off, just ask about it in the forums, that's what I meant.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=95"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row2">

			<td align="center" valign="middle">
				<a name="p155328"></a>
				<b class="postauthor">darryl.revok</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155328">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=155328#p155328"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Mon Sep 14, 2015 9:15 pm&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7129_1443779090.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Jul 25, 2015 1:22 pm<br /><b>Posts:</b> 501
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Okay, so I've got to the point that I have a a very early functional prototype of my game engine, with SMB3 style four-way scrolling, object collision, background collision, rudimentary player controls and some basic sprite flickering. I'm to the point now that I need to add CHR bank switching for sprites in order to add attack moves for my player, more characters, and move forward. I hoped to come back to this thread to get some tips on implementation.<br /><br />My program is currently set up to use the MMC3 although I'm not using it's features yet. I'm pretty sure I'll stick with the MMC3 and work within it's capabilities for this game. First I want to do CHR switching but I eventually plan to utilize the PRG switching, scanline interrupt, and mirror mode switching as well for this project.<br /><br />So, I'd like to create a system that can bank switch each frame of an animation, and that will allow objects to share a bank if they use the same one. I think it's a little more complicated than just that though, because some object types will be cycling through CHR banks and only a few in my game might only use one. So, if an object judged whether or not it can be spawned just based on whether or not one of the current CHR banks was compatible, it would run into issues when the other enemy of the same type does a move requiring CHR switches.<br /><br />So, if I'm correct, I'm thinking it's going to have to work a little like this:<br /><br />Each object type will have to have a bit defining the number of CHR banks it uses. Any objects that can fit in one 1 KB bank can share a bank, but more than that, and there's no reason to share, even if they could share some frames. So, 0=1 bank and 1 = &gt;1 banks<br /><br />I believe I would need two bits somewhere to define the number of CHR banks used currently. This is assuming that one is always used, and the player character is always present when using this logic. To allow otherwise, I suppose I would need three bits to allow values 0-4.<br /><br />Each object will have a byte defining the bank number that it's using, (0-255). When pulling a frame from metasprite data, it will first pull the bank number of that frame, and compare it to the value in the object's RAM. If that's not the same, run bank loading routine.<br /><br />If the object type uses 1 bank, it could first check bank numbers of active objects and look for that bank. If not present, then check number of used banks for an open slot, if there are none, deny spawning of object.<br /><br />If the object type uses more than 1 bank, check number of used banks for an open slot, and if there are none, deny spawning of object.<br /><br />So, I don't know if that logic could be improved, but it seems like that would be a basic framework for determining if an object can access the proper bank, and preventing an object already on screen from losing access to it's sprite data. Now, there's more to do to actually get the bank switching functional, and I'd like to see if my line of thinking on this is correct:<br /><br />The bank number will be stored in object RAM, but I believe the bank window being occupied will also have to be stored in object RAM since objects should be able to share windows. So, I'm thinking two bits in object data to define which CHR window that particular object is using. If these bits are stored in bits 6 and 7, I can AND out the rest of the byte and have the actual window address.<br /><br />My metasprite tile numbers will have to change from $00-$FF to $00-$3F.<br /><br />Then, my bankswitching code might look something like this:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">ChangeCHRBank:<br /><br />;A = bank number to switch in<br /><br />&nbsp; PHA<br />&nbsp; <br />&nbsp; LDA objectAnimationBankLocation, x<br />&nbsp; AND #%11000000<br />&nbsp; ASL<br />&nbsp; ROL<br />&nbsp; ROL<br />;&nbsp; CLC<br />&nbsp; ADC #$02<br />&nbsp; STA $8000<br />&nbsp; <br />&nbsp; PLA<br />&nbsp; STA $8001<br />&nbsp; <br />RTS</div><br /><br />Then, my tile number loading changes from this:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; DEY<br />&nbsp; LDA (currentFrameReadLo), y&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; = 0-255<br />&nbsp; STA (currentSpriteTilePreloadSlotLo), y&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; Store tile number</div><br /><br />To this:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp; DEY<br />&nbsp; LDA objectAnimationBankLocation, x<br />&nbsp; AND #%11000000<br />&nbsp; CLC<br />&nbsp; ADC (currentFrameReadLo), y&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; = 0-63<br />&nbsp; STA (currentSpriteTilePreloadSlotLo), y&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;; Store tile number</div><br /><br />So, before I go further I wanted to ask if you guys think this is along the right track so far.</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row2">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7129"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table class="tablebg" width="100%" cellspacing="1">
	<tr class="row1">

			<td align="center" valign="middle">
				<a name="p155342"></a>
				<b class="postauthor">darryl.revok</b>
			</td>
			<td width="100%" height="25">
				<table width="100%" cellspacing="0">
				<tr>
				
					<td class="gensmall" width="100%"><div style="float: left;">&nbsp;<b>Post subject:</b> <a href="#p155342">Re: First Sprite Designs - Opinions?</a></div><div style="float: right;"><a href="./viewtopic.php?p=155342#p155342"><img src="./styles/subsilver2/imageset/icon_post_target.gif" width="12" height="9" alt="Post" title="Post" /></a><b>Posted:</b> Tue Sep 15, 2015 3:14 am&nbsp;</div></td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td valign="top" class="profile">
				<table cellspacing="4" align="center" width="150">
			
				<tr>
					<td><img src="./styles/subsilver2/imageset/en/icon_user_offline.gif" alt="Offline" title="Offline" /></td>
				</tr>
			
				<tr>
					<td><img src="./download/file.php?avatar=7129_1443779090.png" width="100" height="100" alt="User avatar" /></td>
				</tr>
			
				</table>

				<span class="postdetails">
					<br /><b>Joined:</b> Sat Jul 25, 2015 1:22 pm<br /><b>Posts:</b> 501
				</span>

			</td>
			<td valign="top">
				<table width="100%" cellspacing="5">
				<tr>
					<td>
					

						<div class="postbody">Well, I got basic CHR switching for sprites functioning.<br /><br />I ran into one issue that I didn't anticipate, however. Due to the instantaneous nature of bank swapping, switching banks during game logic resulted in the existing sprites on screen being drawn with incorrect tiles momentarily. At first it looked like a delay in the bank swap, but after a little investigating I figured out what was really happening.<br /><br />Currently I'm solving the issue by swapping my bank during NMI to the bank number saved in object RAM. Right now it's only set up for the player, but after I add functionality for other objects I'll just have to hope that I've still got the spare cycles in NMI for four sprite bank swaps and two background bank swaps.<br /><br />Any thoughts on how other people have tackled this issue? Are CHR bank swaps often placed in NMI to avoid complications?</div>

					<br clear="all" /><br />

						<table width="100%" cellspacing="0">
						<tr valign="middle">
							<td class="gensmall" align="right">
							
							</td>
						</tr>
						</table>
					</td>
				</tr>
				</table>
			</td>
		</tr>

		<tr class="row1">

			<td class="profile"><strong><a href="#wrapheader">Top</a></strong></td>
			<td><div class="gensmall" style="float: left;">&nbsp;<a href="./memberlist.php?mode=viewprofile&amp;u=7129"><img src="./styles/subsilver2/imageset/en/icon_user_profile.gif" alt="Profile" title="Profile" /></a> &nbsp;</div> <div class="gensmall" style="float: right;">&nbsp;</div></td>
	
		</tr>

	<tr>
		<td class="spacer" colspan="2" height="1"><img src="images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	</table>

	<table width="100%" cellspacing="1" class="tablebg">
	<tr align="center">
		<td class="cat"><form name="viewtopic" method="post" action="./viewtopic.php?f=21&amp;t=13049&amp;start=60"><span class="gensmall">Display posts from previous:</span> <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select>&nbsp;<span class="gensmall">Sort by</span> <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select> <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select>&nbsp;<input class="btnlite" type="submit" value="Go" name="sort" /></form></td>
	</tr>
	</table>
	

	<table width="100%" cellspacing="1">
	<tr>
		<td align="left" valign="middle" nowrap="nowrap">
		<a href="./posting.php?mode=post&amp;f=21"><img src="./styles/subsilver2/imageset/en/button_topic_new.gif" alt="Post new topic" title="Post new topic" /></a>&nbsp;<a href="./posting.php?mode=reply&amp;f=21&amp;t=13049"><img src="./styles/subsilver2/imageset/en/button_topic_reply.gif" alt="Reply to topic" title="Reply to topic" /></a>
		</td>
		
			<td class="nav" valign="middle" nowrap="nowrap">&nbsp;Page <strong>5</strong> of <strong>9</strong><br /></td>
			<td class="gensmall" nowrap="nowrap">&nbsp;[ 132 posts ]&nbsp;</td>
			<td class="gensmall" width="100%" align="right" nowrap="nowrap"><b><a href="#" onclick="jumpto(); return false;" title="Click to jump to pageâ€¦">Go to page</a> <a href="./viewtopic.php?f=21&amp;t=13049&amp;start=45">Previous</a>&nbsp;&nbsp;<a href="./viewtopic.php?f=21&amp;t=13049">1</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=15">2</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=30">3</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=45">4</a><span class="page-sep">, </span><strong>5</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=75">6</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=90">7</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=105">8</a><span class="page-sep">, </span><a href="./viewtopic.php?f=21&amp;t=13049&amp;start=120">9</a> &nbsp;<a href="./viewtopic.php?f=21&amp;t=13049&amp;start=75">Next</a></b></td>
		
	</tr>
	</table>

</div>

<div id="pagefooter"></div>

<br clear="all" />
<table class="tablebg" width="100%" cellspacing="1" cellpadding="0" style="margin-top: 5px;">
	<tr>
		<td class="row1">
			<p class="breadcrumbs"><a href="./index.php">Board index</a> &#187; <a href="./viewforum.php?f=24">NES / Famicom</a> &#187; <a href="./viewforum.php?f=21">NES Graphics</a></p>
			<p class="datetime">All times are UTC - 7 hours </p>
		</td>
	</tr>
	</table>
	<br clear="all" />

	<table class="tablebg" width="100%" cellspacing="1">
	<tr>
		<td class="cat"><h4>Who is online</h4></td>
	</tr>
	<tr>
		<td class="row1"><p class="gensmall">Users browsing this forum: No registered users and 4 guests</p></td>
	</tr>
	</table>


<br clear="all" />

<table width="100%" cellspacing="1">
<tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <strong>cannot</strong> post new topics in this forum<br />You <strong>cannot</strong> reply to topics in this forum<br />You <strong>cannot</strong> edit your posts in this forum<br />You <strong>cannot</strong> delete your posts in this forum<br />You <strong>cannot</strong> post attachments in this forum<br /></span></td>
</tr>
</table>

<br clear="all" />

<table width="100%" cellspacing="0">
<tr>
	<td><form method="get" name="search" action="./search.php"><span class="gensmall">Search for:</span> <input class="post" type="text" name="keywords" size="20" /> <input class="btnlite" type="submit" value="Go" /><input type="hidden" name="t" value="13049" />
<input type="hidden" name="sf" value="msgonly" />
</form></td>
	<td align="right">
	<form method="post" name="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	<table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:</span>&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">

		
			<option value="-1">Select a forum</option>
		<option value="-1">------------------</option>
			<option value="24">NES / Famicom</option>
		
			<option value="2">&nbsp; &nbsp;NESdev</option>
		
			<option value="3">&nbsp; &nbsp;NESemdev</option>
		
			<option value="21" selected="selected">&nbsp; &nbsp;NES Graphics</option>
		
			<option value="6">&nbsp; &nbsp;NES Music</option>
		
			<option value="22">&nbsp; &nbsp;Homebrew Projects</option>
		
			<option value="34">&nbsp; &nbsp;&nbsp; &nbsp;2018 NESdev Competition</option>
		
			<option value="33">&nbsp; &nbsp;&nbsp; &nbsp;2017 NESdev Competition</option>
		
			<option value="32">&nbsp; &nbsp;&nbsp; &nbsp;2016 NESdev Competition</option>
		
			<option value="31">&nbsp; &nbsp;&nbsp; &nbsp;2014 NESdev Competition</option>
		
			<option value="30">&nbsp; &nbsp;&nbsp; &nbsp;2011 NESdev Competition</option>
		
			<option value="10">&nbsp; &nbsp;Newbie Help Center</option>
		
			<option value="9">&nbsp; &nbsp;NES Hardware and Flash Equipment</option>
		
			<option value="28">&nbsp; &nbsp;&nbsp; &nbsp;Reproduction</option>
		
			<option value="19">&nbsp; &nbsp;NESdev International</option>
		
			<option value="11">&nbsp; &nbsp;&nbsp; &nbsp;FCdev</option>
		
			<option value="18">&nbsp; &nbsp;&nbsp; &nbsp;NESdev China</option>
		
			<option value="27">&nbsp; &nbsp;&nbsp; &nbsp;NESdev Middle East</option>
		
			<option value="25">Other</option>
		
			<option value="5">&nbsp; &nbsp;General Stuff</option>
		
			<option value="4">&nbsp; &nbsp;Membler Industries</option>
		
			<option value="23">&nbsp; &nbsp;Other Retro Dev</option>
		
			<option value="12">&nbsp; &nbsp;&nbsp; &nbsp;SNESdev</option>
		
			<option value="20">&nbsp; &nbsp;&nbsp; &nbsp;GBDev</option>
		
			<option value="15">&nbsp; &nbsp;Test Forum</option>
		
			<option value="26">Site Issues</option>
		
			<option value="13">&nbsp; &nbsp;phpBB Issues</option>
		
			<option value="14">&nbsp; &nbsp;Web Issues</option>
		
			<option value="16">&nbsp; &nbsp;nesdevWiki</option>
		

		</select>&nbsp;<input class="btnlite" type="submit" value="Go" /></td>
	</tr>
	</table>

	</form>
</td>
</tr>
</table>


</div>


<div id="wrapfooter">
	
	<span class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
	</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61452025-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>