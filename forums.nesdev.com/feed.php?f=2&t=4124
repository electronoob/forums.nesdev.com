<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="https://forums.nesdev.com/feed.php?f=2&amp;t=4124" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="https://forums.nesdev.com/index.php" />
<updated>2015-03-04T12:57:01-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>https://forums.nesdev.com/feed.php?f=2&amp;t=4124</id>
<entry>
<author><name><![CDATA[3gengames]]></name></author>
<updated>2012-03-08T16:33:43-07:00</updated>
<published>2012-03-08T16:33:43-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91080#p91080</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91080#p91080"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91080#p91080"><![CDATA[
Yeah, assuming it's a official controller as the 9th read would be a high.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=4311">3gengames</a> — Thu Mar 08, 2012 4:33 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2012-03-08T14:48:52-07:00</updated>
<published>2012-03-08T14:48:52-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91079#p91079</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91079#p91079"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91079#p91079"><![CDATA[
Just for double checking the things: if no buttons are pressed, it should give a PASS; otherwise, ERROR. Is this ok?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Thu Mar 08, 2012 2:48 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[cpow]]></name></author>
<updated>2012-03-08T12:20:50-07:00</updated>
<published>2012-03-08T12:20:50-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91072#p91072</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91072#p91072"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91072#p91072"><![CDATA[
<div class="quotetitle">Jeroen wrote:</div><div class="quotecontent"><br />Awesome. Also I don't see why that would make YOU retarded....the thread's not magicly gonna be unnecrobumped. (And some extra mirrors are never gonna hurt)<br /></div><br /><br />It's funny.  Every time I see a thread like this pop back up my first reaction is "blargg's baaaaaaaack?!!".<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3705">cpow</a> — Thu Mar 08, 2012 12:20 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Jeroen]]></name></author>
<updated>2012-03-08T11:33:42-07:00</updated>
<published>2012-03-08T11:33:42-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91071#p91071</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91071#p91071"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91071#p91071"><![CDATA[
Awesome. Also I don't see why that would make YOU retarded....the thread's not magicly gonna be unnecrobumped. (And some extra mirrors are never gonna hurt)<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3369">Jeroen</a> — Thu Mar 08, 2012 11:33 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[cpow]]></name></author>
<updated>2012-03-08T11:21:23-07:00</updated>
<published>2012-03-08T11:21:23-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91070#p91070</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91070#p91070"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91070#p91070"><![CDATA[
<div class="quotetitle">Jeroen wrote:</div><div class="quotecontent"><br />Anyone got a backup of these? The links appear down (at least for me)<br /><br />edit: i'm retarded and didnt see the page 2 link &gt;_&gt; sorry for the necrobump<br /><br />edit2: that being said...any chance of a asm6 version?<br /></div><br /><br /><a href="https://gitorious.org/nesicide/nes-test-roms/trees/master/read_joy3" class="postlink">here</a><br /><br />edit: i'm retarded and didn't read your second sentence but decided to submit my post anyway since my answer to your question is valid.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3705">cpow</a> — Thu Mar 08, 2012 11:21 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Jeroen]]></name></author>
<updated>2012-03-07T18:52:46-07:00</updated>
<published>2012-03-07T18:52:46-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91061#p91061</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91061#p91061"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=91061#p91061"><![CDATA[
Anyone got a backup of these? The links appear down (at least for me)<br /><br />edit: i'm retarded and didnt see the page 2 link &gt;_&gt; sorry for the necrobump<br /><br />edit2: that being said...any chance of a asm6 version?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=3369">Jeroen</a> — Wed Mar 07, 2012 6:52 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[thefox]]></name></author>
<updated>2015-03-04T12:57:01-07:00</updated>
<published>2010-05-13T04:53:24-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=61316#p61316</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=61316#p61316"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=61316#p61316"><![CDATA[
<div class="quotetitle">Dwedit wrote:</div><div class="quotecontent"><br />The file is gone, anyone care to rehost it?<br /><br />I also read the companion thread, and realized that pocketnes has a buggy joystick reader (does not require strobe to be stopped before reading bits).<br /></div><br />read_joy3.zip<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=80">thefox</a> — Thu May 13, 2010 4:53 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Dwedit]]></name></author>
<updated>2010-05-11T14:04:12-07:00</updated>
<published>2010-05-11T14:04:12-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=61283#p61283</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=61283#p61283"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=61283#p61283"><![CDATA[
The file is gone, anyone care to rehost it?<br /><br />I also read the companion thread, and realized that pocketnes has a buggy joystick reader (does not require strobe to be stopped before reading bits).<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=53">Dwedit</a> — Tue May 11, 2010 2:04 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-09-01T21:24:45-07:00</updated>
<published>2008-09-01T21:24:45-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=36677#p36677</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=36677#p36677"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=36677#p36677"><![CDATA[
I'm pretty sure the test program is tuned for NTSC DMC rates. I'll have to write a PAL version sometime soon.<br /><br />EDIT: nevermind, that test doesn't do any synchronization. That suggests it doesn't occur on the PAL NES, though a thorough test would be good.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Mon Sep 01, 2008 9:24 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Bregalad]]></name></author>
<updated>2008-09-01T13:34:12-07:00</updated>
<published>2008-09-01T13:34:12-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=36661#p36661</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=36661#p36661"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=36661#p36661"><![CDATA[
Running count_errors.nes from the ReadJoy3 package on my PAL NES outputs me Conflicts : 0/1000 on all tries.<br /><br />Should we conclude that the PAL NES is exempt from this DMC bug ?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=38">Bregalad</a> — Mon Sep 01, 2008 1:34 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Dwedit]]></name></author>
<updated>2008-05-25T04:26:34-07:00</updated>
<published>2008-05-25T04:26:34-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33652#p33652</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33652#p33652"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33652#p33652"><![CDATA[
Has anyone thought of building a list of games potentially affected by the bug?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=53">Dwedit</a> — Sun May 25, 2008 4:26 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2010-07-25T12:03:55-07:00</updated>
<published>2008-05-25T00:45:18-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33651#p33651</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33651#p33651"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33651#p33651"><![CDATA[
OK, probably the final version of the algorithm. This reads four times, then returns two matching readings, taking right around 660 clocks. DMC DMA can only corrupt one, and assuming only one controller change at most between the first and last read, at least two readings will always match. This one uses three zero-page temporary bytes temp, temp2, temp3.<br /><br /><a href="http://blargg.parodius.com/nes-code/read_joy3.zip" class="postlink">read_joy3.zip</a><p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sun May 25, 2008 12:45 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-05-24T22:50:35-07:00</updated>
<published>2008-05-24T22:50:35-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33648#p33648</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33648#p33648"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33648#p33648"><![CDATA[
I wrote a version that keeps reading until it gets two in a row that match. I worked out the worst-case to be 5 reads, which can occur in the following two cases:<br /><br />1: Correct<br />Controller changes here<br />2: Correct<br />3: Corrupted by DMC DMA<br />4: Correct<br />5: Correct<br /><br />1: Correct<br />2: Corrupted by DMC DMA<br />3: Correct<br />Controller changes here<br />4: Correct<br />5: Correct<br /><br />Due to the timing of the reads, DMC DMA cannot corrupt more than one read in 5 consecutive reads, even though 5 reads takes longer than 432 clocks. So the only thing that would hang this algorithm is a controller which kept changing more than once every 800 clocks or so.<br /><br />I guess I could make this multi-read algorithm always read 5 times, then analyze the results, so as to reduce the timing variation.<br /><br /><div class="quotetitle">tepples wrote:</div><div class="quotecontent"><br />As far as I can tell, the turbo controllers that carry the Official Nintendo Seal use a timer that turns on and off at up to 30 Hz or so, not a flip-flop that inverts after every strobe.<br /></div><br />The NES Max also used an oscillator for turbo. I doubt any controllers clock turbo from strobe.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sat May 24, 2008 10:50 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2008-05-24T21:19:58-07:00</updated>
<published>2008-05-24T21:19:58-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33643#p33643</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33643#p33643"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33643#p33643"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br />I guess I'll try writing and analyzing a version that reads until two consecutive reads give the same value. The main problem is that this takes a varying amount of time, and would hang if someone fed the controller a very rapid turbo signal.<br /></div><br />As far as I can tell, the turbo controllers that carry the Official Nintendo Seal use a timer that turns on and off at up to 30 Hz or so, not a flip-flop that inverts after every strobe. At least my SN ProPad's box said it used a timer, and the NES Advantage uses adjustable timers. Has anyone reverse-engineered other licensed turbo controllers such as the NES Max?<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Sat May 24, 2008 9:19 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2008-05-24T20:42:16-07:00</updated>
<published>2008-05-24T20:42:16-07:00</published>
<id>https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33640#p33640</id>
<link href="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33640#p33640"/>
<title type="html"><![CDATA[DMC-fortified controller read routine]]></title>

<content type="html" xml:base="https://forums.nesdev.com/viewtopic.php?t=4124&amp;p=33640#p33640"><![CDATA[
Here's an updated version that should work correctly for Famicom external controllers. I thoroughly tested it at maximum DMC rate and it passes. The three reads now take longer than 432 clocks, but the reads are spaced so that the DMC cannot corrupt more than one. Inserting an 8+16*n (n &gt;= 0) clock delay after the first read causes it to fail, confirming that they are spaced properly. I also added a controller button test.<br /><br /><a href="http://h1.ripway.com/blargg/temp/read_joy2.zip" class="postlink">read_joy2.zip</a><br /><br />I also finally got around to doing the analysis of the case where the DMC corrupts the first read, and the controller input changes during the the second two reads. In this case, the corrupted first read will be returned, rather than one of the two correct reads from the controller.<br /><br />There are 8 opportunities for DMC corruption of the first read, and the window for the controller change during the second two is 162 clocks. That means that the DMC corruption at maximum rate has an 8 in 29780 = 1 in ~3722 chance in a given frame, and the controller change a 162 in 29780 = 1 in ~184 chance in a given frame.<br /><br />Assuming the controller were changing at a random time each frame, and the DMC were running, that makes the chance of both occurring in a given frame 1 in ~684848. So there would be an average of one of these errors every 3.2 hours at this worst-case setup. If the controller input were changing on average 10 times per frame, that would put one error every 19 hours.<br /><br />I guess I'll try writing and analyzing a version that reads until two consecutive reads give the same value. The main problem is that this takes a varying amount of time, and would hang if someone fed the controller a very rapid turbo signal.<p>Statistics: Posted by <a href="https://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sat May 24, 2008 8:42 pm</p><hr />
]]></content>
</entry>
</feed>