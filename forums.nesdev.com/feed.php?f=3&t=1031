<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-gb">
<link rel="self" type="application/atom+xml" href="http://forums.nesdev.com/feed.php?f=3&amp;t=1031" />

<title>nesdev.com</title>
<subtitle>NES Development and Strangulation Records message boards</subtitle>
<link href="http://forums.nesdev.com/index.php" />
<updated>2006-02-04T03:28:18-07:00</updated>

<author><name><![CDATA[nesdev.com]]></name></author>
<id>http://forums.nesdev.com/feed.php?f=3&amp;t=1031</id>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2006-02-04T03:28:18-07:00</updated>
<published>2006-02-04T03:28:18-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9061#p9061</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9061#p9061"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9061#p9061"><![CDATA[
Oh yes, no doubt. Plus, I've found a problem with my PPU core... <img src="http://forums.nesdev.com/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br />EDIT- Yes, I fixed. All tests are OK.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Sat Feb 04, 2006 3:28 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2006-02-04T03:02:16-07:00</updated>
<published>2006-02-04T03:02:16-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9059#p9059</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9059#p9059"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9059#p9059"><![CDATA[
The only question is whether the code does the same thing on an emulator as it does on a NES. This is a question that can be answered in specific cases by running code on the NES and emulator and comparing results, and in general by examining the emulator's source code. Everything else is just hand-waving around the issue (cycle-accurate, bla bla).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Sat Feb 04, 2006 3:02 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[WedNESday]]></name></author>
<updated>2006-02-03T14:50:26-07:00</updated>
<published>2006-02-03T14:50:26-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9048#p9048</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9048#p9048"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9048#p9048"><![CDATA[
<div class="quotetitle">Fx3 wrote:</div><div class="quotecontent"><br />I read the topic regarding 2002h thing... of making the read on 4th clock. Well, it might help but... Nintendulator still fails, so it's not an issue after all.<br /></div><br /><br />Nintendulator <strong>isn't</strong> GOD or anything. Just because something fails on it doesn't make it wrong. If you read up on Nintendulators CPU timing you would see that it does nothing of the sort that WedNESday's does. Question for blargg, would WedNESday's perfect timing fix this issue? I assume that it would.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=191">WedNESday</a> — Fri Feb 03, 2006 2:50 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2006-02-03T14:33:19-07:00</updated>
<published>2006-02-03T14:33:19-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9047#p9047</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9047#p9047"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9047#p9047"><![CDATA[
I read the topic regarding 2002h thing... of making the read on 4th clock. Well, it might help but... Nintendulator still fails, so it's not an issue after all.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Fri Feb 03, 2006 2:33 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mattmatteh]]></name></author>
<updated>2006-02-03T14:01:56-07:00</updated>
<published>2006-02-03T14:01:56-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9045#p9045</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9045#p9045"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9045#p9045"><![CDATA[
my emulator passes nestest.  i was guessing its something in the ppu as that is still in the works. <br /><br />here is a full ccpu dump of frame_basics.nes<br />compressed is 1.3 MB, uncompressed is 33 MB<br /><br /><!-- m --><a class="postlink" href="http://icarus.cc.uic.edu/~mhull1/dump.cpu-1.frame_basics.gz">http://icarus.cc.uic.edu/~mhull1/dump.c ... _basics.gz</a><!-- m --><br /><br />here are the first few lines...<br /><br />a:00 x:00 y:00 p:24 sp:fd<br />        e15a  20 b8 e0  jsr $e0b8                     <br />a:00 x:00 y:00 p:24 sp:fb<br />        e0b8  a9 00       lda#$00                     <br />a:00 x:00 y:00 p:26 sp:fb<br />        e0ba  85 f8       sta $f8 = 00<br />a:00 x:00 y:00 p:26 sp:fb<br />        e0bc  a9 28       lda#$28                     <br />a:28 x:00 y:00 p:24 sp:fb<br />        e0be  20 d7 e1  jsr $e1d7          <br /><br /><br />here are the last few lines.....<br /><br />a:00 x:e0 y:09 p:27 sp:fb<br />        e580  8d 00 20  sta $2000 = 20<br />a:00 x:e0 y:09 p:27 sp:fb<br />        e583  20 77 e5  jsr $e577                     <br />a:00 x:e0 y:09 p:27 sp:f9<br />        e577  a9 00       lda#$00                     <br />a:00 x:e0 y:09 p:27 sp:f9<br />        e579  8d f1 07  sta $07f1 = a5<br />a:00 x:e0 y:09 p:27 sp:f9<br />        e57c  60           rts                        <br />a:00 x:e0 y:09 p:27 sp:fb<br />        e586  4c 89 e5  jmp $e589                     <br />a:00 x:e0 y:09 p:27 sp:fb<br />        e589  4c 89 e5  jmp $e589                     <br />a:00 x:e0 y:09 p:27 sp:fb<br /><br /><br /><br />thanks<br /><br />matt<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=170">mattmatteh</a> — Fri Feb 03, 2006 2:01 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2006-02-03T12:05:39-07:00</updated>
<published>2006-02-03T12:05:39-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9042#p9042</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9042#p9042"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9042#p9042"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br /><div class="quotetitle">Fx3 wrote:</div><div class="quotecontent">a) On VBlank rising, if 1 PPU cycle has elapsed since the last 2002h read, a flag (M) is signed.<br /></div><br /><br />I'm not sure what you mean "a flag (M) is signed". If you replace that with "bit 7 of $2002 is not set for that frame" then that is the correct handling. A simpler way to state this is: "On VBlank rising, bit 7 of $2002 is set <em>unless</em> $2002 was read 1 PPU clock earlier."</div><br /><br />During test 2, I logged <strong>2 times</strong> a 2002h read <em>1 PPU cycle before VBlank</em>, making the test to fail. PC at E0DF. It occurs at line 261, cycle 339 (0-340).<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Fri Feb 03, 2006 12:05 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2006-02-03T03:04:48-07:00</updated>
<published>2006-02-03T03:04:48-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9023#p9023</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9023#p9023"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9023#p9023"><![CDATA[
Have you verified your CPU's operation thoroughly? Try making a log of the program counter before each instruction. It's probably getting hung in a loop, whose address you can post for me to find in my asm source.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Fri Feb 03, 2006 3:04 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mattmatteh]]></name></author>
<updated>2006-02-02T14:38:17-07:00</updated>
<published>2006-02-02T14:38:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9012#p9012</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9012#p9012"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=9012#p9012"><![CDATA[
i started 1.frame_basics.nes and let it run for over a minute and all i get is a black screen.  then i tested it with tuxnes and that starts grey and goes to black background with failed #4 after about a second.  then i tried fceu and that was about the same but failed #6.<br /><br />mine always starts grey and goes black soon as i start the game.<br /><br />thanks<br /><br />matt<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=170">mattmatteh</a> — Thu Feb 02, 2006 2:38 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2006-02-01T11:21:17-07:00</updated>
<published>2006-02-01T11:21:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8926#p8926</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8926#p8926"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8926#p8926"><![CDATA[
<div class="quotetitle">Fx3 wrote:</div><div class="quotecontent"><br />a) On VBlank rising, if 1 PPU cycle has elapsed since the last 2002h read, a flag (M) is signed.<br /></div><br /><br />I'm not sure what you mean "a flag (M) is signed". If you replace that with "bit 7 of $2002 is not set for that frame" then that is the correct handling. A simpler way to state this is: "On VBlank rising, bit 7 of $2002 is set <em>unless</em> $2002 was read 1 PPU clock earlier."<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Wed Feb 01, 2006 11:21 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2006-02-01T10:12:27-07:00</updated>
<published>2006-02-01T10:12:27-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8920#p8920</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8920#p8920"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8920#p8920"><![CDATA[
Ok, here's the entire thing... (2.vbl_timing.nes, test #8)<br /><br />1. Yes, 2002h is read exactly 1 PPU cycle before VBlank.<br />2. There's a second 2002h read that occurs 56 PPU cycles after VBlank (1).<br /><br />- That's what I traced carefully. Both reads should return 00. Mine was returning 80h on second one. I'd like an opinion about this "fix"...<br /><br />a) On VBlank rising, if 1 PPU cycle has elapsed since the last 2002h read, a flag (M) is signed.<br /><br />b) On second 2002h read, if (M) is set and 56 cycles have elapsed since VBlank, so 2002h returns bit #7 clear.<br /><br />- It's clear to me about a)... but b) looks like an hack.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Wed Feb 01, 2006 10:12 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2006-02-01T06:55:41-07:00</updated>
<published>2006-02-01T06:55:41-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8907#p8907</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8907#p8907"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8907#p8907"><![CDATA[
I really don't like adding anything extra to the test code that can be handled just as well in a readme (if someone can't be bothered to read it, then the level of accuracy my test ROMs verify is probably not their aim anyway). I'm sure the tests could be made really nice, but the effort and bugs due to unexpected effects make it not worth it in my opinion. I <em>have</em> improved the final reporting, but that runs after the test so there's no danger of it affecting things. Everything else is geared for making the tests as error-free and easy to write as possible. It's already a very time-consuming process.<br /><br />Rather than put all the responsibility on the test ROM, why not develop some guidelines and frontend designs for emulators so that it's easy to add automated testing to one's emulator? When running tests, it wouldn't even show any PPU video on screen, just a console with the results of each test. The emulator could run at maximum speed, making the tests quite fast.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Wed Feb 01, 2006 6:55 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[tepples]]></name></author>
<updated>2006-02-01T06:24:13-07:00</updated>
<published>2006-02-01T06:24:13-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8906#p8906</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8906#p8906"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8906#p8906"><![CDATA[
<div class="quotetitle">blargg wrote:</div><div class="quotecontent"><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Unless you're testing audio, you could have it play music while it's testing.<br /></div><br /><br />Heh. But not really, because it would affect timing. No way I'd make them any more complex.</div><br />By "music" I just meant one note per test if the tests don't take more than about 3 seconds each. That's just 5 writes to registers in $4000 space.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Did you let "1.frame_basics.nes" run for at least half a minute to be sure it never showed anything? It takes a while before the result is displayed.<br /></div><br />For tests that are that long, you could at least give some sort of indication that something is going on. Would cycling color 0 work?<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=9">tepples</a> — Wed Feb 01, 2006 6:24 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[blargg]]></name></author>
<updated>2006-02-01T01:16:17-07:00</updated>
<published>2006-02-01T01:16:17-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8899#p8899</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8899#p8899"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8899#p8899"><![CDATA[
<div class="quotetitle">tepples wrote:</div><div class="quotecontent"><br />Could there be a way to have at least some of the test ROMs programmatically raise a Pass or Fail signal in such a way that the emulator could know to unload the ROM and load the next one?<br /></div><br /><br />Automated testing would need to deal with multiple test ROMs, so the number doesn't matter much. The simplest way to detect the result of a test would be to monitor the nametable for the text printed on screen when a test completes. It'd be quite simple to write a scripting system that had primitives for checking for text on screen and sending joypad commands or loading new ROMs in response. This would accommodate all current test ROMs that print a result on screen. I might even whip this up and post it, if any actual interest is shown in automated testing.<br /><br />I'll keep 32K mappers in mind (the non-switchability of the last bank for more complex mappers had been stuck in my mind). That would be fairly easy to use with very minimal changes to my current code; it'd just involve replacing the "forever: jmp forever" that all of them jump to with code to switch to the next bank. It would also solve the limited devcart space issue: just test each bank separately. Heck, I could even have it automatically receive the next bank over the serial link from the host PC. :)<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><br />Unless you're testing audio, you could have it play music while it's testing.<br /></div><br /><br />Heh. But not really, because it would affect timing. No way I'd make them any more complex.<br /><br /><div class="quotetitle">mattmatteh wrote:</div><div class="quotecontent"><br />blargg your test only shows a black screen.<br /></div><br /><div class="quotetitle">Fx3 wrote:</div><div class="quotecontent"><br />I bet your VBlank flag has incorrect timing. Check it out. I had a similar problem. Once I double-checked the PPU timing, it fixed the problem.<br /></div><br /><br />I checked and Fx3's problem was with the Sprite 0 Hit test ROMs. I didn't see any code in the PPU VBL/NMI timing test ROMs that would cause a blank screen if the VBL timing was off (and it doesn't make any use of sprites). mattmatteh, reply with a precise description of what you did and what the result is, since it's unclear what you mean by "my test". I don't know if you mean "When 1.frame_basics.nes is run in your emulator, you get a black screen for a minute" or something else. This goes for everyone: post precise descriptions of the context of your problems so that others can avoid having to assume things to fill in the missing details. Did you let "1.frame_basics.nes" run for at least half a minute to be sure it never showed anything? It takes a while before the result is displayed.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=17">blargg</a> — Wed Feb 01, 2006 1:16 am</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[mattmatteh]]></name></author>
<updated>2006-01-31T19:39:46-07:00</updated>
<published>2006-01-31T19:39:46-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8892#p8892</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8892#p8892"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8892#p8892"><![CDATA[
also forgot to add that i dont have sprites coded yet.....<br /><br />blargg... do your test depend on sprites ?<br /><br />matt<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=170">mattmatteh</a> — Tue Jan 31, 2006 7:39 pm</p><hr />
]]></content>
</entry>
<entry>
<author><name><![CDATA[Zepper]]></name></author>
<updated>2006-01-31T19:09:07-07:00</updated>
<published>2006-01-31T19:09:07-07:00</published>
<id>http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8891#p8891</id>
<link href="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8891#p8891"/>
<title type="html"><![CDATA[Help with even/odd frames PPU test]]></title>

<content type="html" xml:base="http://forums.nesdev.com/viewtopic.php?t=1031&amp;p=8891#p8891"><![CDATA[
I bet your VBlank flag has incorrect timing. Check it out.<br />I had a similar problem. Once I double-checked the PPU timing, it fixed the problem.<br /><br />Plus, gathering all ROMs in a single might cause timing to break out.<p>Statistics: Posted by <a href="http://forums.nesdev.com/memberlist.php?mode=viewprofile&amp;u=39">Zepper</a> — Tue Jan 31, 2006 7:09 pm</p><hr />
]]></content>
</entry>
</feed>