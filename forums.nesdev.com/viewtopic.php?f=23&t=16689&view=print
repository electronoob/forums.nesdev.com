<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - CROSS CHASE massively cross-platform 8-bit game</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">CROSS CHASE massively cross-platform 8-bit game</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=23&amp;t=16689">http://forums.nesdev.com/viewtopic.php?f=23&amp;t=16689</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Fabrizio Caruso</b> [ Thu Nov 09, 2017 7:19 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>CROSS CHASE massively cross-platform 8-bit game</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hi!<br /><br />I am developing the massively cross-platform simple game CROSS CHASE written in ANSI C:<br /><!-- m --><a class="postlink" href="https://github.com/Fabrizio-Caruso/CROSS-CHASE">https://github.com/Fabrizio-Caruso/CROSS-CHASE</a><!-- m --><br /><br />The game is supposed to run on ANY 8 bit computer/console/handheld from the 70s and 80s (using either the  Motorola 6809, the MOS 6502, the Zilog Z80 or their derivatives). &quot;ANY&quot; = any system with enough memory and display size for which an ANSI C compiler exists.<br />It currently supports about 40 different systems and about 60 configurations (e.g., expanded memory, expanded display, etc.).<br />I am using CMOC/WinCMOC (6809), CC65 (6502), Z88DK (Z80) and lots of other tools.<br /><br />REMARK: The project is not a collection of ports. All versions are supposed to be generated by the very same code except in some cases for a few bits for sound and graphics. This is achieved through abstractions and macros.<br /><br />For the PCEngine I am blocked by the linker configuration in CC65 because I don't know how to configure the linker so that I can have more than 8k of available memory for my code. Who could help?? Should I open a thread somewhere else on this forum?<br /><br />For the NES I have made a fully working and playable  prototype, which is currently only using black and white  because of lack of support in the conio library in CC65. I will have to use some lower level routines to produce better graphics.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Nov 09, 2017 8:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: CROSS CHASE massively cross-platform 8-bit game</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><strong>The license</strong><br /><br />The license of this repository is the <a href="https://en.wikipedia.org/wiki/Zlib_License" class="postlink">license of zlib</a> with an added non-commercial clause:<br /><br /><blockquote style="margin-left: 1%; padding-left: 1%; border-left: 3px solid #555577;">
Permission is granted to anyone to use this software for <strong>non-commercial applications</strong><br />[...]<br />If you use this software <strong>in a product</strong>
</blockquote><br /><br />Apart from the belief among some analysts that noncommercial clauses are considered harmful (see opinion articles by <a href="https://www.gnu.org/philosophy/selling.en.html" class="postlink">Richard Stallman</a>, <a href="http://esr.ibiblio.org/?p=4559" class="postlink">Eric S. Raymond</a>, <a href="http://www.eioba.com/a/r0/creative-commons-nc-licenses-considered-harmful" class="postlink">Eric Moeller</a>, <a href="https://blog.okfn.org/2013/01/08/consequences-risks-and-side-effects-of-the-license-module-non-commercial-use-only-2/" class="postlink">Joris Pekel</a>), this appears to contradict itself.<br /><br /><strong>Your question: Memory mapping</strong><br /><br />I've never programmed for the TG16, but I have shipped a commercial game using (a clone of) MMC3. So what I'm about to write is extrapolation from how ld65 is used with NES mappers, combined with the article &quot;<a href="https://emu-docs.org/PC%20Engine/hw.html" class="postlink">PC Engine Memory Mapping</a>&quot;.<br /><br />Like the MMC3, FME-7, and VRC7 mappers on the NES, the HuC6280 CPU's built-in MMU divides the 64 KiB address space into 8 KiB windows. But unlike NES mappers, which fix particular windows to particular banks, the HuC6280 makes all eight windows switchable, calling them MPR0 through MPR7. They're mapped as follows:<br /><br /><ul><li>MPR0 ($0000): I/O (bank $FF)</li><li>MPR1 ($2000): RAM (bank $F8)</li><li>MPR2 ($4000) through MPR6 ($C000): ROM (banks $01 through $F7)</li><li>MPR7 ($E000): ROM home bank (bank $00)</li></ul><br />Perhaps the easiest way to proceed is to put your C code in $4000-$DFFF (40 KiB).<br /><br />So here's an untested linker configuration file. It offers a fixed bank at $E000 (<tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">.segment &quot;LOWCODE&quot;</tt>) for startup code and assembly language I/O routines, two 8 KiB banks at $4000 (<tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">.segment &quot;BANK1&quot;</tt> and <tt style="margin-left: 2px; margin-right: 2px; padding:3px; background-color: #3355aa; color: white;">.segment &quot;BANK2&quot;</tt>) for things like tile data that only the I/O routines need to access, and a 40 KiB continuous area at $4000-$DFFF for your C code.<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent"># 512 kbit HuCard linker script<br /># Copyright 2017 Damian Yerrick<br />#<br /># Copying and distribution of this file, with or without<br /># modification, are permitted in any medium without royalty<br /># provided the copyright notice and this notice are preserved.<br /># This file is offered as-is, without any warranty.<br />#<br />MEMORY {<br />&nbsp; ZP:&nbsp; &nbsp; &nbsp;start = $10, size = $f0, type = rw;<br />&nbsp; # use first $10 zeropage locations as locals<br />&nbsp; HEADER: start = 0, size = $0010, type = ro, file = %O, fill=yes, fillval=$00;<br />&nbsp; RAM:&nbsp; &nbsp; start = $2200, size = $1E00, type = rw;<br />&nbsp; ROM0:&nbsp; &nbsp;start = $E000, size = $2000, type = ro, file = %O, fill=yes, fillval=$FF, bank=0;<br />&nbsp; ROM1:&nbsp; &nbsp;start = $4000, size = $2000, type = ro, file = %O, fill=yes, fillval=$FF, bank=1;<br />&nbsp; ROM2:&nbsp; &nbsp;start = $4000, size = $2000, type = ro, file = %O, fill=yes, fillval=$FF, bank=2;<br />&nbsp; ROM37:&nbsp; start = $4000, size = $A000, type = ro, file = %O, fill=yes, fillval=$FF, bank=3;<br />}<br /><br />SEGMENTS {<br />&nbsp; ZEROPAGE: load = ZP, type = zp;<br />&nbsp; BSS:&nbsp; &nbsp; &nbsp; load = RAM, type = bss, define = yes, align = $100;<br /><br />&nbsp; # Fixed bank segments<br />&nbsp; LOWCODE:&nbsp; load = ROM0, type = ro, align = $100;<br />&nbsp; STARTUP:&nbsp; load = ROM0, type = ro, align = $100, optional = yes;<br />&nbsp; ONCE:&nbsp; &nbsp; &nbsp;load = ROM0, type = ro, align = $100;<br />&nbsp; VECTORS:&nbsp; load = ROM0, type = ro, start = $FFF6;<br /><br />&nbsp; # Auxiliary segments<br />&nbsp; BANK1:&nbsp; &nbsp; load = ROM1, type = ro, align = $100, optional = yes;<br />&nbsp; BANK2:&nbsp; &nbsp; load = ROM2, type = ro, align = $100, optional = yes;<br /><br />&nbsp; # Main C code segments<br />&nbsp; CODE:&nbsp; &nbsp; &nbsp;load = ROM37, type = ro, align = $100;<br />&nbsp; RODATA:&nbsp; &nbsp;load = ROM37, type = ro, align = $100;<br />}<br /><br />FILES {<br />&nbsp; %O: format = bin;<br />}<br /></div><br />The startup code is then responsible for setting the MPRs to [$FF, $F8, $03, $04, $05, $06, $07, $00] before the C code runs.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Fabrizio Caruso</b> [ Thu Nov 16, 2017 2:16 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: CROSS CHASE massively cross-platform 8-bit game</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thanks for your reply!<br /><br />Unfortunately my understanding of what I need to do other than just using your proposed cfg file is very limited.<br /><br />Am I supposed to write some startup code myself? I have no idea how to select the banks.<br /><br />Remark:<br />I only need 16k to get my game to work on the NES.<br /><br />Why can't I just add<br /><br />ROM37:  start = $4000, size = $A000, type = ro, file = %O, fill=yes, fillval=$FF;<br /><br />and<br /><br />CODE:     load = ROM37, type = ro;<br /><br />What are the options bank=0/1/2/3 used for? Are they necessary?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>OmegaMax</b> [ Sat Nov 18, 2017 11:37 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: CROSS CHASE massively cross-platform 8-bit game</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />There is a pce development thread on these forums<br /><br /><!-- m --><a class="postlink" href="http://www.pcenginefx.com/forums/index.php">http://www.pcenginefx.com/forums/index.php</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Sat Nov 18, 2017 1:22 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: CROSS CHASE massively cross-platform 8-bit game</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />From your link:<br /><blockquote style="margin-left: 1%; padding-left: 1%; border-left: 3px solid #555577;">
Only registered members are allowed to access this section.<br />Please login below or register an account with Pcenginefx.com.
</blockquote><br /><br />From the <a href="http://www.pcenginefx.com/forums/index.php?action=register" class="postlink">registration form</a>:<br /><blockquote style="margin-left: 1%; padding-left: 1%; border-left: 3px solid #555577;">
This connection is not secure. Logins entered<br />here could be compromised. <a href="https://support.mozilla.org/en-US/kb/insecure-password-warning-firefox?as=u&amp;utm_source=inproduct" class="postlink">Learn More</a>
</blockquote><br /><br />The registration form appears to display through HTTPS, but none of the theme graphics display. I wasn't able to verify that the form actually submits and allows me to register in the time that I had allotted to test the form.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ccovell</b> [ Wed Nov 22, 2017 5:56 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: CROSS CHASE massively cross-platform 8-bit game</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yeah, that's one of the problems of the PCEnginefx forums: they can't even be read (or searched by Google) if you're not a member...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Pokun</b> [ Sun Nov 26, 2017 7:21 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: CROSS CHASE massively cross-platform 8-bit game</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yeah and you can't log in securely without breaking the theme and all other images. I've filed a complaint about this on the forum.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Fabrizio Caruso</b> [ Tue Feb 06, 2018 10:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: CROSS CHASE massively cross-platform 8-bit game</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hi!<br /><br />I am still struggling to understand how to use CC65 to build functional roms for the PCE bigger than 8k.<br /><br />I know how create the roms but they don't work if bigger than 8k. Some sort of bank activation seems necessary but I have no idea how to activate the banks and where to put this activation code.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>