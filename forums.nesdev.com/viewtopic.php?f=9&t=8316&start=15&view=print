<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Need help for Kazzo USB rom dumper</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Need help for Kazzo USB rom dumper</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=9&amp;t=8316">http://forums.nesdev.com/viewtopic.php?f=9&amp;t=8316</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>2</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>HardWareMan</b> [ Wed Nov 16, 2011 1:54 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You welcome.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>byemu</b> [ Wed Nov 16, 2011 4:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">HardWareMan wrote:</div><div class="quotecontent">IC 74xx00, resistors 390 Ohm, capasitors 300 pf, quarz 1,7 MHz (or so).</div>
<br />
<br />oh,390 Ohm!
<br />In market,I can only buy the quarz 1.6 MHz!
<br />Can I replace the 1.7 mhz, or must change the element.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Wed Nov 16, 2011 5:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'd guess anything between 1 and 3 MHz would work, depending on the values of the caps in the cart's reset detector. So go ahead and try the 1.6 MHz.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>HardWareMan</b> [ Wed Nov 16, 2011 8:30 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />As I already <a href="http://nesdev.com/bbs/viewtopic.php?p=86375#86375" class="postlink">said</a>:
<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">This signal are not required to be toggled at 1.7MHz, all depend on capasitor. Sometimes couple of hundred kHz are enough. </div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>byemu</b> [ Fri Nov 18, 2011 12:31 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">HardWareMan wrote:</div><div class="quotecontent">As I already <a href="http://nesdev.com/bbs/viewtopic.php?p=86375#86375" class="postlink">said</a>:<br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">This signal are not required to be toggled at 1.7MHz, all depend on capasitor. Sometimes couple of hundred kHz are enough. </div></div>
<br />
<br />I am add your circuit to kazzo ,but it's failed!
<br />why?
<br />
<br />I can not read the cpu data from 0x8000 t0 0xffff!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>HardWareMan</b> [ Fri Nov 18, 2011 10:36 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I think that the firmware for the controller must be improved in order to correct work management PH2 signal. The old one controls PH2 pin directly wich are may not be compatible with new schematic with oscillator. By the way, you checked for presence of frequency?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>byemu</b> [ Fri Nov 18, 2011 4:21 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">HardWareMan wrote:</div><div class="quotecontent">I think that the firmware for the controller must be improved in order to correct work management PH2 signal. The old one controls PH2 pin directly wich are may not be compatible with new schematic with oscillator. By the way, you checked for presence of frequency?</div>
<br />
<br />
<br />I think so,but i don't know how to improved,maybe I can try it.
<br />
<br />see the firmware's sourcecode,maybe you can improved it(I use a 1.6mhz quarz).
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">&nbsp;//&nbsp; 00000000<br />&nbsp;//&nbsp; &nbsp; &nbsp; &nbsp;|||____PHI2&nbsp; 1=up,0=down<br />&nbsp;//&nbsp; &nbsp; &nbsp; &nbsp;||_____ROMCS 1=up<br />&nbsp;//&nbsp; &nbsp; &nbsp; &nbsp;|______RW&nbsp; &nbsp; 1=up<br />&nbsp;//<br />&nbsp;// BUS_CLOSE = ~&#40;1 &lt;&lt; CPU_PHI2&#41;<br />void cpu_read&#40;uint16_t address, uint16_t length, uint8_t *data&#41;<br />&#123;<br />&nbsp; &nbsp;BUS_CONTROL_OUT = BUS_CLOSE;//pulldown CPU_PHI2,other are up<br />&nbsp; &nbsp;while&#40;length != 0&#41;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;uint8_t c = BUS_CLOSE;<br />&nbsp; &nbsp;&nbsp; &nbsp;direction_write&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;address_set&#40;address&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;&#40;address &amp; 0x8000&#41; != 0&#41;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;c &amp;= bit_get_negative&#40;CPU_ROMCS&#41;;//pulldown CPU_ROMCS<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;c |= 1 &lt;&lt; CPU_PHI2;//pullup PHI2<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = c;//execute op<br />&nbsp; &nbsp;&nbsp; &nbsp;direction_read&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;*data = DATABUS_IN;<br />&nbsp; &nbsp;&nbsp; &nbsp;data += 1;<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = BUS_CLOSE;<br />&nbsp; &nbsp;&nbsp; &nbsp;address += 1;<br />&nbsp; &nbsp;&nbsp; &nbsp;length--;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;direction_write&#40;&#41;;<br />&#125;<br /><br />void cpu_read_6502&#40;uint16_t address, uint16_t length, uint8_t *data&#41;<br />&#123;<br />&nbsp; &nbsp;while&#40;length != 0&#41;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;uint8_t c = BUS_CLOSE;<br />&nbsp; &nbsp;&nbsp; &nbsp;//down -&gt; up<br />&nbsp; &nbsp;&nbsp; &nbsp;direction_write&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;address_set&#40;address&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = c;//execute op<br />&nbsp; &nbsp;&nbsp; &nbsp;clock_wait&#40;1&#41;;//wait 550ns<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;//phi2 up<br />&nbsp; &nbsp;&nbsp; &nbsp;c |= &#40;1 &lt;&lt; CPU_PHI2&#41;;////pullup PHI2<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;&#40;address &amp; 0x8000&#41; != 0&#41;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;c &amp;= bit_get_negative&#40;CPU_ROMCS&#41;;//pulldown CPU_ROMCS<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = c;//execute op<br />&nbsp; &nbsp;&nbsp; &nbsp;direction_read&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;clock_wait&#40;1&#41;;//wait 550ns<br />&nbsp; &nbsp;&nbsp; &nbsp;*data = DATABUS_IN;//read data<br />&nbsp; &nbsp;&nbsp; &nbsp;data += 1;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = c;//execute op<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;//phi2 down, bus close<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = BUS_CLOSE;//pulldown CPU_PHI2,other are up<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;address += 1;<br />&nbsp; &nbsp;&nbsp; &nbsp;length--;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;address_set&#40;ADDRESS_CLOSE&#41;;<br />&#125;<br /><br />/*<br />NTSC hardware timing<br />Master clock fsc: 21.4772272 MHz<br />CPU clock fsc/12: 1.789773MHz<br />clock per second 12/fsc: 5.58*10**-7 sec, 0.55 us<br />*/<br />void cpu_write_6502&#40;uint16_t address, uint16_t length, const uint8_t *data&#41;<br />&#123;<br />&nbsp; &nbsp;while&#40;length != 0&#41;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;uint8_t control;<br />&nbsp; &nbsp;&nbsp; &nbsp;address_set&#40;address&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;//phi2 down<br />&nbsp; &nbsp;&nbsp; &nbsp;////pulldown CPU_RW and CPU_PHI2<br />&nbsp; &nbsp;&nbsp; &nbsp;control = bit_get_negative&#40;CPU_RW&#41; &amp; bit_get_negative&#40;CPU_PHI2&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = control;<br />&nbsp; &nbsp;&nbsp; &nbsp;clock_wait&#40;1&#41;;//wait 550ns<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;//phi2 up<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;&#40;address &amp; 0x8000&#41; != 0&#41;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;control &amp;= bit_get_negative&#40;CPU_ROMCS&#41;;//pulldown CPU_ROMCS<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;control |= &#40;1 &lt;&lt; CPU_PHI2&#41;;//pullup PHI2<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = control;<br />&nbsp; &nbsp;&nbsp; &nbsp;//data set<br />&nbsp; &nbsp;&nbsp; &nbsp;DATABUS_OUT = *data;//write data<br />&nbsp; &nbsp;&nbsp; &nbsp;data++;<br />&nbsp; &nbsp;&nbsp; &nbsp;clock_wait&#40;1&#41;;//wait 550ns<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;//phi2 down<br />&nbsp; &nbsp;&nbsp; &nbsp;control &amp;= bit_get_negative&#40;CPU_PHI2&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = control;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;&#40;address &amp; 0x8000&#41; != 0&#41;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;control &amp;= bit_get_negative&#40;CPU_ROMCS&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = control;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;//bus close<br />&nbsp; &nbsp;&nbsp; &nbsp;BUS_CONTROL_OUT = BUS_CLOSE;<br />&nbsp; &nbsp;&nbsp; &nbsp;clock_wait&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;address += 1;<br />&nbsp; &nbsp;&nbsp; &nbsp;length--;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;address_set&#40;ADDRESS_CLOSE&#41;;<br />&#125;</div>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>infiniteneslives</b> [ Fri Nov 18, 2011 8:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />If that's the original firmware it looks that phi2 is ALREADY being toggled.  But the original issue was supposed to be that it wasn't?
<br />
<br />I'm sure the frequency isn't 1.7Mhz but I would think it's enough to prevent a reset.  I'm not really sure how that mapper reset thing works though...

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>2</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>