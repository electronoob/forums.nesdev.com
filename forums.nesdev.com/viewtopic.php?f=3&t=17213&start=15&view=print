<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - NES 2.0 Additions Proposal</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">NES 2.0 Additions Proposal</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=17213">http://forums.nesdev.com/viewtopic.php?f=3&amp;t=17213</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>2</strong> of <strong>4</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Mon Apr 02, 2018 9:03 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Emulating two CPUs and PPUs is not too difficult if the emulator design is modular. I don't think stuffing the two units' ROMs into one file is a problem at all provided it's properly documented how to separate them and no emulator does &quot;its own thing&quot; on that. <em>Vs. Raid on Bungeling Bay</em> is a Vs. Dual game with the second CPU only getting the dummy &quot;mds-rb4-2 b.1a&quot; ROM image. For iNES, you would pack the first 32 KiB PRG-ROM, then 24 KiB of padding, then the 8 KiB &quot;mds-rb4-2 b.1a&quot; ROM, then the 16 KiB CHR-ROM into the file. I've got it working right here.<br /><br />Emulators can show both screens or just one of them. Showing just one is entirely justifiable, because the second unit running a different game session from the first is an unlikely option for home use, and players on the first playing against players on the second unit will necessarily show the entire game situation on both screens.<br /><br />I am not sure what you mean by single PPU byte. You mean combining the Vs. PPU with the TV System field? I agree that could not be done without breaking backwards compatibility.<br /><br />What I have not done is add a field for input/expansion device. I would have used to so-far unused byte 15 for that. That would make the &quot;Vs. Mode&quot; byte cleaner, since the Reversed and Weird control types would be moved out of it, and it would also relieve emulators of automatically assigning input devices using hash tables. But it was indicated on this board in the past that this would not be accepted and relegated to a metadata text file, so I left it out of the proposal, even though I would disagree and would find it nice.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Apr 02, 2018 9:28 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent">players on the first playing against players on the second unit will necessarily show the entire game situation on both screens.</div><br />Are all Dualsystem games mirrored like this? I thought there'd be at least one that presents different views for the two players, such as games of partial information like Stratego or many card games or many FPS or RTS games, or things where the scrolling viewpoint differs like any racing game that isn't non-scrolling like Super Sprint or edge-triggered like Micro Machines. Even in a game of perfect information, something like doubles tennis might display the reverse angle, causing one side's controls to appear inverted if everybody's looking at the first machine's display.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Mon Apr 02, 2018 9:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I think Vs. Mahjong only shows each player's own stones. Of course, putting both screens side-by-side loses you the limited information as well, so unless an emulator outputs each emulated screen to a separate host display, the limited information aspect will be gone. Vs. Tennis indeed shows the reverse point of view, though not seeing the different point of view would not necessarily impact gameplay, even as the left/right buttons of the second unit would have to be reversed in that scenario.<br /><br />But those are not issues for the NES 2.0 file format, as they would present themselves even when using MAME-like split ROMs.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Mon Apr 02, 2018 10:18 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent">Emulating to CPUs and PPUs is not too difficult if the emulator design is modular. I don't think stuffing the two units' ROMs into one file is a problem at all provided it's properly documented how to separate them and no emulator does &quot;its own thing&quot; on that. <em>Vs. Raid on Bungeling Bay</em> is a Vs. Dual game with the second CPU only getting the dummy &quot;mds-rb4-2 b.1a&quot; ROM image. For iNES, you would pack the first 32 KiB PRG-ROM, then 24 KiB of padding, then the 8 KiB &quot;mds-rb4-2 b.1a&quot; ROM, then the 16 KiB CHR-ROM into the file. I've got it working right here.<br /></div>I've always been uncomfortable with mapper 99's &quot;any padding is actually open bus&quot; but given the constraints of the iNES format there was nothing to be done for it. Extending this such that<br />32 KiB PRG implies 1 CPU, no PRG bankswitching<br />48 KiB PRG implies 1 CPUs, PRG bankswitching at $8000<br />64 KiB PRG implies 2 CPUs, no PRG bankswitching<br /><br />is ... well, I guess not really any worse.<br /><br />I guess this does make we wonder if this behavior is better something baked into mapper 99 instead of into the header. We don't know of any DualSystem games that aren't mapper 99, and I'm unclear whether this &quot;just pad and duplicate&quot; behavior is something that should be generalized?<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">will necessarily show the entire game situation on both screens.<br /></div>Well ... sorta? at least Vs. Wrecking Crew displays the complementary information on both screens (near vs far is flipped)<br /><br /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent">Vs. Tennis indeed shows the reverse point of view, though not seeing the different point of view would not necessarily impact gameplay, even as the left/right buttons of the second unit would have to be reversed in that scenario.<br /></div>Er. If you display both screens, then you don't need to reverse controls on the second unit. It's a problem specifically created by choosing to display just one screen.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">But those are not issues for the NES 2.0 file format, as they would present themselves even when using MAME-like split ROMs.<br /></div>They're issues with saying that it's practical to display just one screen, which evidently has some sticking points.<br /><br />I think Nocash is the only previous person to have attempted to put DualSystem emulation in a general-purpose NES emulator; if I'm right in that regard, I'd like his input on this too.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">What I have not done is add a field for input/expansion device. I would have used to so-far unused byte 15 for that.<br /></div>I remember Zzo38 starting defining the external metadata format in response to being disappointed by that decision, but I forget basically everything else about that discussion. Link?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Mon Apr 02, 2018 10:22 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Here was <a href="http://wiki.nesdev.com/w/index.php/User:Zzo38/Metadata_INI" class="postlink">zzo38's metadata proposal</a>.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Mon Apr 02, 2018 10:37 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The discussion was <a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=10183" class="postlink">here</a>. It quickly became philosophical. My point would be that the ROM header should contain everything needed to allow an emulator to run the game in a way that it can be played, without having to use a hash database. &quot;in a way that it can be played&quot; would include input devices, while it would not include cartridge codes, manuals, overscan and palette preferences and things like that. If the objection is to say that the real-hardware user has to know as well which input device he needs to plug into his console, I would reply saying that the user also has to know into which type of console --- NTSC, PAL, Dendy --- he is sticking his cartridge, and yet we have a TV System field.<br /><br />As for the &quot;who's going to update the headers in all the ROM files out there&quot; problem (regardless of whether an &quot;input devices&quot; field is included or not), I would volunteer to make a NES-header correction utility (which in turn would of course need to have its database) that can be applied on an entire ROM collection. Once everything is finalized, new mapper numbers and all, that is.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Mon Apr 02, 2018 11:24 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">NewRisingSun wrote:</div><div class="quotecontent">The discussion was <a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=10183" class="postlink">here</a>. It quickly became philosophical.<br /></div>Wow, that was a useless discussion. Small wonder I'd forgotten specifics.<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">My point would be that the ROM header should contain everything needed to allow an emulator to run the game in a way that it can be played, without having to use a hash database. &quot;in a way that it can be played&quot; would include input devices<br /></div>I can't think of a good reason to <em>not</em> include this information, but I think discussion about it should probably have its own thread.<br /><br />There's plenty of homebrew that supports a choice of multiple different controllers via any given input; are there commercial games that do so also?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Mon Apr 02, 2018 11:31 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'll post an input device proposal for byte 15 to a separate thread then.<br /><br />Edit: <a href="http://forums.nesdev.com/viewtopic.php?f=3&amp;t=17219" class="postlink">Done</a>.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>B00daW</b> [ Wed Apr 04, 2018 6:24 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Should we add a Byte 13 reference to the CPU TEST mode being enabled?  Not certain if test ROMs have been made yet, but it could also help with accurate emulation of the feature.  Not certain if it's even emulated yet either.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Thu Apr 05, 2018 2:02 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That's quite esoteric. I suppose one could add a value for it, as long as it does not turn the whole proposal into a complete joke.<br /><br />On another note, there already exist ROM images with 64 MiB and more in PRG-ROM size --- two OneBus plug-and-plays with exactly 64 MiB, and that &quot;Coolgirl 320-in-1&quot; multicart which has more than 64 MiB of PRG-ROM (and an <a href="https://clusterrr.com/temp/coolgirl.cpp" class="postlink">insanely complex mapper</a>). NES 2.0 only allows up to 64 MiB at the moment, and 64 MiB are implicitly represented by zero PRG-ROM banks.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>B00daW</b> [ Thu Apr 05, 2018 7:19 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Not certain how the proposal would be a joke if it's an embedded feature (albeit hidden) within the processor itself.  It also gives the emulator an opportunity to let the user know that the type of ROM requires the features enabled; and to provide a compatibility message.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Thu Apr 05, 2018 7:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It would become a joke if emulator authors started seeing the proposal as a wishlist for obscure features they have no intent of adding, and refuse to implement the header additions themselves for that reason. But okay, I have added Byte 13 value 02 to the proposal along with a disclaimer.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>lidnariq</b> [ Thu Apr 05, 2018 8:54 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />P.S. enumerating what test mode means:<br /><br />* Normally, only reads from $4015 come from the CPU's internal data bus. There's some simple logic that controls whether the external data bus drives the internal data bus, and it's normally true during all other reads.<br />* When TEST is enabled, reads from the entire range from $4000-$401F are only from the internal data bus. THERE IS NO WAY TO USE EXTERNAL CONTROLLERS WHEN IN TEST MODE. Entirely separate controllers attached to the cartridge would be the only way.<br />** Now, Zzo38 has asked, and I <strong>think</strong> Quietust has confirmed, that TEST can be switched on a cycle-by-cycle basis, so it's possible to connect CPU A3 to TEST and change the isolated addresses to $4008-$400F, and $4018-$401F, but ... this option bothers me.<br />* When TEST is enabled, a write-only register at $401A and three read-only registers from $4018-$401A are enabled.<br /><br />TEST is not present in the 2A03letterless. I don't know if it's present in the 2A03E and 2A03H.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>tepples</b> [ Thu Apr 05, 2018 9:28 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Just a wild guess, but Nintendo's factory probably tested 2A03 CPUs received from Ricoh, and the test rig had a 2A03 socket and some additional MMIO port that controls the test mode pin, letting the program switch between test mode and run mode. But I imagine that sort of stuff would be even more obscure than the Nintendo PlayStation. So until such a test rig surfaces, I oppose baking into NES 2.0 a means to distribute a firmware for it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>NewRisingSun</b> [ Thu Apr 05, 2018 9:58 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: NES 2.0 Additions Proposal</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />All right, out with it then.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>2</strong> of <strong>4</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>