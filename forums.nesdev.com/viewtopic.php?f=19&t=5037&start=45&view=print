<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<title>nesdev.com :: View topic - Comunidad nesdev hispana</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">nesdev.com</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/">http://forums.nesdev.com/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Comunidad nesdev hispana</span><br /><span class="gensmall"><a href="http://forums.nesdev.com/viewtopic.php?f=19&amp;t=5037">http://forums.nesdev.com/viewtopic.php?f=19&amp;t=5037</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>4</strong> of <strong>7</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Petruza</b> [ Fri Jul 15, 2011 9:27 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Anes wrote:</div><div class="quotecontent">Argentino, de aca también colaborando con el habla hispana.<br />Yo vengo haciendo el emulador desde el 2004. Lo dejé por obligaciones, pero estoy de vuelta.</div>
<br />
<br />Qué bueno, contá:
<br />1- lenguaje
<br />2- sistema operativo
<br />3- librerías
<br />4- estado de avance
<br />( todos pueden contestar )

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Anes</b> [ Sat Jul 16, 2011 8:35 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Petruza wrote:</div><div class="quotecontent"><div class="quotetitle">Anes wrote:</div><div class="quotecontent">Argentino, de aca también colaborando con el habla hispana.<br />Yo vengo haciendo el emulador desde el 2004. Lo dejé por obligaciones, pero estoy de vuelta.</div><br /><br />Qué bueno, contá:<br />1- lenguaje<br />2- sistema operativo<br />3- librerías<br />4- estado de avance<br />( todos pueden contestar )</div>
<br />
<br /><ul>1 - C (Visual Studio)<br />2 - Win32/Win64 (Desarrollado bajo Windows 7 x64)<br />3 - DirectX (DirectDraw, DirectSound, DirectInput) en fin Ninguna, todo metido dentro del exe hecho desde 0<br />4 - <br /><ul>    - MAPPER 0 (por supuesto)<br />    - UNROM, CNROM, <br />    - MMC1 <br />    - MMC3 (parcialmente)<br />    - Desensamblador (parcialmente también)<br /></ul></ul>
<br />
<br />En tiempos pasados lo hice en Assembler (MASM) y C++ (VS), pero me quedé con el C.
<br />Los otros tenían Sonido, pero decidí hacer el emulador de vuelta porque era un desastre, pero pronto le agrego sonido. Estoy esperando arreglar cosas del PPU.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Petruza</b> [ Sat Jul 16, 2011 8:49 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Anes wrote:</div><div class="quotecontent"><ul>1 - C (Visual Studio)<br />2 - Win32/Win64 (Desarrollado bajo Windows 7 x64)<br />3 - DirectX (DirectDraw, DirectSound, DirectInput) en fin Ninguna, todo metido dentro del exe hecho desde 0<br />4 - <br /><ul>    - MAPPER 0 (por supuesto)<br />    - UNROM, CNROM, <br />    - MMC1 <br />    - MMC3 (parcialmente)<br />    - Desensamblador (parcialmente también)<br /></ul></ul></div>
<br />
<br />Ah, muy avanzado.
<br />Cuántos y cuales juegos testeaste?
<br />Cómo testeas y debugeas? con el desensamblador, con el debugger del visual studio?
<br />En qué consiste el desensamblador?
<br />
<br />Te pregunto porque yo programé lo mínimo necesario para correr un juego, básicamente las opcodes y un mínimo render, corrí un par de juegos y obviamente no anduvo ninguno. Así que ahora estoy haciendo un debugger gráfico para ver dónde se cuelgan los juegos.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Anes</b> [ Tue Jul 19, 2011 1:27 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Petruza wrote:</div><div class="quotecontent"><div class="quotetitle">Anes wrote:</div><div class="quotecontent"><ul>1 - C (Visual Studio)<br />2 - Win32/Win64 (Desarrollado bajo Windows 7 x64)<br />3 - DirectX (DirectDraw, DirectSound, DirectInput) en fin Ninguna, todo metido dentro del exe hecho desde 0<br />4 - <br /><ul>    - MAPPER 0 (por supuesto)<br />    - UNROM, CNROM, <br />    - MMC1 <br />    - MMC3 (parcialmente)<br />    - Desensamblador (parcialmente también)<br /></ul></ul></div><br /><br />Ah, muy avanzado.<br />Cuántos y cuales juegos testeaste?<br />Cómo testeas y debugeas? con el desensamblador, con el debugger del visual studio?<br />En qué consiste el desensamblador?<br /><br />Te pregunto porque yo programé lo mínimo necesario para correr un juego, básicamente las opcodes y un mínimo render, corrí un par de juegos y obviamente no anduvo ninguno. Así que ahora estoy haciendo un debugger gráfico para ver dónde se cuelgan los juegos.</div>
<br />
<br />Creo que no te conviene escribir el código específico para un sólo juego. Emulá el CPU completoe (que no es tan díficil) primero, depués hacés un Render pixel por pixel básico y de ahí progresas.
<br />
<br />He probado unos 100 mas o menos me corre un 85%.
<br />
<br />Básicamente depuro con el Visual Studio, en realidad estoy usando el Visual C++ 2010 express con el Resedit (editor de recursos). Lo uso principalmente por las capacidades muy buenas de depuración en tiempo real que tiene. Aunque tengo el Visual Studio Original. Te dejo unos link que te pueden interesar:
<br />
<br />6502:
<br /><a href="http://users.telenet.be/kim1-6502/6502/proman.html" class="postlink">http://users.telenet.be/kim1-6502/6502/proman.html</a>
<br />Éste de explica el 6502 de una forma sencilla y amigable, mucho mejor que los documentos esos tan exactos. El 6502.txt del Nesdev tiambién es un buen comienzo.
<br />
<br />DirectDraw:
<br /><a href="http://archive.gamedev.net/reference/articles/article1260.asp" class="postlink">http://archive.gamedev.net/reference/articles/article1260.asp</a>
<br /><a href="http://archive.gamedev.net/reference/articles/article1270.asp" class="postlink">http://archive.gamedev.net/reference/articles/article1270.asp</a>
<br />
<br />Podés usar directamente el el modo de colores de 32bits depth en DirectDraw. Mostrar píxeles (ahí en el artículo te muestra cómo mostrar píxeles usando coordenadas X e Y. Te sugiero que emprecés con esto, después optimizás el código.
<br />Del CPU no te olvidés del nestest.nes para probar el CPU.
<br />
<br />PPU:
<br />Te aconsejo que empecés como todos con el de Yoshi (auque está desactualizado) para un panorama general. Después podés pasar al nintech.txt y depués al "2A03" reference. De todas formas así fue como hice yo. 
<br />En realidad cuando empecé lo hice por scanline, fui dando vueltas y preguntando en el NesemDev hasta que obtuve algo palpable.
<br />Acordate que el pattern table son dos bytes, y que obiente el bit alto y el bit bajo del pixel, con esto te sobra para hacer un render de 4 colores para ver algo en la pantalla (sobre todo el nestest.nes para que testees el CPU. Después más adelante te preocupas por los attribute table.
<br />Tomá como referencia un juego simple: "Popeye" se me viene a la cabeza y metele hasta que veas algo en pantalla. En el switch(opcode)
<br />agrega un default para que veas los opcodes que estan fallando.
<br />
<br />Aunque sea una pregunta boluda, preguntala en el Nesdev, es la mejor forma de avanzar.
<br />
<br />En fin así mas o menos empecé yo, que hay otras formas no lo niego, pero algo de resultado me dió.  <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" /> 
<br />
<br />Si querés agregame al messenger o mandame un mail y charlamos.
<br />
<br />Suerte.   <img src="./images/smilies/icon_wink.gif" alt=":wink:" title="Wink" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ehguacho</b> [ Tue Jul 19, 2011 7:40 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />me gustaria agregar una pequeña cosita: el "6502.txt" tiene algunos errores en los numeros de los opcodes. en el foro se dice que este -&gt; <a href="http://www.obelisk.demon.co.uk/6502/reference.html" class="postlink">http://www.obelisk.demon.co.uk/6502/reference.html</a> es el mejor documento sobre el 6502 de la web, ya que no tiene errores (cabe destacar que el documento es sobre el 6502 original, y NO sobre el 6502 que usa la NES, que tiene unas pequeñas variaciones). un sitio en el que te pueden ayudar muchisimo es este -&gt; <a href="http://forum.6502.org/" class="postlink">http://forum.6502.org/</a>, un foro hecho por gente que la tiene mas que clara con el 6502.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Petruza</b> [ Tue Jul 19, 2011 9:24 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Anes wrote:</div><div class="quotecontent">Creo que no te conviene escribir el código específico para un sólo juego...</div>
<br />
<br />Me expresé mal, no es que apunté a que corra un juego específico, sino que le di soporte apenas para que pudiera correr cualquier juego con mapper 0.
<br />Implementé todos los opcodes documentados, y los testeé.
<br />Con respecto al render, en realidad como estoy desarollando el engine exclusivamente, no tiene render per se, simplemente emula el estado de la memoria de video, nametables, etc. y eso luego es tomado por algún plugin que se ocupa del render.
<br />Por ahora y para testearlo hice un plugin muy básico que renderea no por scanline ni pixel, sino por sprite. Esto funciona, obviamente que los juegos que usan scroll con pantalla partida o algún otro truco entre scalines, se verán mal, pero para testear juegos sin scroll en pantalla fija como por ejemplo balloon fight, sirve.
<br />
<br />El emulador logró mostrar una pantalla estática con la intro del Zelda, que es una demo que alguien posteó en este foro, pero cuando pruebo juegos de verdad, crashean en algún lugar, y me parece medio tedioso usar un debugger normal para debugear el juego, por eso quiero desarrollar un debugger visual para ver en qué estado está la memoria de video, nametables, sprites y demás

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Anes</b> [ Tue Jul 19, 2011 11:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">ehguacho wrote:</div><div class="quotecontent">me gustaria agregar una pequeña cosita: el "6502.txt" tiene algunos errores en los numeros de los opcodes. en el foro se dice que este -&gt; <a href="http://www.obelisk.demon.co.uk/6502/reference.html" class="postlink">http://www.obelisk.demon.co.uk/6502/reference.html</a> es el mejor documento sobre el 6502 de la web, ya que no tiene errores (cabe destacar que el documento es sobre el 6502 original, y NO sobre el 6502 que usa la NES, que tiene unas pequeñas variaciones). un sitio en el que te pueden ayudar muchisimo es este -&gt; <a href="http://forum.6502.org/" class="postlink">http://forum.6502.org/</a>, un foro hecho por gente que la tiene mas que clara con el 6502.</div><br /><br />Sí ese docuemento es el más exacto pero no explica los modos de direccionamiento. Yo decía para alguien que recién está empezando ...<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent">Me expresé mal, no es que apunté a que corra un juego específico, sino que le di soporte apenas para que pudiera correr cualquier juego con mapper 0. <br />Implementé todos los opcodes documentados, y los testeé. <br />Con respecto al render, en realidad como estoy desarollando el engine exclusivamente, no tiene render per se, simplemente emula el estado de la memoria de video, nametables, etc. y eso luego es tomado por algún plugin que se ocupa del render. <br />Por ahora y para testearlo hice un plugin muy básico que renderea no por scanline ni pixel, sino por sprite. Esto funciona, obviamente que los juegos que usan scroll con pantalla partida o algún otro truco entre scalines, se verán mal, pero para testear juegos sin scroll en pantalla fija como por ejemplo balloon fight, sirve. <br /><br />El emulador logró mostrar una pantalla estática con la intro del Zelda, que es una demo que alguien posteó en este foro, pero cuando pruebo juegos de verdad, crashean en algún lugar, y me parece medio tedioso usar un debugger normal para debugear el juego, por eso quiero desarrollar un debugger visual para ver en qué estado está la memoria de video, nametables, sprites y demás</div>
<br />
<br />Está bien, cada uno tiene su método. Yo no niego que en el futuro voy a necesitar un debugger mas o menos así.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Petruza</b> [ Tue Jul 19, 2011 2:47 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">ehguacho wrote:</div><div class="quotecontent"><a href="http://www.obelisk.demon.co.uk/6502/reference.html" class="postlink">http://www.obelisk.demon.co.uk/6502/reference.html</a> </div>
<br />
<br />Si, sobre ese doc basé mi cpu

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Anes</b> [ Tue Jul 19, 2011 4:13 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Petruza wrote:</div><div class="quotecontent"><div class="quotetitle">ehguacho wrote:</div><div class="quotecontent"><a href="http://www.obelisk.demon.co.uk/6502/reference.html" class="postlink">http://www.obelisk.demon.co.uk/6502/reference.html</a> </div><br /><br />Si, sobre ese doc basé mi cpu</div>
<br />
<br />En realidad, los cpu test de Blargg en el readme tienen una matriz de los ciclos de los opcodes, de ahí yo los tomé directamente e hice una matriz en C.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Petruza</b> [ Tue Jul 19, 2011 5:20 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />y la ejecución de las instrucciones, la hacés con punteros a función guardados en esa matriz?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ehguacho</b> [ Tue Jul 19, 2011 5:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />si están compadre, solo que no están en ESA página en particular. es cuestión de buscarla en el index jeje <a href="http://www.obelisk.demon.co.uk/index.html" class="postlink">http://www.obelisk.demon.co.uk/index.html</a>
<br />
<br />no creo que en este momento te haga falta la info que pueda brindarte ese sitio, simplemente contesto por si el día de mañana alguien lo lee <img src="./images/smilies/icon_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ehguacho</b> [ Tue Jul 19, 2011 5:52 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Petruza wrote:</div><div class="quotecontent">y la ejecución de las instrucciones, la hacés con punteros a función guardados en esa matriz?</div>
<br />
<br />segun lei en algunos documentos sobre emulacion, ese metodo tiene la mejor performance pero puede llegar a tirar un error de sobrecarga en la pila de llamadas. ¿sera cierto eso? ¿o con la capacidad de los procesadores de hoy uno deberia despreocuparse de algo asi?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Petruza</b> [ Tue Jul 19, 2011 6:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />No veo por qué podría haber problemas con la pila. Si se llamaran recursivamente podría ser, pero no tiene sentido.
<br />Cada CPU emulado debería llamar sólo a una instrucción a la vez

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ehguacho</b> [ Tue Jul 19, 2011 6:12 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Petruza wrote:</div><div class="quotecontent">No veo por qué podría haber problemas con la pila. Si se llamaran recursivamente podría ser, pero no tiene sentido.<br />Cada CPU emulado debería llamar sólo a una instrucción a la vez</div>
<br />
<br />lo mismo pense yo, pero queria sacarme la duda de todas maneras jeje

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Anes</b> [ Wed Jul 20, 2011 10:53 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Petruza wrote:</div><div class="quotecontent">y la ejecución de las instrucciones, la hacés con punteros a función guardados en esa matriz?</div>
<br />
<br />No, de ahí tomo los ciclos nomás, no uso puntero a funciones, excepto para los mappers.
<br />
<br />Mapeo la memoria del CPU y PPU.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>4</strong> of <strong>7</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 7 hours </span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />http://www.phpbb.com/</span></td>
</tr>
</table>

</body>
</html>